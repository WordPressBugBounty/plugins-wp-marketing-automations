(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{1436:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a(1),o=a(1048),i=a(331),l=function(e){var t=e.metrics,a=(0,o.a.getEmailAnalyticsLoading)();return Object(r.createElement)("div",{className:"bwf-crm-emails-report-tiles"},Object(r.createElement)(i.a,{items:t,title:Object(n.__)("Overview","wp-marketing-automations"),isLoading:a}))},c=a(327),s=a(33),u=a(5),m=a(6),p=a.n(m),b=a(2),f=a(12);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var r,n,o=[],i=!0,l=!1;try{for(a=a.call(e);!(i=(r=a.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==a.return||a.return()}finally{if(l)throw n}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var _=function(e){var t,a=e.query,i=e.metrics,l=a.chart?a.chart:"email_sents",m=o.a.getEmailAnalyticsLoading,y=o.a.getEmailAnalytics,_=m(),O=y(),g=d(Object(r.useState)(i[0]),2),j=g[0],v=g[1],h=(a.chartType&&a.chartType,Object(s.f)(a)),w=Object(s.b)(((t=a).period&&""!==t.period||(t.period="month"),t.compare&&""!==t.compare||(t.compare="previous_year"),a));w.includes(h)||(h=w[w.length-1]);Object(n.__)("Sent","wp-marketing-automations"),Object(n.__)("Open","wp-marketing-automations"),Object(n.__)("Clicks","wp-marketing-automations"),Object(n.__)("Orders","wp-marketing-automations"),Object(n.__)("Revenue","wp-marketing-automations");return Object(r.createElement)("div",{className:"bwf-mt-24"},Object(r.createElement)(c.a,{isRequesting:_,data:function(e){var t=[];O&&O.hasOwnProperty("intervals")&&O.intervals.map((function(a){return"email_sents"===e&&t.push({date:a.start_date,email_sents:{label:Object(n.__)("Email Sent","wp-marketing-automations"),value:parseInt(a.subtotals.email_sents)}}),"open_rate"===e&&t.push({date:a.start_date,email_open:{label:Object(n.__)("Opens","wp-marketing-automations"),value:parseInt(a.subtotals.email_open)}}),"click_rate"===e&&t.push({date:a.start_date,email_click:{label:Object(n.__)("Clicks","wp-marketing-automations"),value:parseInt(a.subtotals.email_click)}}),"total_orders"===e&&t.push({date:a.start_date,total_orders:{label:Object(n.__)("Total Orders","wp-marketing-automations"),value:parseInt(a.subtotals.total_orders)}}),"total_revenue"===e&&t.push({date:a.start_date,total_revenue:{label:Object(n.__)("Total Revenue","wp-marketing-automations"),value:parseInt(a.subtotals.total_revenue)}}),""}));return t}(l),title:Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:""},Object(n.__)("Performance","wp-marketing-automations"))),interval:h,layout:"item-comparison",chartType:"curve-line",interactiveLegend:!0,chartMeta:j,tabs:i,hideTypeSelect:!0,customHeaderItem:Object(r.createElement)(r.Fragment,null,i&&Object(b.isArray)(i)&&Object(r.createElement)("div",{className:"bwf-chart-tabs"},i.filter((function(e){return"convert_time"!==e.key})).map((function(e){return Object(r.createElement)(u.Button,{className:p()({"is-gray-light":j.key!==e.key,"is-secondary-light":j.key===e.key}),key:e.key,onClick:function(t){v(e),t.preventDefault(),delete a.compare,Object(f.k)({chart:e.key},"/",a)}},e.title)}))))}))},O=a(3),g=a(341),j=a(1186),v=a(351),h=a(9),w=a.n(h);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){A(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function S(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return M(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var D=function(e){var t=e.query,a=e.children,o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(t.hasOwnProperty("filter")){var a=0;return"broadcast"==t.filter?a=2:"automation"==t.filter&&(a=1),w()({path:Object(O.y)("/analytics/entity/data/?type=".concat(a,"&oid=").concat(e)),method:"GET"}).then((function(e){return 200==e.code&&e.hasOwnProperty("result")?[{key:e.result.id,label:e.result.title}]:[]}))}},i=[{staticParams:["page","path","period","chart","chartType"],param:"filter",showFilters:function(){return!0},filters:[{label:Object(n.__)("All Emails","wp-marketing-automations"),value:"all"}]}];if(Object(O.Sb)()){var l=[{label:Object(n.__)("Single Automation","wp-marketing-automations"),value:"select_automation",subFilters:[{component:"Search",value:"automation",path:["select_automation"],autocompleter:v.a,settings:{type:"custom",param:"id",selected:!0,getLabels:o,labels:{placeholder:Object(n.__)("Type to search for a automation","wp-marketing-automations"),button:Object(n.__)("Automation","wp-marketing-automations")}}}]},{label:Object(n.__)("Single Broadcast","wp-marketing-automations"),value:"select_broadcast",subFilters:[{component:"Search",value:"broadcast",path:["select_broadcast"],autocompleter:j.a,settings:{type:"custom",param:"id",getLabels:o,labels:{placeholder:Object(n.__)("Type to search for a broadcast","wp-marketing-automations"),button:Object(n.__)("Broadcast","wp-marketing-automations")}}}]}];i[0].filters=[].concat(S(i[0].filters),l)}return Object(r.createElement)("div",{className:"bwf-crm-emails-report-filter"},a,Object(r.createElement)(g.a,{siteLocale:"en-US",path:"/",query:t,filterTitle:"Email",filters:i,onDateSelect:function(e){var a=E(E({},t),e);delete a.compare,Object(f.k)(a,"/",{})},showDatePicker:!0,isoDateFormat:s.g,hideCompare:!0,dateQuery:function(e){e.compare="previous_year";var t=Object(s.e)(e),a=t.period,r=t.compare,n=t.before,o=t.after,i=Object(s.c)(e);return{period:a,compare:r,before:n,after:o,primaryDate:i.primary,secondaryDate:i.secondary}}(t),currency:Object(O.sb)()}))},Y=a(1068),I=a(1069),P=a(54),T=a(65),L=a(137),F=a(1078),N=a(1051);function C(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return x(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}t.default=function(){var e=Object(P.a)(Object(O.sb)()).formatAmount,t=Object(Y.a)(),a=t.fetchEmailAnalytics,i=t.setEmailAnalyticsData,c=t.fetchEmailTable,u=t.setEmailTableData;Object(I.a)("emails",!1,"");var m=Object(f.i)(),p=function(e){return e.compare="previous_year",Object(s.c)(e).primary};m.hasOwnProperty("period")||(m.period="month");var d=o.a.getEmailTableLoading,y=o.a.getEmailTableLimit,g=o.a.getEmailTableOffset,j=o.a.getEmailTablePage,v=o.a.getEmailTableList,h=o.a.getEmailTableTotal,w=o.a.getEmailAnalytics,k=d(),E=g(),A=y(),S=j(),M=v(),x=h(),R=w(),q=m.period,U=m.compare,B=m.interval,H=m.after,Q=m.before,$=m.id,G=m.filter,J=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,i=p(e),l="",s="";i&&(Object(b.isEmpty)(i.after)||(l=i.after.format("YYYY-MM-DD HH:mm:ss")),Object(b.isEmpty)(i.before)||(s=i.before.format("YYYY-MM-DD 23:59:59")),Object(b.isEmpty)(l)||Object(b.isEmpty)(s)||(r&&a(l,s,t,$,G),c(n,o,l,s,t,$,G)))};Object(r.useEffect)((function(){if(Object(O.l)(Object(n.__)("Email Analytics","wp-marketing-automations")),Object(O.Sb)()){var e=m.hasOwnProperty("interval")?m.interval:"day";J(m,e,!0,A,E)}else{for(var t=p(m),a=0,r=0,o=0,l=0,c=0,s=[],b=t.after;b.isBefore(t.before);b.add(1,"days")){var f=Math.floor(11*Math.random()),d=Math.floor(Math.random()*parseInt(f)),y=Math.floor(Math.random()*parseInt(f)),_=Math.floor(Math.random()*parseInt(y)),g=Math.floor(100*Math.random());s.push({date_end_gmt:b.format("YYYY-MM-DD")+" 23:59:59",date_start_gmt:b.format("YYYY-MM-DD")+" 00:00:00",end_date:b.format("YYYY-MM-DD")+" 23:59:59",interval:b.format("YYYY-MM-DD"),start_date:b.format("YYYY-MM-DD")+" 00:00:00",subtotals:{click_rate:(d/f*100).toFixed(2),email_click:d,email_open:y,email_sents:f,open_rate:(y/f*100).toFixed(2),total_orders:_,total_revenue:g}}),a+=y,r+=f,o+=d,l+=_,c+=g}i("data",{totals:{click_rate:(o/r*100).toFixed(2),email_click:o,email_open:a,email_sents:r,open_rate:(a/r*100).toFixed(2),total_orders:l,total_revenue:c},intervals:s}),i("isLoading",!1),u("data",[{click_count:o,click_rate:(o/r*100).toFixed(2),conversions:l,oid:"5",open_count:a,open_rate:(a/r*100).toFixed(2),revenue:c,sent:r,subject:Object(n.__)("Dummy Subject","wp-marketing-automations"),template:"",tid:"52",title:Object(n.__)("Dummy Mail","wp-marketing-automations"),type:"1"}]),u("isLoading",!1)}}),[q,U,B,H,Q,$,G]);var z,K=[{key:"subject",label:Object(n.__)("Subject","wp-marketing-automations"),isLeftAligned:!0},{key:"source",label:Object(n.__)("Source","wp-marketing-automations"),isLeftAligned:!1},{key:"sent",label:Object(n.__)("Sent","wp-marketing-automations"),isLeftAligned:!0,isNumeric:!0},{key:"open",label:Object(n.__)("Open Rate","wp-marketing-automations"),isLeftAligned:!0},{key:"click",label:Object(n.__)("Click Rate","wp-marketing-automations"),isLeftAligned:!1,isNumeric:!0},Object(O.fc)()?{key:"orders",label:Object(n.__)("Orders","wp-marketing-automations"),isLeftAligned:!0}:{},Object(O.fc)()?{key:"revenue",label:Object(n.__)("Revenue","wp-marketing-automations"),isLeftAligned:!1,isNumeric:!0}:{}],V=function(e){if(e!==A){u("limit",e);var t=m.hasOwnProperty("interval")?m.interval:"day";J(m,t,!1,e,E)}},W=function(e){if(!R||!R.hasOwnProperty("totals"))return 0;var t=R.totals;return t.hasOwnProperty(e)?t[e]:void 0},X=function(t){return[{key:"email_sents",title:Object(n.__)("Sent","wp-marketing-automations"),icon:"sent",value:parseInt(W("email_sents"))},{key:"open_rate",title:Object(n.__)("Open Rate","wp-marketing-automations"),icon:"open-rate",value:parseFloat(W("open_rate"))+" %"},{key:"click_rate",title:Object(n.__)("Click Rate","wp-marketing-automations"),icon:"click-rate",value:parseFloat(W("click_rate"))+" %"}].concat(C(Object(O.fc)()?[{key:"total_orders",title:Object(n.__)("Orders","wp-marketing-automations"),icon:"order-summary",value:parseInt(W("total_orders"))},{key:"total_revenue",title:Object(n.__)("Revenue","wp-marketing-automations"),icon:"revenue-new",value:e(W("total_revenue")),isCurrency:!0}]:[]))};return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-content-header-new"},Object(r.createElement)("div",{className:"bwf-content-header-left"},Object(r.createElement)("div",{className:"bwf-content-header-title"},Object(n.__)("Emails","wp-marketing-automations")))),Object(r.createElement)(T.a,null),Object(r.createElement)("div",{className:"bwf-crm-analytics-wrap bwf-crm-emails-report-wrap bwf-table-with-border"},!O.Qb&&!Object(O.Sb)()&&Object(r.createElement)(N.a,{onPage:!0,modalContent:{proLink:Object(O.ab)("upgrade",{utm_medium:"Email+Analytics+Upgrade+Modal"})}}),Object(r.createElement)(D,{query:m},O.Qb&&Object(r.createElement)(F.a,{title:Object(n.__)("Email Analytics","wp-marketing-automations"),message:Object(n.__)("Use our sample data to explore Email Analytics. Get detailed analytics across all automations and broadcasts.","wp-marketing-automations"),proLink:Object(O.ab)("upgrade",{utm_medium:"Email+Analytics+Sample+Data+Notice"})})),Object(r.createElement)("div",{className:"bwf_clear_2"}),Object(r.createElement)(l,{query:m,metrics:X()}),Object(r.createElement)(_,{query:m,metrics:X()}),Object(r.createElement)(L.a,{title:Object(n.__)("Emails","wp-marketing-automations"),rows:(z=[],Object(b.isEmpty)(M)||M.map((function(t){z.push([{display:t.subject?t.subject:"-",value:t.subject},{display:t.title?t.title:"-",value:t.title},{display:parseInt(t.sent)?parseInt(t.sent):"-",value:t.sent},{display:parseInt(t.open_rate)?parseFloat(t.open_rate).toFixed(1)+"%":"-",value:t.open_count},{display:parseInt(t.click_rate)?parseFloat(t.click_rate).toFixed(1)+"%":"-",value:t.click_count},Object(O.fc)()?{display:parseInt(t.conversions)?parseInt(t.conversions):"-",value:t.conversions}:{},Object(O.fc)()?{display:parseFloat(t.revenue)>0?Object(r.createElement)("span",{className:"bwf-tags bwf-tag-revenue"},e(t.revenue)):"-",value:t.revenue}:{}])})),z),headers:K,query:{paged:S},rowsPerPage:A?parseInt(A):25,totalRows:x,isLoading:k,onPageChange:function(e,t){var a=(e-1)*A;u("offset",a);var r=m.hasOwnProperty("interval")?m.interval:"day";J(m,r,!1,A,a)},onQueryChange:function(e){return"per_page"!==e?function(){}:V},showMenu:!1,rowHeader:!0,emptyMessage:Object(n.__)("No emails found","wp-marketing-automations")})))}}}]);