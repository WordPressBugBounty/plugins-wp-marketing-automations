(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{1063:function(e,t,n){"use strict";var r=n(74),a=n(0),o=n(1),i=n(3),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={workflow:{name:Object(o.__)("Workflow","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e):"admin.php?page=autonami-automations&edit=".concat(e),redirect:!t}};return t&&(n.single_a_contacts={name:Object(o.__)("Contacts","wp-marketing-automations"),link:"admin.php?page=autonami&path=/automation/".concat(e,"/contacts"),showOnClick:!0},n.analytics={name:Object(o.__)("Analytics","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/analytics"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/analytics"),isPro:!0,showOnClick:!0}),n.engagement={name:Object(o.__)("Engagements","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/engagements"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/engagements"),isPro:!0,showOnClick:!0},Object(i.pc)()&&(n.orders={name:Object(o.__)("Orders","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/orders"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/orders"),isPro:!0,showOnClick:!0}),n};t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],f=arguments.length>7&&void 0!==arguments[7]&&arguments[7],m=arguments.length>8&&void 0!==arguments[8]&&arguments[8],b=bwfcrm_contacts_data&&bwfcrm_contacts_data.header_data?bwfcrm_contacts_data.header_data:{},p=(b.automation_nav,b.automationv2_nav),d=Object(r.a)(),h=d.setActiveMultiple,y=d.resetHeaderMenu,v=d.setL2NavType,O=d.setL2Nav,w=d.setBackLink,j=d.setL2Title,g=d.setL2Content,E=d.setBackLinkLabel,_=d.setL2NavAlign,k=d.setPageHeader,N=d.setTabHeader;return Object(a.useEffect)((function(){y(!0),!i&&v("menu");var r=c(s,f);m||O(s?r:p),e&&r.hasOwnProperty(e)&&r[e].hasOwnProperty("name")&&N(r[e].name),h({leftNav:"automations-v2",rightNav:e}),n&&w(n),s&&w(n&&!f?"admin.php?page=autonami&path=/automations-v1":"admin.php?page=autonami&path=/automations"),i||f&&s&&E(Object(o.__)("All Automations","wp-marketing-automations")),!f&&s&&E(Object(o.__)("All Automations","wp-marketing-automations")),s&&_("left"),t&&""!==t&&j(t),!n&&l&&g(l),k(Object(o.__)("Automations","wp-marketing-automations")),u&&O({})}),[e,f,m]),!0}},1064:function(e,t){e.exports=function(e,t,n,r){for(var a=e.length,o=n+(r?1:-1);r?o--:++o<a;)if(t(e[o],o,e))return o;return-1}},1067:function(e,t){e.exports=function(e){return e!=e}},1068:function(e,t){e.exports=function(e,t,n){for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}},1078:function(e,t,n){var r=n(1064),a=n(1067),o=n(1068);e.exports=function(e,t,n){return t==t?o(e,t,n):r(e,a,n)}},1085:function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},1122:function(e,t,n){},1156:function(e,t,n){},1158:function(e,t,n){"use strict";var r=n(0),a=n(6),o=n.n(a),i=n(2),c=n(58),l=n(1),s=n(10),u=n.n(s),f=n(8),m=(n(1159),n(3)),b=n(19);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=p(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==p(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.header,n=void 0===t?Object(l.__)("View Analytics","wp-marketing-automations"):t,a=e.icon,s=void 0===a?"analytic":a,p=e.automationId,d=e.analyticsId,y=e.mode,O=void 0===y?"":y,w=e.extraData,j=void 0===w?{}:w,g=v(Object(r.useState)(!0),2),E=g[0],_=g[1],k=v(Object(r.useState)(!1),2),N=k[0],S=k[1],P=v(Object(r.useState)({}),2),x=P[0],L=P[1],C=function(){parseInt(d)>0&&Object(m.Zb)()?(_(!0),L({}),function(){try{var e=h(h({},j),{},{mode:O});u()({path:Object(m.A)("/automation/".concat(p,"/analytics/").concat(d,"?").concat(Object(b.stringify)(e))),method:"GET"}).then((function(e){200===e.code?Object(i.isEmpty)(e.result)||L(e.result):S(!0),_(!1)}))}catch(e){S(!0),_(!1)}}()):_(!1)},A=function(){var e,t=x.tile,n=void 0===t?[]:t;return N?Object(r.createElement)(r.Fragment,null,Object(l.__)("Error while fetching the Analytics.","wp-marketing-automations")):Object(m.Zb)()?Object(r.createElement)(r.Fragment,null,Object(i.isEmpty)(n)?Object(r.createElement)("div",{className:"bwf-normal-text"},Object(l.__)("No analytics found.","wp-marketing-automations")):Object(r.createElement)("div",{className:"bwf-info-brick"},n.map((function(e,t){var n=e.label,a=void 0===n?"":n,o=e.value,i=void 0===o?"-":o;if(""!==a)return Object(r.createElement)("div",{className:"bwf-info-item",key:t},Object(r.createElement)("span",{className:"bwf-node-content-type"},a),Object(r.createElement)("span",{className:"bwf-node-content-label"},i))})))):(e=[{label:Object(l.__)("Sent","wp-marketing-automations")},{label:Object(l.__)("Open Rate","wp-marketing-automations")}],"email"===O&&e.push({label:Object(l.__)("Click Rate","wp-marketing-automations")},{label:Object(l.__)("Click to Open Rate","wp-marketing-automations")}),e.push({label:Object(l.__)("Revenue","wp-marketing-automations")},{label:Object(l.__)("Revenue/Contact","wp-marketing-automations")},{label:Object(l.__)("Unsubscribe Rate","wp-marketing-automations")}),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-info-brick"},e.map((function(e,t){return Object(r.createElement)("div",{className:"bwf-info-item",key:t},Object(r.createElement)("span",{className:"bwf-node-content-type"},e.label),Object(r.createElement)("span",{className:"bwf-node-content-label"},"-"))}))),Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-normal-text"},Object(l.__)("Email Analytics is a PRO feature.","wp-marketing-automations")+" ",Object(r.createElement)("a",{target:"__blank",className:"bwf-normal-a-t bwf-font-light",href:Object(m.eb)("upgrade",{utm_medium:"Automation+Email+Analytics"})},Object(l.__)("Upgrade to PRO","wp-marketing-automations")))))};return Object(r.createElement)("div",{className:"bwf-info-popup"},Object(r.createElement)(c.a,{contentClassName:"bwf-info__popover",position:"top center",renderToggle:function(e){var t=e.onToggle,a=e.isOpen,i=o()("bwf-info__toggle bwf-cursor-pointer",{"is-opened":a});return Object(r.createElement)("div",{className:i,onClick:function(){t(),C()},"aria-expanded":a},Object(r.createElement)(f.a,{size:14,icon:s}),n)},renderContent:function(e){var t=e.onToggle;return Object(r.createElement)("div",{className:"bwf-info-popover-container"},Object(r.createElement)("div",{className:"bwf-info-popover-header"},Object(r.createElement)("div",{className:"bwf-info-header-text"},n,!Object(m.Zb)()&&m.e),Object(r.createElement)("span",{className:"bwf-info-close",onClick:t},Object(r.createElement)(f.a,{icon:"close",size:20}))),Object(r.createElement)("div",{className:"bwf-info-popover-body"},Object(r.createElement)("div",{className:"bwf-info-wrapper"},Object(r.createElement)("div",{className:"bwf-info--content"},E?Object(r.createElement)("div",{className:"bwf-info-brick"},[1,2,3,4,5,6].map((function(e){return Object(r.createElement)("div",{className:"bwf-info-item",key:e},Object(r.createElement)("span",{className:"bwf-node-content-type"},Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-60 bwf-h-15"})),Object(r.createElement)("span",{className:"bwf-node-content-label"},Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-90 bwf-h-15"})))}))):A()))))},focusOnMount:!0}))}},1159:function(e,t,n){},1400:function(e,t,n){},1401:function(e,t,n){},1402:function(e,t,n){},1403:function(e,t,n){},1404:function(e,t,n){},1405:function(e,t,n){},1406:function(e,t,n){},1469:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1058),o=n(2),i=n(6),c=n.n(i),l=n(1),s=(n(1120),n(8)),u=n(5),f=n(329),m=n(143),b=n(3);var p=n(10),d=n.n(p),h=(n(1122),n(55)),y=n(14),v=n(39),O=n(28);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(){j=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new C(r||[]);return a(i,"_invoke",{value:S(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var g=Object.getPrototypeOf,E=g&&g(g(A([])));E&&E!==n&&r.call(E,i)&&(O=E);var _=v.prototype=h.prototype=Object.create(O);function k(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function N(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==w(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function S(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=P(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function P(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(w(t)+" is not iterable")}return y.prototype=v,a(_,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},k(N.prototype),s(N.prototype,c,(function(){return this})),t.AsyncIterator=N,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new N(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(_),s(_,l,"Generator"),s(_,i,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=A,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;L(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:A(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function g(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){g(o,r,a,i,c,"next",e)}function c(e){g(o,r,a,i,c,"throw",e)}i(void 0)}))}}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==w(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){var t=Object(r.useContext)(b.h),n=e.isOpen,a=e.onRequestClose,i=e.node,p=e.isEvent,w=void 0===p||p,g=e.automationID,_=i.id,N=Object(f.a)(),P=N.setNodeDatabyId,x=N.fetchAutomation,L=N.setAutomationData,C=N.showSidebar,A=Object(m.a)(),T=A.getEventsList,I=A.getActionsList,D=A.getAutomationSteps,M=A.getAutomationLinks,F=A.getCount,G=A.getAutomationData,z=A.getNodeDataByID,Z=A.getautomationMeta,U=w?T():I(),q=S(Object(r.useState)({loading:!1,status:!1}),2),B=q[0],R=q[1],Y=U.group,H=void 0===Y?[]:Y,V=U.list,$=void 0===V?{}:V,J=U.subgroup,W=void 0===J?[]:J,K=U.subgroup_priority,Q=void 0===K?{}:K,X=U.subgroup_desc,ee=void 0===X?{}:X,te=S(Object(r.useState)(""),2),ne=te[0],re=te[1],ae=S(Object(r.useState)(""),2),oe=ae[0],ie=ae[1],ce=S(Object(r.useState)(""),2),le=ce[0],se=ce[1],ue=S(Object(r.useState)(""),2),fe=ue[0],me=ue[1],be=S(Object(r.useState)(!1),2),pe=be[0],de=be[1],he=S(Object(r.useState)({status:!1}),2),ye=he[0],ve=he[1],Oe=D(),we=M(),je=F(),ge=G("data"),Ee=z(_),_e=Ee.data,ke=void 0===_e?{}:_e,Ne=Ee.stepId,Se=void 0===Ne?0:Ne,Pe=Z(),xe=Object.keys(Q).sort((function(e,t){return Q[e]-Q[t]})),Le=ge.source,Ce=void 0===Le?"":Le,Ae=ge.event,Te=void 0===Ae?"":Ae,Ie=function(e){var t=[],n="";return H.map((function(r){(Object(o.isArray)(r.subgroup)&&r.subgroup.includes(e)||Object(o.isObject)(r.subgroup)&&Object.values(r.subgroup).includes(e))&&(t=r.subgroup,n=r.group_slug)})),{acsubgp:t,acgrp:n}};Object(r.useEffect)((function(){if(Object(o.isEmpty)(H)||(""!=Ce||""!=Te)&&w){var e=Ie(Ce),t=e.acsubgp,n=e.acgrp;se(Object(o.isObject)(t)?Object.values(t):t),ie(n),me(Te)}else ie(H[0].group_slug),se(Object(o.isObject)(H[0].subgroup)?Object.values(H[0].subgroup):H[0].subgroup)}),[n]),Object(r.useEffect)((function(){if(Object(o.isEmpty)(ne))if(Object(o.isEmpty)(H)||(""!=Ce||""!=Te)&&w){var e=Ie(Ce),t=e.acsubgp,n=e.acgrp;se(Object(o.isObject)(t)?Object.values(t):t),ie(n),me(Te)}else ie(H[0].group_slug);else ie("")}),[ne]);var De,Me,Fe=function(){a&&a()},Ge=function(){var e=E(j().mark((function e(n,r,a,c){var s,u;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!1,c.hasOwnProperty("event")&&$.hasOwnProperty(c.event)&&$[c.event].hasOwnProperty("need_unique_key")&&$[c.event].need_unique_key&&(s=!0),u={},u=""==Te?{steps:Object(o.cloneDeep)(n).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:r,count:a,data:c,need_unique_key:s}:{data:c,need_unique_key:s},e.prev=4,de(!0),t(Object(l.__)("Updating automation…","wp-marketing-automations")),e.next=9,d()({path:Object(b.A)("/automation/".concat(g)),method:"POST",data:{data:u}}).then(function(){var e=E(j().mark((function e(n){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==n.code){e.next=7;break}return e.next=3,x(g).then((function(){L("openStartSidebar",!0)})).then((function(){var e=Object(o.cloneDeep)(i);e.data.selected="start",L("sidebarNodeData",e),C(!0)}));case 3:t(n.message),Object(b.Kb)(t,3e3),e.next=8;break;case 7:throw Error(Object(b.u)(null==n?void 0:n.message));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 9:e.next=16;break;case 11:e.prev=11,e.t0=e.catch(4),Object(b.Kb)(t,3e3),de(!1),setTimeout((function(){R({status:!0,error:e.t0.message})}),[1500]);case 16:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),ze=function(){var e=E(j().mark((function e(n,r){var a;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={steps:Object(o.cloneDeep)(Oe).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:we,count:je,data:{action:{action:n,intergration:r}},updateStatus:2},e.prev=1,de(!0),t(Object(l.__)("Updating automation…","wp-marketing-automations")),e.next=6,d()({path:Object(b.A)("/automation/".concat(g,"/step/").concat(Se)),method:"POST",data:a}).then((function(e){if(200!==e.code)throw Error(Object(b.u)(null==e?void 0:e.message));P(i.id,{selected:n},{step_status:2}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&L("meta",k(k({},Pe),e.result.meta)),t(e.message)})).then((function(){var e=Object(o.cloneDeep)(i);e.data.selected=n,L("sidebarNodeData",e),C(!0),de(!1),Fe(),Object(b.Kb)(t,3e3)}));case 6:e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),Object(b.Kb)(t,3e3),de(!1),setTimeout((function(){R({status:!0,error:e.t0.message})}),[1500]);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),Ze=function(e){if("string"==typeof e&&""!==e&&Te!==e)if("start"===_&&w)ke.evtGroup=$[e].source_type,ke.event=e,function(e){var t={};t=Oe.map((function(t){return"start"==t.id&&(t.data=e),t}));var n=[];1==Oe.length?(t.push({id:"end",type:"end",data:{label:Object(l.__)("End Automation","wp-marketing-automations")},hidden:!1,position:{x:250,y:600}}),n=[{id:"endlink",source:"start",target:"end",sourceHandle:"",animated:!1}]):n=Object(o.cloneDeep)(we);var r=Object(o.cloneDeep)(ge);r.event=e.event,r.source=e.evtGroup,Ge(t,n,2,r)}(ke);else{var n=$[e].integration_slug;ze(e,n)}else t(Te===e?Object(l.__)("Please choose a different event to save.","wp-marketing-automations"):w?Object(l.__)("Please choose an event.","wp-marketing-automations"):Object(l.__)("Please choose an action.","wp-marketing-automations")),Object(b.Kb)(t,3e3)};return n?Object(r.createElement)(u.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-admin-modal-xl",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(r.createElement)("div",{className:"bwf-modal-search-header"},Object(r.createElement)("div",{className:"bwf-modal-title"},w?Object(l.__)("Select an Event","wp-marketing-automations"):Object(l.__)("Select an Action","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-modal-search-wrap"},Object(r.createElement)("div",{className:"bwf-component-search-control"},Object(r.createElement)(s.a,{icon:"search",size:15}),Object(r.createElement)(u.TextControl,{value:ne,onChange:re,placeholder:Object(l.__)("Search…","wp-marketing-automations")}))),Object(r.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:Fe},Object(r.createElement)(s.a,{icon:"close",size:20}))),Object(r.createElement)("div",{className:"bwf-event-modal-main"},Object(r.createElement)("div",{className:"bwf-event-modal-body"},Object(r.createElement)("div",{className:"bwf-modal-sidebar"},Object(r.createElement)("div",{className:"bwf-modal-filter-wrap"},H.map((function(e,t){if(function(e){var t=!1;if(e.hasOwnProperty("subgroup")&&!Object(o.isEmpty)(e.subgroup)){var n=[];(Object(o.isObject)(e.subgroup)?Object.values(e.subgroup):e.subgroup).map((function(e){W.hasOwnProperty(e)&&n.push(e)})),Object(o.isEmpty)(n)||(t=!0)}return t}(e))return Object(r.createElement)("div",{key:t,className:c()("bwf-modal-filter",{active:oe===e.group_slug}),onClick:function(){me(""),ie(e.group_slug),se(Object(o.isObject)(e.subgroup)?Object.values(e.subgroup):e.subgroup)}},e.label)})))),Object(r.createElement)("div",{className:"bwf-modal-content-content"},Object(r.createElement)("div",{className:"bwf-modal-content-brick"},Object(r.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(r.createElement)("div",{className:"bwf-brick-content"},(De=[],Me={},Object(o.isEmpty)(ne)?le.map((function(e){Me=k(k({},Me),W[e])})):Object.values(W).map((function(e){Me=k(k({},Me),e)})),De.push(Me),De).map((function(e,t){if(Object(o.isEmpty)(e))return Object(r.createElement)(r.Fragment,{key:t});var n=[],a=Object.keys(e);return Object(o.isEmpty)(xe)?n=a:xe.map((function(e){a.includes(e)&&n.push(e)})),Object(r.createElement)("div",{key:t+"-2"},n.map((function(t,n){var a=[];return a=function(e){var t=[];return(Object(o.isObject)(e)?Object.values(e):e).map((function(e){if($.hasOwnProperty(e)&&$[e].hasOwnProperty(w?"event_name":"action_name")){var n=w?$[e].event_name:$[e].action_name;(Object(o.isEmpty)(ne)||n.toLowerCase().includes(ne.toLowerCase()))&&t.push(e)}})),t}(e[t]),!Object(o.isEmpty)(a)&&Object(r.createElement)(r.Fragment,{key:n},Object(r.createElement)("div",{className:"bwf-brick-content-header",key:n},t),ee.hasOwnProperty(t)&&""!==ee[t]&&Object(r.createElement)(O.a,{status:"warning",icon:"shield",className:"bwf-mtb-12"},ee[t]),a.map((function(e,t){var n=!!$[e].hasOwnProperty("lock")&&$[e].lock;return Object(r.createElement)(y.a,{key:t,isPrimary:fe===e,isSecondary:fe!==e,className:"bwf-secondary-alter "+(Object(b.Zb)()?n?"locked":"":n?"not-pro locked":"not-pro"),onClick:function(){!Object(b.Zb)()&&n?ve({status:!0,featureTitle:w?$[e].event_name:$[e].action_name}):me(e)},disabled:Object(b.Zb)()&&n},fe===e&&Object(r.createElement)("span",{className:"bwf-circle-tick"},Object(r.createElement)(s.a,{icon:"tick",size:10})),w?$[e].event_name:$[e].action_name,n&&!Object(b.Zb)()&&Object(r.createElement)("span",{className:"bwf-display-flex bwf-ml-5"},Object(r.createElement)(s.a,{icon:"king",size:15})))})))})))}))))),Object(r.createElement)("div",{className:"bwf-modal-inner-footer bwf_text_right"},Object(r.createElement)(y.a,{className:"bwf-modal-cancel-btn",onClick:Fe},Object(l.__)("Cancel","wp-marketing-automations")),Object(r.createElement)(y.a,{isPrimary:!0,isBusy:pe,className:"bwf-no-ripple",onClick:function(){pe||Ze(fe)}},Object(l.__)("Done","wp-marketing-automations")))))),Object(r.createElement)(h.a,{modalTitle:w?Object(l.__)("Event Selection","wp-marketing-automations"):Object(l.__)("Action Selection","wp-marketing-automations"),errorMessage:B.error,onRequestClose:function(){return R({status:!1})},isOpen:B.status}),!Object(b.Zb)()&&Object(r.createElement)(v.b,{isOpen:ye.status,onRequestClose:function(){return ve({status:!1})},modalContent:{title:Object(l.sprintf)(Object(l.__)("%s is a PRO Event","wp-marketing-automations"),ye.featureTitle),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Event+Upgrade+Modal"})}})):""};function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(){C=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(A([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==L(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function A(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(L(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=A,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:A(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=L(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==L(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var G=function(e){var t=Object(r.useContext)(b.h),n=e.isOpen,a=e.onRequestClose,i=e.node,p=e.automationID,h=i.id,v=Object(f.a)(),O=v.setNodeDatabyId,w=v.setAutomationData,j=v.showSidebar,g=Object(m.a)(),E=g.getGoals,_=g.getAutomationSteps,k=g.getAutomationLinks,N=g.getCount,S=g.getNodeDataByID,P=(0,g.getautomationMeta)(),x=E(),L=x.group,A=void 0===L?[]:L,I=x.list,F=void 0===I?{}:I,G=x.subgroup,z=void 0===G?[]:G,Z=x.subgroup_priority,U=void 0===Z?{}:Z,q=M(Object(r.useState)(""),2),B=q[0],R=q[1],Y=M(Object(r.useState)(""),2),H=Y[0],V=Y[1],$=M(Object(r.useState)(""),2),J=$[0],W=$[1],K=M(Object(r.useState)(""),2),Q=K[0],X=K[1],ee=M(Object(r.useState)(!1),2),te=ee[0],ne=ee[1],re=_(),ae=k(),oe=N(),ie=S(h),ce=ie.data,le=void 0===ce?{}:ce,se=ie.stepId,ue=void 0===se?0:se,fe=U[H]?U[H]:{},me=le.source,be=void 0===me?"":me,pe=le.benchmark,de=void 0===pe?"":pe,he=function(e){var t=[],n="";return A.map((function(r){r.subgroup.includes(e)&&(t=r.subgroup,n=r.group_slug)})),{acsubgp:t,acgrp:n}};Object(r.useEffect)((function(){if(Object(o.isEmpty)(A)||""!=be||""!=de){var e=he(be),t=e.acsubgp,n=e.acgrp;W(t),V(n),X(de)}else V(A[0].group_slug),W(A[0].subgroup)}),[n]),Object(r.useEffect)((function(){if(Object(o.isEmpty)(B))if(Object(o.isEmpty)(A)||""!=be||""!=de){var e=he(be),t=e.acsubgp,n=e.acgrp;W(t),V(n),X(de)}else V(A[0].group_slug);else V("")}),[B]);var ye,ve=function(){a&&a()},Oe=function(){var e,n=(e=C().mark((function e(n,r){var a,c;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=le,ne(!0),a.benchmark=n,t(Object(l.__)("Adding benchmark..","wp-marketing-automations")),e.prev=4,c={steps:Object(o.cloneDeep)(re).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:ae,count:oe,data:{action:{benchmark:n,source:r}},updateStatus:2},e.next=8,d()({path:Object(b.A)("/automation/".concat(p,"/step/").concat(ue)),method:"POST",data:c}).then((function(e){200===e.code&&(t(e.message),O(parseInt(h),a,{step_status:2}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&w("meta",T(T({},P),e.result.meta)))})).then((function(){var e=Object(o.cloneDeep)(i);e.data.benchmark=n,w("sidebarNodeData",e),j(!0),ne(!1),ve()}));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.log(e.t0),ne(!0);case 14:Object(b.Kb)(t,3e3);case 15:case"end":return e.stop()}}),e,null,[[4,10]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){D(o,r,a,i,c,"next",e)}function c(e){D(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e,t){return n.apply(this,arguments)}}();return n?Object(r.createElement)(u.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-admin-modal-xl",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(r.createElement)("div",{className:"bwf-modal-search-header"},Object(r.createElement)("div",{className:"bwf-modal-title"},Object(l.__)("Select an Goal","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-modal-search-wrap"},Object(r.createElement)("div",{className:"bwf-component-search-control"},Object(r.createElement)(s.a,{icon:"search",size:15}),Object(r.createElement)(u.TextControl,{value:B,onChange:R,placeholder:Object(l.__)("Search…..")}))),Object(r.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:ve},Object(r.createElement)(s.a,{icon:"close",size:20}))),Object(r.createElement)("div",{className:"bwf-event-modal-main"},Object(r.createElement)("div",{className:"bwf-event-modal-body"},Object(r.createElement)("div",{className:"bwf-modal-sidebar"},Object(r.createElement)("div",{className:"bwf-modal-filter-wrap"},A.map((function(e,t){if(function(e){var t=!1;if(e.hasOwnProperty("subgroup")&&!Object(o.isEmpty)(e.subgroup)){var n=[];e.subgroup.map((function(e){z.hasOwnProperty(e)&&n.push(e)})),Object(o.isEmpty)(n)||(t=!0)}return t}(e))return Object(r.createElement)("div",{key:t,className:c()("bwf-modal-filter",{active:H===e.group_slug}),onClick:function(){X(""),V(e.group_slug),W(e.subgroup)}},e.label)})))),Object(r.createElement)("div",{className:"bwf-modal-content-content"},Object(r.createElement)("div",{className:"bwf-modal-content-brick"},Object(r.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(r.createElement)("div",{className:"bwf-brick-content"},(ye=[],Object(o.isEmpty)(B)&&!Object(o.isEmpty)(J)?J.map((function(e){ye.push(z[e])})):Object.values(z).map((function(e){ye.push(e)})),ye).map((function(e,t){if(Object(o.isEmpty)(e))return Object(r.createElement)("div",{key:t});var n=[];return n=fe&&Object.keys(fe).length>0?Object.keys(e).sort((function(e,t){return fe[e]||fe[t]?fe[e]&&!fe[t]?1:!fe[e]&&fe[t]?-1:fe[e]-fe[t]:1})):Object.keys(e),Object(r.createElement)("div",{key:t},n.map((function(t,n){var a=function(e){var t=[];return e.map((function(e){if(F.hasOwnProperty(e)&&F[e].hasOwnProperty("event_name")){var n=F[e].event_name;(Object(o.isEmpty)(B)||n.toLowerCase().includes(B.toLowerCase()))&&t.push(e)}})),t}(e[t]);return!Object(o.isEmpty)(a)&&Object(r.createElement)("div",{key:n},Object(r.createElement)("div",{className:"bwf-brick-content-header"},t),a.map((function(e){return Object(r.createElement)(y.a,{key:e,isPrimary:Q===e,isSecondary:Q!==e,className:"bwf-secondary-alter",onClick:function(){X(e)}},Q===e&&Object(r.createElement)("span",{className:"bwf-circle-tick"},Object(r.createElement)(s.a,{icon:"tick",size:10})),Object(r.createElement)(r.Fragment,null,F[e].event_name))})))})))}))))),Object(r.createElement)("div",{className:"bwf-modal-inner-footer bwf_text_right"},Object(r.createElement)(y.a,{className:"bwf-modal-cancel-btn",onClick:ve},Object(l.__)("Cancel","wp-marketing-automations")),Object(r.createElement)(y.a,{isPrimary:!0,className:"bwf-no-ripple",isBusy:te,onClick:function(){te||function(e){if("string"==typeof e&&""!==e){var n=F[e].source_type;Oe(e,n)}else t(Object(l.__)("Please choose an benchmark.","wp-marketing-automations")),Object(b.Kb)(t,3e3)}(Q)}},Object(l.__)("Done","wp-marketing-automations"))))))):""},z=function(e){var t=e.onNodeClick,n=e.onNoteToggleClick,a=e.onElipsisToggleClick,o=e.onInfoToggleClick,i=e.onNodeStatClick,c=e.onNodeQueuedStatClick,l=e.onNodeFailedStatClick,s=e.onAnalyticsClick,u=e.onNodeSkippedStatClick,f=Object(m.a)(),b=f.getEnableCopy,p=f.getEnableMove,d=b(),h=p(),y=Object(r.useCallback)((function(e,t){var n=!(!e.target||"string"!=typeof e.target.className)&&e.target.className;return!!n&&n.includes(t)||e.target.closest("."+t)}),[]);return function(e){if(!d&&!h)if(y(e,"bwf-note__toggle"))n&&n();else if(y(e,"bwf-ellipsis-menu__toggle"))a&&a();else if(y(e,"bwf-info__toggle"))o&&o();else if(y(e,"bwf-queued-status-wrap"))c&&c();else if(y(e,"bwf-failed-status-wrap"))l&&l();else if(y(e,"bwf-skipped-status-wrap"))u&&u();else if(y(e,"bwf-node-analytics"))s&&s();else if(y(e,"bwf-status-wrap"))i&&i();else{var r=y(e,"bwf-ellipsis-menu"),f=y(e,"bwf-note-popup"),m=y(e,"bwf-info-popup");r||f||m||t&&t()}}},Z=n(63),U=n(18),q=n(62);function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Y=function(e){var t=e.selected,n=void 0!==t&&t,i=B(Object(r.useState)(!1),2),c=i[0],u=i[1],p=Object(m.a)(),d=p.getEventsList,h=p.getAutomationData,y=p.getOpenStartSidebar,v=p.getEnableMove,O=p.getEnableCopy,w=p.getStatLoading,j=p.getStatData,g=O(),E=v(),_=h(),k=y(),N=w(),S=j(),P=_.ID,L=_.event,C=void 0===L?"":L,A=S.hasOwnProperty("start")?S.start:{};Object(r.useEffect)((function(){k&&(I("sidebarNodeData",e),D(!0))}),[k]);var T=Object(f.a)(),I=T.setAutomationData,D=T.showSidebar,M=d(),F=z({onNodeClick:!Object(o.isEmpty)(C)&&M.list.hasOwnProperty(C)&&function(){M.list[C].hasOwnProperty("fields")&&!Object(o.isEmpty)(M.list[C].fields)&&(I("sidebarNodeData",e),D(!0))},onNodeStatClick:function(){I("showContactModalId",C),I("showContactModalType","completed")},onNodeQueuedStatClick:function(){I("showContactModalId",C),I("showContactModalType","active")}});return Object(r.createElement)("div",{className:"bwf-node-wrapper"},Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":"")+(Object(o.isEmpty)(C)?" bwf-empty-start-node":""),onClick:F},Object(o.isEmpty)(C)?Object(r.createElement)("div",{className:"bwf-node-brick is-start-node",onClick:function(){return u(!0)}},Object(r.createElement)("div",{className:"bwf-node-icon"},Object(r.createElement)(s.a,{size:22,icon:"tap-icon"})),Object(r.createElement)("div",{className:"bwf-display-flex bwf-h4"},Object(l.__)("Select an Event","wp-marketing-automations"))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-brick is-start-node-selected"},Object(r.createElement)("div",{className:"bwf-node-icon icon-start"},Object(r.createElement)(s.a,{size:22,icon:"rocket"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},M.list.hasOwnProperty(C)&&M.list[C].hasOwnProperty("source_label")?M.list[C].source_label:""),Object(r.createElement)("div",{className:"bwf-node-content-label"},M.list.hasOwnProperty(C)&&M.list[C].hasOwnProperty("event_name")?M.list[C].event_name:Object(l.__)("Event Not Found","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"},!Object(o.isEmpty)(C)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(q.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!g&&!E),renderContent:function(e){var t=e.onToggle;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){u(!0),t()}},Object(r.createElement)(U.a,{justify:"flex-start"},Object(r.createElement)(U.c,null,Object(l.__)("Change Event","wp-marketing-automations")))))}})))),Object(r.createElement)("div",{className:"bwf-node-status bwf-node-m-0"},Object(r.createElement)("div",{className:"bwf-queued-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Active","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},N?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,A.hasOwnProperty("active")?Object(b.sc)(parseInt(A.active)):0))),Object(r.createElement)("div",{className:"bwf-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},N?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,A.hasOwnProperty("completed")?Object(b.sc)(parseInt(A.completed)):0)))))),!Object(o.isEmpty)(C)&&Object(r.createElement)(a.d,{type:"source",position:"bottom",isConnectable:!1}),Object(r.createElement)(x,{isOpen:c,node:e,onRequestClose:function(){return u(!1)},automationID:P}))},H=(n(58),n(1400),n(40));function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(){$=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==V(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(V(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function J(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Q=function(e){var t,n,a=e.node,i=a.id,p=void 0===i?"":i,h=a.data,y=Object(r.useContext)(b.h),v=W(Object(r.useState)(!1),2),O=v[0],w=v[1],j=W(Object(r.useState)(h.hasOwnProperty("note")?h.note:""),2),g=j[0],E=j[1],_=W(Object(r.useState)(!1),2),k=_[0],N=_[1],S=Object(f.a)().setNodeDatabyId,P=Object(m.a)(),x=P.getAutomationData,L=P.getNodeDataByID,C=P.getEnableMove,A=P.getEnableCopy,T=C(),I=A(),D=Object(o.isEmpty)(p)?{}:L(p),M=D.stepId,F=void 0===M?0:M,G=D.data,z=(void 0===G?{}:G).note,U=void 0===z?"":z,B=x().ID,R=function(){var e,t=(e=$().mark((function e(t){return $().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(!0),e.prev=1,e.next=4,d()({path:Object(b.A)("/automation/".concat(B,"/step/").concat(F)),method:"POST",data:{data:{data:{note:t}}}}).then((function(e){200===e.code&&(y(e.message),h.note=t,S(p,h),N(!1))}));case 4:w(!1),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),y(e.t0.message),w(!1);case 11:Object(b.Kb)(y,3e3);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){J(o,r,a,i,c,"next",e)}function c(e){J(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),Y=W(Object(r.useState)(!1),2),V=Y[0],K=Y[1];return Object(r.createElement)("div",{className:"bwf-note-popup"},function(e,t){var n=c()("bwf-note__toggle bwf-cursor-pointer",{"is-opened":t});return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:n,onClick:function(t){T||I||e(t)},"aria-expanded":t},!Object(o.isEmpty)(g)&&Object(r.createElement)("span",{className:"bwf-has-note"}),Object(r.createElement)(s.a,{size:16,icon:"note"})))}((function(){return K(!V)}),!0),V&&Object(r.createElement)(H.a,{position:"top right",className:"bwf-note__popover",onClose:function(){return K(!1)},focusOnMount:!0},(t=function(){return K(!V)},Object(r.createElement)("div",{className:"bwf-note-popover-container"},Object(r.createElement)("div",{className:"bwf-note-popover-header"},Object(r.createElement)("div",{className:"bwf-note-header-text"},Object(l.__)("Notes","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-note-close",onClick:t},Object(r.createElement)(s.a,{icon:"close",size:20}))),Object(r.createElement)("div",{className:"bwf-note-popover-body"},Object(o.isEmpty)(g)||k?Object(r.createElement)(r.Fragment,null,Object(r.createElement)(u.TextareaControl,{value:g,onChange:function(e){N(!0),E(e)}}),Object(r.createElement)("div",{className:"bwf_text_right",onClick:function(){return R(g)}},Object(r.createElement)(u.Button,{isPrimary:!0,isBusy:O},Object(o.isEmpty)(U)?Object(l.__)("Add","wp-marketing-automations"):Object(l.__)("Update","wp-marketing-automations")))):Object(r.createElement)("div",{className:"bwf-note-wrapper"},Object(r.createElement)("div",{className:"bwf-note--content"},Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:(n=g,n.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,'<a href="$1" target="_blank" class="bwf-a-no-underline">$1</a>'))}})),Object(r.createElement)(q.a,{label:Object(l.__)("Event note action","wp-marketing-automations"),renderContent:function(e){var t=e.onToggle;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){N(!0)}},Object(l.__)("Edit","wp-marketing-automations")),Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){t(),E(""),R("")}},Object(l.__)("Delete","wp-marketing-automations")))}})))))))},X=n(1123);function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(){te=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==ee(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(ee(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function ne(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ae(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ae(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var oe=function(e){var t=e.readables;return Object(r.createElement)("div",{className:"bwf-step-brick"},t.map((function(e,t){var n=e.map((function(e,t){return Object(o.isEmpty)(e)?Object(r.createElement)(r.Fragment,null):Object(r.createElement)("div",{key:t},0!==t&&Object(r.createElement)("div",{className:"bwf-step-divider"},Object(r.createElement)("span",{className:"bwf-divider"},"AND")),Object(r.createElement)("div",{className:"bwf-step-content-content bwf-two-line-ellipse-text"},e))}));return 0!==t?Object(o.isEmpty)(n)?Object(r.createElement)(r.Fragment,null):Object(r.createElement)("div",{key:t+"-or"},Object(r.createElement)("div",{className:"bwf-step-divider divider-line bwf-or"},Object(r.createElement)("span",{className:"bwf-divider"},"OR")),n):n})))},ie=function(e){var t=e.data,n=void 0===t?{}:t,i=e.selected,c=void 0!==i&&i,u=e.id,p=re(Object(r.useState)({status:!1,loading:!0}),2),d=p[0],y=p[1],v=Object(f.a)(),O=v.deleteNode,w=v.setAutomationData,j=v.showSidebar,g=v.setNodeForAdd,E=v.copyNodeHere,_=v.setOpenStepModal,k=v.setModalAnchorNode,N=v.fetchSplitPathNodes,S=Object(m.a)(),P=S.getAutomationId,x=S.getAutomationData,L=S.getEnableCopy,C=S.getEnableMove,A=S.getNodeDataByID,T=S.getLastAddedNode,I=S.getStatLoading,D=S.getStatData,M=T(),F=x().event,G=P(),B=I(),R=D();Object(r.useEffect)((function(){M==u&&(w("sidebarNodeData",e),j(!0),w("lastAddedNode",0))}),[M]);var Y,H,V=L(),$=C(),J=A(e.id),W=J.hasMultiParents,K=void 0!==W&&W,ee=J.stepId,ae=J.step_status,ie=void 0===ae?1:ae,ce=R.hasOwnProperty(ee)?R[ee]:{},le=Object(o.isEmpty)(F)||b.Xb?{}:Object(X.a)(F,parseInt(G)),se=le.isLoading,ue=le.error,fe=le.getReadableTexts,me=le.rules,be=b.Xb?[]:(Y=n.sidebarValues,H=[],Object(o.isEmpty)(Y)?[]:(Object.keys(Y).map((function(e){var t=Y[e],n=[];!Object(o.isEmpty)(t)&&Object(o.isArray)(t)&&(t.map((function(e){me.hasOwnProperty(e.filter)&&n.push(e)})),Object(o.isEmpty)(n)||H.push(n))})),H)),pe=b.Xb||se||ue||Object(o.isEmpty)(F)?[]:fe(be),de=z({onNodeClick:function(){w("sidebarNodeData",e),j(!0)},onNodeStatClick:function(){b.Xb?(w("proModalContent",Object(l.__)("Conditional Step","wp-marketing-automations")),w("showProModal",!0)):(w("showContactModalId",ee),w("showContactModalType","completed"))}});return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-wrapper","data-stepid":ee},Object(r.createElement)(a.d,{type:"target",position:"top",isConnectable:!1}),b.Xb?Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(c?"bwf-selected-node":"")+(2===parseInt(ie)?" bwf-draft-node":""),onClick:function(){w("proModalContent",Object(l.__)("Conditional Step","wp-marketing-automations")),w("showProModal",!0)}},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon"},Object(r.createElement)(s.a,{size:26,icon:"condition"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+ee),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Condition","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"})),Object(r.createElement)("div",{className:"bwf-control-event-error"},Object(r.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(r.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(c?"bwf-selected-node":"")+(2===parseInt(ie)?" bwf-draft-node":""),onClick:de},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon"},Object(r.createElement)(s.a,{size:26,icon:"condition"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Condition","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"},Object(r.createElement)(Q,{node:e}),Object(r.createElement)(q.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!V&&!$),renderContent:function(t){var n=t.onToggle,a=N();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){Object(b.Zb)()?(w("enableCopy",!0),w("copyData",{type:"conditional",data:e.data,id:e.id})):(w("proModalContent",Object(l.__)("Copy Step","wp-marketing-automations")),w("showProModal",!0)),n()}},Object(r.createElement)(U.a,{justify:"space-between"},Object(r.createElement)(U.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(U.c,null,b.e))),!a.includes(u)&&Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){Object(b.Zb)()?(w("enableMove",!0),w("moveID",e.id),w("copyData",{type:"conditional",data:e.data,id:e.id})):(w("proModalContent",Object(l.__)("Move Step","wp-marketing-automations")),w("showProModal",!0)),n()}},Object(r.createElement)(U.a,{justify:"space-between"},Object(r.createElement)(U.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(U.c,null,b.e))),Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){var t,r;y({status:!0,onConfirm:(t=te().mark((function t(){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O(e).then((function(){return y({status:!1})}));case 2:case"end":return t.stop()}}),t)})),r=function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){ne(o,r,a,i,c,"next",e)}function c(e){ne(o,r,a,i,c,"throw",e)}i(void 0)}))},function(){return r.apply(this,arguments)})}),n()}},Object(r.createElement)(U.a,{justify:"flex-start"},Object(r.createElement)(U.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Array.isArray(pe)&&pe.length?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-step-content"},Object(r.createElement)("div",{className:"bwf-step-content"},Object(r.createElement)(oe,{readables:pe}))),Object(r.createElement)("div",{className:"bwf-node-status"},Object(r.createElement)("div",{className:"bwf-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},B?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,ce.hasOwnProperty("completed")?Object(b.sc)(parseInt(ce.completed)):0))))):Object(r.createElement)(r.Fragment,null,se?Object(r.createElement)("div",{className:"bwf-node-step-content"},Object(r.createElement)("div",{className:"bwf-step-brick"},Object(r.createElement)("div",{className:"bwf-step-content-content"},Object(r.createElement)("div",{className:"bwf-step-brick"},Object(r.createElement)("div",{className:"bwf-step-content-content"},Object(l.__)("Loading","wp-marketing-automations")))))):Object(r.createElement)("div",{className:"bwf-control-event-error"},Object(r.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))))),K&&Object(r.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},V||$?Object(r.createElement)("div",{className:"bwf-drag-area",onClick:function(){return E(e,"before","")}},Object(r.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(r.createElement)("div",{className:"bwf-node-add"})),Object(r.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(r.createElement)("div",{className:"bwf-node-add",onClick:function(t){g(e.id,{option:"",position:"before"}),_(!0),k(t.target)}}))),Object(r.createElement)(a.d,{type:"source",position:"bottom",isConnectable:!1}),Object(r.createElement)(h.a,{modalTitle:Object(l.__)("Delete Conditional Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("conditional step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:d.onConfirm,isLoading:!1,onRequestClose:function(){return y({status:!1})},isOpen:d.status,isDelete:!0}))},ce=n(1158),le=n(145);function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(){ue=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==se(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(se(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function fe(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function me(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){fe(o,r,a,i,c,"next",e)}function c(e){fe(o,r,a,i,c,"throw",e)}i(void 0)}))}}function be(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var de=function(e){var t=e.data,n=void 0===t?{}:t,i=e.selected,c=void 0!==i&&i,u=e.id,p=be(Object(r.useState)(!1),2),d=p[0],y=p[1],v=be(Object(r.useState)({status:!1,loading:!0}),2),O=v[0],w=v[1],j=Object(f.a)(),g=j.deleteNode,E=j.setAutomationData,_=j.showSidebar,k=j.setNodeForAdd,N=j.copyNodeHere,S=j.setOpenStepModal,P=j.setModalAnchorNode,L=j.fetchSplitPathNodes,C=Object(m.a)(),A=C.getActionsList,T=C.getAutomationData,I=C.getNodeDataByID,D=C.getEnableCopy,M=C.getEnableMove,F=C.getLastAddedNode,G=C.getStatLoading,B=C.getStatData,R=F(),Y=A(),H=T(),V=G(),$=B(),J=H.ID,W=D(),K=M(),X=I(e.id),ee=X.hasMultiParents,te=void 0!==ee&&ee,ne=X.stepId,re=X.step_status,ae=void 0===re?1:re,oe=$.hasOwnProperty(ne)?$[ne]:{},ie=n.sidebarValues,se=void 0===ie?{}:ie,fe=n.desc_text,pe=void 0===fe?"":fe;Object(r.useEffect)((function(){R==u&&(y(!0),E("lastAddedNode",0))}),[R]);var de,he,ye,ve=z({onNodeClick:!!n.selected&&function(){Y.list.hasOwnProperty(n.selected)&&(E("sidebarNodeData",e),_(!0))},onNodeStatClick:function(){E("showContactModalId",ne),E("showContactModalType","completed")},onNodeFailedStatClick:function(){E("showContactModalId",ne),E("showContactModalType","failed")},onNodeSkippedStatClick:function(){E("showContactModalId",ne),E("showContactModalType","skipped")},onInfoToggleClick:function(){return E("analyticNodeId",ne)}}),Oe=!V&&oe.hasOwnProperty("failed")&&parseInt(oe.failed)>0&&oe.hasOwnProperty("skipped")&&parseInt(oe.skipped)>0;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-wrapper ".concat(Oe?"bwf-width-2":""),"data-stepid":ne},Object(r.createElement)(a.d,{type:"target",position:"top",isConnectable:!1}),Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(c?"bwf-selected-node":"")+(n.hasOwnProperty("selected")&&n.selected&&Y.list.hasOwnProperty(n.selected)&&2===parseInt(ae)&&Y.list[n.selected].hasOwnProperty("fields")&&!Object(o.isEmpty)(Y.list[n.selected].fields)?" bwf-draft-node":""),onClick:ve},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon icon-action"},Object(r.createElement)(s.a,{size:22,icon:"charge"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Action","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"},n.hasOwnProperty("selected")&&!Object(o.isEmpty)(n.selected)&&Object(r.createElement)(Q,{id:u,node:e}),Object(r.createElement)(q.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!W&&!K),renderContent:function(t){var a=t.onToggle,i=L();return Object(r.createElement)(r.Fragment,null,n.hasOwnProperty("selected")&&!Object(o.isEmpty)(n.selected)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){Object(b.Zb)()?(E("enableCopy",!0),E("copyData",{type:"action",data:e.data})):(E("proModalContent",{featureTitle:Object(l.__)("Copy Step","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),E("showProModal",!0)),a()}},Object(r.createElement)(U.a,{justify:"space-between"},Object(r.createElement)(U.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(U.c,null,b.e))),!i.includes(u)&&Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:me(ue().mark((function t(){return ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(b.Zb)()?(E("enableMove",!0),E("moveID",e.id),E("copyData",{type:"action",data:e.data})):(E("proModalContent",{featureTitle:Object(l.__)("Move Step","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),E("showProModal",!0)),a();case 2:case"end":return t.stop()}}),t)})))},Object(r.createElement)(U.a,{justify:"space-between"},Object(r.createElement)(U.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(U.c,null,b.e)))),Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){var t;w({status:!0,onConfirm:(t=me(ue().mark((function t(){return ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(e).then((function(){return w({status:!1})}));case 2:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}),a()}},Object(r.createElement)(U.a,{justify:"flex-start"},Object(r.createElement)(U.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),n.hasOwnProperty("selected")&&!Object(o.isEmpty)(n.selected)?Object(r.createElement)("div",{className:"bwf-node-step-content"},Object(r.createElement)("div",{className:"bwf-step-content"},Object(r.createElement)("div",{className:"bwf-step-brick"},Object(r.createElement)("div",{className:"bwf-step-content-content"},!Object(o.isEmpty)(n)&&n.hasOwnProperty("selected")&&(ye=Object(r.createElement)(r.Fragment,null),"wp_sendemail"===n.selected?(de=se.bwfan_email_data,he=void 0===de?{}:de,ye=Object(r.createElement)(r.Fragment,null,!Object(o.isEmpty)(he)&&Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle "},Object(r.createElement)(ce.a,{automationId:J,analyticsId:ne,mode:"email"})))):"twilio_send_sms"!==n.selected&&"bulkgate_send_transactional_sms"!==n.selected&&"linkmobility_send_sms"!==n.selected&&"unifonic_send_sms"!==n.selected||(ye=Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle"},Object(r.createElement)(ce.a,{automationId:J,analyticsId:ne,mode:"sms"}))),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-content-type"},Y.list.hasOwnProperty(n.selected)&&Y.list[n.selected].hasOwnProperty("integration_nicename")?Y.list[n.selected].integration_nicename:""),Object(r.createElement)("div",{className:"bwf-node-content-label"},Y.list.hasOwnProperty(n.selected)?Y.list[n.selected].action_name:Object(l.__)("Action Not Found","wp-marketing-automations")),!Object(o.isEmpty)(pe)&&Object(r.createElement)("div",{className:"bwf-node-content-label bwf-node-desc"+(Object(o.isArray)(pe)?"":" bwf-two-line-ellipse-text")},function(e){if(Object(o.isEmpty)(e))return Object(r.createElement)(r.Fragment,null);if(Object(o.isArray)(e)){var t="",n=[];return e.map((function(e){Object(o.isEmpty)(t)&&(t=e),n.push(Object(r.createElement)("span",{key:e},e))})),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-table-v-center"},Object(r.createElement)("span",null,!Object(o.isEmpty)(t)&&t),!Object(o.isEmpty)(n)&&n.length>1&&Object(r.createElement)("div",{className:"bwf-display-inline",onClick:function(e){e.preventDefault(),e.stopPropagation()}},Object(r.createElement)(le.a,{items:n}))))}return e}(pe)),ye,Y.list.hasOwnProperty(n.selected)&&Y.list[n.selected].hasOwnProperty("analytics_mode")&&""!==Y.list[n.selected].analytics_mode?Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle"},Object(r.createElement)(ce.a,{automationId:J,analyticsId:ne,mode:Y.list[n.selected].analytics_mode})):null)))))):Object(r.createElement)("div",{className:"bwf-control-event-error"},Object(r.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer",onClick:function(){return y(!0)}},Object(l.__)("Not Configured","wp-marketing-automations"))),n.hasOwnProperty("selected")&&!Object(o.isEmpty)(n.selected)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-status"},Object(r.createElement)("div",{className:"bwf-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},V?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,oe.hasOwnProperty("completed")?Object(b.sc)(parseInt(oe.completed)):0))),!V&&oe.hasOwnProperty("skipped")&&parseInt(oe.skipped)>0&&Object(r.createElement)("div",{className:"bwf-skipped-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Skipped","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count bwf-skipped-status"},Object(b.sc)(parseInt(oe.skipped)))),!V&&oe.hasOwnProperty("failed")&&parseInt(oe.failed)>0&&Object(r.createElement)("div",{className:"bwf-failed-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Failed","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count bwf-failed-status"},Object(b.sc)(parseInt(oe.failed))))))),te&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},W||K?Object(r.createElement)("div",{className:"bwf-drag-area",onClick:function(){return N(e,"before","")}},Object(r.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(r.createElement)("div",{className:"bwf-node-add"})),Object(r.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(r.createElement)("div",{className:"bwf-node-add",onClick:function(t){k(e.id,{option:"",position:"before"}),S(!0),P(t.target)}})))),Object(r.createElement)(a.d,{type:"source",isConnectable:!1,position:"bottom"}),Object(r.createElement)(x,{isOpen:d,onRequestClose:function(){return y(!1)},node:e,isEvent:!1,automationID:J}),Object(r.createElement)(h.a,{modalTitle:Object(l.__)("Delete Action Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("action step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:O.onConfirm,isLoading:!1,onRequestClose:function(){return w({status:!1})},isOpen:O.status,isDelete:!0}))},he=function(e){var t=Object(m.a)(),n=t.getEnableCopy,o=t.getEnableMove,i=t.getNodeDataByID,c=n(),s=o(),u=Object(f.a)(),b=u.copyNodeHere,p=u.setNodeForAdd,d=u.setOpenStepModal,h=u.setModalAnchorNode,y=i(e.id).hasMultiParents,v=void 0!==y&&y;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-wrapper"},v?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},c||s?Object(r.createElement)("div",{className:"bwf-drag-area",onClick:function(){return b(e,"before","")}},Object(r.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(r.createElement)("div",{className:"bwf-node-add"})),Object(r.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(r.createElement)("div",{className:"bwf-node-add",onClick:function(t){p(e.id,{option:"",position:"before"}),d(!0),h(t.target)}})),Object(r.createElement)(a.d,{type:"source",position:"top",isConnectable:!1})):Object(r.createElement)(a.d,{type:"source",position:"top",isConnectable:!1}),Object(r.createElement)("div",{className:"bwf-node-content bwf-end"},Object(r.createElement)("div",{className:"bwf-node-content-item"},Object(l.__)("End Automation","wp-marketing-automations")))))};function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(){ve=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==ye(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(ye(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function Oe(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function we(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return je(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?je(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ge=function(e){var t=e.data,n=void 0===t?{}:t,i=e.selected,c=void 0!==i&&i,u=e.id,p=we(Object(r.useState)(!1),2),d=p[0],y=p[1],v=we(Object(r.useState)({status:!1,loading:!0}),2),O=v[0],w=v[1],j=Object(f.a)(),g=j.deleteNode,E=j.setAutomationData,_=j.showSidebar,k=j.setNodeForAdd,N=j.copyNodeHere,S=j.setOpenStepModal,P=j.setModalAnchorNode,x=Object(m.a)(),L=x.getGoals,C=x.getNodeDataByID,A=x.getEnableCopy,T=x.getEnableMove,I=x.getLastAddedNode,D=x.getAutomationData,M=x.getStatLoading,F=x.getStatData,B=L().list,R=I(),Y=A(),H=T(),V=M(),$=F();Object(r.useEffect)((function(){R==u&&(y(!0),E("lastAddedNode",0))}),[R]);var J=D(),W=C(e.id),K=W.hasMultiParents,X=void 0!==K&&K,ee=W.stepId,te=W.step_status,ne=void 0===te?1:te,re=J.ID,ae=$.hasOwnProperty(ee)?$[ee]:{},oe=n.desc_text,ie=void 0===oe?"":oe,ce=z({onNodeClick:!!n&&!!n.benchmark&&function(){E("sidebarNodeData",e),_(!0)},onNodeStatClick:function(){b.Xb?(E("proModalContent",Object(l.__)("Goal Step","wp-marketing-automations")),E("showProModal",!0)):(E("showContactModalId",ee),E("showContactModalType","completed"))},onNodeQueuedStatClick:function(){b.Xb?(E("proModalContent",Object(l.__)("Goal Step","wp-marketing-automations")),E("showProModal",!0)):(E("showContactModalId",ee),E("showContactModalType","queued"))}});return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-wrapper","data-stepid":ee},Object(r.createElement)(a.d,{type:"target",position:"top",isConnectable:!1}),b.Xb?Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(c?"bwf-selected-node":"")+(2===parseInt(ne)?" bwf-draft-node":""),onClick:function(){E("proModalContent","Goal Step"),E("showProModal",!0)}},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(r.createElement)(s.a,{size:26,icon:"goal"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Goal","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"})),Object(r.createElement)("div",{className:"bwf-control-event-error"},Object(r.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(r.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(c?"bwf-selected-node":"")+(2===parseInt(ne)?" bwf-draft-node":""),onClick:ce},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(r.createElement)(s.a,{size:26,icon:"goal"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Goal","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"},n.hasOwnProperty("benchmark")&&!Object(o.isEmpty)(n.benchmark)&&Object(r.createElement)(Q,{node:e}),Object(r.createElement)(q.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!Y&&!H),renderContent:function(t){var a=t.onToggle;return Object(r.createElement)(r.Fragment,null,n.hasOwnProperty("benchmark")&&!Object(o.isEmpty)(n.benchmark)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){Object(b.Zb)()?(E("enableCopy",!0),E("copyData",{type:"benchmark",data:e.data})):(E("proModalContent",Object(l.__)("Copy Step","wp-marketing-automations")),E("showProModal",!0)),a()}},Object(r.createElement)(U.a,{justify:"space-between"},Object(r.createElement)(U.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(U.c,null,b.e))),Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){E("enableMove",!0),E("moveID",e.id),E("copyData",{type:"benchmark",data:e.data}),a()}},Object(r.createElement)(U.a,{justify:"flex-start"},Object(r.createElement)(U.c,null,Object(l.__)("Move","wp-marketing-automations"))))),Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){var t,n;w({status:!0,onConfirm:(t=ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(e).then((function(){return w({status:!1})}));case 2:case"end":return t.stop()}}),t)})),n=function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){Oe(o,r,a,i,c,"next",e)}function c(e){Oe(o,r,a,i,c,"throw",e)}i(void 0)}))},function(){return n.apply(this,arguments)})}),a()}},Object(r.createElement)(U.a,{justify:"flex-start"},Object(r.createElement)(U.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),!n.hasOwnProperty("benchmark")||Object(o.isEmpty)(n.benchmark)?Object(r.createElement)("div",{className:"bwf-control-event-error"},Object(r.createElement)("div",{className:"bwf-control-error-msg",onClick:function(){return y(!0)}},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(r.createElement)("div",{className:"bwf-node-step-content"},Object(r.createElement)("div",{className:"bwf-step-content"},Object(r.createElement)("div",{className:"bwf-step-brick"},Object(r.createElement)("div",{className:"bwf-step-content-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},B.hasOwnProperty(n.benchmark)&&B[n.benchmark].hasOwnProperty("source_label")?B[n.benchmark].source_label:""),Object(r.createElement)("div",{className:"bwf-node-content-label"},B.hasOwnProperty(n.benchmark)?B[n.benchmark].event_name:"Goal Not Found"),!Object(o.isEmpty)(ie)&&Object(r.createElement)("div",{className:"bwf-node-content-label bwf-node-desc"+(Object(o.isArray)(ie)?"":" bwf-two-line-ellipse-text")},function(e){if(Object(o.isEmpty)(e))return Object(r.createElement)(r.Fragment,null);if(Object(o.isArray)(e)){var t="",n=[];return e.map((function(e){Object(o.isEmpty)(t)&&(t=e),n.push(Object(r.createElement)("span",{key:e},e))})),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-table-v-center"},Object(r.createElement)("span",null,!Object(o.isEmpty)(t)&&t),!Object(o.isEmpty)(n)&&n.length>1&&Object(r.createElement)("div",{className:"bwf-display-inline",onClick:function(e){e.preventDefault(),e.stopPropagation()}},Object(r.createElement)(le.a,{items:n}))))}return e}(ie)))))),n.hasOwnProperty("benchmark")&&!Object(o.isEmpty)(n.benchmark)&&Object(r.createElement)("div",{className:"bwf-node-status"},Object(r.createElement)("div",{className:"bwf-queued-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Queued","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},V?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,ae.hasOwnProperty("queued")?Object(b.sc)(parseInt(ae.queued)):0))),Object(r.createElement)("div",{className:"bwf-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},V?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,ae.hasOwnProperty("completed")?Object(b.sc)(parseInt(ae.completed)):0))))),X&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},Y||H?Object(r.createElement)("div",{className:"bwf-drag-area",onClick:function(){return N(e,"before","")}},Object(r.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(r.createElement)("div",{className:"bwf-node-add"})),Object(r.createElement)("div",{className:"bwf-paste-label"},"Paste Here")):Object(r.createElement)("div",{className:"bwf-node-add",onClick:function(t){k(e.id,{option:"",position:"before"}),S(!0),P(t.target)}})))),Object(r.createElement)(a.d,{type:"source",position:"bottom",isConnectable:!1}),Object(r.createElement)(G,{isOpen:d,onRequestClose:function(){return y(!1)},node:e,automationID:re}),Object(r.createElement)(h.a,{modalTitle:Object(l.__)("Delete Goal Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("goal step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:O.onConfirm,isLoading:!1,onRequestClose:function(){return w({status:!1})},isOpen:O.status,isDelete:!0,deleteDescriptionText:Object(l.__)("Once you delete this step, all the queued contacts will move to next step right away.","wp-marketing-automations")}))},Ee=n(99),_e=n(9),ke=n.n(_e);function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(){Se=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==Ne(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Ne(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function Pe(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Le(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Le(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Ce={1:Object(l.__)("Delay for a specific period","wp-marketing-automations"),2:Object(l.__)("Delay until a specific date and time","wp-marketing-automations"),3:Object(l.__)("Delay until a custom field date","wp-marketing-automations"),4:Object(l.__)("Delay with variable","wp-marketing-automations")},Ae={1:Object(l.__)("Sun","wp-marketing-automations"),2:Object(l.__)("Mon","wp-marketing-automations"),3:Object(l.__)("Tue","wp-marketing-automations"),4:Object(l.__)("Wed","wp-marketing-automations"),5:Object(l.__)("Thu","wp-marketing-automations"),6:Object(l.__)("Fri","wp-marketing-automations"),7:Object(l.__)("Sat","wp-marketing-automations")},Te=function(e){var t=e.data,n=e.selected,i=void 0!==n&&n,c=e.id,u=xe(Object(r.useState)({status:!1,loading:!0}),2),p=u[0],d=u[1],y=Object(f.a)(),v=y.deleteNode,O=y.setAutomationData,w=y.showSidebar,j=y.setNodeForAdd,g=y.copyNodeHere,E=y.setOpenStepModal,_=y.setModalAnchorNode,k=y.fetchSplitPathNodes,N=Object(m.a)(),S=N.getNodeDataByID,P=N.getEnableCopy,x=N.getEnableMove,L=N.getLastAddedNode,C=N.getStatLoading,A=N.getStatData,T=L(),I=!Object(o.isEmpty)(t)&&t.hasOwnProperty("sidebarValues")?t.sidebarValues:{},D=I.type,M=void 0===D?0:D,F=I.data,G=void 0===F?{}:F,B=C(),R=A();Object(r.useEffect)((function(){T==c&&(O("sidebarNodeData",e),w(!0),O("lastAddedNode",0))}),[T]);var Y=function(){switch(parseInt(M)){case 1:var e=G.day_delay,t=void 0===e?{}:e,n=G.enable_time_delay,a=void 0!==n&&n,i=G.enable_week_delay,c=void 0!==i&&i,s=G.time_delay,u=void 0===s?{time:""}:s,f=G.week_delay,m=void 0===f?[]:f;if(!Object(o.isEmpty)(t)){var b=t.text+" "+function(e,t){switch(e){case"min":return parseInt(t)>1?Object(l.__)("Minutes","wp-marketing-automations"):Object(l.__)("Minute","wp-marketing-automations");case"hours":return parseInt(t)>1?Object(l.__)("Hours","wp-marketing-automations"):Object(l.__)("Hour","wp-marketing-automations");case"days":return parseInt(t)>1?Object(l.__)("Days","wp-marketing-automations"):Object(l.__)("Day","wp-marketing-automations");case"weeks":return parseInt(t)>1?Object(l.__)("Weeks","wp-marketing-automations"):Object(l.__)("Week","wp-marketing-automations");case"months":return parseInt(t)>1?Object(l.__)("Months","wp-marketing-automations"):Object(l.__)("Month","wp-marketing-automations");default:return""}}(t.unit,t.text),p=[];return c&&!Object(o.isEmpty)(m)&&m.map((function(e){Ae.hasOwnProperty(e)&&p.push(Ae[e])})),a&&u.hasOwnProperty("time")&&!Object(o.isEmpty)(u.time)?(b+=" till "+Object(Ee.format)(bwfcrm_contacts_data.time_format,ke()(u.time,"HH:mm:ss")),Object(o.isEmpty)(p)||(b+=" "+p.join("/")),u.hasOwnProperty("in_contact_timezone")&&u.in_contact_timezone&&(b+=" ".concat(Object(l.__)("in Contact's Timezone","wp-marketing-automations")))):Object(o.isEmpty)(p)||(b+=" "+p.join("/")),b+"."}break;case 2:var d=G.date,h=void 0===d?"":d,y=G.time_delay,v=void 0===y?{time:"",in_contact_timezone:!1}:y,O=G.enable_step_skip,w=void 0!==O&&O,j=G.skip_to_step,g=void 0===j?{step:"",name:""}:j;if(!Object(o.isEmpty)(h)&&!Object(o.isEmpty)(v.time)){var E="",_="";return v.hasOwnProperty("in_contact_timezone")&&v.in_contact_timezone?E+=" ".concat(Object(l.__)("in Contact's Timezone.","wp-marketing-automations")):E+=".",w&&!Object(o.isEmpty)(g)&&g.hasOwnProperty("step")&&""!=g.step&&g.hasOwnProperty("name")&&""!=g.name&&(_=" ".concat(Object(l.__)("Jump to","wp-marketing-automations")," ").concat(g.name,".")),Object(l.__)("Delay till ","wp-marketing-automations")+" "+Object(Ee.format)(bwfcrm_contacts_data.date_format,ke()(h))+" "+Object(l.__)("at","wp-marketing-automations")+" "+Object(Ee.format)(bwfcrm_contacts_data.time_format,ke()(v.time,"HH:mm:ss"))+" "+E+_}break;case 3:var k=G.custom_field,N=G.enable_time_delay,S=void 0!==N&&N,P=G.time_delay,x=G.enable_step_skip,L=void 0!==x&&x,C=G.skip_to_step,A=G.occurrence,T=void 0===A?"daymonth":A;if(k.hasOwnProperty("field")&&""!==k.field){var I=Object(l.__)("Delay","wp-marketing-automations");return S?P.hasOwnProperty("duration")&&(I+=" ".concat(Object(l.__)("of","wp-marketing-automations")," ").concat(P.duration," ").concat(P.type," ").concat(P.timing," ")):I+=" ".concat(Object(l.__)("till","wp-marketing-automations")),k.hasOwnProperty("custom_field_label")&&""!==k.custom_field_label?I+=" ".concat(Object(l.__)("Contacts","wp-marketing-automations")," '").concat(k.custom_field_label,"' ").concat(Object(l.__)("field value","wp-marketing-automations")):I+=" ".concat(Object(l.__)("Contacts","wp-marketing-automations")," ( ").concat(k.field," ) ").concat(Object(l.__)("field value","wp-marketing-automations")),"fulldatetime"!==T&&k.hasOwnProperty("time")&&""!==k.time&&(I+=" till ".concat(Object(Ee.format)(bwfcrm_contacts_data.time_format,ke()(k.time,"HH:mm:ss")))),k.hasOwnProperty("in_contact_timezone")&&k.in_contact_timezone?I+=" ".concat(Object(l.__)("in Contact's Timezone.","wp-marketing-automations")):I+=".",L&&!Object(o.isEmpty)(C)&&C.hasOwnProperty("step")&&""!=C.step&&C.hasOwnProperty("name")&&""!=C.name&&(I+=" ".concat(Object(l.__)("Jump to","wp-marketing-automations")," ").concat(C.name,".")),I}break;case 4:var D=G.variable_field,F=G.enable_time_delay,z=void 0!==F&&F,Z=G.time_delay,U=G.enable_step_skip,q=void 0!==U&&U,B=G.skip_to_step;if(D.hasOwnProperty("variable")&&""!==D.variable){var R=Object(l.__)("Delay","wp-marketing-automations");return z?Z.hasOwnProperty("duration")&&(R+=" ".concat(Object(l.__)("of","wp-marketing-automations")," ").concat(Z.duration," ").concat(Z.type," ").concat(Z.timing," ")):R+=" "+Object(l.__)("till","wp-marketing-automations"),D.hasOwnProperty("variable")&&""!==D.variable&&(R+=" ".concat(Object(l.__)("Orders meta key","wp-marketing-automations")," ").concat(D.variable," value")),D.hasOwnProperty("time")&&""!==D.time&&(R+=" till ".concat(Object(Ee.format)(bwfcrm_contacts_data.time_format,ke()(D.time,"HH:mm:ss")))),D.hasOwnProperty("in_contact_timezone")&&D.in_contact_timezone?R+=" ".concat(Object(l.__)("in Contact's Timezone.","wp-marketing-automations")):R+=".",q&&!Object(o.isEmpty)(B)&&B.hasOwnProperty("step")&&""!=B.step&&B.hasOwnProperty("name")&&""!=B.name&&(R+=" ".concat(Object(l.__)("Jump to","wp-marketing-automations")," ").concat(B.name,".")),R}break;default:return Object(r.createElement)(r.Fragment,null)}return Object(r.createElement)(r.Fragment,null)},H=P(),V=x(),$=S(e.id),J=$.hasMultiParents,W=void 0!==J&&J,K=$.stepId,X=$.step_status,ee=void 0===X?1:X,te=R.hasOwnProperty(K)?R[K]:{},ne=z({onNodeClick:function(){O("sidebarNodeData",e),w(!0)},onNodeStatClick:function(){O("showContactModalId",K),O("showContactModalType","completed")},onNodeQueuedStatClick:function(){O("showContactModalId",K),O("showContactModalType","queued")}});return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-wrapper","data-stepid":K},Object(r.createElement)(a.d,{type:"target",position:"top",isConnectable:!1}),Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ee)?" bwf-draft-node":""),onClick:ne},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon icon-delay"},Object(r.createElement)(s.a,{size:28,icon:"time-left"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+c),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Delay","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"},Object(r.createElement)(Q,{node:e}),Object(r.createElement)(q.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!H&&!V),renderContent:function(t){var n=t.onToggle,a=k();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){Object(b.Zb)()?(O("enableCopy",!0),O("copyData",{type:"wait",data:e.data})):(O("proModalContent",{featureTitle:Object(l.__)("Copy Step","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),O("showProModal",!0)),n()}},Object(r.createElement)(U.a,{justify:"space-between"},Object(r.createElement)(U.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(U.c,null,b.e))),!a.includes(c)&&Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){Object(b.Zb)()?(O("enableMove",!0),O("moveID",e.id),O("copyData",{type:"wait",data:e.data})):(O("proModalContent",{featureTitle:Object(l.__)("Move Step","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),O("showProModal",!0)),n()}},Object(r.createElement)(U.a,{justify:"space-between"},Object(r.createElement)(U.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(U.c,null,b.e))),Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){var t,r;d({status:!0,onConfirm:(t=Se().mark((function t(){return Se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v(e).then((function(){return d({status:!1})}));case 2:case"end":return t.stop()}}),t)})),r=function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){Pe(o,r,a,i,c,"next",e)}function c(e){Pe(o,r,a,i,c,"throw",e)}i(void 0)}))},function(){return r.apply(this,arguments)})}),n()}},Object(r.createElement)(U.a,{justify:"flex-start"},Object(r.createElement)(U.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(o.isEmpty)(t)||!parseInt(M)>0?Object(r.createElement)("div",{className:"bwf-control-event-error"},Object(r.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-step-content"},Object(r.createElement)("div",{className:"bwf-step-content"},Object(r.createElement)("div",{className:"bwf-step-brick"},Object(r.createElement)("div",{className:"bwf-step-content-content"},Ce.hasOwnProperty(M)&&Object(r.createElement)("div",{className:"bwf-node-content-type"},Ce[M]),Object(r.createElement)("div",{className:"bwf-node-content-label bwf-two-line-ellipse-text",title:Y()},Y()))))),Object(r.createElement)("div",{className:"bwf-node-status"},Object(r.createElement)("div",{className:"bwf-queued-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Queued","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},B?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,te.hasOwnProperty("queued")?Object(b.sc)(parseInt(te.queued)):0))),Object(r.createElement)("div",{className:"bwf-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},B?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,te.hasOwnProperty("completed")?Object(b.sc)(parseInt(te.completed)):0)))))),W&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},H||V?Object(r.createElement)("div",{className:"bwf-drag-area",onClick:function(){return g(e,"before","")}},Object(r.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(r.createElement)("div",{className:"bwf-node-add"})),Object(r.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(r.createElement)("div",{className:"bwf-node-add",onClick:function(t){j(e.id,{option:"",position:"before"}),E(!0),_(t.target)}})))),Object(r.createElement)(a.d,{type:"source",position:"bottom",isConnectable:!1}),Object(r.createElement)(h.a,{modalTitle:Object(l.__)("Delete Delay Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("delay step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:p.onConfirm,isLoading:!1,onRequestClose:function(){return d({status:!1})},isOpen:p.status,isDelete:!0,deleteDescriptionText:Object(l.__)("Once you delete this step, all the queued contacts will move to next step right away.","wp-marketing-automations")}))},Ie=function(e){var t=Object(f.a)().deleteNode;return Object(r.createElement)("div",{className:e&&e.data&&e.data.direction&&"no"===e.data.direction?"bwf-yes-no-node  bwf-no-node":"bwf-yes-no-node bwf-yes-node"},Object(r.createElement)(a.d,{type:"target",position:"top",style:{opacity:0},isConnectable:!1}),Object(r.createElement)("span",{className:"bwf-yes-no-wrap"},e&&e.data&&e.data.direction&&"no"===e.data.direction?Object(l.__)("No","wp-marketing-automations"):Object(l.__)("Yes","wp-marketing-automations"),Object(r.createElement)("button",{style:{display:"none"},onClick:function(){return t(e)}},"del")),Object(r.createElement)(a.d,{type:"source",position:"bottom",style:{opacity:0},isConnectable:!1}))};function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(){Me=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==De(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(De(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function Fe(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function Ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ze(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ze(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Ze=function(e){var t=e.selected,n=void 0!==t&&t,o=e.id,i=Ge(Object(r.useState)({status:!1,loading:!0}),2),c=i[0],u=i[1],p=Object(f.a)(),d=p.deleteNode,y=p.setAutomationData,v=p.setNodeForAdd,O=p.copyNodeHere,w=p.setOpenStepModal,j=p.setModalAnchorNode,g=Object(m.a)(),E=g.getNodeDataByID,_=g.getEnableCopy,k=g.getEnableMove,N=g.getLastAddedNode,S=g.getStatLoading,P=g.getStatData,x=N(),L=_(),C=k(),A=S(),T=P();Object(r.useEffect)((function(){x==o&&y("lastAddedNode",0)}),[x]);var I=E(e.id),D=I.hasMultiParents,M=void 0!==D&&D,F=I.stepId,G=T.hasOwnProperty(F)?T[F]:{},B=z({onNodeStatClick:function(){y("showContactModalId",F),y("showContactModalType","completed")}});return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-wrapper","data-stepid":F},Object(r.createElement)(a.d,{type:"target",position:"top",isConnectable:!1}),b.Xb?Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":""),onClick:function(){y("proModalContent","Exit Step"),y("showProModal",!0)}},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(r.createElement)(s.a,{size:26,icon:"exit"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+o),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Exit Automation","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"})),Object(r.createElement)("div",{className:"bwf-control-event-error"},Object(r.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(r.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":""),onClick:B},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(r.createElement)(s.a,{size:26,icon:"exit"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+o),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Exit Automation","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"},Object(r.createElement)(q.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!L&&!C),renderContent:function(t){var n=t.onToggle;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){var t,r;u({status:!0,onConfirm:(t=Me().mark((function t(){return Me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d(e).then((function(){return u({status:!1})}));case 2:case"end":return t.stop()}}),t)})),r=function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){Fe(o,r,a,i,c,"next",e)}function c(e){Fe(o,r,a,i,c,"throw",e)}i(void 0)}))},function(){return r.apply(this,arguments)})}),n()}},Object(r.createElement)(U.a,{justify:"flex-start"},Object(r.createElement)(U.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(r.createElement)("div",{className:"bwf-node-status"},Object(r.createElement)("div",{className:"bwf-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},A?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,G.hasOwnProperty("completed")?Object(b.sc)(parseInt(G.completed)):0))))),M&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},L||C?Object(r.createElement)("div",{className:"bwf-drag-area",onClick:function(){return O(e,"before","")}},Object(r.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(r.createElement)("div",{className:"bwf-node-add"}))):Object(r.createElement)("div",{className:"bwf-node-add",onClick:function(t){v(e.id,{option:"",position:"before"}),w(!0),j(t.target)}})))),Object(r.createElement)(a.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}),Object(r.createElement)(h.a,{modalTitle:Object(l.__)("Delete Exit Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("exit step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:c.onConfirm,isLoading:!1,onRequestClose:function(){return u({status:!1})},isOpen:c.status,isDelete:!0}))};function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(){qe=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==Ue(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Ue(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function Be(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function Re(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Be(o,r,a,i,c,"next",e)}function c(e){Be(o,r,a,i,c,"throw",e)}i(void 0)}))}}function Ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return He(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?He(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Ve=function(e){var t=e.data,n=void 0===t?{}:t,i=e.selected,c=void 0!==i&&i,u=e.id,p=Ye(Object(r.useState)({status:!1,loading:!0}),2),d=p[0],y=p[1],v=Object(f.a)(),O=v.deleteNode,w=v.setAutomationData,j=v.setNodeForAdd,g=v.copyNodeHere,E=v.setOpenStepModal,_=v.setModalAnchorNode,k=v.showSidebar,N=Object(m.a)(),S=N.getNodeDataByID,P=N.getEnableCopy,x=N.getEnableMove,L=N.getLastAddedNode,C=N.getStatLoading,A=N.getStatData,T=L(),I=P(),D=x(),M=C(),F=A();Object(r.useEffect)((function(){T==u&&w("lastAddedNode",0)}),[T]);var G=(!Object(o.isEmpty)(n)&&n.hasOwnProperty("sidebarValues")?n.sidebarValues:{}).jump_to,B=void 0===G?{}:G,R=B.name,Y=void 0===R?"":R,H=B.step,V=void 0===H?"":H,$=S(e.id),J=$.hasMultiParents,W=void 0!==J&&J,K=$.stepId,Q=F.hasOwnProperty(K)?F[K]:{},X=z({onNodeClick:function(){w("sidebarNodeData",e),k(!0)},onNodeStatClick:function(){Object(b.Zb)()?(w("showContactModalId",K),w("showContactModalType","completed")):(w("proModalContent","Jump Step"),w("showProModal",!0))}});return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-wrapper","data-stepid":K},Object(r.createElement)(a.d,{type:"target",position:"top",isConnectable:!1}),b.Xb?Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(c?"bwf-selected-node":""),onClick:function(){w("proModalContent","Jump Step"),w("showProModal",!0)}},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(r.createElement)(s.a,{size:26,icon:"jump"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Jump","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"})),Object(r.createElement)("div",{className:"bwf-control-event-error"},Object(r.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(r.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(c?"bwf-selected-node":""),onClick:X},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(r.createElement)(s.a,{size:26,icon:"jump"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Jump","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"},Object(r.createElement)(q.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!I&&!D),renderContent:function(t){var n=t.onToggle;return Object(r.createElement)(r.Fragment,null,""!=V&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){Object(b.Zb)()?(w("enableCopy",!0),w("copyData",{type:"jump",data:e.data})):(w("proModalContent","Copy Step"),w("showProModal",!0)),n()}},Object(r.createElement)(U.a,{justify:"space-between"},Object(r.createElement)(U.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(U.c,null,b.e))),Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:Re(qe().mark((function t(){return qe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(b.Zb)()?(w("enableMove",!0),w("moveID",e.id),w("copyData",{type:"jump",data:e.data})):(w("proModalContent","Move Step"),w("showProModal",!0)),n();case 2:case"end":return t.stop()}}),t)})))},Object(r.createElement)(U.a,{justify:"space-between"},Object(r.createElement)(U.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(U.c,null,b.e)))),Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){var t;y({status:!0,onConfirm:(t=Re(qe().mark((function t(){return qe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O(e).then((function(){return y({status:!1})}));case 2:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}),n()}},Object(r.createElement)(U.a,{justify:"flex-start"},Object(r.createElement)(U.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(o.isEmpty)(n)||Object(o.isEmpty)(B)||""==V?Object(r.createElement)("div",{className:"bwf-control-event-error no-padding"},Object(r.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(r.createElement)("div",{className:"bwf-node-step-content"},Object(r.createElement)("div",{className:"bwf-step-content"},Object(r.createElement)("div",{className:"bwf-step-brick"},Object(r.createElement)("div",{className:"bwf-step-content-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Jump to","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-node-content-label bwf-two-line-ellipse-text"},""!==Y?Y:"step #"+V))))),Object(r.createElement)("div",{className:"bwf-node-status"},Object(r.createElement)("div",{className:"bwf-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},M?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,Q.hasOwnProperty("completed")?Object(b.sc)(parseInt(Q.completed)):0))))),W&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},I||D?Object(r.createElement)("div",{className:"bwf-drag-area",onClick:function(){return g(e,"before","")}},Object(r.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(r.createElement)("div",{className:"bwf-node-add"}))):Object(r.createElement)("div",{className:"bwf-node-add",onClick:function(t){j(e.id,{option:"",position:"before"}),E(!0),_(t.target)}})))),Object(r.createElement)(a.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}),Object(r.createElement)(h.a,{modalTitle:Object(l.__)("Delete Jump Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("jump step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:d.onConfirm,isLoading:!1,onRequestClose:function(){return y({status:!1})},isOpen:d.status,isDelete:!0}))};function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(){Je=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==$e(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError($e(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function We(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function Ke(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Qe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Xe=function(e){var t=e.selected,n=void 0!==t&&t,i=e.id,c=e.data,u=void 0===c?{}:c,p=Ke(Object(r.useState)({status:!1,loading:!0}),2),d=p[0],y=p[1],v=Object(f.a)(),O=v.deleteNode,w=v.setAutomationData,j=v.setNodeForAdd,g=v.copyNodeHere,E=v.setOpenStepModal,_=v.setModalAnchorNode,k=v.showSidebar,N=Object(m.a)(),S=N.getNodeDataByID,P=N.getEnableCopy,x=N.getEnableMove,L=N.getLastAddedNode,C=N.getStatLoading,A=N.getStatData,T=L(),I=P(),D=x(),M=C(),F=A();Object(r.useEffect)((function(){T==i&&w("lastAddedNode",0)}),[T]);var G=S(e.id),B=G.hasMultiParents,R=void 0!==B&&B,Y=G.stepId,H=F.hasOwnProperty(Y)?F[Y]:{},V=!Object(o.isEmpty)(u)&&u.hasOwnProperty("sidebarValues")?u.sidebarValues:{},$=V.split_path,J=void 0===$?"":$,W=V.title,K=void 0===W?"":W,X=V.desc,ee=void 0===X?"":X,te=z({onNodeClick:function(){w("sidebarNodeData",e),k(!0)},onNodeStatClick:function(){Object(b.Zb)()?(w("showContactModalId",Y),w("showContactModalType","completed"),w("contactModalData",{split:!0,pathCount:J})):(w("proModalContent","Split Path Step"),w("showProModal",!0))},onAnalyticsClick:function(){}});return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-wrapper","data-stepid":Y},Object(r.createElement)(a.d,{type:"target",position:"top",isConnectable:!1}),b.Xb?Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":""),onClick:function(){w("proModalContent","Split Path Step"),w("showProModal",!0)}},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon icon-split-test"},Object(r.createElement)(s.a,{size:26,icon:"split-test"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+i),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Split Path","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"})),Object(r.createElement)("div",{className:"bwf-control-event-error"},Object(r.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(r.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(r.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":""),onClick:te},Object(r.createElement)("div",{className:"bwf-node-brick"},Object(r.createElement)("div",{className:"bwf-node-icon icon-split-test"},Object(r.createElement)(s.a,{size:26,icon:"split-test"})),Object(r.createElement)("div",{className:"bwf-node-inner-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+i),Object(r.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Split Path","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-node-action"},Object(r.createElement)(Q,{node:e}),Object(r.createElement)(q.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!I&&!D),renderContent:function(t){var n=t.onToggle;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){Object(b.Zb)()?(w("enableMove",!0),w("moveID",e.id),w("copyData",{type:"split",data:e.data,id:e.id})):(w("proModalContent",Object(l.__)("Move Step","wp-marketing-automations")),w("showProModal",!0)),n()}},Object(r.createElement)(U.a,{justify:"space-between"},Object(r.createElement)(U.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(U.c,null,b.e))),Object(r.createElement)(Z.a,{isClickable:!0,onInvoke:function(){var t,r;y({status:!0,onConfirm:(t=Je().mark((function t(){return Je().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O(e).then((function(){return y({status:!1})}));case 2:case"end":return t.stop()}}),t)})),r=function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){We(o,r,a,i,c,"next",e)}function c(e){We(o,r,a,i,c,"throw",e)}i(void 0)}))},function(){return r.apply(this,arguments)})}),n()}},Object(r.createElement)(U.a,{justify:"flex-start"},Object(r.createElement)(U.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(o.isEmpty)(u)||Object(o.isEmpty)(J)?Object(r.createElement)("div",{className:"bwf-control-event-error"},Object(r.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-step-content"},Object(r.createElement)("div",{className:"bwf-step-content"},Object(r.createElement)("div",{className:"bwf-step-brick bwf-split-wrap"},Object(r.createElement)("div",{className:"bwf-step-content-content"},Object(r.createElement)("div",{className:"bwf-node-content-type"},""!==K?K:"-"),""!==ee&&Object(r.createElement)("div",{className:"bwf-node-content-label bwf-node-desc bwf-two-line-ellipse-text"},ee)),Object(r.createElement)("div",{className:"bwf-node-analytics bwf-split-path-analytics"},Object(r.createElement)("div",{className:"bwf-analytics-btn",onClick:function(){Object(b.Zb)()?(w("declareWinner",{nodeId:i,stepID:Y,title:K}),w("showSplitWinner",!0)):(w("proModalContent",Object(l.__)("Split Step","wp-marketing-automations")),w("showProModal",!0))}},!Object(b.Zb)()&&Object(r.createElement)(s.a,{icon:"king",size:14,color:"#fff"}),Object(l.__)("View Results","wp-marketing-automations")))))),Object(r.createElement)("div",{className:"bwf-node-status bwf-node-mt-10"},Object(r.createElement)("div",{className:"bwf-status-wrap"},Object(r.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(r.createElement)("span",{className:"bwf-node-status-count"},M?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(r.createElement)(r.Fragment,null,H.hasOwnProperty("completed")?Object(b.sc)(parseInt(H.completed)):0)))))),R&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},I||D?Object(r.createElement)("div",{className:"bwf-drag-area",onClick:function(){return g(e,"before","")}},Object(r.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(r.createElement)("div",{className:"bwf-node-add"}))):Object(r.createElement)("div",{className:"bwf-node-add",onClick:function(t){j(e.id,{option:"",position:"before"}),E(!0),_(t.target)}})))),Object(r.createElement)(a.d,{type:"source",position:"bottom",isConnectable:!1}),Object(r.createElement)(h.a,{modalTitle:Object(l.__)("Delete Split Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("split step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:d.onConfirm,isLoading:!1,onRequestClose:function(){return y({status:!1})},isOpen:d.status,isDelete:!0}))},et=function(e){var t=e.data,n=void 0===t?{}:t,o=e.id,i=Object(m.a)().getNodeDataByID,c=Object(f.a)().deleteNode,s=i(o).stepId,u=Object(b.Lc)(),p=n.path,d=void 0===p?"1":p;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-splitpath-node-wrapper","data-stepid":s},Object(r.createElement)(a.d,{type:"target",position:"top",isConnectable:!1}),Object(r.createElement)("div",{className:"bwf-split-node split-path-"+d},Object(l.__)("Path","wp-marketing-automations")+" "+u[d],Object(r.createElement)("button",{style:{display:"none"},onClick:function(){return c(e)}},"del"))),Object(r.createElement)(a.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}))},tt=(n(1401),n(87)),nt=n(109),rt=n(357),at=n(24);n(1402);function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(Object(n),!0).forEach((function(t){lt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=ot(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ot(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function st(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ut(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ft=function(e){var t=Object(r.useRef)(null),n=e.mergetag,a=e.copyTagToClipBoard,i=e.automationId,s=st(Object(r.useState)({}),2),f=s[0],m=s[1],b=st(Object(r.useState)({}),2),p=b[0],d=b[1],h=st(Object(r.useState)({}),2),y=h[0],v=h[1],O=n.schema,w=void 0===O?[]:O,j=n.tag_name,g=void 0===j?"":j,E=n.default_val,_=void 0===E?[]:E;Object(r.useEffect)((function(){var e={},t={};w.map((function(n){e[n.id]=n.type,t[n.id]=n})),d(e),v(t)}),[w]);var k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,r=t.fields,a=t.relation,o=void 0===a?"OR":a;o=o.toUpperCase();try{var i=null;if("OR"===o){if(r&&Array.isArray(r))for(var c=0;c<r.length;c++){i=e[r[c].id];var l=void 0===r[c].value||r[c].value;if(""!=l&&i==l||""==l&&""!=i&&null!=i)return!0}}else"AND"==o&&r&&Array.isArray(r)&&(n=r.every((function(t){i=e[t.id];var n=void 0===t.value||t.value;return(""===n||i==n)&&(""!=n||""!=i&&null!=i)})))}catch(e){console.log(e)}return n},N=Object(r.useMemo)((function(){var e=["{{"+g];if(!Object(o.isEmpty)(f))if("cart_recovery_link"===g){var t=f.coupon_type,n=void 0===t?"static":t,r=f.dynamic_coupon,a=void 0===r?"":r,i=f.static_coupon,c=void 0===i?"":i;"static"===n&&""!==c?e.push("coupon='"+c+"'"):"dynamic"===n&&""!==a&&e.push("coupon='"+a+"'")}else Object.entries(f).map((function(t){var n=st(t,2),r=n[0],a=n[1];if(!y[r].hasOwnProperty("toggler")||Object(o.isEmpty)(y[r].toggler)||k(f,y[r].toggler,y[r]))if("search"!=p[r]||Object(o.isEmpty)(a))""!==a&&e.push(r+"='"+a+"'");else{var i=[];a.map((function(e){i.push(e.id)})),e.push(r+"='"+i.join(",")+"'")}}));return e.join(" ")+"}}"}),[f]);return Object(r.createElement)("div",{className:"bwf-merge-tag-wrap bwf_w_full"},Object(r.createElement)(tt.a,{onChange:function(e){!function(e){var t=ct(ct({},_),f);t[e.name]=e.value,m(t)}(e)},initialValues:ct(ct({},_),f),validate:function(){return!1}},(function(e){var n=e.getInputProps,a=e.values;e.errors,e.handleSubmit;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"wr_content",ref:t},Object(r.createElement)("div",null,w.map((function(e,t){return Object(r.createElement)(r.Fragment,{key:t},(Object(o.isEmpty)(e.toggler)||k(a,e.toggler,e))&&e.wrap_before&&Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(r.createElement)(r.Fragment,null,!1!==e.show&&(Object(o.isEmpty)(e.toggler)||k(a,e.toggler,e))&&Object(r.createElement)(nt.a,{input:e,formProps:n(e.id),values:a,automationId:i})):e.hint?Object(r.createElement)(r.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:c()(e.class)}):null,(Object(o.isEmpty)(e.toggler)||k(a,e.toggler,e))&&e.wrap_after&&Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))))})),Object(r.createElement)("div",{className:"bwf-merge-tag-config-view"},Object(r.createElement)("span",{className:"bwf-merge-tag"},N),Object(r.createElement)("div",{className:"bwf-display-flex bwf-j-end"},Object(r.createElement)(u.Button,{isPrimary:!0,onClick:function(){a(N)},disabled:(w.map((function(e){if(e.hasOwnProperty("required")&&e.required&&(!f.hasOwnProperty(e.id)||""===f[e.id]))return!1})),!(""!==N))},Object(l.__)("Copy","wp-marketing-automations")))))},mt=n(201);function bt(e){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){ht(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ht(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=bt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=bt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return vt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Ot=function(e){var t=Object(r.useContext)(b.h),n=Object(r.useContext)(mt.a).setSelectedMergeTag,a=e.isOpen,i=e.onRequestClose,f=e.automationID,p=yt(Object(r.useState)(""),2),d=p[0],h=p[1],y=yt(Object(r.useState)(""),2),v=y[0],O=y[1],w=yt(Object(r.useState)({}),2),j=w[0],g=w[1],E=(0,Object(m.a)().getMergeTagList)();Object(r.useEffect)((function(){a||(g({}),h(""),Object(o.isEmpty)(E)||O(Object.keys(E)[0]))}),[a]);var _=function(){i&&i()},k=function(e){n(e);var r=document.createElement("textarea");r.value=e,document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r),t(Object(l.__)("Merge tag copied.","wp-marketing-automations")),Object(b.Kb)(t,3e3),_()},N=function(){var e,t=(e={},Object.entries(E).map((function(t){var n=yt(t,2),r=n[0],a=n[1];""!==v?v==r&&(e=a):""!==d?Object.entries(a).map((function(t){var n=yt(t,2),r=n[0],a=n[1];(r.includes(d)||a.hasOwnProperty("tag_name")&&a.tag_name.includes(d))&&(e[r]=a)})):e=dt(dt({},e),a)})),Object.values(e).sort((function(e,t){return e.priority-t.priority})));return Object(o.isEmpty)(t)?Object(r.createElement)("tr",null,Object(r.createElement)("td",{className:"bwf-no-merge-tag"},Object(l.__)("No Merge Tag Available","wp-marketing-automations"))):Object(r.createElement)(r.Fragment,null,Object.entries(t).map((function(e,t){var n=yt(e,2),a=(n[0],n[1]);return Object(r.createElement)("tr",{key:"row"+t},Object(r.createElement)("td",null,Object(r.createElement)("span",{className:"bwf-tag-label"},a.tag_description)),Object(r.createElement)("td",null,Object(r.createElement)("span",{className:"bwf-tag-slug"},"{{"+a.tag_name+"}}")),Object(r.createElement)("td",null,a.hasOwnProperty("schema")?Object(r.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return g(a)},title:Object(l.__)("Configure","wp-marketing-automations")},Object(r.createElement)(s.a,{color:"#353030",icon:"settings"})):Object(r.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return k("{{"+a.tag_name+"}}")},title:Object(l.__)("Copy","wp-marketing-automations")},Object(r.createElement)(s.a,{color:"#353030",icon:"duplicate"}))))})))};return a?Object(r.createElement)(u.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-event-search-modal__merge-tag bwf-admin-modal-xl",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(r.createElement)("div",{className:"bwf-modal-search-header"},Object(r.createElement)("div",{className:"bwf-modal-title"},Object(o.isEmpty)(j)?Object(l.__)("Merge Tags","wp-marketing-automations"):Object(r.createElement)("div",{className:"bwf-display-flex"},Object(r.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){g({})}},Object(r.createElement)(s.a,{icon:Object(l.isRTL)()?"arrow-right":"arrow-left"})),j.hasOwnProperty("tag_description")?j.tag_description:"")),Object(r.createElement)("div",{className:"bwf-modal-search-wrap"},Object(o.isEmpty)(j)&&Object(r.createElement)("div",{className:"bwf-component-search-control"},Object(r.createElement)(s.a,{icon:"search",size:15}),Object(r.createElement)(u.TextControl,{value:d,onChange:function(e){""===e?Object(o.isEmpty)(E)||O(Object.keys(E)[0]):O(""),h(e)},placeholder:Object(l.__)("Search by name","wp-marketing-automations")}))),Object(r.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:_},Object(r.createElement)(s.a,{icon:"close",size:20}))),Object(r.createElement)("div",{className:"bwf-event-modal-main"},Object(r.createElement)("div",{className:"bwf-event-modal-body bwf-merge-modal-content"+(Object(o.isEmpty)(j)&&!Object(o.isEmpty)(E)?"":" gridfull")},Object(o.isEmpty)(j)?Object(o.isEmpty)(E)?Object(r.createElement)("div",{className:"bwf-modal-content-content"},Object(r.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(r.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(r.createElement)("div",{className:"bwf-brick-content"},Object(r.createElement)("div",{className:"bwf-merge-tag-list"},Object(r.createElement)("div",{className:"bwf-no-merge-tag"},Object(l.__)("No Merge Tag Available","wp-marketing-automations"))))))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-modal-sidebar"},Object(r.createElement)("div",{className:"bwf-modal-filter-wrap"},Object.keys(E).map((function(e){return Object(r.createElement)("div",{key:e,className:c()("bwf-modal-filter",{active:v===e}),onClick:function(){h(""),O(e)}},e)})))),Object(r.createElement)("div",{className:"bwf-modal-content-content"},Object(r.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(r.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(r.createElement)("div",{className:"bwf-brick-content"},Object(r.createElement)("div",{className:"bwf-merge-tag-list"},Object(r.createElement)("table",null,Object(r.createElement)("tbody",null,N())))))))):Object(r.createElement)(ft,{mergetag:j,copyTagToClipBoard:k,automationId:f})))):""};function wt(e){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(){jt=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==wt(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(wt(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){_t(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _t(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=wt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==wt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kt(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function Nt(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){kt(o,r,a,i,c,"next",e)}function c(e){kt(o,r,a,i,c,"throw",e)}i(void 0)}))}}function St(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Pt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var xt=function(){var e=Object(r.useContext)(b.h),t=Object(m.a)(),n=t.getSidebarNodeData,a=t.getSelectedSidebarData,i=t.getAutomationId,u=t.getNodeDataByID,p=t.getAutomationData,h=(0,t.getautomationMeta)(),v=Object(f.a)(),w=v.showSidebar,j=v.setNodeDatabyId,g=v.setAutomationData,E=p().event,_=void 0===E?"":E,k=i(),N=Object(r.useRef)(null),S=St(Object(r.useState)(!1),2),P=S[0],x=S[1],L=St(Object(r.useState)(""),2),C=L[0],A=L[1],T=St(Object(r.useState)(!1),2),I=T[0],D=T[1],M=St(Object(r.useState)(!1),2),F=M[0],G=M[1],z=St(Object(r.useState)([]),2),Z=z[0],U=z[1],q=St(Object(r.useState)(!1),2),B=q[0],R=q[1],Y=St(Object(r.useState)(!1),2),H=Y[0],V=Y[1],$=n(),J=St(Object(r.useState)(!1),2),W=J[0],K=J[1],Q=!Object(o.isEmpty)($)&&$.hasOwnProperty("data")?$.data:{},X=Object(o.isEmpty)($)?{}:a($),ee=X.side_header,te=void 0===ee?[]:ee,ne=!Object(o.isEmpty)(Q)&&Q.hasOwnProperty("sidebarValues")?Q.sidebarValues:{},re=Object(o.isEmpty)(X)?{}:X,ae=re.fields,oe=void 0===ae?[]:ae,ie=re.default_values,ce=void 0===ie?{}:ie,le=!Object(o.isEmpty)($)&&$.hasOwnProperty("id")?u($.id):{},se=le.stepId,ue=void 0===se?0:se,fe=le.data;(void 0===fe?{}:fe).sidebarValues;Object(r.useEffect)((function(){U([]),x(!1)}),[]);var me=function(e,t,n){var r=!1,a=t.fields,o=t.relation,i=void 0===o?"OR":o;i=i.toUpperCase();try{var c=null;if("OR"===i){if(a&&Array.isArray(a))for(var l=0;l<a.length;l++){c=e[a[l].id];var s=void 0===a[l].value||a[l].value;if(Array.isArray(s)&&s.includes(c))return!0;if(""!=s&&c==s||""==s&&""!=c&&null!=c)return!0}}else"AND"==i&&a&&Array.isArray(a)&&(r=a.every((function(t){c=e[t.id];var n=void 0===t.value||t.value;return!(!Array.isArray(n)||!n.includes(c))||(""===n||c==n)&&(""!=n||""!=c&&null!=c)})))}catch(e){console.log(e)}return r},be=[];Object(o.isEmpty)(oe)||oe.forEach((function(e){e.hasOwnProperty("required")&&e.required&&be.push(e)}));var pe=function(e){var t=!1;return Object(o.isObject)(e)?Object.keys(e).map((function(n){["",void 0,null].includes(e[n])&&(t=!0)})):["",void 0,null].includes(e)&&(t=!0),t},de=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={};return be.map((function(r){if(r.hasOwnProperty("toggler")&&!Object(o.isEmpty)(r.toggler)&&!me(e,r.toggler))return!1;if((Array.isArray(e[r.id])&&0===e[r.id].length||""===e[r.id]||void 0===e[r.id])&&(n[r.id]=r.hasOwnProperty("errorMsg")?r.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations")),"custom_fields"===r.id&&e[r.id].map((function(e,t){!e.hasOwnProperty("field_value")||""===e.field_value||pe(e.field_value)?n["field_value_"+t]=r.hasOwnProperty("errorMsg")?r.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations"):n.hasOwnProperty(r.id)&&delete n[r.id]})),"bwfan_email_data"===r.id)if(e.hasOwnProperty("bwfan_email_data")){e.bwfan_email_data.hasOwnProperty("subject")&&""===e.bwfan_email_data.subject&&(n[r.id]="error");var a=Object(b.E)(),i=[],c=e.bwfan_email_data,s=!(!c.hasOwnProperty("data")||Object(o.isEmpty)(c.data)||!c.data.hasOwnProperty("isTransactional"))&&c.data.isTransactional,u="";c.hasOwnProperty("template")&&(u=c.template),u.includes("{{mail_footer}}")||(s||a.includes("unsubscribe_link")||u.includes("unsubscribe_link"))&&(s||a.includes("business_name")||u.includes("business_name"))&&(s||a.includes("business_address")||u.includes("business_address"))||(s||a.includes("unsubscribe_link")||u.includes("unsubscribe_link")||i.push("{{unsubscribe_link}}"),s||a.includes("business_name")||u.includes("business_name")||i.push("{{business_name}}"),s||a.includes("business_address")||u.includes("business_address")||i.push("{{business_address}}")),Object(o.isEmpty)(i)?A(""):(n[r.id]="error",t&&A(Object(l.__)("The required merge tags","wp-marketing-automations")+" "+i.join(", ")+(i.length>1?" are ":" is ")+" "+Object(l.__)("missing in the email body.","wp-marketing-automations")))}else n[r.id]="error";if("coupon_data"===r.id)if(e.hasOwnProperty(r.id)){var f=e[r.id],m=f.type,p=void 0===m?"new":m,d=f.coupon_id,h=void 0===d?{}:d,y=f.general,v=void 0===y?{}:y;("existing"===p&&(Object(o.isEmpty)(h)||!h.hasOwnProperty("key")||""===h.key)||"new"===p&&(Object(o.isEmpty)(v)||!v.hasOwnProperty("amount")||parseFloat(v.amount)<=0))&&(n[r.id]="error")}else n[r.id]="error"})),t&&U(n),n},he=function(){var t=Nt(jt().mark((function t(n){var r,a,i,c,s=arguments;return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!(s.length>1&&void 0!==s[1])||s[1],a=[],a=r?de(n):[],!Object(o.isEmpty)(a)){t.next=21;break}return Q.sidebarValues=n,R(!0),t.prev=6,i={data:{data:{sidebarData:n}}},r||Object(o.isEmpty)(X)||!X.hasOwnProperty("slug")||"wp_sendemail"!==X.slug||(c=de(n,!1),Object(o.isEmpty)(c)||(i.updateStatus=2)),t.next=11,d()({path:Object(b.A)("/automation/".concat(k,"/step/").concat(ue)),method:"POST",data:i}).then((function(t){if(200!==t.code)throw Error(Object(b.u)(null==t?void 0:t.message));var n="";t.hasOwnProperty("result")&&t.result.hasOwnProperty("desc_text")&&!Object(o.isEmpty)(t.result.desc_text)&&(n=t.result.desc_text),j($.id,Et(Et({},Q),{},{desc_text:n}),{step_status:i.hasOwnProperty("updateStatus")&&2===i.updateStatus?2:1}),t.hasOwnProperty("result")&&t.result.hasOwnProperty("meta")&&g("meta",Et(Et({},h),t.result.meta)),r&&(e(t.message),H||setTimeout((function(){w(!1)}),100)),R(!1),G(!1)})).catch((function(e){throw Error(Object(b.u)(null==e?void 0:e.message))}));case 11:t.next=18;break;case 13:t.prev=13,t.t0=t.catch(6),g("modalData",{status:!0,modalTitle:Object(l.__)("Update Action","wp-marketing-automations"),error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),R(!1),G(!1);case 18:Object(b.Kb)(e,3e3),t.next=24;break;case 21:e(Object(l.__)("Validation failed. Please check the fields for error.","wp-marketing-automations")),Object(b.Kb)(e,3e3),G(!1);case 24:case"end":return t.stop()}}),t,null,[[6,13]])})));return function(e){return t.apply(this,arguments)}}();return Object(r.createElement)(b.f.Provider,{value:{errorList:Z,setErrorList:U,stepId:ue}},Object(r.createElement)(b.c.Provider,{value:{isOpenTags:P,setOpenTags:x}},Object(r.createElement)("div",{className:"wr_header"},Object(r.createElement)("div",{className:"bwf-node-icon icon-action"},Object(r.createElement)(s.a,{size:22,icon:"charge"})),Object(r.createElement)("div",{className:"wr_event_title"},X.hasOwnProperty("action_name")?X.action_name:""),Object(r.createElement)("div",{className:"wr_event_variant"},te.includes("link-trigger")&&Object(r.createElement)(rt.a,{canCreate:!0,isLinkTriggerOpen:W,setLinkTriggerOpen:K,hideButton:!1}),te.includes("merge-tag")&&Object(r.createElement)("span",{onClick:function(){x(!0)},className:"bwf-cursor-pointer bwf-modal-icon-link-trigger",key:"merge-tag"},Object(r.createElement)(at.a,{icon:"merge-tag",iconSize:24,size:"auto",toolTipText:Object(r.createElement)("span",{className:"bwfan_tooltip_text bwf-w-120","data-position":"top"},Object(l.__)("Merge tags","wp-marketing-automations"))}))),Object(r.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return w(!1)}},Object(r.createElement)(s.a,{icon:"close"}))),Object(o.isEmpty)(oe)?Object(r.createElement)("div",{className:"wr_content"},Object(r.createElement)("div",{className:"bwf-single-automation-notice is-info"},Object(l.__)("No settings to configure.","wp-marketing-automations"))):Object(r.createElement)(tt.a,{onSubmit:function(){var e=Nt(jt().mark((function e(t){var n,r=arguments;return jt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(r.length>1&&void 0!==r[1])||r[1],e.next=3,he(t,n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),initialValues:Et(Et({},ce),ne),validate:function(){return!1}},(function(e){var t,n=e.getInputProps,a=e.values,i=e.errors,s=e.handleSubmit;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:(t="wr_content",X.hasOwnProperty("slug")&&(t=t+" wr_action_"+X.slug),t),ref:N},Object(r.createElement)("div",null,!Object(o.isEmpty)(X)&&X.hasOwnProperty("slug")&&"wp_sendemail"===X.slug&&""!==C&&Object(r.createElement)(O.a,{className:"bwf-error-notice",status:"error"},C),oe.map((function(e,t){return Object(r.createElement)(r.Fragment,{key:t},(Object(o.isEmpty)(e.toggler)||me(a,e.toggler))&&e.wrap_before&&Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(r.createElement)(r.Fragment,null,!1!==e.show&&(Object(o.isEmpty)(e.toggler)||me(a,e.toggler))&&Object(r.createElement)(nt.a,{input:e,formProps:n(e.id),values:a,isOpenTemplate:I,setOpenTemplate:function(){Object(b.Zb)()?D(!I):g("showProModal",!0)},automationId:k,automationEvent:_,setMergeTagModal:x,saveNodeDataOnSubmit:s})):e.hint?Object(r.createElement)(r.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:c()(e.class)}):null,(Object(o.isEmpty)(e.toggler)||me(a,e.toggler))&&e.wrap_after&&Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))),Object(r.createElement)("div",{className:"wr_footer"},Object(r.createElement)(y.a,{className:"bwf-cancel-btn",onClick:function(){return w(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),!Object(o.isEmpty)(X)&&X.hasOwnProperty("slug")&&"wp_sendemail"===X.slug&&Object(r.createElement)(y.a,{isSecondary:!0,onClick:function(){V(!1),G(!0),setTimeout((function(){return s()}),100)},isBusy:F,disabled:Object.keys(i).length},Object(l.__)("Save & Close","wp-marketing-automations")),Object(r.createElement)(y.a,{isPrimary:!0,className:"bwf-no-ripple",onClick:function(){!Object(o.isEmpty)(X)&&X.hasOwnProperty("slug")&&"wp_sendemail"===X.slug&&V(!0),setTimeout((function(){return s()}),100)},isBusy:B&&!F},Object(l.__)("Save","wp-marketing-automations"))))})),Object(r.createElement)(Ot,{isOpen:P,onRequestClose:x,automationID:k})))};n(1403);function Lt(e){return function(e){if(Array.isArray(e))return Tt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||At(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||At(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e,t){if(e){if("string"==typeof e)return Tt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tt(e,t):void 0}}function Tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var It=function(e){var t=e.options,n=e.selected,a=e.setSelected,i=e.selectedContent,c=void 0===i?"":i,l=e.liteDummyData,u=void 0===l?[]:l,f=Ct(Object(r.useState)([]),2),m=f[0],p=f[1];return Object(o.isEmpty)(t)?Object(r.createElement)(r.Fragment,null):Object(r.createElement)(r.Fragment,null,t.map((function(e,t){if(Object(o.isEmpty)(e)||!e.hasOwnProperty("value"))return!1;var i=e.value==n?"selected":"";return Object(r.createElement)("div",{className:"bwf-custom-radio-control",key:t},Object(r.createElement)("div",{className:"bwf-custom-radio-option",key:e.value,onClick:function(){return a(e.value)}},Object(r.createElement)("div",{className:"bwf-select-option-indicator "+i},e.hasOwnProperty("isProFeature")&&e.isProFeature&&!Object(b.Zb)()?Object(r.createElement)(s.a,{icon:"king"}):Object(r.createElement)("div",{className:"bwf-option-mark-outer"},Object(r.createElement)("div",{className:"bwf-option-mark-inner"}))),Object(r.createElement)("div",{className:"bwf-select-option-info"},Object(r.createElement)("div",{className:"bwf-bold"},e.hasOwnProperty("label")?e.label:""),Object(r.createElement)("div",{className:"bwf-desc"},e.hasOwnProperty("desc")?e.desc:"")),e.hasOwnProperty("isProFeature")&&e.isProFeature&&!Object(b.Zb)()&&Object(r.createElement)("a",{onClick:function(t){t.stopPropagation();var n=Lt(m);n.includes(e.value)?n.pop(e.value):n.push(e.value),p(n)},className:"bwf-no-underline bwf-cursor-pointer"},"Explore")),m.includes(e.value)&&u.hasOwnProperty(e.value)&&Object(r.createElement)(r.Fragment,null,u[e.value]),i&&Object(r.createElement)("div",{className:"bwf-option-content"},c))})))},Dt=n(364),Mt=n(121);n(1404);function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){Zt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Ft(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ft(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ut(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return qt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Bt=function(e){var t=Object(r.useRef)(null),n=e.mergetag,a=e.copyTagToClipBoard,i=e.automationId,s=Ut(Object(r.useState)({}),2),f=s[0],m=s[1],b=Ut(Object(r.useState)({}),2),p=b[0],d=b[1],h=n.schema,y=void 0===h?[]:h,v=n.tag_name,O=void 0===v?"":v,w=n.default_val,j=void 0===w?[]:w;Object(r.useEffect)((function(){var e=[];y.map((function(t){e[t.id]=t.type})),d(e)}),[y]);var g,E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,r=t.fields,a=t.relation,o=void 0===a?"OR":a;o=o.toUpperCase();try{var i=null;if("OR"===o){if(r&&Array.isArray(r))for(var c=0;c<r.length;c++){i=e[r[c].id];var l=void 0===r[c].value||r[c].value;if(""!=l&&i==l||""==l&&""!=i&&null!=i)return!0}}else"AND"==o&&r&&Array.isArray(r)&&(n=r.every((function(t){i=e[t.id];var n=void 0===t.value||t.value;return(""===n||i==n)&&(""!=n||""!=i&&null!=i)})))}catch(e){console.log(e)}return n},_=function(){var e=["{{"+O];if(!Object(o.isEmpty)(f))if("cart_recovery_link"===O){var t=f.coupon_type,n=void 0===t?"":t,r=f.dynamic_coupon,a=void 0===r?"":r,i=f.static_coupon,c=void 0===i?"":i;"static"===n&&""!==c?e.push("coupon='"+c+"'"):"dynamic"===n&&""!==a&&e.push("coupon='"+a+"'")}else Object.entries(f).map((function(t){var n=Ut(t,2),r=n[0],a=n[1];if("search"!=p[r]||Object(o.isEmpty)(a))""!==a&&e.push(r+"='"+a+"'");else{var i=[];a.map((function(e){i.push(e.id)})),e.push(r+"='"+i.join(",")+"'")}}));return e.join(" ")+"}}"},k=function(){var e=_();return y.map((function(t){!t.hasOwnProperty("required")||!t.required||f.hasOwnProperty(t.id)&&""!==f[t.id]||(e="")})),""!==e};return Object(r.createElement)("div",{className:"bwf-merge-tag-wrap bwf_w_full"},Object(r.createElement)(tt.a,{onChange:function(e){!function(e){var t=zt({},f);t[e.name]=e.value,m(t)}(e)},initialValues:zt(zt({},j),f),validate:function(){return!1}},(function(e){var n=e.getInputProps,a=e.values;e.errors,e.handleSubmit;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"wr_content",ref:t},Object(r.createElement)("div",null,y.map((function(e,t){return Object(r.createElement)(r.Fragment,{key:t},(Object(o.isEmpty)(e.toggler)||E(a,e.toggler,e))&&e.wrap_before&&Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(r.createElement)(r.Fragment,null,!1!==e.show&&(Object(o.isEmpty)(e.toggler)||E(a,e.toggler,e))&&Object(r.createElement)(nt.a,{input:e,formProps:n(e.id),values:a,automationId:i})):e.hint?Object(r.createElement)(r.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:c()(e.class)}):null,(Object(o.isEmpty)(e.toggler)||E(a,e.toggler,e))&&e.wrap_after&&Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))))})),(g=_(),Object(r.createElement)("div",{className:"bwf-merge-tag-config-view"},Object(r.createElement)("span",{className:"bwf-merge-tag"},g),Object(r.createElement)("div",{className:"bwf-display-flex bwf-j-end"},Object(r.createElement)(u.Button,{isPrimary:!0,onClick:function(){a(g)},disabled:!k()},Object(l.__)("Select","wp-marketing-automations"))))))};function Rt(e){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(n),!0).forEach((function(t){Vt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Rt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Rt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Jt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Wt=function(e){var t=Object(r.useContext)(mt.a).setSelectedMergeTag,n=e.isOpen,a=e.onRequestClose,i=e.automationID,f=e.onSelect,b=$t(Object(r.useState)(""),2),p=b[0],d=b[1],h=$t(Object(r.useState)(""),2),y=h[0],v=h[1],O=$t(Object(r.useState)({}),2),w=O[0],j=O[1],g=(0,Object(m.a)().getDelayTagList)();Object(r.useEffect)((function(){n||(j({}),d(""),Object(o.isEmpty)(g)||v(Object.keys(g)[0]))}),[n]);var E=function(){a&&a()},_=function(e){t(e),f(e),E()},k=function(){var e,t=(e={},Object.entries(g).map((function(t){var n=$t(t,2),r=n[0],a=n[1];""!==y?y==r&&(e=a):""!==p?Object.entries(a).map((function(t){var n=$t(t,2),r=n[0],a=n[1];(r.includes(p)||a.hasOwnProperty("tag_name")&&a.tag_name.includes(p))&&(e[r]=a)})):e=Ht(Ht({},e),a)})),e);return Object(o.isEmpty)(t)?Object(r.createElement)("tr",null,Object(r.createElement)("td",{className:"bwf-no-merge-tag"},Object(l.__)("No Delay Tag Available","wp-marketing-automations"))):Object(r.createElement)(r.Fragment,null,Object.entries(t).map((function(e,t){var n=$t(e,2),a=(n[0],n[1]);return Object(r.createElement)("tr",{key:"row"+t},Object(r.createElement)("td",null,Object(r.createElement)("span",{className:"bwf-tag-label"},a.tag_description)),Object(r.createElement)("td",null,Object(r.createElement)("span",{className:"bwf-tag-slug"},"{{"+a.tag_name+"}}")),Object(r.createElement)("td",null,a.hasOwnProperty("schema")?Object(r.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return j(a)},title:Object(l.__)("Configure","wp-marketing-automations")},Object(r.createElement)(s.a,{color:"#353030",icon:"settings"})):Object(r.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return _("{{"+a.tag_name+"}}")},title:Object(l.__)("Copy","wp-marketing-automations")},Object(r.createElement)(s.a,{color:"#353030",icon:"duplicate"}))))})))};return n?Object(r.createElement)(u.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-event-search-delay-tag bwf-admin-modal-xl bwf-overflow-remove",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(r.createElement)("div",{className:"bwf-modal-search-header"},Object(r.createElement)("div",{className:"bwf-modal-title"},Object(o.isEmpty)(w)?Object(l.__)("Delay Tags","wp-marketing-automations"):Object(r.createElement)("div",{className:"bwf-display-flex"},Object(r.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){j({})}},Object(r.createElement)(s.a,{icon:Object(l.isRTL)()?"arrow-right":"arrow-left"})),w.hasOwnProperty("tag_description")?w.tag_description:"")),Object(r.createElement)("div",{className:"bwf-modal-search-wrap"},Object(o.isEmpty)(w)&&Object(r.createElement)("div",{className:"bwf-component-search-control"},Object(r.createElement)(s.a,{icon:"search",size:15}),Object(r.createElement)(u.TextControl,{value:p,onChange:function(e){""===e?Object(o.isEmpty)(g)||v(Object.keys(g)[0]):v(""),d(e)},placeholder:Object(l.__)("Search by name","wp-marketing-automations")}))),Object(r.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:E},Object(r.createElement)(s.a,{icon:"close",size:20}))),Object(r.createElement)("div",{className:"bwf-event-modal-main"},Object(r.createElement)("div",{className:"bwf-event-modal-body bwf-merge-modal-content"+(Object(o.isEmpty)(w)&&!Object(o.isEmpty)(g)?"":" gridfull")},Object(o.isEmpty)(w)?Object(o.isEmpty)(g)?Object(r.createElement)("div",{className:"bwf-modal-content-content"},Object(r.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(r.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(r.createElement)("div",{className:"bwf-brick-content"},Object(r.createElement)("div",{className:"bwf-merge-tag-list"},Object(r.createElement)("div",{className:"bwf-no-merge-tag"},Object(l.__)("No Delay Tag Available","wp-marketing-automations"))))))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-modal-sidebar"},Object(r.createElement)("div",{className:"bwf-modal-filter-wrap"},Object.keys(g).map((function(e){return Object(r.createElement)("div",{key:e,className:c()("bwf-modal-filter",{active:y===e}),onClick:function(){d(""),v(e)}},e)})))),Object(r.createElement)("div",{className:"bwf-modal-content-content"},Object(r.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(r.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(r.createElement)("div",{className:"bwf-brick-content"},Object(r.createElement)("div",{className:"bwf-merge-tag-list"},Object(r.createElement)("table",null,Object(r.createElement)("tbody",null,k())))))))):Object(r.createElement)(Bt,{mergetag:w,copyTagToClipBoard:_,automationId:i})))):""},Kt=n(43);function Qt(e){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xt(e){return function(e){if(Array.isArray(e))return sn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ln(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function en(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?en(Object(n),!0).forEach((function(t){nn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):en(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Qt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rn(){rn=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==Qt(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Qt(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function an(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function on(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){an(o,r,a,i,c,"next",e)}function c(e){an(o,r,a,i,c,"throw",e)}i(void 0)}))}}function cn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||ln(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ln(e,t){if(e){if("string"==typeof e)return sn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sn(e,t):void 0}}function sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var un=function(){var e=cn(Object(r.useState)({}),2),t=e[0],n=e[1],a=cn(Object(r.useState)({}),2),i=a[0],c=a[1],p=cn(Object(r.useState)(!0),2),h=p[0],v=p[1],O=cn(Object(r.useState)(!1),2),w=O[0],j=O[1],g=cn(Object(r.useState)(!1),2),E=g[0],_=g[1],k=Object(r.useContext)(b.h),N=Object(f.a)(),S=N.showSidebar,P=N.setNodeDatabyId,x=N.setAutomationData,L=N.fetchSplitPathNodes,C=cn(Object(r.useState)(!1),2),A=C[0],T=C[1],I=Object(m.a)(),D=I.getSidebarNodeData,M=I.getNodeDataByID,F=I.getAutomationId,G=I.getAutomationLinks,z=I.getAutomationSteps,Z=I.getCount,U=I.getActionsList,q=I.getGoals,B=I.getDelayTagList,R=I.getautomationMeta,Y=D(),H=F(),V=B(),$=z(),J=G(),W=Z(),K=U(),Q=q(),X=R(),ee=L(),te=!Object(o.isEmpty)(Y)&&Y.hasOwnProperty("id")?M(Y.id):{},ne=te.stepId,re=void 0===ne?0:ne,ae=te.data,oe=(void 0===ae?{}:ae).sidebarValues,ie=function(){var e=on(rn().mark((function e(){return rn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d()({path:Object(b.A)("/fields/?type=7,8&all=true"),method:"GET"}).then((function(e){200===e.code&&(Object(o.isEmpty)(e.result)||c(e.result),v(!1))}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){Object(b.Zb)()&&ie(),n({})}),[]);var ce=!Object(o.isEmpty)(Y)&&Y.hasOwnProperty("data")?Y.data:{},le=!Object(o.isEmpty)(ce)&&ce.hasOwnProperty("sidebarValues")?ce.sidebarValues:{},se=cn(Object(r.useState)(1),2),ue=se[0],fe=se[1],me=cn(Object(r.useState)({day_delay:{unit:"min",text:"0"}}),2),be=me[0],pe=me[1];Object(r.useEffect)((function(){le.hasOwnProperty("type")&&[1,2,3,4].includes(parseInt(le.type))&&fe(parseInt(le.type)),le.hasOwnProperty("data")&&!Object(o.isEmpty)(le.data)&&pe(le.data)}),[le]),Object(r.useEffect)((function(){if(!h){var e=tn(tn({},le),{},{type:ue,data:be});Object(o.isEqual)(oe,e)||Object(o.isEmpty)(oe)?j(!1):j(!0)}}),[ue,be]);var de=function(e){var t=e.type,r=void 0===t?0:t,a=e.data,i=void 0===a?{}:a,c={};switch(parseInt(r)){case 1:var s=i.day_delay,u=void 0===s?{}:s,f=i.enable_time_delay,m=void 0!==f&&f,b=i.time_delay,p=void 0===b?{}:b,d=i.enable_week_delay,h=void 0!==d&&d,y=i.week_delay,v=void 0===y?[]:y;(Object(o.isEmpty)(u)||u.hasOwnProperty("text")&&""==u.text)&&(c.day_delay=Object(l.__)("Select a specific period.","wp-marketing-automations")),m?(Object(o.isEmpty)(p)||p.hasOwnProperty("time")&&Object(o.isEmpty)(p.time))&&(c.time_delay=Object(l.__)("Select a specific time of day.","wp-marketing-automations")):i.time_delay={},h?Object(o.isEmpty)(v)&&(c.week_delay=Object(l.__)("Select a specific day of the week.","wp-marketing-automations")):i.week_delay=[];break;case 2:var O=i.date,w=void 0===O?"":O,j=i.time_delay,g=void 0===j?{time:"10:00"}:j,E=i.enable_step_skip,_=void 0!==E&&E,k=i.skip_to_step,N=void 0===k?{}:k;Object(o.isEmpty)(w)&&(c.specific_date=Object(l.__)("Select a specific date.","wp-marketing-automations")),Object(o.isEmpty)(g.time)&&(c.specific_time=Object(l.__)("Select a specific time.","wp-marketing-automations")),!_||N.hasOwnProperty("step")&&""!=N.step||(c.specific_date_time_step=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"));break;case 3:var S=i.custom_field,P=void 0===S?{}:S,x=i.enable_step_skip,L=void 0!==x&&x,C=i.skip_to_step,A=void 0===C?{}:C;if(!P.hasOwnProperty("field")||0==parseInt(P.field)||isNaN(parseInt(P.field))){c.custom_field=Object(l.__)("Please select custom field.","wp-marketing-automations");break}!L||A.hasOwnProperty("step")&&""!=A.step||(c.custom_field=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"));break;case 4:var T=i.variable_field,I=void 0===T?{}:T,D=i.enable_step_skip,M=void 0!==D&&D,F=i.skip_to_step,G=void 0===F?{}:F;if(!I.hasOwnProperty("variable")||""==I.variable){c.variable=Object(l.__)("Please select a delay variable.","wp-marketing-automations");break}!M||G.hasOwnProperty("step")&&""!=G.step||(c.variable=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))}return!!Object(o.isEmpty)(c)||(n(c),!1)},he=function(){var e=on(rn().mark((function e(){var t,n,r;return rn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,n=tn(tn({},le),{},{type:ue,data:be}),de(n)){e.next=4;break}return e.abrupt("return");case 4:if(!Object(o.isEqual)(oe,n)){e.next=7;break}return S(!1),e.abrupt("return");case 7:return Object(o.isEmpty)(oe)||(t=!0),T(!0),r={data:{data:{sidebarData:n}},steps:Object(o.cloneDeep)($).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:J,count:W,optionUpdated:t,actionType:1},e.prev=10,e.next=13,d()({path:Object(b.A)("/automation/".concat(H,"/step/").concat(re)),method:"POST",data:r}).then((function(e){if(200!==e.code)throw Error(Object(b.u)(null==e?void 0:e.message));k(e.message),P(Y.id,tn(tn({},ce),{},{sidebarValues:n}),{step_status:1}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&x("meta",tn(tn({},X),e.result.meta)),setTimeout((function(){S(!1)}),100),T(!1)})).catch((function(e){throw Error(Object(b.u)(null==e?void 0:e.message))}));case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(10),x("modalData",{status:!0,modalTitle:Object(l.__)("Update Delay","wp-marketing-automations"),error:null===e.t0||void 0===e.t0?void 0:e.t0.message}),T(!1);case 19:Object(b.Kb)(k,3e3);case 20:case"end":return e.stop()}}),e,null,[[10,15]])})));return function(){return e.apply(this,arguments)}}(),ye=[{value:1,label:Object(l.__)("Delay for a specific period","wp-marketing-automations"),desc:Object(l.__)("Wait for a specified number of hours, days, or week before continuing","wp-marketing-automations"),isProFeature:!1},{value:2,label:Object(l.__)("Delay until a specific date and time","wp-marketing-automations"),desc:Object(l.__)("Set a specific date and time","wp-marketing-automations"),isProFeature:!0},{value:3,label:Object(l.__)("Delay until a custom field date","wp-marketing-automations"),desc:Object(l.__)("Choose from contacts custom field","wp-marketing-automations"),isProFeature:!0}];Object(o.isEmpty)(V)||ye.push({value:4,label:Object(l.__)("Delay with events variable","wp-marketing-automations"),desc:Object(l.__)("Choose from event field value","wp-marketing-automations"),isProFeature:!0});var ve=[{value:"1",label:Object(l.__)("S","wp-marketing-automations")},{value:"2",label:Object(l.__)("M","wp-marketing-automations")},{value:"3",label:Object(l.__)("T","wp-marketing-automations")},{value:"4",label:Object(l.__)("W","wp-marketing-automations")},{value:"5",label:Object(l.__)("TH","wp-marketing-automations")},{value:"6",label:Object(l.__)("F","wp-marketing-automations")},{value:"7",label:Object(l.__)("SA","wp-marketing-automations")}],Oe=function(e){return t.hasOwnProperty(e)},we={1:Object(l.__)("Sun","wp-marketing-automations"),2:Object(l.__)("Mon","wp-marketing-automations"),3:Object(l.__)("Tue","wp-marketing-automations"),4:Object(l.__)("Wed","wp-marketing-automations"),5:Object(l.__)("Thu","wp-marketing-automations"),6:Object(l.__)("Fri","wp-marketing-automations"),7:Object(l.__)("Sat","wp-marketing-automations")},je=function(){var e=be.day_delay,t=void 0===e?{}:e,n=be.enable_time_delay,r=void 0!==n&&n,a=be.enable_week_delay,i=void 0!==a&&a,c=be.time_delay,s=void 0===c?{time:"10:00"}:c,u=be.week_delay,f=void 0===u?[]:u;if(!Object(o.isEmpty)(t)&&t.hasOwnProperty("unit")&&t.hasOwnProperty("text")&&!Object(o.isEmpty)(t.unit)&&!Object(o.isEmpty)(t.text)){var m=t.text+" "+function(e,t){switch(e){case"min":return parseInt(t)>1?Object(l.__)("Minutes","wp-marketing-automations"):Object(l.__)("Minute","wp-marketing-automations");case"hours":return parseInt(t)>1?Object(l.__)("Hours","wp-marketing-automations"):Object(l.__)("Hour","wp-marketing-automations");case"days":return parseInt(t)>1?Object(l.__)("Days","wp-marketing-automations"):Object(l.__)("Day","wp-marketing-automations");case"weeks":return parseInt(t)>1?Object(l.__)("Weeks","wp-marketing-automations"):Object(l.__)("Week","wp-marketing-automations");case"months":return parseInt(t)>1?Object(l.__)("Months","wp-marketing-automations"):Object(l.__)("Month","wp-marketing-automations");default:return""}}(t.unit,t.text),b=[];return i&&!Object(o.isEmpty)(f)&&f.map((function(e){we.hasOwnProperty(e)&&b.push(we[e])})),r&&s.hasOwnProperty("time")&&!Object(o.isEmpty)(s.time)?(m+=" "+Object(l.__)("till","wp-marketing-automations")+" "+Object(Ee.format)(bwfcrm_contacts_data.time_format,ke()(s.time,"HH:mm:ss")),Object(o.isEmpty)(b)||(m+="  "+b.join("/")),s.hasOwnProperty("in_contact_timezone")&&s.in_contact_timezone&&(m+=" "+Object(l.__)("in Contact's Timezone","wp-marketing-automations"))):Object(o.isEmpty)(b)||(m+="  "+b.join("/")),Object(l.__)("Delay of","wp-marketing-automations")+" "+m+"."}return""},ge=function(){var e=be.custom_field,t=void 0===e?{field:"",time:"10:00",in_contact_timezone:!1,custom_field_label:""}:e,n=be.enable_time_delay,r=void 0!==n&&n,a=be.time_delay,i=void 0===a?{duration:0,type:"days",timing:"after"}:a,c=be.enable_step_skip,s=void 0!==c&&c,u=be.skip_to_step,f=void 0===u?{step:0,name:""}:u,m=be.occurrence,b=void 0===m?"daymonth":m;if(t.hasOwnProperty("field")&&""!==t.field){var p=Object(l.__)("Delay","wp-marketing-automations")+" ";return r?i.hasOwnProperty("duration")&&(p+="".concat(Object(l.__)("of","wp-marketing-automations")," ").concat(i.duration," ").concat(i.type," ").concat(i.timing," ")):p+=Object(l.__)("till","wp-marketing-automations")+" ",t.hasOwnProperty("custom_field_label")&&""!==t.custom_field_label?p+="'".concat(t.custom_field_label,"' ").concat(Object(l.__)("field","wp-marketing-automations")," "):p+="".concat(Object(l.__)("Custom Field","wp-marketing-automations")," ( ").concat(t.field," )"),"fulldatetime"!==b&&t.hasOwnProperty("time")&&""!==t.time&&(p+=" ".concat(Object(l.__)("till","wp-marketing-automations")," ").concat(Object(Ee.format)(bwfcrm_contacts_data.time_format,ke()(t.time,"HH:mm:ss")))),t.hasOwnProperty("in_contact_timezone")&&t.in_contact_timezone?p+=" ".concat(Object(l.__)("in Contact's Timezone","wp-marketing-automations"),". "):p+=". ",s&&!Object(o.isEmpty)(f)&&f.hasOwnProperty("step")&&""!=f.step&&f.hasOwnProperty("name")&&""!=f.name&&(p+=" ".concat(Object(l.__)("Jump to","wp-marketing-automations")," ").concat(f.name,".")),p}return""},_e=function(){var e=be.date,t=void 0===e?"":e,n=be.time_delay,r=void 0===n?{time:"10:00",in_contact_timezone:!1}:n,a=be.enable_step_skip,i=void 0!==a&&a,c=be.skip_to_step,s=void 0===c?{step:0,name:""}:c;if(!Object(o.isEmpty)(t)&&r.hasOwnProperty("time")&&!Object(o.isEmpty)(r.time)){var u=Object(l.__)("Delay till","wp-marketing-automations")+" ";return u+=Object(b.gb)(t,!0,!1)+" ",r.hasOwnProperty("time")&&""!==r.time&&(u+="".concat(Object(l.__)("at","wp-marketing-automations")," ").concat(Object(Ee.format)(bwfcrm_contacts_data.time_format,ke()(r.time,"HH:mm:ss"))," ")),r.hasOwnProperty("in_contact_timezone")&&r.in_contact_timezone?u+="".concat(Object(l.__)("in Contact's Timezone","wp-marketing-automations"),". "):u+=". ",i&&!Object(o.isEmpty)(s)&&s.hasOwnProperty("step")&&""!=s.step&&s.hasOwnProperty("name")&&""!=s.name&&(u+="".concat(Object(l.__)("Jump to","wp-marketing-automations")," ").concat(s.name)),u}return""},Ne={action:Object(l.__)("Action","wp-marketing-automations"),wait:Object(l.__)("Delay","wp-marketing-automations"),conditional:Object(l.__)("Conditional","wp-marketing-automations"),exit:Object(l.__)("Exit","wp-marketing-automations"),benchmark:Object(l.__)("Goal","wp-marketing-automations")},Se=Object(r.useMemo)((function(){var e={stepsOptArr:[],stepsOptions:[{value:"",label:Object(l.__)("Select Step","wp-marketing-automations")}]};return Object(o.isEmpty)($)||($.map((function(t){var n=t.stepId,r=void 0===n?0:n,a=t.id,o=void 0===a?0:a;if(!["yesNoNode","end","jump","start","exit","split","splitpath"].includes(t.type)&&!e.stepsOptArr.hasOwnProperty(o)&&r!=re&&!ee.includes(o)){var i=[Object(l.__)("Step","wp-marketing-automations")];i.push(o),Ne.hasOwnProperty(t.type)&&i.push(" : "+Ne[t.type]),"action"==t.type&&t.hasOwnProperty("data")&&K.list.hasOwnProperty(t.data.selected)&&K.list[t.data.selected].hasOwnProperty("action_name")&&(K.list[t.data.selected].hasOwnProperty("integration_nicename")?i.push(" - "+K.list[t.data.selected].integration_nicename+" : "):i.push(" - "),i.push(K.list[t.data.selected].action_name)),"benchmark"==t.type&&t.hasOwnProperty("data")&&Q.list.hasOwnProperty(t.data.benchmark)&&Q.list[t.data.benchmark].hasOwnProperty("event_name")&&(Q.list[t.data.benchmark].hasOwnProperty("source_label")&&i.push(Q.list[t.data.benchmark].source_label+" : "),i.push(Q.list[t.data.benchmark].event_name)),e.stepsOptArr[r]=i.join(" "),e.stepsOptions.push({value:r,label:i.join(" ")})}})),e.stepsOptArr.end=Object(l.__)("End Automation","wp-marketing-automations"),e.stepsOptions.push({value:"end",label:Object(l.__)("End Automation","wp-marketing-automations")})),e}),[$]),Pe=cn(Object(r.useState)(!1),2),xe=Pe[0],Le=Pe[1],Ce=cn(Object(r.useState)(!1),2),Ae=Ce[0],Te=Ce[1],Ie=function(){var e=be.day_delay,n=void 0===e?{unit:"min",text:"0"}:e,a=be.enable_time_delay,i=void 0!==a&&a,c=be.time_delay,f=void 0===c?{time:"10:00",in_contact_timezone:!1}:c,m=be.enable_week_delay,p=void 0!==m&&m,d=be.week_delay,h=void 0===d?["sunday"]:d;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-delay-field "+(Oe("day_delay")?"has-error":"")},Object(r.createElement)(Dt.a,{units:[{value:"min",label:Object(l.__)("Minutes","wp-marketing-automations")},{value:"hours",label:Object(l.__)("Hours","wp-marketing-automations")},{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")},{value:"months",label:Object(l.__)("Months","wp-marketing-automations")}],onChange:function(e){pe(tn(tn({},be),{},{day_delay:e}))},value:n}),Oe("day_delay")&&Object(r.createElement)("div",{className:"has-bwfan-error"},t.day_delay)),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(b.Zb)()?Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Kt.a,{checked:i,label:Object(l.__)("Delay until a specific time of day","wp-marketing-automations"),onChange:function(e){return pe(tn(tn({},be),{},{enable_time_delay:e}))}}),i&&Object(r.createElement)("div",{className:"bwf-delay-field "+(Oe("time_delay")?"has-error":"")},Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(r.createElement)("input",{type:"time",value:f.time,className:"bwf-w-150 bwf-h-36",onChange:function(e){pe(tn(tn({},be),{},{time_delay:tn(tn({},be.time_delay),{},{time:e.target.value})}))}}),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-display-flex "+(Object(b.Zb)()?"":"bwf-delay-no-pro")},Object(b.Zb)()?Object(r.createElement)(Kt.a,{checked:f.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){pe(tn(tn({},be),{},{time_delay:tn(tn({},be.time_delay),{},{in_contact_timezone:e})}))}}):Object(r.createElement)("div",{className:"bwf-cursor-pointer no-color",onClick:function(){x("proModalContent",Object(l.__)("This","wp-marketing-automations")),x("showProModal",!0)}},Object(l.__)("In Contact Timezone","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(s.a,{icon:"king",size:16})))),Oe("time_delay")&&Object(r.createElement)("div",{className:"has-bwfan-error"},t.time_delay))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start"},Object(r.createElement)(s.a,{icon:"king",size:16}),Object(l.__)("Delay until a specific time of day","wp-marketing-automations"),Object(r.createElement)("a",{onClick:function(){return Le(!xe)},className:"bwf-no-underline bwf-cursor-pointer"},Object(l.__)("Explore","wp-marketing-automations"))),xe&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-mtb-10 bwf-lite-restrict-section"},Object(r.createElement)(Kt.a,{checked:!1,disabled:!0,label:Object(l.__)("Delay until a specific time of day","wp-marketing-automations")}),Object(r.createElement)("div",{className:"bwf-delay-field "},Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(r.createElement)("input",{type:"time",value:"",disabled:!0,className:"bwf-w-150 bwf-h-36",onChange:function(){}}),Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-display-flex "},Object(r.createElement)(Kt.a,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(r.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(r.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(b.eb)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(b.Zb)()?Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Kt.a,{checked:p,label:Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),onChange:function(e){return pe(tn(tn({},be),{},{enable_week_delay:e}))}}),p&&Object(r.createElement)("div",{className:"bwf-delay-field "+(Oe("week_delay")?"has-error":"")},Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)(u.ButtonGroup,null,ve.map((function(e,t){return Object(r.createElement)(u.Button,{key:t,isPrimary:h.includes(e.value),isSecondary:!h.includes(e.value),onClick:function(){var t=Xt(h);t.includes(e.value)?t=t.filter((function(t){return t!==e.value})):t.push(e.value),pe(tn(tn({},be),{},{week_delay:t}))}},e.label)}))),Oe("week_delay")&&Object(r.createElement)("div",{className:"has-bwfan-error"},t.week_delay))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start"},Object(r.createElement)(s.a,{icon:"king",size:16}),Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),Object(r.createElement)("a",{onClick:function(){return Te(!Ae)},className:"bwf-no-underline bwf-cursor-pointer"},Object(l.__)("Explore","wp-marketing-automations"))),Ae&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-mtb-10 bwf-lite-restrict-section"},Object(r.createElement)(Kt.a,{checked:!1,disabled:!0,label:Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),onChange:function(){}}),Object(r.createElement)("div",{className:"bwf-delay-field "},Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)(u.ButtonGroup,null,ve.map((function(e,t){return Object(r.createElement)(u.Button,{key:t,isPrimary:!1,isSecondary:!0,onClick:function(){},disabled:!0},e.label)})))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(r.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(r.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(b.eb)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))),!Object(o.isEmpty)(je())&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-single-automation-notice is-info"},je())))},De=function(e){var t=ke()().format("MM/DD/YYYY");return ke()(t).isSameOrBefore(ke()(e))},Me=function(){return Object(r.createElement)("div",{className:"bwf-custom-date-delay"},Object(r.createElement)("div",{className:"bwf-delay-field "},h?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf_w_full bwf-h-15"}):function(){var e=be.custom_field,t=void 0===e?{field:0,time:"10:00",in_contact_timezone:!1,custom_field_label:""}:e,n=be.enable_time_delay,a=void 0!==n&&n,c=be.time_delay,s=void 0===c?{duration:0,type:"days",timing:"after"}:c,f=be.occurrence,m=void 0===f?"daymonth":f,p=be.enable_step_skip,d=void 0!==p&&p,h=be.skip_to_step,y=void 0===h?{step:0,name:""}:h,v=Se.stepsOptArr,O=Se.stepsOptions;if(Object(o.isEmpty)(i))return Object(r.createElement)(r.Fragment,null,Object(l.__)("No Custom Field with type Date found","wp-marketing-automations"));var w=[{value:"",label:Object(l.__)("Select Type","wp-marketing-automations")}];Object.keys(i).map((function(e){w.push({label:i[e].hasOwnProperty("name")?i[e].name:"",value:e})}));var j,g,E=ge();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(r.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(r.createElement)("div",{className:"bwf-delay-field-select bwf-w-210 "+(Oe("custom_field")&&""==t.field?"has-error":"")},Object(r.createElement)(u.SelectControl,{value:t.field,className:"bwf_W_full",options:w,onChange:function(e){if(e&&i.hasOwnProperty(e)){var t=Object(o.cloneDeep)(be);t=tn(tn({},t),{},{custom_field:tn(tn({},t.custom_field),{},{field:e,custom_field_label:i[e].name})}),8==i[e].type?(t.occurrence="fulldatetime",t.time_delay=tn(tn({},t.time_delay),{},{type:"hours"})):(t.occurrence="daymonth",t.time_delay=tn(tn({},t.time_delay),{},{type:"days"})),pe(tn(tn({},be),t))}}}),Oe("custom_field")&&""==t.field&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please select a custom field.","wp-marketing-automations")))),Object(r.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "+(Oe("custom_field")&&""==m?"has-error":"")},Object(r.createElement)(u.SelectControl,{value:m,className:"bwf_w_full",options:(j=(null==t?void 0:t.field)||0,g=[],i.hasOwnProperty(j)&&!Object(o.isEmpty)(i[j])&&i[j].hasOwnProperty("type")&&8===parseInt(i[j].type)&&(g=[{value:"fulldatetime",label:Object(l.__)("Use Full Date Time","wp-marketing-automations")}]),[].concat(Xt(g),[{value:"daymonth",label:Object(l.__)("Use Day & Month","wp-marketing-automations")},{value:"daymonthyear",label:Object(l.__)("Use Full Date","wp-marketing-automations")}])),onChange:function(e){return pe(tn(tn({},be),{},{occurrence:e}))}}))),Object(r.createElement)("div",{className:"bwf-sidebar-hint"},Object(l.__)("Note: Contact would not pass this step if the value of custom field is blank.","wp-marketing-automations"),"daymonth"===m&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("br",null),Object(l.__)("It will pick the day and month from the selected field value and if the time is older than the current time it will increase by one year.","wp-marketing-automations")),"fulldatetime"===m&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("br",null),Object(l.__)("It will pick the time, day and month from the selected field value and if the time is older than the current time it will increase by one year.","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},"fulldatetime"!==m&&Object(r.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(r.createElement)("input",{type:"time",value:t.time,className:"bwf-w-210 bwf-h-36",onChange:function(e){pe(tn(tn({},be),{},{custom_field:tn(tn({},be.custom_field),{},{time:e.target.value})}))}})),Object(r.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(r.createElement)(Kt.a,{checked:t.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){pe(tn(tn({},be),{},{custom_field:tn(tn({},be.custom_field),{},{in_contact_timezone:e})}))}}))))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(r.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(r.createElement)("div",{className:"bwf-specific-date "+(Object(b.Zb)()?"":"bwf-delay-no-pro")},Object(r.createElement)(Kt.a,{checked:a,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(e){Object(b.Zb)()?pe(tn(tn({},be),{},{enable_time_delay:e})):(x("proModalContent",Object(l.__)("This","wp-marketing-automations")),x("showProModal",!0))}}))),a&&Object(r.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(r.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "+(Oe("custom_field")&&parseInt(s.duration)<0?"has-error":"")},Object(r.createElement)(u.TextControl,{className:"bwf-h-36",type:"number",value:s.duration,onChange:function(e){return pe(tn(tn({},be),{},{time_delay:tn(tn({},be.time_delay),{},{duration:e})}))},min:1,placeholder:Object(l.__)("Enter","wp-marketing-automations")})),Object(r.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(r.createElement)(u.SelectControl,{value:s.type,className:"bwf_w_full",options:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];return"fulldatetime"===e&&(t=[{value:"hours",label:Object(l.__)("Hours","wp-marketing-automations")}]),[].concat(Xt(t),[{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")}])}(m),onChange:function(e){return pe(tn(tn({},be),{},{time_delay:tn(tn({},be.time_delay),{},{type:e})}))}})),Object(r.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(r.createElement)(u.SelectControl,{value:s.timing,className:"bwf_w_full",options:[{value:"before",label:Object(l.__)("Before","wp-marketing-automations")},{value:"after",label:Object(l.__)("After","wp-marketing-automations")}],onChange:function(e){return pe(tn(tn({},be),{},{time_delay:tn(tn({},be.time_delay),{},{timing:e})}))}}))))),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(r.createElement)("div",{className:"bwf-specific-date "+(Object(b.Zb)()?"":"bwf-delay-no-pro")},Object(r.createElement)(Kt.a,{checked:d,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(b.Zb)()?pe(tn(tn({},be),{},{enable_step_skip:e})):(x("proModalContent",Object(l.__)("This","wp-marketing-automations")),x("showProModal",!0))}}))),d&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-delay-skip-step-select bwf-specific-date "+(Oe("custom_field")&&""==y.step?"has-error":"")},Object(r.createElement)(u.SelectControl,{value:y.step,className:"bwf_w_full",options:O,onChange:function(e){return pe(tn(tn({},be),{},{skip_to_step:tn(tn({},be.skip_to_step),{},{step:e,name:v[e]})}))}}),Oe("custom_field")&&""==y.step&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))))),""!==E&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-single-automation-notice is-info"},E)))}()))};return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"wr_header"},Object(r.createElement)("div",{className:"bwf-node-icon icon-delay"},Object(r.createElement)(s.a,{size:28,icon:"time-left"})),Object(r.createElement)("div",{className:"wr_event_title"},Object(r.createElement)("span",null,Object(l.__)("Delay","wp-marketing-automations"))),Object(r.createElement)("div",{className:"wr_event_variant"}),Object(r.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){S(!1)}},Object(r.createElement)(s.a,{icon:"close"}))),Object(r.createElement)("div",{className:"wr_content"},Object(r.createElement)("div",{className:"bwf-delay-wrap"},Object(r.createElement)(It,{selected:ue,setSelected:function(e){if(!Object(b.Zb)()&&[2,3].includes(parseInt(e)))return x("proModalContent",Object(l.__)("This Type","wp-marketing-automations")),void x("showProModal",!0);pe(function(e){switch(e){case 1:return{day_delay:{unit:"min",text:""},enable_time_delay:!1,time_delay:{time:"10:00",in_contact_timezone:!1},enable_week_delay:!1,week_delay:[]};case 2:return{date:"",time_delay:{time:"10:00",in_contact_timezone:!1},enable_step_skip:!1,skip_to_step:{step:0,name:""}};case 3:return{custom_field:{field:"",time:"10:00",in_contact_timezone:!1,custom_field_label:""},time_delay:{duration:0,type:"days",timing:"before"},occurrence:"daymonth",enable_step_skip:!1,skip_to_step:{step:0,name:""}};case 4:return{variable_field:{variable:"",time:"10:00",in_contact_timezone:!1},time_delay:{duration:0,type:"days",timing:"before"},occurrence:"daymonthyear",enable_step_skip:!1,skip_to_step:{step:0,name:""}};default:return{}}}(parseInt(e))),fe(e)},options:ye,selectedContent:function(){switch(parseInt(ue)){case 1:return Object(r.createElement)(r.Fragment,null,Ie());case 2:return Object(r.createElement)(r.Fragment,null,Object(b.Zb)()?(e=be.date,n=void 0===e?"":e,a=be.time_delay,i=void 0===a?{time:"10:00",in_contact_timezone:!1}:a,c=be.enable_step_skip,f=void 0!==c&&c,m=be.skip_to_step,p=void 0===m?{step:0,name:""}:m,d=Se.stepsOptArr,h=Se.stepsOptions,Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-specific-date-time-delay"},Object(r.createElement)("div",{className:"bwf-specific-date bwf_w_full bwf-h-36"},Object(r.createElement)("div",{className:"bwf-delay-field "+(Oe("specific_date")?"has-error":"")},Object(r.createElement)(Mt.a,{date:Object(o.isEmpty)(n)?null:ke()(n),dateFormat:"MM/DD/YYYY",isInvalidDate:function(e){return!De(e)},onUpdate:function(e){De(e.text)?pe(tn(tn({},be),{},{date:e.text})):(k(Object(l.__)("Invalid Date selected","wp-marketing-automations")),Object(b.Kb)(k,3e3))},text:n,iconRight:!0}),Oe("specific_date")&&Object(r.createElement)("div",{className:"has-bwfan-error"},t.specific_date))),Object(r.createElement)("div",{className:"bwf-specific-time bwf_w_full"},Object(r.createElement)("div",{className:"bwf-delay-field "+(Oe("specific_time")?"has-error":"")},Object(r.createElement)("input",{type:"time",value:i.time,onChange:function(e){pe(tn(tn({},be),{},{time_delay:tn(tn({},be.time_delay),{},{time:e.target.value})}))},className:"bwf-h-36"}),Oe("specific_time")&&Object(r.createElement)("div",{className:"has-bwfan-error"},t.specific_time))),Object(r.createElement)("div",{className:"bwf-specific-date bwf-w-210 "+(Object(b.Zb)()?"":"bwf-delay-no-pro")},Object(b.Zb)()?Object(r.createElement)(Kt.a,{checked:i.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){pe(tn(tn({},be),{},{time_delay:tn(tn({},be.time_delay),{},{in_contact_timezone:e})}))}}):Object(r.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){x("proModalContent",Object(l.__)("This","wp-marketing-automations")),x("showProModal",!0)}},Object(l.__)("In Contact TimeZone","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(s.a,{icon:"king",size:16}))),Object(r.createElement)("div",{className:"bwf-m-0 bwf-mt-16 bwf-single-automation-notice is-info"},Object(l.__)("Current Store Time","wp-marketing-automations")+": ",Object(b.hb)(ke()().tz("UTC"))),Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)("div",{className:"bwf-specific-date"},Object(r.createElement)("div",{className:"bwf-specific-date "+(Object(b.Zb)()?"":"bwf-delay-no-pro")},Object(r.createElement)(Kt.a,{checked:f,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(b.Zb)()?pe(tn(tn({},be),{},{enable_step_skip:e})):(x("proModalContent",Object(l.__)("This","wp-marketing-automations")),x("showProModal",!0))}}))),f&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-specific-date "+(Oe("specific_date_time_step")?"has-error":"")},Object(r.createElement)(u.SelectControl,{value:p.step,className:"bwf_w_full",options:h,onChange:function(e){return pe(tn(tn({},be),{},{skip_to_step:tn(tn({},be.skip_to_step),{},{step:e,name:d[e]})}))}}),Oe("specific_date_time_step")&&Object(r.createElement)("div",{className:"has-bwfan-error"},t.specific_date_time_step))),!Object(o.isEmpty)(_e())&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-single-automation-notice is-info"},_e())))):Object(r.createElement)(r.Fragment,null));case 3:return Object(r.createElement)(r.Fragment,null,Object(b.Zb)()?Me():Object(r.createElement)(r.Fragment,null));case 4:return Object(r.createElement)(r.Fragment,null,Object(b.Zb)()?function(){var e=be.variable_field,t=void 0===e?{variable:"",time:"10:00",in_contact_timezone:!1}:e,n=be.enable_time_delay,a=void 0!==n&&n,o=be.time_delay,i=void 0===o?{duration:0,type:"days",timing:"after"}:o,c=be.occurrence,s=void 0===c?"daymonthyear":c,f=be.enable_step_skip,m=void 0!==f&&f,p=be.skip_to_step,d=void 0===p?{step:0,name:""}:p,h=Se.stepsOptArr,y=Se.stepsOptions,v=ge();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Wt,{isOpen:E,onRequestClose:_,automationID:H,onSelect:function(e){pe(tn(tn({},be),{},{variable_field:tn(tn({},be.variable_field),{},{variable:e})}))}}),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(r.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(r.createElement)("div",{className:"bwf-delay-field-select bwf-w-300 "+(Oe("variable")&&""==t.variable?"has-error":""),onClick:function(){return _(!0)}},Object(r.createElement)(u.TextControl,{value:t.variable,disabled:!0}),Oe("variable")&&""==t.variable&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please select a variable.","wp-marketing-automations")))),Object(r.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field ",onClick:function(){return _(!0)}},Object(r.createElement)(u.Button,{isSecondary:!0},Object(l.__)("Select","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "},Object(r.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "+(Oe("variable")&&""==s?"has-error":"")},Object(r.createElement)(u.SelectControl,{value:s,className:"bwf_w_full",options:[{value:"daymonth",label:Object(l.__)("Use Day & Month","wp-marketing-automations")},{value:"daymonthyear",label:Object(l.__)("Use Full Date","wp-marketing-automations")}],onChange:function(e){return pe(tn(tn({},be),{},{occurrence:e}))}})))),Object(r.createElement)("div",{className:"bwf-sidebar-hint"},Object(l.__)("Note: If key value is not present it will run immediately.","wp-marketing-automations"),"daymonth"===s&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("br",null),Object(l.__)("It will pick the day and month from the selected field value and if the time is older than the current time it will increase by one year.","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(r.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(r.createElement)("input",{type:"time",value:t.time,className:"bwf-w-210 bwf-h-36",onChange:function(e){pe(tn(tn({},be),{},{variable_field:tn(tn({},be.variable_field),{},{time:e.target.value})}))}})),Object(r.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(r.createElement)(Kt.a,{checked:t.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){pe(tn(tn({},be),{},{variable_field:tn(tn({},be.variable_field),{},{in_contact_timezone:e})}))}}))))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(r.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(r.createElement)("div",{className:"bwf-specific-date "+(Object(b.Zb)()?"":"bwf-delay-no-pro")},Object(r.createElement)(Kt.a,{checked:a,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(e){Object(b.Zb)()?pe(tn(tn({},be),{},{enable_time_delay:e})):(x("proModalContent",Object(l.__)("This","wp-marketing-automations")),x("showProModal",!0))}}))),a&&Object(r.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(r.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "+(Oe("custom_field")&&parseInt(i.duration)<0?"has-error":"")},Object(r.createElement)(u.TextControl,{className:"bwf-h-36",type:"number",value:i.duration,onChange:function(e){return pe(tn(tn({},be),{},{time_delay:tn(tn({},be.time_delay),{},{duration:e})}))},min:1,placeholder:Object(l.__)("Enter","wp-marketing-automations")})),Object(r.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(r.createElement)(u.SelectControl,{value:i.type,className:"bwf_w_full",options:[{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")}],onChange:function(e){return pe(tn(tn({},be),{},{time_delay:tn(tn({},be.time_delay),{},{type:e})}))}})),Object(r.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(r.createElement)(u.SelectControl,{value:i.timing,className:"bwf_w_full",options:[{value:"before",label:Object(l.__)("Before","wp-marketing-automations")},{value:"after",label:Object(l.__)("After","wp-marketing-automations")}],onChange:function(e){return pe(tn(tn({},be),{},{time_delay:tn(tn({},be.time_delay),{},{timing:e})}))}}))))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(r.createElement)("div",{className:"bwf-specific-date "+(Object(b.Zb)()?"":"bwf-delay-no-pro")},Object(r.createElement)(Kt.a,{checked:m,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(b.Zb)()?pe(tn(tn({},be),{},{enable_step_skip:e})):(x("proModalContent",Object(l.__)("This","wp-marketing-automations")),x("showProModal",!0))}}))),m&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-delay-skip-step-select bwf-delay-field "+(Oe("variable")&&""==d.step?"has-error":"")},Object(r.createElement)(u.SelectControl,{value:d.step,className:"bwf_w_full",options:y,onChange:function(e){return pe(tn(tn({},be),{},{skip_to_step:tn(tn({},be.skip_to_step),{},{step:e,name:h[e]})}))}}),Oe("variable")&&""==d.step&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))))),""!==v&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-single-automation-notice is-info"},v)))}():Object(r.createElement)(r.Fragment,null));default:return Object(r.createElement)(r.Fragment,null)}var e,n,a,i,c,f,m,p,d,h}(),liteDummyData:{2:Object(r.createElement)("div",{className:"bwf-pl-30 bwf-lite-restrict-section"},Object(r.createElement)("div",{className:"bwf-specific-date-time-delay"},Object(r.createElement)("div",{className:"bwf-specific-date bwf_w_full bwf-h-36"},Object(r.createElement)("div",{className:"bwf-delay-field ",style:{pointerEvents:"none"}},Object(r.createElement)(Mt.a,{date:null,dateFormat:"MM/DD/YYYY",onUpdate:function(){},text:"",iconRight:!0,disabled:!0}))),Object(r.createElement)("div",{className:"bwf-specific-time bwf_w_full"},Object(r.createElement)("div",{className:"bwf-delay-field "},Object(r.createElement)("input",{type:"time",value:"",disabled:!0,onChange:function(){},className:"bwf-h-36"}))),Object(r.createElement)("div",{className:"bwf-specific-date bwf-w-210 "},Object(r.createElement)(Kt.a,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-specific-date"},Object(r.createElement)("div",{className:"bwf-specific-date "},Object(r.createElement)(Kt.a,{checked:!1,disabled:!0,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(){}}))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-specific-date "},Object(r.createElement)(u.SelectControl,{value:"",disabled:!0,className:"bwf_w_full",options:[],onChange:function(){}})),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(r.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(r.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(b.eb)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations")))),3:Object(r.createElement)("div",{className:"bwf-pl-30 bwf-lite-restrict-section"},Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(r.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(r.createElement)("div",{className:"bwf-delay-field-select bwf-w-210 "},Object(r.createElement)(u.SelectControl,{value:"",className:"bwf_W_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0})),Object(r.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field bwf-w-210 "},Object(r.createElement)(u.SelectControl,{value:"",className:"bwf_w_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0}))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(r.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(r.createElement)("input",{type:"time",value:"",disabled:!0,className:"bwf-w-210 bwf-h-36",onChange:function(){}})),Object(r.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(r.createElement)(Kt.a,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(r.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(r.createElement)("div",{className:"bwf-specific-date "},Object(r.createElement)(Kt.a,{checked:!1,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(){},disabled:!0}))),Object(r.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(r.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "},Object(r.createElement)(u.TextControl,{className:"bwf-h-36",type:"number",disabled:!0,value:"",onChange:function(){},min:1,placeholder:Object(l.__)("Enter","wp-marketing-automations")})),Object(r.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(r.createElement)(u.SelectControl,{value:"",className:"bwf_w_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0})),Object(r.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(r.createElement)(u.SelectControl,{value:"",disabled:!0,className:"bwf_w_full",options:[],onChange:function(){}}))))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(r.createElement)("div",{className:"bwf-specific-date "},Object(r.createElement)(Kt.a,{checked:!1,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),disabled:!0,onChange:function(){}}))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(r.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(r.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(b.eb)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))}}),w&&Object(r.createElement)("div",{className:"bwf-single-automation-notice"},Object(l.__)("There can be contacts queued at this step, new settings will apply to all of them.","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_clear_24"}))),Object(r.createElement)("div",{className:"wr_footer"},Object(r.createElement)(y.a,{className:"bwf-cancel-btn",onClick:function(){return S(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(r.createElement)(y.a,{isPrimary:!0,onClick:he,isBusy:A,className:"bwf-no-ripple"},Object(l.__)("Save","wp-marketing-automations"))))},fn=n(525),mn=n(105);function bn(e){return(bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pn(){pn=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==bn(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(bn(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dn(Object(n),!0).forEach((function(t){yn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=bn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=bn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vn(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function On(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){vn(o,r,a,i,c,"next",e)}function c(e){vn(o,r,a,i,c,"throw",e)}i(void 0)}))}}function wn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return jn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var gn=function(){var e=Object(r.useContext)(b.h),t=wn(Object(r.useState)(""),2),n=(t[0],t[1]),a=wn(Object(r.useState)(!1),2),i=a[0],c=a[1],u=wn(Object(r.useState)(!1),2),p=u[0],h=u[1],v=wn(Object(r.useState)(!1),2),O=v[0],w=v[1],j=wn(Object(r.useState)(""),2),g=j[0],E=j[1];Object(r.useEffect)((function(){c(!1)}),[]);var _,k,N=Object(f.a)(),S=N.showSidebar,P=N.setNodeDatabyId,x=N.setAutomationData,L=Object(m.a)(),C=L.getSidebarNodeData,A=L.getAutomationId,T=L.getNodeDataByID,I=L.getAutomationLinks,D=L.getAutomationSteps,M=L.getCount,F=L.getAutomationData,G=(0,L.getautomationMeta)(),z=D(),Z=I(),U=M(),q=C(),B=A(),R=F(),Y=R&&R.event?R.event:"",V=Object(X.a)(Y,parseInt(B)),$=(V.isLoading,V.error,V.rules),J=!Object(o.isEmpty)(q)&&q.hasOwnProperty("data")?q.data:{},W=!Object(o.isEmpty)(J)&&J.hasOwnProperty("sidebarValues")?(_=J.sidebarValues,k=[],Object(o.isEmpty)(_)?[]:(Object.keys(_).map((function(e){var t=_[e],n=[];t.map((function(e){$.hasOwnProperty(e.filter)&&n.push(e)})),Object(o.isEmpty)(n)||k.push(n)})),k)):[],K=!Object(o.isEmpty)(q)&&q.hasOwnProperty("id")?T(q.id):{},Q=K.stepId,ee=void 0===Q?0:Q,te=K.data,ne=(void 0===te?{}:te).sidebarValues,re=function(){var t=On(pn().mark((function t(){var n,r,a,i=arguments;return pn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:{},r=!(i.length>1&&void 0!==i[1])||i[1],a={data:{data:{sidebarData:n}},steps:Object(o.cloneDeep)(z).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:Z,count:U},r||(a.updateStatus=2),t.prev=4,t.next=7,d()({path:Object(b.A)("/automation/".concat(B,"/step/").concat(ee)),method:"POST",data:a}).then((function(t){if(200!==t.code)throw Error(Object(b.u)(null==t?void 0:t.message));r&&e(t.message),r&&(J.sidebarValues=n,P(q.id,J,{step_status:1})),t.hasOwnProperty("result")&&t.result.hasOwnProperty("meta")&&x("meta",hn(hn({},G),t.result.meta)),setTimeout((function(){S(!1)}),100),h(!1)})).catch((function(e){throw Error(Object(b.u)(null==e?void 0:e.message))}));case 7:t.next=13;break;case 9:t.prev=9,t.t0=t.catch(4),r&&x("modalData",{status:!0,modalTitle:Object(l.__)("Update Condition","wp-marketing-automations"),error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),h(!1);case 13:Object(b.Kb)(e,3e3);case 14:case"end":return t.stop()}}),t,null,[[4,9]])})));return function(){return t.apply(this,arguments)}}(),ae=function(){var e=On(pn().mark((function e(){var t,r,a;return pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(b.Zb)()){e.next=4;break}return x("proModalContent",Object(l.__)("Conditional Step","wp-marketing-automations")),x("showProModal",!0),e.abrupt("return");case 4:if(t=Object(o.cloneDeep)(J.sidebarValues),r=[],a=!1,Object(o.isEmpty)(t)||t.map((function(e){Object(o.isEmpty)(e)||(r.push(e),e.map((function(e){var t;(t=e).hasOwnProperty("rule")&&["is_blank","is_not_blank"].includes(t.rule)||!(!t.hasOwnProperty("data")||""==t.data||null==t.data||Array.isArray(t.data)&&Object(o.isEmpty)(t.data)||$&&$.hasOwnProperty(t.filter)&&"key-value"==$[t.filter].input.component&&(""==t.data[0]||null==t.data[0]||Array.isArray(t.data[1])&&Object(o.isEmpty)(t.data[1])||""==t.data[1]||null==t.data[1]||Array.isArray(t.data[1])&&Object(o.isEmpty)(t.data[1]))||$&&$.hasOwnProperty(t.filter)&&["Date","Days","datetime"].includes($[t.filter].input.component)&&"between"===t.rule&&(!t.data.hasOwnProperty("to")||!t.data.hasOwnProperty("from")||Object(o.isEmpty)(t.data.to)||Object(o.isEmpty)(t.data.from)))||(c(!0),a=!0,n(Object(l.__)("Some condition(s) are empty please remove them or fill them.","wp-marketing-automations")))})))})),Object(o.isEmpty)(r)||a){e.next=18;break}if(!Object(o.isEqual)(ne,r)){e.next=13;break}return S(!1),h(!1),e.abrupt("return");case 13:return h(!0),e.next=16,re(r);case 16:e.next=19;break;case 18:!a&&n(Object(l.__)("Please select conditions to save.","wp-marketing-automations"));case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe=Object(r.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object.keys(W).length,n=Object(o.cloneDeep)(W);n[t]=[e];var r=hn(hn({},q),{},{data:hn(hn({},J),{},{sidebarValues:n})});x("sidebarNodeData",r),setTimeout((function(){E(""),w(!1)}),1)}),[W]),ie=(Object(r.useCallback)((function(e){var t=hn({},W);delete t[e];var n=hn(hn({},q),{},{data:hn(hn({},J),{},{sidebarValues:t})});x("sidebarNodeData",n)}),[W]),function(){return Object(r.createElement)("ul",{className:"bwf-popover-container bwf-group"},Object(r.createElement)("li",{className:"list-label"},Object(l.__)("Select Group","wp-marketing-automations")),function(){var e=[],t=[];Object.entries($).map((function(n){var r=wn(n,2),a=(r[0],r[1]);e.includes(a.group)||(e.push(a.group),t.push({priority:a.priority?a.priority:0,key:a.group,label:a.groupLabel}))}));return t.sort((function(e,t){return e.priority-t.priority})),t}().map((function(e,t){return Object(r.createElement)("li",{className:"list-values has-pointer",onClick:function(){return E(e.key)},key:t},e.label,Object(r.createElement)("span",{className:"bwf-svgtailf-arrow"},Object(r.createElement)(s.a,{icon:"tailless-arrow-forward",size:14,color:"#353030"})))})))}),ce=function(){return Object(r.createElement)("ul",{className:"bwf-popover-container bwf-filters"},Object(r.createElement)("li",{className:"list-label list-values has-pointer is-back-button",onClick:function(){return E("")}},Object(r.createElement)("span",{className:"bwf-svgtailb-arrow"},Object(r.createElement)(s.a,{icon:"tailless-arrow-forward",size:14,color:"#353030"})),Object(l.__)("Back","wp-marketing-automations")),(e=[],Object.entries($).map((function(t){var n=wn(t,2),r=n[0],a=n[1];(Object(o.isEmpty)(g)||g===a.group)&&e.push({key:r,label:a.labels.add})})),e).map((function(e,t){return Object(r.createElement)("li",{className:"list-values has-pointer",onClick:function(){oe({filter:e.key,rule:"",data:""})},key:t},e.label)})));var e},le=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e?"bwf-sidebar-empty-placeholder ":"";return Object(r.createElement)("div",{className:t},e&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-main-icon"},Object(r.createElement)(s.a,{icon:"conditional-placeholder",size:90})),Object(r.createElement)("div",{className:"bwf-h2"},Object(l.__)("No Condition","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-h4 bwf-h4-grey bwf-mb-0"},Object(l.__)("Add a condition to segment and make contacts flow to different branches","wp-marketing-automations"))),e&&Object(r.createElement)("div",{className:"bwf_clear_24"}),!Object(o.isEmpty)($)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(y.a,{isPrimary:!0,className:"bwf-no-ripple "+(e?"":"bwf-conditional-btn conditional-or"),onClick:function(){return w(!0)},style:e?{}:{margin:"-38px 0px 0px 62px",position:"absolute"}},e?Object(l.__)("Add New Condition","wp-marketing-automations"):Object(l.__)("OR","wp-marketing-automations"),O&&Object(r.createElement)(H.a,{className:"bwf-conditioal-group-popup "+(e?"":"bwf-conditional-or"),focusOnMount:!0,onFocusOutside:function(){return w(!1)},onClose:function(){return w(!1)}},Object(o.isEmpty)(g)?ie():ce())),e&&Object(r.createElement)("div",{className:"bwf_clear_48"})))};return Object(r.createElement)(b.f.Provider,{value:{errorList:i,setErrorList:c,stepId:ee}},Object(r.createElement)("div",{className:"wr_header"},Object(r.createElement)("div",{className:"bwf-node-icon"},Object(r.createElement)(s.a,{size:26,icon:"condition"})),Object(r.createElement)("div",{className:"wr_event_title"},Object(l.__)("Condition","wp-marketing-automations"),!Object(b.Zb)()&&Object(r.createElement)(mn.a,null)),Object(r.createElement)("div",{className:"wr_event_variant"}),Object(r.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:On(pn().mark((function e(){return pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(o.isEmpty)(W)){e.next=3;break}return e.next=3,re([],!1);case 3:S(!1);case 4:case"end":return e.stop()}}),e)})))},Object(r.createElement)(s.a,{icon:"close"}))),Object(r.createElement)("div",{className:"wr_content wr-conditioal-sidebar"},Object(o.isEmpty)(W)||Object(o.isEmpty)($)?Object(r.createElement)(r.Fragment,null,le()):Object(r.createElement)(r.Fragment,null,Object.keys(W).map((function(e,t){return Object(r.createElement)("div",{className:"bwf-conditional-wrap",key:t},Object(r.createElement)(fn.a,{key:e,filters:$,groupingEnabled:!0,value:W[e],setValue:function(t){var n=Object(o.cloneDeep)(W);n[e]=t,n=n.filter((function(e){return 0!==Object.keys(e).length}));var r=hn(hn({},q),{},{data:hn(hn({},J),{},{sidebarValues:n})});x("sidebarNodeData",r)}}),t+1!==Object.keys(W).length&&Object(r.createElement)("div",{className:"bwf-conditional-rules-label-or"},Object(r.createElement)("span",{className:"bwf-line"}),Object(r.createElement)("span",{className:"bwf-rule-text"},Object(l.__)("OR","wp-marketing-automations"))))})),le(!1)),Object(r.createElement)("div",{className:"bwf_clear_24"})),Object(r.createElement)("div",{className:"wr_footer"},Object(r.createElement)(y.a,{className:"bwf-cancel-btn",onClick:function(){Object(o.isEmpty)(W)&&re([],!1),S(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(r.createElement)(y.a,{isPrimary:!0,className:"bwf-no-ripple",onClick:ae,isBusy:p},!Object(b.Zb)()&&Object(r.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),Object(l.__)("Save","wp-marketing-automations"))))};function En(e){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _n(){_n=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==En(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(En(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function kn(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){Pn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=En(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=En(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==En(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ln(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ln(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ln(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Cn=function(){var e=Object(r.useContext)(b.h),t=xn(Object(r.useState)(!1),2),n=t[0],a=t[1],i=xn(Object(r.useState)(!1),2),u=i[0],p=i[1],h=xn(Object(r.useState)(!1),2),v=h[0],O=h[1],w=Object(m.a)(),j=w.getSidebarNodeData,g=w.getNodeDataByID,E=w.getAutomationSteps,_=w.getAutomationLinks,k=w.getCount,N=w.getAutomationId,S=w.getGoals,P=w.getautomationMeta,x=Object(f.a)(),L=x.showSidebar,C=x.setNodeDatabyId,A=x.setAutomationData,T=Object(r.useRef)(null),I=xn(Object(r.useState)([]),2),D=I[0],M=I[1],F=j(),G=S().list,z=void 0===G?{}:G,Z=P(),U=F.data,q=F&&F.data&&F.data.benchmark&&z.hasOwnProperty(F.data.benchmark)?z[F.data.benchmark]:{},B=F&&F.data&&F.data.benchmark?F.data.benchmark:"",R=!Object(o.isEmpty)(F.data)&&F.data.hasOwnProperty("sidebarValues")?F.data.sidebarValues:{},Y=q.fields,H=void 0===Y?[]:Y,V=q.default_values,$=void 0===V?{}:V,J=N(),W=E(),K=_(),Q=k(),X=!Object(o.isEmpty)(F)&&F.hasOwnProperty("id")?g(F.id):{},ee=X.stepId,te=void 0===ee?0:ee,ne=X.data,re=(void 0===ne?{}:ne).sidebarValues;Object(r.useEffect)((function(){M([])}),[]);var ae=Sn(Sn({},$),R),oe=function(e,t,n){var r=!1,a=t.fields,o=t.relation,i=void 0===o?"OR":o;i=i.toUpperCase();try{var c=null;if("OR"===i){if(a&&Array.isArray(a))for(var l=0;l<a.length;l++){c=e[a[l].id];var s=void 0===a[l].value||a[l].value;if(Array.isArray(s)&&s.includes(c))return!0;if(""!=s&&c==s||""==s&&""!=c&&null!=c)return!0}}else"AND"==i&&a&&Array.isArray(a)&&(r=a.every((function(t){c=e[t.id];var n=void 0===t.value||t.value;return!(!Array.isArray(n)||!n.includes(c))||(""===n||c==n)&&(""!=n||""!=c&&null!=c)})))}catch(e){console.log(e)}return r},ie=function(){var t,n=(t=_n().mark((function t(n){var r;return _n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Object(b.Zb)()){t.next=4;break}return A("proModalContent",Object(l.__)("Goal Step","wp-marketing-automations")),A("showProModal",!0),t.abrupt("return");case 4:if(!Object(o.isEmpty)(le(n))){t.next=21;break}if(!Object(o.isEqual)(re,n)){t.next=8;break}return L(!1),t.abrupt("return");case 8:return U.sidebarValues=n,a(!0),r={data:{data:{sidebarData:n}},steps:Object(o.cloneDeep)(W).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:K,count:Q,optionUpdated:u,actionType:3},t.prev=11,t.next=14,d()({path:Object(b.A)("/automation/".concat(J,"/step/").concat(te)),method:"POST",data:r}).then((function(t){if(200!==t.code)throw Error(Object(b.u)(null==t?void 0:t.message));e(t.message);var n="";t.hasOwnProperty("result")&&t.result.hasOwnProperty("desc_text")&&!Object(o.isEmpty)(t.result.desc_text)&&(n=t.result.desc_text),t.hasOwnProperty("result")&&t.result.hasOwnProperty("meta")&&A("meta",Sn(Sn({},Z),t.result.meta)),C(F.id,Sn(Sn({},U),{},{desc_text:n}),{step_status:1}),setTimeout((function(){L(!1)}),100),a(!1)})).catch((function(e){throw Error(Object(b.u)(null==e?void 0:e.message))}));case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(11),A("modalData",{status:!0,modalTitle:Object(l.__)("Update Goal","wp-marketing-automations"),error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),a(!1);case 20:Object(b.Kb)(e,3e3);case 21:case"end":return t.stop()}}),t,null,[[11,16]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){kn(o,r,a,i,c,"next",e)}function c(e){kn(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}(),ce=[];Object(o.isEmpty)(H)||H.forEach((function(e){e.hasOwnProperty("required")&&e.required&&ce.push(e)}));var le=function(e){var t={};return ce.map((function(n){(!n.hasOwnProperty("toggler")||Object(o.isEmpty)(n.toggler)||oe(e,n.toggler))&&(Array.isArray(e[n.id])&&0===e[n.id].length||""===e[n.id]||void 0===e[n.id])&&(t[n.id]=n.hasOwnProperty("errorMsg")?n.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations")),"bwfan_email_data"===n.id&&(!e.hasOwnProperty("bwfan_email_data")||e.bwfan_email_data.hasOwnProperty("subject")&&Object(o.isEmpty)(e.bwfan_email_data.subject))&&(t[n.id]="error")})),M(t),t};return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"wr_header"},Object(r.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(r.createElement)(s.a,{size:26,icon:"goal"})),Object(r.createElement)("div",{className:"wr_event_title"},q.event_name,!Object(b.Zb)()&&Object(r.createElement)(mn.a,null)),Object(r.createElement)("div",{className:"wr_event_variant"},Object(b.Zb)()&&!Object(o.isEmpty)(B)&&"crm_link_trigger"===B&&Object(r.createElement)(rt.a,{canCreate:!0,isLinkTriggerOpen:v,setLinkTriggerOpen:O,hideButton:!1})),Object(r.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return L(!1)}},Object(r.createElement)(s.a,{icon:"close"}))),Object(r.createElement)(b.f.Provider,{value:{errorList:D,setErrorList:M,stepId:te}},Object(r.createElement)(tt.a,{onSubmit:function(e){ie(e)},initialValues:ae,validate:function(e){return p(function(e){var t=U.sidebarValues,n=void 0===t?{}:t;if(Object(o.isEmpty)(n))return!1;var r=ae.bwfan_goal_run,a=void 0===r?"":r,i=e.bwfan_goal_run;return a!==(void 0===i?"":i)&&"wait"===a}(e)),!1}},(function(e){var t=e.getInputProps,a=e.values,i=e.errors,f=e.handleSubmit;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"wr_content",ref:T},Object(r.createElement)("div",null,H.map((function(e,n){return Object(r.createElement)(r.Fragment,{key:n},(Object(o.isEmpty)(e.toggler)||oe(a,e.toggler))&&e.wrap_before&&Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(r.createElement)(r.Fragment,null,!1!==e.show&&(Object(o.isEmpty)(e.toggler)||oe(a,e.toggler))&&Object(r.createElement)(nt.a,{input:e,formProps:t(e.id),values:a})):e.hint?Object(r.createElement)(r.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:c()(e.class)}):null,(Object(o.isEmpty)(e.toggler)||oe(a,e.toggler))&&e.wrap_after&&Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))}))),u&&Object(r.createElement)("div",{className:"bwf-single-automation-notice"},Object(l.__)("There can be contacts queued at this step, new settings will apply to all of them.","wp-marketing-automations"))),Object(r.createElement)("div",{className:"wr_footer"},Object(r.createElement)(y.a,{className:"bwf-cancel-btn",onClick:function(){return L(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(r.createElement)(y.a,{isPrimary:!0,onClick:function(){f()},className:"bwf-no-ripple",isBusy:n,disabled:Object.keys(i).length},!Object(b.Zb)()&&Object(r.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),Object(l.__)("Save","wp-marketing-automations"))))}))))},An=n(202);function Tn(e){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function In(){In=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==Tn(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Tn(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function Dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dn(Object(n),!0).forEach((function(t){Fn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Tn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Tn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Tn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gn(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function zn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Zn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Un=function(){var e=Object(r.useContext)(b.h),t=zn(Object(r.useState)(!1),2),n=t[0],a=t[1],i=Object(m.a)(),u=i.getSelectedEventData,p=i.getAutomationId,h=i.getautomationMeta,v=Object(f.a)(),O=v.showSidebar,w=v.setAutomationData,j=p(),g=Object(r.useRef)(null),E=zn(Object(r.useState)(!1),2),_=E[0],k=E[1],N=zn(Object(r.useState)([]),2),S=N[0],P=N[1],x=h(),L=u(),C=!Object(o.isEmpty)(x)&&x.hasOwnProperty("event_meta")?x.event_meta:{},A=Object(o.isEmpty)(L)?{}:L,T=A.fields,I=void 0===T?[]:T,D=A.default_values,M=void 0===D?{}:D,F=A.need_unique_key,G=void 0!==F&&F;Object(r.useEffect)((function(){P([]),k(!1)}),[]);var z=function(e,t,n){var r=!1,a=t.fields,o=t.relation,i=void 0===o?"OR":o;i=i.toUpperCase();try{var c=null;if("OR"===i){if(a&&Array.isArray(a))for(var l=0;l<a.length;l++){c=e[a[l].id];var s=void 0===a[l].value||a[l].value;if(Array.isArray(s)&&s.includes(c))return!0;if(""!=s&&c==s||""==s&&""!=c&&null!=c)return!0}}else"AND"==i&&a&&Array.isArray(a)&&(r=a.every((function(t){c=e[t.id];var n=void 0===t.value||t.value;return!(!Array.isArray(n)||!n.includes(c))||(""===n||c==n)&&(""!=n||""!=c&&null!=c)})))}catch(e){console.log(e)}return r},Z=function(){var t,n=(t=In().mark((function t(n){return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(o.isEmpty)(q(n))){t.next=15;break}if(!Object(o.isEqual)(C,n)){t.next=4;break}return O(!1),t.abrupt("return");case 4:return a(!0),t.prev=5,t.next=8,d()({path:Object(b.A)("/automation/".concat(j,"/")),method:"POST",data:{data:{meta:{event_meta:n},isWebhook:G}}}).then((function(t){if(200!==t.code)throw Error(Object(b.u)(null==t?void 0:t.message));e(t.message);var r=Mn({},n);G&&C.hasOwnProperty("webhook_data")&&(r.webhook_data=C.webhook_data),w("meta",Mn(Mn({},x),{},{event_meta:r})),setTimeout((function(){O(!1)}),100),a(!1)})).catch((function(e){throw Error(Object(b.u)(null==e?void 0:e.message))}));case 8:t.next=14;break;case 10:t.prev=10,t.t0=t.catch(5),w("modalData",{status:!0,modalTitle:Object(l.__)("Update Event","wp-marketing-automations"),error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),a(!1);case 14:Object(b.Kb)(e,3e3);case 15:case"end":return t.stop()}}),t,null,[[5,10]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){Gn(o,r,a,i,c,"next",e)}function c(e){Gn(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}(),U=[];Object(o.isEmpty)(I)||I.forEach((function(e){e.hasOwnProperty("required")&&e.required&&U.push(e)}));var q=function(e){var t={};return U.map((function(n){(!n.hasOwnProperty("toggler")||Object(o.isEmpty)(n.toggler)||z(e,n.toggler))&&(Array.isArray(e[n.id])&&0===e[n.id].length||""===e[n.id]||void 0===e[n.id])&&(t[n.id]=n.hasOwnProperty("errorMsg")?n.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations")),"bwfan_email_data"===n.id&&(!e.hasOwnProperty("bwfan_email_data")||e.bwfan_email_data.hasOwnProperty("subject")&&Object(o.isEmpty)(e.bwfan_email_data.subject))&&(t[n.id]="error"),"bwf_form_submit"===n.type&&(e.hasOwnProperty("bwfan-form-field-map")&&e["bwfan-form-field-map"].hasOwnProperty("bwfan_email_field_map")&&""!==e["bwfan-form-field-map"].bwfan_email_field_map||(t["bwfan-form-email-field-map"]="error"))})),P(t),t};return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"wr_header"},Object(r.createElement)("div",{className:"bwf-node-icon icon-start"},Object(r.createElement)(s.a,{size:22,icon:"rocket"})),Object(r.createElement)("div",{className:"wr_event_title"},L.hasOwnProperty("event_name")?L.event_name:""),Object(r.createElement)("div",{className:"wr_event_variant"}),Object(r.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return O(!1)}},Object(r.createElement)(s.a,{icon:"close"}))),Object(r.createElement)(b.f.Provider,{value:{errorList:S,setErrorList:P}},Object(r.createElement)(tt.a,{onSubmit:function(e){Z(e)},initialValues:Mn(Mn({},M),C),validate:function(){return!1}},(function(e){var t=e.getInputProps,a=e.values,i=e.errors,s=e.handleSubmit;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"wr_content",ref:g},Object(r.createElement)("div",null,I.map((function(e,n){return Object(r.createElement)(r.Fragment,{key:n},(Object(o.isEmpty)(e.toggler)||z(a,e.toggler))&&e.wrap_before&&Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(r.createElement)(r.Fragment,null,!1!==e.show&&(Object(o.isEmpty)(e.toggler)||z(a,e.toggler))&&Object(r.createElement)(nt.a,{input:e,formProps:t(e.id),values:a})):e.hint?Object(r.createElement)(r.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:c()(e.class)}):null,(Object(o.isEmpty)(e.toggler)||z(a,e.toggler))&&e.wrap_after&&Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))),Object(r.createElement)("div",{className:"wr_footer"},Object(r.createElement)(y.a,{className:"bwf-cancel-btn",onClick:function(){return O(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(r.createElement)(y.a,{isPrimary:!0,onClick:function(){s()},className:"bwf-no-ripple",isBusy:n,disabled:Object.keys(i).length},Object(l.__)("Save","wp-marketing-automations"))))}))),Object(b.Zb)()&&Object(r.createElement)(An.a,{isOpen:_,setOpenTags:k}))};function qn(e){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bn(){Bn=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==qn(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(qn(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function Rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(n),!0).forEach((function(t){Hn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Hn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=qn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=qn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vn(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function $n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Jn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Wn=function(){var e=$n(Object(r.useState)(!1),2),t=e[0],n=e[1],a=$n(Object(r.useState)(!1),2),i=a[0],c=a[1],p=$n(Object(r.useState)({step:"",name:""}),2),h=p[0],v=p[1],O=Object(r.useContext)(b.h),w=Object(f.a)(),j=w.showSidebar,g=w.setNodeDatabyId,E=w.fetchSplitPathNodes,_=w.setAutomationData,k=Object(m.a)(),N=k.getSidebarNodeData,S=k.getNodeDataByID,P=k.getAutomationId,x=k.getAutomationLinks,L=k.getAutomationSteps,C=k.getCount,A=k.getActionsList,T=k.getGoals,I=k.getautomationMeta,D=N(),M=P(),F=L(),G=x(),z=C(),Z=A(),U=T(),q=I(),B=E(),R=!Object(o.isEmpty)(D)&&D.hasOwnProperty("id")?S(D.id):{},Y=(R.id,R.stepId),H=void 0===Y?0:Y,V=R.data,$=(void 0===V?{}:V).sidebarValues;Object(r.useEffect)((function(){n({}),n(!1)}),[]);var J=!Object(o.isEmpty)(D)&&D.hasOwnProperty("data")?D.data:{},W=!Object(o.isEmpty)(J)&&J.hasOwnProperty("sidebarValues")?J.sidebarValues:{};Object(r.useEffect)((function(){W.hasOwnProperty("jump_to")&&!Object(o.isEmpty)(W.jump_to)&&v(W.jump_to)}),[W]);var K={action:Object(l.__)("Action","wp-marketing-automations"),wait:Object(l.__)("Delay","wp-marketing-automations"),conditional:Object(l.__)("Conditional","wp-marketing-automations"),exit:Object(l.__)("Exit","wp-marketing-automations"),benchmark:Object(l.__)("Goal","wp-marketing-automations")},Q=Object(r.useMemo)((function(){var e={stepsOptArr:[],stepsOptions:[{value:"",label:Object(l.__)("Select Step","wp-marketing-automations")}]};return Object(o.isEmpty)(F)||(F.map((function(t){var n=t.stepId,r=void 0===n?0:n,a=t.id,o=void 0===a?0:a;if(!["yesNoNode","start","end","exit","jump","split","splitpath"].includes(t.type)&&!e.stepsOptArr.hasOwnProperty(o)&&!B.includes(o)){var i=[Object(l.__)("Step","wp-marketing-automations")];i.push(o),K.hasOwnProperty(t.type)&&i.push(" : "+K[t.type]),"action"==t.type&&t.hasOwnProperty("data")&&Z.list.hasOwnProperty(t.data.selected)&&Z.list[t.data.selected].hasOwnProperty("action_name")&&(Z.list[t.data.selected].hasOwnProperty("integration_nicename")?i.push(" - "+Z.list[t.data.selected].integration_nicename+" : "):i.push(" - "),i.push(Z.list[t.data.selected].action_name)),"benchmark"==t.type&&t.hasOwnProperty("data")&&U.list.hasOwnProperty(t.data.benchmark)&&U.list[t.data.benchmark].hasOwnProperty("event_name")&&(U.list[t.data.benchmark].hasOwnProperty("source_label")&&i.push(U.list[t.data.benchmark].source_label+" : "),i.push(U.list[t.data.benchmark].event_name)),e.stepsOptArr[r]=i.join(" "),e.stepsOptions.push({value:r,label:i.join(" ")})}})),e.stepsOptArr.end=Object(l.__)("End Automation","wp-marketing-automations"),e.stepsOptions.push({value:"end",label:Object(l.__)("End Automation","wp-marketing-automations")})),e}),[F]),X=Q.stepsOptArr,ee=Q.stepsOptions,te=function(){var e,t=(e=Bn().mark((function e(){var t,r;return Bn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(b.Zb)()){e.next=4;break}return _("proModalContent",Object(l.__)("Jump Step","wp-marketing-automations")),_("showProModal",!0),e.abrupt("return");case 4:if(h.hasOwnProperty("step")&&""!=h.step&&h.hasOwnProperty("name")&&""!=h.name){e.next=7;break}return n(!0),e.abrupt("return");case 7:if(n(!1),t=Yn(Yn({},W),{},{jump_to:h}),!Object(o.isEqual)($,t)){e.next=12;break}return j(!1),e.abrupt("return");case 12:return e.prev=12,c(!0),r={data:{data:{sidebarData:t}},steps:Object(o.cloneDeep)(F).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:G,count:z},e.next=17,d()({path:Object(b.A)("/automation/".concat(M,"/step/").concat(H)),method:"POST",data:r}).then((function(e){if(200!==e.code)throw Error(Object(b.u)(null==e?void 0:e.message));O(e.message),g(D.id,Yn(Yn({},J),{},{sidebarValues:t}),{step_status:1}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&_("meta",Yn(Yn({},q),e.result.meta)),setTimeout((function(){j(!1)}),100),c(!1)})).catch((function(e){throw Error(Object(b.u)(null==e?void 0:e.message))}));case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(12),_("modalData",{status:!0,modalTitle:Object(l.__)("Update Jump","wp-marketing-automations"),error:null===e.t0||void 0===e.t0?void 0:e.t0.message}),c(!1);case 23:Object(b.Kb)(O,3e3);case 24:case"end":return e.stop()}}),e,null,[[12,19]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Vn(o,r,a,i,c,"next",e)}function c(e){Vn(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"wr_header"},Object(r.createElement)("div",{className:"bwf-node-icon icon-jump"},Object(r.createElement)(s.a,{size:28,icon:"jump"})),Object(r.createElement)("div",{className:"wr_event_title"},Object(r.createElement)("span",null,Object(l.__)("Jump","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(mn.a,null)),Object(r.createElement)("div",{className:"wr_event_variant"}),Object(r.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){j(!1)}},Object(r.createElement)(s.a,{icon:"close"}))),Object(r.createElement)("div",{className:"wr_content"},Object(r.createElement)("div",{className:"bwf-jump-wrap"},Object(r.createElement)("div",{className:"bwf-jump-skip-step-select "+(t?"has-error":"")},Object(r.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("Jump To","wp-marketing-automations")),Object(r.createElement)(u.SelectControl,{value:h.step,className:"bwf_w_full",options:ee,onChange:function(e){v({step:e,name:e?X[e]:""})}}),t&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("This is a required field.","wp-marketing-automations"))))),Object(r.createElement)("div",{className:"bwf_clear_24"})),Object(r.createElement)("div",{className:"wr_footer"},Object(r.createElement)(y.a,{className:"bwf-cancel-btn",onClick:function(){return j(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(r.createElement)(y.a,{isPrimary:!0,onClick:te,isBusy:i,className:"bwf-no-ripple"},!Object(b.Zb)()&&Object(r.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),Object(l.__)("Save","wp-marketing-automations"))))},Kn=n(52);function Qn(e){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xn(){Xn=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==Qn(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Qn(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function er(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?er(Object(n),!0).forEach((function(t){nr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):er(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Qn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Qn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rr(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function ar(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return or(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?or(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function or(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ir=function(){var e=ar(Object(r.useState)(!1),2),t=e[0],n=e[1],a=ar(Object(r.useState)(!1),2),i=a[0],c=a[1],p=ar(Object(r.useState)(""),2),h=p[0],v=p[1],O=ar(Object(r.useState)(""),2),w=O[0],j=O[1],g=ar(Object(r.useState)(""),2),E=g[0],_=g[1],k=Object(r.useContext)(b.h),N=Object(f.a)(),S=N.showSidebar,P=N.setNodeDatabyId,x=N.setAutomationData,L=N.setSplitNodePath,C=N.fetchAutomationStat,A=Object(r.useRef)(new AbortController),T=Object(m.a)(),I=T.getSidebarNodeData,D=T.getNodeDataByID,M=T.getAutomationId,F=(0,T.getautomationMeta)(),G=I(),z=M(),Z=!Object(o.isEmpty)(G)&&G.hasOwnProperty("id")?D(G.id):{},U=Z.id,q=void 0===U?0:U,B=Z.stepId,R=void 0===B?0:B,Y=[{key:"",label:Object(l.__)("Select","wp-marketing-automations")},{key:"2",label:"2"},{key:"3",label:"3"}];Object(r.useEffect)((function(){return n({}),n(!1),function(){A.current.abort()}}),[]);var H=!Object(o.isEmpty)(G)&&G.hasOwnProperty("data")?G.data:{},V=!Object(o.isEmpty)(H)&&H.hasOwnProperty("sidebarValues")?H.sidebarValues:{};Object(r.useEffect)((function(){V.hasOwnProperty("split_path")&&!Object(o.isEmpty)(V.split_path)&&v(V.split_path),V.hasOwnProperty("title")&&!Object(o.isEmpty)(V.title)&&j(V.title),V.hasOwnProperty("desc")&&!Object(o.isEmpty)(V.desc)&&_(V.desc)}),[V]);var $=function(){var e,t=(e=Xn().mark((function e(){var t,r,a,o,i,s,u;return Xn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(b.Zb)()){e.next=4;break}return x("proModalContent",Object(l.__)("Split Path Step","wp-marketing-automations")),x("showProModal",!0),e.abrupt("return");case 4:if(""!=h&&""!=w){e.next=7;break}return n(!0),e.abrupt("return");case 7:return c(!0),n(!1),t=tr(tr({},V),{},{split_path:h,title:w,desc:E}),r={data:{data:{sidebarData:t}}},a=[],V.hasOwnProperty("split_path")&&""!=V.split_path||(o=L(q,h),i=o.newStep,s=o.newLink,u=o.newCount,r=tr(tr({},r),{},{steps:i,links:s,count:u}),a=i,x("statLoading",!0)),e.prev=13,e.next=16,d()({path:Object(b.A)("/automation/".concat(z,"/step/").concat(R)),method:"POST",data:r}).then((function(e){if(200!==e.code)throw Error(Object(b.u)(null==e?void 0:e.message));k(e.message),V.hasOwnProperty("split_path")&&""!=V.split_path?P(G.id,tr(tr({},H),{},{sidebarValues:t}),{step_status:1}):P(G.id,tr(tr({},H),{},{sidebarValues:t}),{step_status:1},a),C(),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&x("meta",tr(tr({},F),e.result.meta)),setTimeout((function(){S(!1)}),100),c(!1)})).catch((function(e){throw Error(Object(b.u)(null==e?void 0:e.message))}));case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(13),x("modalData",{status:!0,modalTitle:Object(l.__)("Update Split","wp-marketing-automations"),error:null===e.t0||void 0===e.t0?void 0:e.t0.message}),c(!1);case 22:Object(b.Kb)(k,3e3);case 23:case"end":return e.stop()}}),e,null,[[13,18]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){rr(o,r,a,i,c,"next",e)}function c(e){rr(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"wr_header"},Object(r.createElement)("div",{className:"bwf-node-icon icon-split-test"},Object(r.createElement)(s.a,{size:28,icon:"split-test"})),Object(r.createElement)("div",{className:"wr_event_title"},Object(r.createElement)("span",null,Object(l.__)("Split Path","wp-marketing-automations")),!Object(b.Zb)()&&Object(r.createElement)(mn.a,null)),Object(r.createElement)("div",{className:"wr_event_variant"}),Object(r.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){S(!1)}},Object(r.createElement)(s.a,{icon:"close"}))),Object(r.createElement)("div",{className:"wr_content "+(V.hasOwnProperty("split_path")&&""!=V.split_path?"":"split-full")},Object(r.createElement)("div",{className:"bwf-split-wrap"},Object(r.createElement)("div",{className:"bwf-split-title-text "+(t&&""===w?"has-error":"")},Object(r.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("Name","wp-marketing-automations")),Object(r.createElement)(u.TextControl,{className:"bwf-h-36",value:w,onChange:function(e){return j(e)},placeholder:Object(l.__)("Enter Name","wp-marketing-automations")}),t&&""===w&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("This is a required field.","wp-marketing-automations")))),(!V.hasOwnProperty("split_path")||""==V.split_path)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-split-path-select "+(t&&""===h?"has-error":"")},Object(r.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("No of Paths","wp-marketing-automations")),Object(r.createElement)(Kn.b,{selected:h,className:"bwf_w_full",options:Y,onChange:function(e){v(e)}}),t&&""===h&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("This is a required field.","wp-marketing-automations"))))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-split-title-desc "},Object(r.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("Description","wp-marketing-automations")),Object(r.createElement)(u.TextareaControl,{placeholder:Object(l.__)("Type here …","wp-marketing-automations"),value:E,onChange:function(e){return _(e)},rows:4})),Object(r.createElement)("div",{className:"bwf_clear_24"}))),Object(r.createElement)("div",{className:"wr_footer"},Object(r.createElement)(y.a,{className:"bwf-cancel-btn",onClick:function(){return S(!1)},disabled:i},Object(l.__)("Cancel","wp-marketing-automations")),Object(r.createElement)(y.a,{isPrimary:!0,className:"bwf-no-ripple",onClick:$,isBusy:i,disabled:i},!Object(b.Zb)()&&Object(r.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),V.hasOwnProperty("split_path")&&""!=V.split_path?Object(l.__)("Save","wp-marketing-automations"):Object(l.__)("Add","wp-marketing-automations"))))},cr=function(){var e=Object(m.a)(),t=e.openSidebar,n=e.getSidebarNodeData,a=t(),o=n(),i=o.type,c=void 0===i?"":i,s=o.data,u=(void 0===s?{}:s).selected,f=void 0===u?"":u;return a?Object(r.createElement)("div",{className:"bwf-wl-wrap"},Object(r.createElement)("div",{className:"wl-sidebar-overlay step-"+c+"-wrap ",onClick:function(e){return e.preventDefault()}}),Object(r.createElement)("div",{className:"wr wr-expanded step-"+c+"-wrap-content "+("wp_sendemail"==f?"bwf-mail-action":"")},function(){switch(c){case"start":return Object(r.createElement)(Un,null);case"action":return Object(r.createElement)(xt,null);case"conditional":return Object(r.createElement)(gn,null);case"wait":return Object(r.createElement)(un,null);case"benchmark":return Object(r.createElement)(Cn,null);case"jump":return Object(r.createElement)(Wn,null);case"split":return Object(r.createElement)(ir,null);default:return Object(r.createElement)(r.Fragment,null,Object(l.__)("Node Type not registered","wp-marketing-automations"))}}())):Object(r.createElement)(r.Fragment,null)},lr=n(74),sr=n(104),ur=n(1063),fr=n(1128);n(1119),n(1405);function mr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return br(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?br(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function br(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var pr=function(e){var t=e.id,n=e.sourceX,o=e.sourceY,i=e.targetX,c=e.targetY,s=e.sourcePosition,u=e.targetPosition,b=e.style,p=void 0===b?{}:b,d=(e.data,e.arrowHeadType),h=e.markerEndId,y=e.source,v=e.sourceHandleId,O=Object(a.g)({sourceX:n,sourceY:o,sourcePosition:s,targetX:i,targetY:c,targetPosition:u}),w=Object(a.i)(d,h),j=mr(Object(a.h)({sourceX:n,sourceY:o,targetX:i,targetY:c}),2),g=j[0],E=j[1],_=Object(f.a)(),k=_.setNodeForAdd,N=_.copyNodeHere,S=_.setOpenStepModal,P=_.setModalAnchorNode,x=Object(m.a)(),L=x.getEnableCopy,C=x.getEnableMove,A=x.getNodeDataByID,T=L(),I=C(),D=A(y);return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("path",{id:t,style:p,className:"react-flow__edge-path",d:O,markerEnd:w}),Object(r.createElement)("foreignObject",{width:23,height:23,x:g-11.5,y:E-11.5,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml"},Object(r.createElement)("div",{className:"bwf-edge-body"},T||I?Object(r.createElement)("div",{className:"bwf-drag-area",onClick:function(){return N(D,"after",v||"")}},Object(r.createElement)("div",{className:"bwf-drag-node is-edge"},Object(r.createElement)("div",{className:"bwf-node-add"})),Object(r.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(r.createElement)("div",{className:"bwf-node-add",onClick:function(e){k(y,{option:v}),S(!0),P(e.target)}}))))},dr=n(142),hr=n(19),yr=(n(1406),n(32));function vr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Or(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Or(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Or(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var wr=function(){var e=Object(m.a)(),t=e.getShowContactModalId,n=e.getAutomationData,a=e.getShowContactModalType,i=e.getContactModalExtraData,p=t(),h=a(),y=n().ID,O=i(),w=Object(o.isEmpty)(O)||Object(o.isNull)(O)?{}:O,j=w.split,g=void 0!==j&&j,E=w.path,_=void 0===E?"":E,k=w.pathCount,N=void 0===k?2:k,S=Object(f.a)().setAutomationData,P=vr(Object(r.useState)(!0),2),x=P[0],L=P[1],C=vr(Object(r.useState)({}),2),A=C[0],T=C[1],I=vr(Object(r.useState)(10),2),D=I[0],M=I[1],F=vr(Object(r.useState)(0),2),G=F[0],z=F[1],Z=vr(Object(r.useState)(!1),2),U=Z[0],q=Z[1],B=vr(Object(r.useState)(_),2),R=B[0],Y=B[1],H=Object(r.useRef)(new AbortController);Object(r.useEffect)((function(){return function(){S("contactModalData",{}),H.current.abort()}}),[]),Object(r.useEffect)((function(){L(!0),T({}),function(){try{var e={limit:D,offset:G,type:h};""!==R&&(e.path=R);var t=Object(hr.stringify)(e),n="string"!=typeof p?parseInt(p):0;d()({path:Object(b.A)("/automation/".concat(y,"/step/").concat(n,"/contacts?").concat(t)),method:"GET",signal:H.current.signal}).then((function(e){200===e.code&&(Object(o.isEmpty)(e.result)||T(e.result)),L(!1)}))}catch(e){L(!1)}}()}),[p,G,D,R]);var V=c()("bwfcrm-contacts-list",{"has-search":!1}),$=[{key:"name",label:Object(l.__)("Name","wp-marketing-automations"),isLeftAligned:!0,required:!0,cellClassName:"bwf-w-210 bwf-word-break"},{key:"email",label:Object(l.__)("Email","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-word-break bwf-w-150"},{key:"date",label:function(){if(g)return Object(l.__)("Date","wp-marketing-automations");switch(h){case"completed":return Object(l.__)("Completed On","wp-marketing-automations");case"queued":return Object(l.__)("Queued On","wp-marketing-automations");case"failed":return Object(l.__)("Failed On","wp-marketing-automations");case"active":return Object(l.__)("Started On","wp-marketing-automations");case"skipped":return Object(l.__)("Skipped On","wp-marketing-automations");default:return Object(l.__)("Date","wp-marketing-automations")}}(),isLeftAligned:!0,cellClassName:"bwf-w-150 bwf-word-break"}];!g||""!=_&&"all"!=_||$.push({key:"path",label:Object(l.__)("Path","wp-marketing-automations"),isLeftAligned:!1,cellClassName:"bwf-w-90"}),$.push({key:"traillink",label:"",isLeftAligned:!0,cellClassName:"bwf-w-100"});var J,W,K,Q,X,ee,te=function(e){return Object(r.createElement)(yr.a,{href:"admin.php?page=autonami&path=/contact/"+e.id,type:"bwf-crm",className:"bwf-cursor-pointer bwf-a-no-underline",style:{color:"#0073aa"},key:e.id},e.hasOwnProperty("name")&&""!==e.name?e.name:"-")},ne=function(e){var t=[];return Object(o.isEmpty)(e)||e.map((function(e){var n=[{display:te(e),value:""},{display:e.email,value:""},{display:e.hasOwnProperty("time")&&""!==e.time?Object(b.gb)(ke.a.unix(e.time).format("MM/DD/YYYY HH:mm:ss")):"-",value:""}];!g||""!=_&&"all"!=_||n.push({display:e.hasOwnProperty("path")&&le.hasOwnProperty(e.path)?Object(r.createElement)("div",{className:"bwf-splitpath bwfpathid-".concat(e.path)},Object(l.sprintf)(Object(l.__)("Path %s","wp-marketing-automations"),le[e.path])):"-",value:""}),n.push({display:e.hasOwnProperty("trail")&&""!==e.trail?Object(r.createElement)("div",{onClick:function(){Object(b.Zb)()?(S("customerSelected",e),S("showContactModalId",0),S("showContactModalType","")):q(!0)},className:"bwf-cursor-pointer bwf-display-flex bwf-flex-start gap-8",style:{color:"#0073aa"}},!Object(b.Zb)()&&Object(r.createElement)(s.a,{icon:"king",size:16}),Object(l.__)("View Journey","wp-marketing-automations")):"-",value:""}),t.push(n)})),t},re=function(e){z((e-1)*D)},ae=function(e){return"per_page"!==e?function(){}:oe},oe=function(e){e!==D&&M(e)},ie=Object(r.createElement)("div",{className:"bwf-contact-zero-state"},Object(r.createElement)(s.a,{icon:"contact-zero"}),Object(r.createElement)("div",{className:"bwf-heading"},Object(l.__)("No Contacts","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-desc"},Object(l.__)("Once your customer start purchase or interact with the product. The contacts will appear here","wp-marketing-automations"))),ce=function(){var e=A.total,t=void 0===e?0:e,n=A.path_total,r=void 0===n?0:n;return""==R?parseInt(t):parseInt(r)},le=Object(b.Lc)();return Object(r.createElement)(u.Modal,{className:"bwf-admin-modal bwf-admin-modal-large bwf-single-automation-contact-modal bwf-h--core-header",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(r.createElement)("div",{className:"bwf-modal-header"},Object(r.createElement)("div",{className:"bwf-modal-heading"},function(){var e="",t=ce();if(g)e=""==_||"all"==_?Object(l.__)("Split Path Contacts","wp-marketing-automations"):Object(l.sprintf)(Object(l.__)("Path %s Contacts","wp-marketing-automations"),le[_]);else switch(h){case"completed":e=Object(l.__)("Completed Contacts","wp-marketing-automations");break;case"queued":e=Object(l.__)("Queued Contacts","wp-marketing-automations");break;case"failed":e=Object(l.__)("Failed Contacts","wp-marketing-automations");break;case"skipped":e=Object(l.__)("Skipped Contacts","wp-marketing-automations");break;case"active":e=Object(l.__)("Active Contacts","wp-marketing-automations");break;default:e=Object(l.__)("Contacts","wp-marketing-automations")}return e+" "+(t>0?"("+t+")":"")}()),Object(r.createElement)("span",{onClick:function(){S("showContactModalId",0),S("showContactModalType","")},className:"bwf-modal-close"},Object(r.createElement)(s.a,{icon:"close",color:"#353030"}))),(W=A.data,K=void 0===W?[]:W,Q=A.total,X=void 0===Q?0:Q,A.path_total,ee=parseInt(G)/parseInt(D)+1,x||0!==parseInt(X)?Object(r.createElement)(r.Fragment,null,g&&(""===_||"all"===_)&&Object(r.createElement)("div",{className:"bwf-path-selector"},Object(r.createElement)(u.SelectControl,{value:R,className:"bwf_w_full",options:(J=[{label:Object(l.__)("Path: All","wp-marketing-automations"),value:""},{label:Object(l.__)("Path A","wp-marketing-automations"),value:"1"},{label:Object(l.__)("Path B","wp-marketing-automations"),value:"2"}],3===parseInt(N)&&J.push({label:Object(l.__)("Path C","wp-marketing-automations"),value:"3"}),J),onChange:function(e){Y(e)}})),Object(r.createElement)(dr.a,{className:V,title:"",rows:x?[]:ne(K),headers:$,query:{paged:ee},rowsPerPage:D,totalRows:ce(),isLoading:x,onPageChange:re,onQueryChange:ae,showMenu:!1,emptyMessage:Object(l.__)("No contacts found","wp-marketing-automations")}),!Object(b.Zb)()&&Object(r.createElement)(v.b,{isOpen:U,onRequestClose:function(){return q(!1)},modalContent:{isFeature:!0,featureTitle:Object(l.__)("Contact Journey","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Step+Contact+Journey+Upgrade+Modal"})}})):Object(r.createElement)(r.Fragment,null,ie)))},jr=n(47);function gr(e){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Er(){Er=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==gr(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(gr(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function _r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_r(Object(n),!0).forEach((function(t){Nr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=gr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=gr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==gr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sr(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function Pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return xr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Lr=function(e){var t=e.isProActive,n=void 0!==t&&t,a=Object(r.useContext)(b.h),i=Pr(Object(r.useState)(!1),2),c=i[0],p=i[1],d=Pr(Object(r.useState)(!1),2),h=d[0],y=d[1],v=Pr(Object(r.useState)(!1),2),O=v[0],w=v[1],j=Object(f.a)(),g=j.addNewStep,E=j.unsetCurrentNode,_=j.setOpenStepModal,k=j.setAutomationData,N=j.fetchSplitPathNodes,S=j.showSidebar,P=j.isInsideConditional,x=Object(m.a)(),L=x.getCurrentNode,C=x.getCurrentNodeAction,A=x.getOpenStepModal,T=x.getModalAnchorNode,I=A(),D=L(),M=C(),F=T();Object(r.useEffect)((function(){if(!Object(o.isEmpty)(D)&&D.hasOwnProperty("id")){var e=P(D.id);w(e),N().includes(D.id)?y(!0):y(!1)}}),[D]);var G=function(){var e,t=(e=Er().mark((function e(){var t,n,r,o,i=arguments;return Er().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:"action",p(!0),n=M.data&&M.data.option?M.data.option:"",r=M.data&&M.data.position?M.data.position:"after",o=kr(kr({},D),{},{xPos:D.position.x,yPos:D.position.y}),e.next=7,g(t,o,n,r,{}).then((function(e){Object(b.Kb)(a,3e3),E(),p(!1),_(!1),"split"==t&&(k("sidebarNodeData",e),S(!0))}));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Sr(o,r,a,i,c,"next",e)}function c(e){Sr(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();return I&&Object(r.createElement)(H.a,{onFocusOutside:function(){E(),_(!1)},position:"center",className:"bwf-type-select-modal",onClick:function(e){return e.stopPropagation()},anchorRef:F},!c&&Object(r.createElement)("div",{className:"bwf-title-wrap"},Object(r.createElement)("div",{className:"bwf-title bwf_w_full"},Object(l.__)("Add Step","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-cross bwf-cursor-pointer",onClick:function(){return _(!1)}},Object(r.createElement)(s.a,{icon:"cross",size:20})," ")),Object(r.createElement)("div",{className:"bwf-type-select-wrapper "+(c?"is-loading":"")},c?Object(r.createElement)("div",{className:"bwf-display-flex-column set-center is-loading"},Object(r.createElement)(jr.a,{spaceClass:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-h3"},Object(l.__)("Please Wait…","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-p"},Object(l.__)("We are adding step in the flow","wp-marketing-automations"))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)(u.Button,{isSecondary:!0,onClick:function(){G("action")}},Object(r.createElement)("span",{className:"bwf-type-select-icons"},Object(r.createElement)(s.a,{icon:"charge"})),Object(l.__)("Action","wp-marketing-automations")),Object(r.createElement)(u.Button,{isSecondary:!0,onClick:function(){G("wait")}},Object(r.createElement)("span",{className:"bwf-type-select-icons"},Object(r.createElement)(s.a,{icon:"time-left"})),Object(l.__)("Delay","wp-marketing-automations")),Object(r.createElement)(u.Button,{isSecondary:!0,onClick:function(){n?G("conditional"):(k("proModalContent",{featureTitle:Object(l.__)("Conditional Step","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Add+Step+Condition+Upgrade+Modal"}),image:Object(b.rb)("conditional-step.png"),benefit:Object(l.__)("Use hundreds of conditions and advanced branching to create a highly tailored contact journey. Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))},style:{width:"100%"}},Object(r.createElement)("span",{className:"bwf-type-select-icons"},Object(r.createElement)(s.a,{icon:"condition"})),Object(l.__)("Condition","wp-marketing-automations"),!n&&Object(r.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(r.createElement)(s.a,{icon:"king",size:16}))),!h&&Object(r.createElement)(r.Fragment,null,!O&&Object(r.createElement)(u.Button,{isSecondary:!0,onClick:function(){n?G("split"):(k("proModalContent",{featureTitle:Object(l.__)("Split Path","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Add+Step+Split+Path+Upgrade+Modal"}),image:Object(b.rb)("split-path.png"),benefit:Object(l.__)("Test the subject lines, frequency or different automation paths to uncover hidden profits.Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))},style:{width:"100%"}},Object(r.createElement)("span",{className:"bwf-type-select-icons"},Object(r.createElement)(s.a,{icon:"split-test"})),Object(l.__)("Split Path","wp-marketing-automations"),!n&&Object(r.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(r.createElement)(s.a,{icon:"king",size:16}))),Object(r.createElement)(u.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){n?G("benchmark"):(k("proModalContent",{featureTitle:Object(l.__)("Goal Step","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Add+Step+Goal+Upgrade+Modal"}),image:Object(b.rb)("goal-step.png"),benefit:Object(l.__)("Never send unnecessary messages to users. Pull users to a specific step when a goal is achieved. Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))}},Object(r.createElement)("span",{className:"bwf-type-select-icons"},Object(r.createElement)(s.a,{icon:"goal"})),Object(l.__)("Goal","wp-marketing-automations"),!n&&Object(r.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(r.createElement)(s.a,{icon:"king",size:16}))),Object(r.createElement)(u.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){n?G("jump"):(k("proModalContent",{featureTitle:Object(l.__)("Jump Step","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Add+Step+Jump+Upgrade+Modal"}),image:Object(b.rb)("jump-step.png"),benefit:Object(l.__)("Create advanced automations by letting contacts jump to any step in the journey.Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))}},Object(r.createElement)("span",{className:"bwf-type-select-icons"},Object(r.createElement)(s.a,{icon:"jump"})),Object(l.__)("Jump","wp-marketing-automations"),!n&&Object(r.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(r.createElement)(s.a,{icon:"king",size:16}))),Object(r.createElement)(u.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){n?G("exit"):(k("proModalContent",{featureTitle:Object(l.__)("Exit Automation","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Add+Step+Exit+Upgrade+Modal"}),image:Object(b.rb)("exit-step.png"),benefit:Object(l.__)("Use this to make strategic decisions to end automation based on certain conditions.Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))}},Object(r.createElement)("span",{className:"bwf-type-select-icons"},Object(r.createElement)(s.a,{icon:"exit"})),Object(l.__)("Exit","wp-marketing-automations"),!n&&Object(r.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(r.createElement)(s.a,{icon:"king",size:16})))))))},Cr=n(69),Ar=(n(1156),n(26)),Tr=n(34),Ir=n.n(Tr),Dr=n(44),Mr=n.n(Dr),Fr=n(56);function Gr(e){return(Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Zr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Ur(){Ur=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==Gr(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Gr(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Br(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qr(Object(n),!0).forEach((function(t){Rr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Rr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Gr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Gr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Gr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yr(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}var Hr=function(e){return{name:"contact-journey",className:"bwf-search-bwf-tags-result",options:function(t){return(n=Ur().mark((function t(n){var r,a,o;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={search:n,limit:10,offset:0},t.next=3,d()({path:Object(b.A)("/automation/".concat(e,"/contacts/journey?")+Object(hr.stringify)(r)),method:"GET"});case 3:return a=t.sent,o=[],Ir()(a,"result")&&!Mr()(a.result)&&(o=a.result.map((function(e){return Br(Br({},e),{},{key:String(e.trail),label:Mr()(e.f_name)&&Mr()(e.l_name)?e.email:e.f_name+" "+e.l_name})}))),t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})),r=function(){var e=this,t=arguments;return new Promise((function(r,a){var o=n.apply(e,t);function i(e){Yr(o,r,a,i,c,"next",e)}function c(e){Yr(o,r,a,i,c,"throw",e)}i(void 0)}))},function(e){return r.apply(this,arguments)})(t);var n,r},isDebounced:!0,getOptionIdentifier:function(e){return e.key},getOptionKeywords:function(e){return[e.label]},getOptionLabel:function(e,t){return Object(r.createElement)("span",{key:"name",className:"bwf-customer-journey-search-result-name","aria-label":e.label},Object(r.createElement)("div",{className:"bwf-search-wrap"},Object(r.createElement)("div",{className:"bwf-search-label"},e.label),Object(r.createElement)("div",{className:"bwf-search-date"},"On:"," ",e.hasOwnProperty("c_date")?Object(b.gb)(e.c_date):"")))},getOptionCompletion:function(e){return e}}},Vr=function(e){var t=zr(Object(r.useState)(!1),2),n=t[0],a=t[1],i=e.automationId,c=Object(r.useRef)(),u=Object(f.a)().setAutomationData,p=Object(m.a)().getCustomerSelected;Object(b.Mc)(c,(function(){return a(!1)}));var d=p(),h=function(e){if(Object(o.isArray)(e)&&!Mr()(e)){if(!Mr()(e)){var t=e[e.length-1];(e=[])[0]=t}var n=e.find((function(e){return Ir()(e,"key")}));u("customerSelected",n),a(!1)}else u("customerSelected",{})};return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:"<style>body{overflow-y: hidden !important;}</style>"}}),Object(r.createElement)("div",{className:"bwf-automation-customer-journey-wrap"},Object(r.createElement)("div",{className:"bwf-automation-customer-journey"},Object(r.createElement)("div",{className:"bwf-customer-journey-header"},Object(r.createElement)("div",{className:"bwf-section-header",onClick:function(){Object(b.Zb)()?!n&&Mr()(d)&&a(!0):(u("proModalContent",{featureTitle:Object(l.__)("Contact Journey","wp-marketing-automations"),proLink:Object(b.eb)("upgrade",{utm_medium:"Automation+Workflow+Contact+Journey+Upgrade+Modal"})}),u("showProModal",!0))}},Object(r.createElement)(s.a,{icon:Object(b.Zb)()?"split-path":"king",width:16,height:18}),Object(r.createElement)("span",null,Object(l.__)("View Contact Journey","wp-marketing-automations")))),Object(b.Zb)()&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-customer-journey-popover-wrap"},n&&Object(r.createElement)(H.a,{ref:c,onFocusOutside:function(){return a(!1)},className:"bwf-customer-journey-popover",focusOnMount:!1,placement:"bottom"},Object(r.createElement)("div",{className:"bwf-customer-journey-popover-content"},Object(r.createElement)(Ar.a,{autocompleter:Hr(i),className:"bwf-customer-journey-search",placeholder:Object(l.__)("Search by Name, Email and Phone","wp-marketing-automations"),multiple:!1,inlineTags:!1,selected:[],onChange:h,bwfEnableEmptySearch:!0})))))),!Mr()(d)&&Object(r.createElement)("div",{className:"bwf-customer-selected"},Object(r.createElement)(Fr.a,{id:d.trail,label:d.hasOwnProperty("label")&&!Mr()(d.label.trim())?d.label:d.email,remove:function(){return u("customerSelected",{})}}))))},$r=n(1109);function Jr(e){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wr(){Wr=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==Jr(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Jr(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function Kr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kr(Object(n),!0).forEach((function(t){Xr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Jr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Jr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Jr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ea(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function ta(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){ea(o,r,a,i,c,"next",e)}function c(e){ea(o,r,a,i,c,"throw",e)}i(void 0)}))}}function na(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ra(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ra(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var aa=function(){var e=Object(f.a)(),t=e.setAutomationData,n=e.declareWinnerPath,a=Object(m.a)(),i=a.selectedWinner,c=a.getAutomationId,p=a.getautomationMeta,h=na(Object(r.useState)(!1),2),v=h[0],O=h[1],w=na(Object(r.useState)(!1),2),j=w[0],g=w[1],E=na(Object(r.useState)(!1),2),_=E[0],k=E[1],N=na(Object(r.useState)(!0),2),S=N[0],P=N[1],x=na(Object(r.useState)(!0),2),L=x[0],C=x[1],A=na(Object(r.useState)(""),2),T=A[0],I=A[1],D=na(Object(r.useState)(!1),2),M=D[0],F=D[1],G=Object(b.Lc)(),z=i(),Z=z.nodeId,U=void 0===Z?"":Z,q=z.stepID,B=void 0===q?"":q,R=z.title,Y=void 0===R?"":R,H=Object(r.useRef)(new AbortController),V=p(),$=c(),J=function(){t("declareWinner",{}),t("showSplitWinner",!1)};Object(r.useEffect)((function(){!function(){try{P(!0),d()({path:Object(b.A)("/automation/".concat($,"/analytics/").concat(B,"?mode=split")),method:"GET"}).then((function(e){200===e.code&&e.result.hasOwnProperty("data")&&!Object(o.isEmpty)(e.result.data)&&C(e.result.data),P(!1)}))}catch(e){P(!1)}}()}),[]);var W=function(){var e=ta(Wr().mark((function e(r,a,o){return Wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.prev=1,e.next=4,d()({path:Object(b.A)("/automation/".concat($,"/step/").concat(a,"/declare-winner")),method:"POST",signal:H.current.signal,data:{node_id:r,path_num:o}}).then(function(){var e=ta(Wr().mark((function e(i){return Wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.result){e.next=4;break}return F(!0),e.next=4,n(r,o).then((function(e){if(e){k(!0);var n=e.targetElemt,r=e.newStep,o=e.newLink,i=e.newCount;try{d()({path:Object(b.A)("/automation/".concat($,"/step/").concat(a,"/")),method:"POST",signal:H.current.signal,data:{steps:r,links:o,count:i}}).then((function(e){200===e.code&&(e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&t("meta",Qr(Qr({},V),e.result.meta)),t("targetNode",n),t("flowCenter",!0)),k(!1)}))}catch(e){k(!1)}}else k(!1)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),O(!1);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n,r){return e.apply(this,arguments)}}(),K=function(){var e,t,n=(e=L.paths,t=[],(void 0===e?[]:e).map((function(e){var n=e.path,r=void 0===n?"":n,a=e.stats,o=void 0===a?[]:a;parseInt(r)===parseInt(T)&&(t=o)})),t);return Object(r.createElement)("div",{className:"bwf-declare-winner-confirm-wrap"},Object(r.createElement)(s.a,{icon:"declare-winner"}),Object(r.createElement)("div",{className:"bwf-declare-winner-confirm-content"},Object(r.createElement)("div",{className:"bwf-declare-winner-confirm-header"},Object(l.sprintf)(Object(l.__)("Congratulations! You have declared Path %s as winner","wp-marketing-automations"),G[T])),Object(r.createElement)("div",{className:"bwf-declare-winner-confirm-stat-wrap"},n.map((function(e,t){return Object(r.createElement)("div",{className:"bwf-declare-winner-confirm-stat",key:t},Object(r.createElement)("div",{className:"bwf-split-node-value"},e.v),Object(r.createElement)("div",{className:"bwf-split-node-label"},e.l))}))),Object(r.createElement)("div",{className:"bwf-declare-winner-confirm-footer"},Object(r.createElement)(y.a,{isPrimary:!0,isBusy:_,disabled:_,onClick:J},_?Object(l.__)("Updating Automation","wp-marketing-automations"):Object(l.__)("Close","wp-marketing-automations")))))};return Object(r.createElement)(u.Modal,{className:"bwf-admin-modal bwf-admin-modal-no-header bwf-declare-winner-modal "+(!j||M?"bwf-admin-modal-1024":"bwf-admin-modal-480"),shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(r.createElement)("div",{className:"bwf-declare-winner-header-wrap"},Object(r.createElement)("div",{className:"bwf-declare-winner-header"},function(){if(S)return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-210 bwf-h-20"}),Object(r.createElement)("div",{className:"bwf_clear_5"}),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-150 bwf-h-15"}));var e=L.started_at,t=void 0===e?"":e;return j?Object(r.createElement)(r.Fragment,null,M?"":Object(l.sprintf)(Object(l.__)("Declare Path %s as Winner","wp-marketing-automations"),G[T])):Object(r.createElement)("div",{className:"bwf-declarewinner-step-title"},Object(r.createElement)("div",{className:"bwf-title-wrap"},Object(r.createElement)("div",{className:"bwf-split-title"},Object(l.sprintf)(Object(l.__)("Result of %s","wp-marketing-automations"),Y))),Object(r.createElement)("div",{className:"bwf-split-date"},Object(r.createElement)("span",null,Object(l.__)("Started On ","wp-marketing-automations")+" : "),Object(b.hb)(t)))}()),Object(r.createElement)("div",{className:"bwf-close-modal",onClick:J},Object(r.createElement)(s.a,{icon:"close",size:20}))),Object(r.createElement)("div",{className:"bwf-declare-winner-content"},function(){if(S)return Object(r.createElement)("div",{className:"bwf-declare-winner-analytics-wrap"},[1,2].map((function(e){return Object(r.createElement)("div",{className:"bwf-declare-winner-analytics-row",key:e},Object(r.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-60"})),[1,2,3,4,5,6,7,8].map((function(e){return Object(r.createElement)("div",{className:"bwf-declare-winner-analytics-col",key:e},Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-30"}),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-70"}))})),Object(r.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-h-30 bwf-w-120"})))})));var e=L.paths,t=void 0===e?[]:e;return j?Object(r.createElement)(r.Fragment,null,M?K():Object(l.sprintf)(Object(l.__)("You are about to declare Path %s as winner. All other paths will be removed from the automation. This action cannot be undone.","wp-marketing-automations"),G[T])):Object(r.createElement)("div",{className:"bwf-declare-winner-analytics-wrap"},t.map((function(e,t){var n=e.path,a=void 0===n?1:n,o=e.stats,i=void 0===o?[]:o;return Object(r.createElement)("div",{className:"bwf-declare-winner-analytics-row",key:t},Object(r.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(r.createElement)("span",{className:"bwf-split-path-title splitpath-".concat(a)},Object(l.__)("Path","wp-marketing-automations")+" "+G[a])),i.map((function(e,t){return Object(r.createElement)("div",{className:"bwf-declare-winner-analytics-col",key:t},Object(r.createElement)("span",{className:"bwf-split-test-value"},e.v),Object(r.createElement)("span",{className:"bwf-split-test-label"},e.l))})),Object(r.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(r.createElement)("div",{className:"bwf-declare-winner-btn",onClick:function(){g(!0),I(a)}},Object(l.__)("Declare Winner","wp-marketing-automations"))))})))}()),j&&!M&&Object(r.createElement)("div",{className:"bwf-declare-winner-footer",key:"footer"},Object(r.createElement)(y.a,{className:"bwf-cancel-btn",onClick:J,disabled:!1},Object(l.__)("Cancel","wp-marketing-automations")),Object(r.createElement)(y.a,{isPrimary:!0,onClick:function(){W(U,B,T)},isBusy:v,disabled:v},Object(l.__)("Declare Winner","wp-marketing-automations"))))};function oa(e){return(oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ia(){ia=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),c=new x(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",b="executing",p="completed",d={};function h(){}function y(){}function v(){}var O={};s(O,i,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(L([])));j&&j!==n&&r.call(j,i)&&(O=j);var g=v.prototype=h.prototype=Object.create(O);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==oa(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=m;return function(o,i){if(a===b)throw Error("Generator is already running");if(a===p){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=N(c,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=b;var s=f(t,n,r);if("normal"===s.type){if(a=r.done?p:"suspendedYield",s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=p,r.method="throw",r.arg=s.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(oa(t)+" is not iterable")}return y.prototype=v,a(g,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},E(_.prototype),s(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new _(u(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(g),s(g,l,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function ca(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function la(e){return function(e){if(Array.isArray(e))return fa(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ua(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||ua(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ua(e,t){if(e){if("string"==typeof e)return fa(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fa(e,t):void 0}}function fa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ma(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ba(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ma(Object(n),!0).forEach((function(t){pa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ma(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pa(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=oa(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=oa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==oa(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var da=function(e){var t=e.id,n=Object(lr.a)(),i=n.setL2Title,p=n.setPageCountData,y=Object(sr.a)().getPageCountData,O=Object(r.useContext)(b.h),w=Object(a.n)().setCenter,j=Object(a.l)(),g=Object(a.m)((function(e){return e.setSelectedElements})),E=Object(mt.b)(),_=E.mergeTag,k=E.setMergeTag,N=E.reset,S=E.identifier,P=E.setIdentifier,x=Object(m.a)(),L=y(),C=x.getLoading,A=x.getAutomationSteps,T=x.getAutomationLinks,I=x.getEnableCopy,D=x.getEnableMove,M=x.getAutomationData,F=x.getError,G=x.getShowContactModalId,z=x.getOpenStartSidebar,Z=x.getCustomerSelected,U=x.isProModal,q=x.getautomationMeta,B=(x.getListData,x.getModalData),R=x.getFlowCenter,H=x.getTargetNode,V=x.showSplitWinnerModal,$=x.getProModalContent,J=x.getSingleAutomationFailedCount,W=B(),K=Object(f.a)(),Q=K.setAutomationData,X=K.fetchAutomationStat,ee=T(),te=A(),ne=I(),re=D(),ae=C(),oe=F(),ce=M(),le=G(),se=ce.title,ue=void 0===se?"":se,fe=z(),me=Z(),be=U(),pe=$(),ye=q(),ve=ye.tips,Oe=void 0===ve?[]:ve,we=R(),je=H(),Ee=V(),_e=J();Object(r.useEffect)((function(){ae||p(ba(ba({},L),{},{single_a_contacts:_e}))}),[_e]),Object(ur.a)("workflow",ue,"admin.php?page=autonami&path=/automations",!1,null,t,!1,!0,!1),Object(r.useEffect)((function(){Q("isNewAutomation",0)}),[ce]);var ke=Object(r.useRef)();Object(r.useEffect)((function(){return window.addEventListener("keyup",(function(e){"Escape"!==e.key&&"27"!==e.keyCode||null!==document.querySelector(".bwf-escape-note")&&(Q("enableCopy",!1),Q("enableMove",!1),Q("isProcessingCopyPaste",!1),Q("copyData",{}),Q("moveID",0),Object(b.Kb)(O,100))})),Q("enableCopy",!1),Q("enableMove",!1),Q("copyData",{}),function(){document.body.style.overflow="",i(""),Q("statLoading",!0),Q("statData",[]),Q("isLoading",!0)}}),[]),Object(r.useEffect)((function(){Object(o.isNull)(document.querySelector("#bwf-single-automation-wrap"))||(ke.current=document.querySelector("#bwf-single-automation-wrap").getBoundingClientRect()),ae||X()}),[ae]);var Ne={start:Y,action:de,conditional:ie,end:he,benchmark:ge,wait:Te,yesNoNode:Ie,exit:Ze,jump:Ve,split:Xe,splitpath:et},Se={"bwf-default":pr},Pe=ee.map((function(e){return e.id&&(e.id.includes("yesedge")||e.id.includes("noedge")||e.hasOwnProperty("sourceHandle")&&"split-edge"===e.sourceHandle)?e:ba(ba({},e),{},{type:"bwf-default"})})),xe=sa(Object(r.useState)([]),2),Le=xe[0],Ce=xe[1],Ae=sa(Object(r.useState)(!1),2),De=Ae[0],Me=Ae[1],Fe=sa(Object(r.useState)("bwf-automation-wrap"),2),Ge=Fe[0],ze=Fe[1],Ue=sa(Object(r.useState)(!1),2),qe=Ue[0],Be=Ue[1],Re=sa(Object(r.useState)(!0),2),Ye=Re[0],He=Re[1];if(Object(r.useEffect)((function(){if(!De||we){var e=0,t=0,n=j.getState(),r=n.nodes,a=n.selectedElements;if(Object(o.isEmpty)(a)||fe||we)if(Q("openStartSidebar",!1),we&&!Object(o.isEmpty)(a)){var i=r.filter((function(e){return e.id===je}));(Object(o.isEmpty)(i)||Object(o.isNull)(i)||""===i||Object(o.isUndefined)(i))&&(i=a[0]),i.hasOwnProperty("__rf")?(e=i.__rf.position.x,t=i.__rf.position.y):(e=i.position.x,t=i.position.y),t=parseFloat(t)+parseFloat(ke.current.height)*(qe?.5:.4),Me(!0),w(e,t,1),Q("flowCenter",!1)}else if(r.length&&ke.current){var c=r[0];c.hasOwnProperty("__rf")?(e=c.__rf.position.x+140,t=c.__rf.position.y):(e=c.position.x+140,t=c.position.y),t=parseFloat(t)+parseFloat(ke.current.height)*(qe?.5:.4),Me(!0),w(e,t,1),Q("flowCenter",!1)}}}),[Le,De,we]),Object(r.useEffect)((function(){Me(!1),te.length>1?Ce(Object(fr.a)([].concat(la(te),la(Pe)),!0,ne||re?20:0)):Ce(te)}),[te,ae,qe,me]),Object(r.useEffect)((function(){g([])}),[me]),ae)return Object(r.createElement)(jr.a,null);var $e=function(){var e,n=(e=ia().mark((function e(){return ia().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d()({path:Object(b.A)("/automation/".concat(t,"/delete_meta")),method:"DELETE",data:{meta_key:"tips"}}).then((function(e){200===e.code&&Q("meta",ba(ba({},ye),{},{tips:[]}))}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){ca(o,r,a,i,c,"next",e)}function c(e){ca(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();return Object(r.createElement)(mt.a.Provider,{value:{selectedMergeTag:_,setSelectedMergeTag:k,resetSelection:N,selectedIdentifier:S,setSelectedIdentifier:P}},Object(o.isEmpty)(oe)?Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Cr.a,null),Object(r.createElement)("div",{className:c()(Ge,{"full-screen":qe}),id:"bwf-single-automation-wrap"},Object(r.createElement)("div",{className:"automation-title"}," ",ue," "),Object(r.createElement)(Vr,{automationId:t}),(ne||re)&&Object(r.createElement)("div",{className:"bwf-escape-note"},Object(l.__)("Press ESC to skip paste step","wp-marketing-automations")),Object(o.isEmpty)(me)?Object(r.createElement)(a.f,{defaultZoom:1,minZoom:.5,maxZoom:4,nodeTypes:Ne,nodesConnectable:!1,nodesDraggable:!1,zoomOnScroll:!1,zoomOnDoubleClick:!1,paneMoveable:!0,panOnScroll:!0,elements:Le,edgeTypes:Se,onSelectionChange:function(e){if(!Object(o.isNull)(e)&&e.length>0){var t=e[0];if(Object(a.k)(t))return void ze("bwf-automation-wrap bwf-node-selected");if(Object(a.j)(t))return void ze("bwf-automation-wrap bwf-edge-selected");ze("bwf-automation-wrap")}}},Object(r.createElement)(Lr,{isProActive:Object(b.Zb)()}),Object(r.createElement)(a.c,{showInteractive:!1},Object(r.createElement)(a.b,{onClick:function(){Be(!qe),document.body.style.overflow=qe?"":"hidden",g([])}},qe?Object(r.createElement)("span",{className:"dashicons dashicons-fullscreen-exit-alt custom-control-icon"}):Object(r.createElement)("span",{className:"dashicons dashicons-fullscreen-alt custom-control-icon"}))),Object(r.createElement)(a.a,null)):Object(r.createElement)($r.a,{inAutomation:!0,setFullScreen:Be,fullScreen:qe}),!Object(o.isEmpty)(Oe)&&Object(r.createElement)("div",{className:"bwfan-automation-tips"},Object(r.createElement)("span",{className:"bwf-close-tip",onClick:$e},Object(r.createElement)(s.a,{icon:"close",size:12})),Oe.map((function(e,t){return Object(r.createElement)("div",{className:"bwfan-automation-tip",key:t},Object(r.createElement)("div",null,Object(r.createElement)(s.a,{icon:"tip"}),Object(r.createElement)("strong",null,"Tip")),Object(r.createElement)("div",null,e))})))),Object(r.createElement)(cr,null),""!==le&&0!==le&&Object(r.createElement)(wr,null)):Object(r.createElement)(r.Fragment,null,Object(r.createElement)(r.Fragment,null,Ye&&Object(r.createElement)(u.Modal,{title:Object(l.__)("Failed","wp-marketing-automations"),onRequestClose:function(){return He(!1)},className:"bwf-admin-modal bwf-admin-modal-small bwf-single-automation-error-modal",shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1},Object(r.createElement)("div",{className:"bwf-error-content"},Object(r.createElement)(r.Fragment,null,Object(r.createElement)("p",null,Object(l.__)("There has been a critical error on this website.","wp-marketing-automations")),Object(r.createElement)("p",null,Object(l.__)("For quick help, contact FunnelKit","wp-marketing-automations")," ",Object(r.createElement)("a",{href:"https://funnelkit.com/support/?utm_source=WordPress&utm_medium=Automation+Error&utm_campaign=FKA+Lite+Plugin",target:"_blank",rel:"noopener noreferrer"},Object(l.__)("support ","wp-marketing-automations"))))),Object(r.createElement)("div",{className:"bwf-footer"},Object(r.createElement)(u.Button,{isPrimary:!0,onClick:function(){return He(!1)}},Object(l.__)("Close","wp-marketing-automations")))))),!Object(b.Zb)()&&Object(r.createElement)(v.b,{isOpen:be,onRequestClose:function(){return Q("showProModal",!1)},modalContent:ba({isFeature:!0,proLink:Object(b.eb)("upgrade")},pe)}),Object(r.createElement)(h.a,{modalTitle:W.modalTitle,deleteEntityName:W.deleteEntityName,confirmText:W.confirmText,confirmButtonText:W.buttonConfirm,cancelButtonText:W.buttonCancel,onConfirm:W.onConfirm,isLoading:W.loading,successMessage:W.success,errorMessage:W.error,content:W.content,onRequestClose:function(){Q("modalData",{loading:!1,status:!1})},confirmDescription:W.hasOwnProperty("confirmDescription")?W.confirmDescription:"",isOpen:W.status,isDelete:W.isDelete}),Ee&&Object(r.createElement)(aa,null))};t.default=function(e){var t=e.match.params.id;Object(b.m)("Automation #"+t);var n=Object(f.a)(),o=n.fetchAutomation,i=n.setAutomationData,c=n.clearAutomationError;return Object(r.useEffect)((function(){i("statLoading",!0),i("statData",[]),i("isLoading",!0),c(),o(t)}),[t]),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-single-automation-body-header",style:{paddingBottom:"8px"}},Object(r.createElement)("div",{className:"bwf-content-header-left"},Object(r.createElement)("div",{className:"bwf-content-header-title2"},Object(l.__)("Workflow","wp-marketing-automations")))),Object(r.createElement)(a.e,null,Object(r.createElement)(da,{id:t})))}}}]);