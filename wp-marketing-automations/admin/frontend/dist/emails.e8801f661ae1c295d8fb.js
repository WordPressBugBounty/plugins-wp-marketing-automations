(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1119:function(e,t,n){"use strict";var r=n(0),a=n(1),o=n(9),c=n.n(o),i=n(3),s=n(348);function u(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var s=r&&r.prototype instanceof i?r:i,u=Object.create(s.prototype);return l(u,"_invoke",function(n,r,a){var o,i,s,u=0,l=a||[],f=!1,b={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,i=0,s=e,b.n=n,c}};function m(n,r){for(i=n,s=r,t=0;!f&&u&&!a&&t<l.length;t++){var a,o=l[t],m=b.p,p=o[2];n>3?(a=p===r)&&(s=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=m&&((a=n<2&&m<o[1])?(i=0,b.v=r,b.n=o[1]):m<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,b.n=p,i=0))}if(a||n>1)return c;throw f=!0,r}return function(a,l,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,p),i=l,s=p;(t=i<2?e:s)||!f;){o||(i?i<3?(i>1&&(b.n=-1),m(i,s)):b.n=s:b.v=s);try{if(u=2,o){if(i||(a="next"),t=o[a]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((t=(f=b.n<0)?s:n.call(r,b))!==c)break}catch(t){o=e,i=1,s=t}finally{u=1}}return{value:t,done:f}}}(n,a,o),!0),u}var c={};function i(){}function s(){}function f(){}t=Object.getPrototypeOf;var b=[][r]?t(t([][r]())):(l(t={},r,(function(){return this})),t),m=f.prototype=i.prototype=Object.create(b);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return s.prototype=f,l(m,"constructor",f),l(f,"constructor",s),s.displayName="GeneratorFunction",l(f,a,"GeneratorFunction"),l(m),l(m,a,"Generator"),l(m,r,(function(){return this})),l(m,"toString",(function(){return"[object Generator]"})),(u=function(){return{w:o,m:p}})()}function l(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(l=function(e,t,n,r){function o(t,n){l(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function f(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,c,i=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);s=!0);}catch(e){u=!0,a=e}finally{try{if(!s&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(u)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.conversation,n=void 0===t?{}:t,o=n.ID,l=n.mode,m=n.type,p=e.onRequestClose,d=e.isOpen,y=e.contact,g=void 0===y?{}:y,v=b(Object(r.useState)({}),2),w=v[0],j=v[1],O=b(Object(r.useState)(!1),2),h=O[0],_=O[1],k=b(Object(r.useState)(""),2),E=k[0],S=k[1],C=function(){var e,t=(e=u().m((function e(){var t,n;return u().w((function(e){for(;;)switch(e.p=e.n){case 0:if(o&&!(!parseInt(o)>0)){e.n=1;break}return e.a(2);case 1:return _(!0),e.p=2,e.n=3,c()({method:"GET",path:Object(i.C)("/v3/contacts/".concat(g.id,"/engagement/").concat(parseInt(o),"?mode=1"))});case 3:"result"in(t=e.v)&&j(t.result),e.n=5;break;case 4:e.p=4,n=e.v,console.log(n),n&&"message"in n?S(n.message):Object(a.__)("There are some technical difficulties while getting emails. Please contact support.","wp-marketing-automations");case 5:_(!1);case 6:return e.a(2)}}),e,null,[[2,4]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){f(o,r,a,c,i,"next",e)}function i(e){f(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}();Object(r.useEffect)((function(){d&&C()}),[d]);return Object(r.createElement)(s.a,{isOpen:d,isLoading:h,onRequestClose:function(){p(),j({}),S("")},error:E,subject:![2,3].includes(parseInt(l))&&w?w.subject:"",body:w&&w.body?w.body:"",sourceType:m,mode:l,contact:e.contact,conversation:e.conversation,template:w})}},1280:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(147),o=n(1),c=n(5),i=n(11),s=n(3),u=n(78),l=n(2),f=n(1119),b=n(179),m=n(365);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,c,i=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);s=!0);}catch(e){u=!0,a=e}finally{try{if(!s&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(u)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.default=function(e){var t=e.contactId,n=p(Object(r.useState)({}),2),d=n[0],y=n[1],g=p(Object(r.useState)(!1),2),v=g[0],w=g[1],j=p(Object(r.useState)({status:!1,contactInfo:{}}),2),O=j[0],h=j[1],_=u.a.getContact(),k=u.a.getConversationLimit,E=u.a.getConversations,S=u.a.getConversationOffset,C=u.a.getConversationTotal,N=u.a.getConversationPage,A=u.a.getConversationLoading,I=u.a.getConversationContactId,P=u.a.getContactLoading,T=Object(b.a)().fetchConversations,L=E(),G=A(),x=P(),M=S(),F=C(),q=k(),D=N(),R=I();Object(r.useEffect)((function(){(Object(l.isEmpty)(L)||t!=R)&&T(t,M,q)}),[]);var B=[{key:"subject",label:Object(o.__)("Subject","wp-marketing-automations"),isLeftAligned:!1,cellClassName:"bwf-word-break"},{key:"sent_time",label:Object(o.__)("Sent On","wp-marketing-automations"),isLeftAligned:!0},{key:"type",label:Object(o.__)("Source","wp-marketing-automations"),isLeftAligned:!0},{key:"opens",label:Object(o.__)("Opens","wp-marketing-automations"),isLeftAligned:!0},{key:"clicks",label:Object(o.__)("Clicks","wp-marketing-automations"),isLeftAligned:!0},{key:"view",label:Object(o.__)("Action","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-w-60"}],J=function(e){var t=null!=e&&e.c_status?function(e){switch(parseInt(e)){case 1:return Object(r.createElement)("span",{className:"bwf-tags bwf-tag-gray"},Object(o.__)("Draft","wp-marketing-automations"));case 3:return Object(r.createElement)("span",{className:"bwf-tags bwf-tag-red"},Object(o.__)("Failed","wp-marketing-automations"));case 4:return Object(r.createElement)("span",{className:"bwf-tags bwf-tag-orange"},Object(o.__)("Bounced","wp-marketing-automations"));default:return Object(r.createElement)(r.Fragment,null)}}(null==e?void 0:e.c_status):"-";return Object(r.createElement)("a",{className:"bwf-a-no-underline bwf_bold",onClick:function(){y(e),w(!0)}},Object(r.createElement)("span",{className:"bwf-mr-10"},e.subject?e.subject:"-"),t)},U=L&&L.length>0?L.map((function(e){return"ID"in e&&parseInt(e.ID)>0&&[{display:J(e),value:e.subject},{display:Object(s.lb)(e.created_at,!1),value:e.created_at},{display:e.source&&e.source.hasOwnProperty("type")&&""!==e.type?e.source.type:"-",value:""},{display:e.open?e.open:0,value:e.open},{display:e.click?e.click:0,value:e.click},{display:Object(r.createElement)(i.a,{className:"is-secondary bwf-btn-small is-blue-btn",onClick:function(){y(e),w(!0)}},Object(o.__)("View","wp-marketing-automations")),value:null}]})):[];return Object(r.createElement)("div",{className:"bwf-cs-contact-tab-data"},Object(r.createElement)("div",{className:"bwf-content-header-new"},Object(r.createElement)("div",{className:"bwf-content-header-left"},G||x?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-150 bwf-h-15"}):Object(r.createElement)("div",{className:"bwf-normal-text"},parseInt(F)>0&&Object(o.sprintf)(Object(o.__)("All Emails (%s)","wp-marketing-automations"),F))),Object(r.createElement)("div",{className:"bwf-content-header-right"},G||x?Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-60 bwf-h-30"}):Object(r.createElement)(c.Button,{className:"bwf-btn-small is-blue",isPrimary:!0,onClick:function(){h({status:!0,contactInfo:_})}},Object(o.__)("Send Email","wp-marketing-automations")))),Object(r.createElement)("div",{className:"bwf-c-s-data"},Object(r.createElement)("div",{className:"bwf-c-s-section"},Object(r.createElement)(a.a,{className:"contact-single-table contact-emails",headers:B,hideHeader:"yes",rows:U,query:{paged:D},totalRows:F,rowsPerPage:q,isLoading:G||x,showMenu:!1,onPageChange:function(e,n){return T(t,(e-1)*q,q)},onQueryChange:function(e){return"per_page"===e?function(e){return e!==q&&T(t,M,e)}:function(){return{}}},emptyMessage:Object(o.__)("No emails found","wp-marketing-automations")}))),Object(r.createElement)(f.a,{onRequestClose:function(){return w(!1)},conversation:d,contact:_,isOpen:v}),O.status&&Object(r.createElement)(m.a,{contact:O.contactInfo,setSendMessageModel:h,onSuccess:function(){return T(t,M,q)},messageType:"email"}))}}}]);