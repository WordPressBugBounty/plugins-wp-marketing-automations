(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{1126:function(e,t,n){"use strict";var r=n(0),a=n(28),o=n(1),c=n(204);t.a=function(e){var t=e.selected,n=e.onTagsChange;return Object(r.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(r.createElement)("div",{className:"bwf-input-label"},Object(o.__)("Add Tags","wp-marketing-automations")),Object(r.createElement)(a.a,{autocompleter:c.b,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){n(e)},onRemoveTag:function(e,r){var a=t.filter((function(t){return!(t.key==e&&t.label==r)}));n(a)},placeholder:Object(o.__)("Search by tag name","wp-marketing-automations"),showClearButton:!0,disabled:!1}))}},1329:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(210),o=n(5),c=n(1),i=n(11),l=n(1104),u=n(1108),s=n(68),m=n(19),b=n(9),f=n.n(b),d=n(3),p=["template"];function O(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function g(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof i?r:i,u=Object.create(l.prototype);return j(u,"_invoke",function(n,r,a){var o,i,l,u=0,s=a||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,r){for(i=n,l=r,t=0;!m&&u&&!a&&t<s.length;t++){var a,o=s[t],f=b.p,d=o[2];n>3?(a=d===r)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(i=0,b.v=r,b.n=o[1]):f<d&&(a=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,b.n=d,i=0))}if(a||n>1)return c;throw m=!0,r}return function(a,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&f(s,d),i=s,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(u=2,o){if(i||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(r,b))!==c)break}catch(t){o=e,i=1,l=t}finally{u=1}}return{value:t,done:m}}}(n,a,o),!0),u}var c={};function i(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(j(t={},r,(function(){return this})),t),m=u.prototype=i.prototype=Object.create(s);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,j(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=u,j(m,"constructor",u),j(u,"constructor",l),l.displayName="GeneratorFunction",j(u,a,"GeneratorFunction"),j(m),j(m,a,"Generator"),j(m,r,(function(){return this})),j(m,"toString",(function(){return"[object Generator]"})),(g=function(){return{w:o,m:b}})()}function j(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(j=function(e,t,n,r){function o(t,n){j(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function y(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function _(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){y(o,r,a,c,i,"next",e)}function i(e){y(o,r,a,c,i,"throw",e)}c(void 0)}))}}var v=function(e){return{sendTestEmail:(a=_(g().m((function e(t,n,r,a,o,c){var i,l,u,s,m,b=arguments;return g().w((function(e){for(;;)switch(e.p=e.n){case 0:return i=b.length>6&&void 0!==b[6]&&b[6],l=b.length>7&&void 0!==b[7]?b[7]:{},u=b.length>8&&void 0!==b[8]&&b[8],s=b.length>9&&void 0!==b[9]?b[9]:{},e.p=1,m={email:t,content:JSON.stringify({subject:n,body:r,type:a,mail_data:o,preheader:c,utmEnabled:i,utmDetails:l,overRideSenderInfo:u,overRideInfo:s})},e.n=2,f()({method:"POST",path:Object(d.C)("/send-test-email"),data:m});case 2:return e.a(2,2);case 3:return e.p=3,e.v,e.a(2,3)}}),e,null,[[1,3]])}))),function(e,t,n,r,o,c){return a.apply(this,arguments)}),saveEditorContent:(r=_(g().m((function t(n){var r,a,o,c,i;return g().w((function(t){for(;;)switch(t.p=t.n){case 0:return"block"===n[0].type&&n[0].hasOwnProperty("block")&&(r=n[0].block,a=r.template,o=void 0===a?"":a,c=O(r,p),""!==o&&(n[0].body=n[0].block.template),n[0].block=c),t.p=1,i={content:JSON.stringify(n)},t.n=2,f()({method:"POST",path:Object(d.C)("/form-feeds/".concat(e,"/save-email-content")),data:i});case 2:return t.a(2,2);case 3:return t.p=3,t.v,t.a(2,3)}}),t,null,[[1,3]])}))),function(e){return r.apply(this,arguments)}),uploadImage:(n=_(g().m((function e(t){var n,r;return g().w((function(e){for(;;)switch(e.p=e.n){case 0:return(n=new FormData).append("image",t),e.p=1,e.n=2,f()({method:"POST",path:Object(d.C)("/upload-image"),body:n});case 2:return r=e.v,e.a(2,r&&r.result?r.result:"");case 3:return e.p=3,e.v,e.a(2,"")}}),e,null,[[1,3]])}))),function(e){return n.apply(this,arguments)}),fetchCurrentMailEditorContent:(t=_(g().m((function t(){var n;return g().w((function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,f()({method:"GET",path:Object(d.C)("/form-feeds/".concat(e,"/get-email-content"))});case 1:return n=t.v,t.a(2,n&&n.result?n.result:"");case 2:return t.p=2,t.v,t.a(2,"")}}),t,null,[[0,2]])}))),function(){return t.apply(this,arguments)})};var t,n,r,a},w=n(1126),h=n(2),E=n(40),k=n(7);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,c,i=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(u)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return T(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=S(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==S(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings&&bwfcrm_contacts_data.editor_settings.default&&bwfcrm_contacts_data.editor_settings.default.form?bwfcrm_contacts_data.editor_settings.default.form:{};return e&&0!==Object.keys(n).length?Array.isArray(e.content)&&e.content[0]?(e.content[0].body||(e.content[0].body=n.body?n.body:""),e.content[0].last_updated=t,e.content[0].editor||(e.content[0].editor=n.editor?n.editor:{}),e):P(P({},e),{},{content:[{body:n.body?n.body:"",editor:n.editor?P({},n.editor):{}}]}):e};t.default=function(e){var t,n=e.feedId,b=Object(l.a)(),f=Object(u.a)(),p=b.getUpdateStepThreeStatus(),O=b.getFeed(),g=O&&O.status?parseInt(O.status):1,j=O&&O.last_updated?O.last_updated:"",y=O&&O.data?O.data:{},_=!(!y||!("incentivize_email"in y))&&y.incentivize_email,S=!(!y||!("marketing_status"in y))&&y.marketing_status,T=!(!y||!("not_send_to_subscribed"in y))&&y.not_send_to_subscribed,N=!(!y||!("add_tag_enable"in y))&&y.add_tag_enable,A=y&&"tag_to_add"in y?y.tag_to_add:[],I=y&&"redirect_url"in y?y.redirect_url:"",x=y&&"redirect_mode"in y?y.redirect_mode:"url",D=C(Object(r.useState)(!1),2),R=D[0],B=D[1],M=C(Object(r.useState)(!1),2),z=M[0],G=M[1],U=C(Object(r.useState)(!1),2),J=U[0],L=U[1],q=C(Object(r.useState)(!1),2),$=q[0],H=q[1],K=Object(r.useCallback)((function(e){Object(d.fc)()?!1===_?f.updateStepThree(n,{incentivize_email:_,marketing_status:S},e):(G(e),B(!0)):H(!0)}),[_,S]),Q=Object(r.useCallback)((function(e){f.updateStepThree(n,{incentivize_email:_,marketing_status:S,incentive_email:e,redirect_mode:x,redirect_url:I,add_tag_enable:N,tag_to_add:A,not_send_to_subscribed:T},z),B(!1)}),[_,S,z,x,I]),V={objectId:"crm.form.".concat(n),mergeTagsContext:"forms"};return Object(r.createElement)("div",{className:"bwf-crm-stepper-wrap bwf-card-wrap bwf-crm-forms-step-3"},Object(r.createElement)(s.a,null),Object(r.createElement)("div",{className:"bwf-card-header"},Object(r.createElement)("span",{className:"bwf-form-title"},Object(c.__)("Lead Notification","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-crm-importer-wrap"},Object(r.createElement)("div",{className:"bwf-crm-import-section"},Object(r.createElement)(o.ToggleControl,{label:Object(c.__)("Enable email notification","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",help:Object(c.__)("Note: Use {{contact_confirmation_link}} for double optin","wp-marketing-automations"),onChange:function(e){return f.setIncentivizeEmail(e)},checked:!!_})),!!_&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0 bwf-pb-0"},Object(r.createElement)(a.a,{disableDefaultButtons:!0,onEmailContentReady:Q,onEmailContentError:function(){return B(!1)},showTab:!1,initData:F(y&&"incentive_email"in y?P(P({},y.incentive_email),V):V,j),validateEmailContent:!!R,apiMethods:v?v(n):{},openTemplateModal:J,setTemplateModal:L,transactionalEnabled:!0})),Object(r.createElement)("div",{className:"bwf-p-gap"},Object(r.createElement)(o.Card,{className:"bwf-p-gap bwf-border"},Object(r.createElement)(o.ToggleControl,{label:Object(c.__)("Don't send email if contact is already subscribed","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",onChange:function(e){return f.setNotSendToSubscribed(e)},checked:!!T}),Object(r.createElement)(m.a,{gap:5,justify:"start",align:"start"},Object(r.createElement)(o.FlexItem,null,Object(r.createElement)("p",{className:"bwf-heading7-new bwf-mb-8"},Object(c.__)("Redirect After Confirmation","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-display-flex bwf-flex-start gap-16"},Object(r.createElement)(o.Button,{isSecondary:!x||"url"===x,isTertiary:x&&"url"!==x,onClick:function(){return f.setRedirectMode("url")},className:"bwf-btn-small "+(x&&"url"!==x?"":"is-border is-blue-bg")},Object(c.__)("URL","wp-marketing-automations")),Object(r.createElement)(o.Button,{isSecondary:x&&"file"===x,isTertiary:x&&"file"!==x,onClick:function(){return f.setRedirectMode("file")},className:"bwf-btn-small "+(x&&"file"===x?"is-border is-blue-bg":"")},Object(c.__)("File","wp-marketing-automations"))))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)(o.TextControl,{label:"",value:I,onChange:function(e){return f.setRedirectUrl(e)},placeholder:Object(c.__)("Enter URL","wp-marketing-automations")}),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(o.ToggleControl,{label:Object(c.__)("Add Tags after confirmation","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",onChange:function(e){return f.setAddTagEnabled(e)},checked:!!N}),N&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)(w.a,{onTagsChange:function(e){f.setTagList(e.map((function(e){return{id:e.key,value:e.label}})))},selected:(t=[],Object(h.isEmpty)(A)||A.map((function(e){t.push({key:e.id,label:e.value})})),t)})),Object(r.createElement)("p",{className:"bwf-mb-0"},Object(c.__)("Note: The settings will work when confirmation link is clicked","wp-marketing-automations"))))),Object(r.createElement)("div",{className:"bwf-crm-import-section sa",style:{paddingTop:"0"}},Object(r.createElement)(o.ToggleControl,{label:Object(c.__)("Auto-confirm Contacts","wp-marketing-automations"),help:Object(c.__)("This will automatically mark new Contacts as Subscribed","wp-marketing-automations"),onChange:function(e){return f.setMarketingStatus(e)},className:"bwf-tooglecontrol-advance",checked:!!S})),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)(m.a,null,Object(r.createElement)(m.b,null,Object(r.createElement)(i.a,{className:"bwf-display-flex",isSecondary:!0,onClick:function(){return f.setStep("mapping")}},Object(c.__)("Back","wp-marketing-automations"))),Object(r.createElement)(m.b,{className:"bwf_text_right"},3===parseInt(g)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(i.a,{onClick:function(){return K(g)},isSecondary:!0},Object(c.__)("Save","wp-marketing-automations")),Object(r.createElement)(i.a,{onClick:function(){return K(2)},className:"bwf-ml-10",isPrimary:!0,isBusy:1===p},Object(c.__)("Save & Activate","wp-marketing-automations"))),2===parseInt(g)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(i.a,{onClick:function(){return K(3)},isSecondary:!0},Object(c.__)("Deactivate","wp-marketing-automations")),Object(r.createElement)(i.a,{onClick:function(){return K(g)},className:"bwf-ml-10",isPrimary:!0,isBusy:1===p},Object(c.__)("Save","wp-marketing-automations"))),1===parseInt(g)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(i.a,{onClick:function(){return K(g)},isSecondary:!0},!Object(d.fc)()&&Object(r.createElement)(k.a,{icon:"king",size:16}),Object(c.__)("Save As Draft","wp-marketing-automations")),Object(r.createElement)(i.a,{onClick:function(){return K(2)},className:"bwf-ml-10",isPrimary:!0,isBusy:1===p},!Object(d.fc)()&&Object(r.createElement)(k.a,{icon:"king",size:16,color:"#fff"}),Object(c.__)("Activate","wp-marketing-automations"))))))),!Object(d.fc)()&&Object(r.createElement)(E.b,{isOpen:$,onRequestClose:function(){return H(!1)},modalContent:{isFeature:!0,featureTitle:Object(c.__)("Form","wp-marketing-automations")}}))}}}]);