(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{1287:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(3),o=n(1121),c=n(9),i=n.n(c),l=n(1),s=n(60),u=n(61),b=n(19),f=n(147),m=n(1131),p=n(150),d=n(48),O=n(2),j=n(11),y=n(1147),w=n(346),g=n(33),v=n(6),h=n.n(v),_=n(68),k=n(12),E=n(7),S=n(345),P=n(149),C=n(1149),A=n(44),x=n(203),N=n(26),T=n(1129),D=n(54),I=n(40);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=L(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==L(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(){return(G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}function q(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof i?r:i,s=Object.create(l.prototype);return M(s,"_invoke",function(n,r,a){var o,i,l,s=0,u=a||[],b=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,i=0,l=e,f.n=n,c}};function m(n,r){for(i=n,l=r,t=0;!b&&s&&!a&&t<u.length;t++){var a,o=u[t],m=f.p,p=o[2];n>3?(a=p===r)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=m&&((a=n<2&&m<o[1])?(i=0,f.v=r,f.n=o[1]):m<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,f.n=p,i=0))}if(a||n>1)return c;throw b=!0,r}return function(a,u,p){if(s>1)throw TypeError("Generator is already running");for(b&&1===u&&m(u,p),i=u,l=p;(t=i<2?e:l)||!b;){o||(i?i<3?(i>1&&(f.n=-1),m(i,l)):f.n=l:f.v=l);try{if(s=2,o){if(i||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((t=(b=f.n<0)?l:n.call(r,f))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:b}}}(n,a,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(M(t={},r,(function(){return this})),t),b=s.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,M(e,a,"GeneratorFunction")),e.prototype=Object.create(b),e}return l.prototype=s,M(b,"constructor",s),M(s,"constructor",l),l.displayName="GeneratorFunction",M(s,a,"GeneratorFunction"),M(b),M(b,a,"Generator"),M(b,r,(function(){return this})),M(b,"toString",(function(){return"[object Generator]"})),(q=function(){return{w:o,m:f}})()}function M(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(M=function(e,t,n,r){function o(t,n){M(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function B(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function z(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){B(o,r,a,c,i,"next",e)}function i(e){B(o,r,a,c,i,"throw",e)}c(void 0)}))}}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw a}}return i}}(e,t)||Q(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e,t){if(e){if("string"==typeof e)return H(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.default=function(){var e=Object(k.i)(),t=Object(r.useContext)(a.h),n=J(Object(r.useState)(25),2),c=n[0],v=n[1],L=J(Object(r.useState)(0),2),R=L[0],U=L[1],M=J(Object(r.useState)(0),2),B=M[0],H=M[1],V=J(Object(r.useState)([]),2),Y=V[0],$=V[1],K=J(Object(r.useState)([]),2),W=K[0],X=K[1],Z=J(Object(r.useState)(!1),2),ee=Z[0],te=Z[1],ne=J(Object(r.useState)(),2),re=ne[0],ae=ne[1],oe=J(Object(r.useState)(!1),2),ce=oe[0],ie=oe[1],le=J(Object(r.useState)({status:!1}),2),se=le[0],ue=le[1],be=J(Object(r.useState)({status:!1,loading:!1}),2),fe=be[0],me=be[1],pe=J(Object(r.useState)(""),2),de=pe[0],Oe=pe[1],je=Object(r.useRef)(new AbortController),ye=e.s,we=void 0===ye?"":ye,ge=Object(a.Ib)();Object(m.a)("recovered",W);var ve=function(){var e=z(q().m((function e(){var t,n,r,o,s,u,b,f;return q().w((function(e){for(;;)switch(e.p=e.n){case 0:return te(!0),e.p=1,e.n=2,i()({method:"GET",path:Object(a.C)("/carts/recovered?offset=".concat(R,"&limit=").concat(c,"&search=").concat(we)),signal:je.current.signal});case 2:if((t=e.v)&&t.result&&Array.isArray(t.result)){e.n=3;break}return ae(Object(l.__)("Blank response returned","wp-marketing-automations")),e.a(2);case 3:n=t.total_count,r=void 0===n?0:n,o=t.result,s=void 0===o?[]:o,u=t.limit,b=t.offset,H(parseInt(r)),$(s),u&&v(parseInt(u)),b&&U(parseInt(b)),t.hasOwnProperty("count_data")&&X(t.count_data),te(!1),e.n=5;break;case 4:e.p=4,"AbortError"===(f=e.v).name?console.log(f.message):(ae(f&&f.message?f.message:Object(l.__)("Unknown Error Occurred","wp-marketing-automations")),te(!1));case 5:return e.a(2)}}),e,null,[[1,4]])})));return function(){return e.apply(this,arguments)}}(),he=J(Object(r.useState)([]),2),_e=he[0],ke=he[1],Ee=J(Object(r.useState)(!1),2),Se=Ee[0],Pe=Ee[1],Ce=J(Object(r.useState)(""),2),Ae=Ce[0],xe=Ce[1],Ne=function(){Ue&&Ue(),ke([])};Object(r.useLayoutEffect)((function(){$([]),te(!0)}),[]);var Te=Object(r.useCallback)((function(e,t){ke(t),xe(e),Pe(!0)}),[]);Object(r.useEffect)((function(){Object(a.m)(Object(l.__)("Recovered Carts","wp-marketing-automations")),Object(a.Ub)()&&ve()}),[R,c,we]),Object(r.useEffect)((function(){return Ne(),function(){je.current.abort()}}),[]);var De=Object(r.useMemo)((function(){var e={};if(Array.isArray(Y)){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Q(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw o}}}}(Y);try{for(n.s();!(t=n.n()).done;){var r=t.value;e[r.order_id]=r}}catch(e){n.e(e)}finally{n.f()}}return e}),[Y]),Ie=Object(P.b)(De),Le=Ie.singleSelectProps,Re=Ie.selectAllProps,Fe=Ie.floatingBarProps,Ue=Ie.resetSelection,Ge=Ie.selected,qe=void 0===Ge?{}:Ge,Me=Object.keys(qe).filter((function(e){return qe[e]})).length,Be=[{key:"select",label:Object(r.createElement)(A.a,G({type:"checkbox",checked:!1,onChange:function(){}},Re)),isLeftAligned:!0,required:!0,cellClassName:"bwf-col-action bwf-w-30 bwf-table-col-sticky bwf-sticky-left"},{key:"action",label:"",isLeftAligned:!0,required:!0,cellClassName:"bwf-col-action bwf-w-30 bwf-table-col-sticky bwf-sticky-left"},{key:"name",label:Object(l.__)("Contact","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-w-210 bwf-table-col-sticky bwf-sticky-left"},{key:"contact",label:Object(l.__)("Details","wp-marketing-automations"),isLeftAligned:!0},{key:"recovered_date",label:Object(l.__)("Recovered On","wp-marketing-automations"),isLeftAligned:!0},{key:"items",label:Object(l.__)("Items","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-max-w-360"},{key:"order",label:Object(l.__)("Order","wp-marketing-automations"),isLeftAligned:!0},{key:"total",label:Object(l.__)("Total","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-w-100"},{key:"show",label:Object(l.__)("Action","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-w-100 bwf-table-col-sticky bwf-sticky-right"}],ze=function(e){e!==c&&(U(0),v(e))},Je=function(t){var n=t.id,a=void 0===n?"":n,o=t.order_id,c=void 0===o?"":o;return a||c?Object(r.createElement)(s.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),menuPosition:"bottom right",renderContent:function(n){var o=n.onToggle;return Object(r.createElement)(r.Fragment,null,a&&Object(r.createElement)(u.a,{isClickable:!0,onInvoke:function(){Object(k.l)({path:"/carts/recovered/".concat(t.id,"/tasks")},"/",e),o()}},Object(r.createElement)(b.a,{justify:"flex-start"},Object(r.createElement)(b.c,null,Object(l.__)("View Automations","wp-marketing-automations")))),c&&Object(r.createElement)(u.a,{isClickable:!0,onInvoke:function(){Oe(t.order_id),me({status:!0}),o()}},Object(r.createElement)(b.a,{justify:"flex-start"},Object(r.createElement)(b.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}):null},Qe=function(e){return e.total?Object(r.createElement)("span",{className:"bwf-tags bwf-tag-green"},e.currency?Object(d.a)(e.currency).formatAmount(e.total):e.total):"-"},He=function(e){return e.order_id?Object(r.createElement)("a",{target:"_blank",className:"bwf-a-no-underline",href:"post.php?post=".concat(e.order_id,"&action=edit"),rel:"noreferrer"},"#",e.order_id," ",e.buyer_name):"-"},Ve=function(e){return Object(r.createElement)("div",{className:"bwf-c-contact-details-cell"},e.hasOwnProperty("email")&&e.email&&Object(r.createElement)(b.a,{justify:"justify",align:"top"},Object(r.createElement)(b.c,null,e.email)),e.phone&&Object(r.createElement)(b.a,{justify:"justify",align:"top"},Object(r.createElement)(b.c,null,e.phone)),!e.phone&&!e.email&&Object(r.createElement)("span",null,"-"))},Ye=function(t){var n=Object(r.createElement)(w.a,{contact:{f_name:t.f_name?t.f_name:"",l_name:t.l_name?t.l_name:"",email:t.email}});return t.contact_id?Object(r.createElement)(g.a,{href:"admin.php?page=autonami&path=/contact/"+t.contact_id+"&return_to=".concat(e.path),type:"bwf-crm",className:"bwf-a-no-underline"},n):n},$e=Array.isArray(Y)?Y.map((function(e){return[{display:Le.hasOwnProperty(e.order_id)?Object(r.createElement)(A.a,G({type:"checkbox",checked:!1,onChange:function(){}},Le[e.order_id])):Object(r.createElement)(r.Fragment,null),value:null},{display:Je(e),value:""},{display:Ye(e),value:""},{display:Ve(e),value:""},{display:(c=e,c.hasOwnProperty("date")?Object(a.lb)(c.date,!1,!1):"-"),value:""},{display:(t=e.items,n=[],o=[],Object.entries(t).map((function(e){var t=J(e,2),a=t[0],c=t[1];n.length<5&&n.push(Object(r.createElement)("a",{target:"_blank",className:"bwf-a-no-underline",href:"post.php?action=edit&post="+a,rel:"noreferrer"},c)),o.push(Object(r.createElement)("a",{target:"_blank",className:"bwf-a-no-underline",href:"post.php?action=edit&post="+a,rel:"noreferrer"},c))})),Object(r.createElement)("div",{className:"bwf-table-v-center"},!Object(O.isEmpty)(n)&&n.map((function(e,t){return Object(r.createElement)("span",{key:t},e,t!==n.length-1&&", ")})),!Object(O.isEmpty)(o)&&o.length>5&&Object(r.createElement)(p.a,{items:o,count:5}))),value:""},{display:He(e),value:e.order_id},{display:Qe(e),value:e.total},{display:Object(r.createElement)(y.a,{cart:e}),value:""}];var t,n,o,c})):[],Ke=function(){Oe(""),me({status:!1,loading:!1})},We=function(){var e=z(q().m((function e(){var n;return q().w((function(e){for(;;)switch(e.p=e.n){case 0:return me(F(F({},fe),{},{loading:!0})),e.p=1,e.n=2,i()({path:Object(a.C)("/carts"),method:"DELETE",data:{type:"order",abandoned_ids:[de]}}).then((function(e){e.hasOwnProperty("code")&&200===e.code&&ve(),t(e.message)}));case 2:e.v,Ke(),e.n=4;break;case 3:e.p=3,n=e.v,console.log(re),me(F(F({},fe),{},{error:n&&n.message?n.message:Object(l.__)("Unable to delete cart","wp-marketing-automations")}));case 4:Object(a.Pb)(t,3e3);case 5:return e.a(2)}}),e,null,[[1,3]])})));return function(){return e.apply(this,arguments)}}(),Xe=function(){var e=z(q().m((function e(){var n;return q().w((function(e){for(;;)switch(e.p=e.n){case 0:return t(Object(l.__)("Exportingâ€¦","wp-marketing-automations")),e.p=1,e.n=2,i()({path:Object(a.C)("/export/action"),data:{type:"recovered_carts",action:"start",extra_data:{search:we}},method:"POST"}).then((function(e){if(200!==e.code)throw Error(Object(a.w)(null==e?void 0:e.message));e.hasOwnProperty("result")&&e.result.hasOwnProperty("data")&&!Object(O.isEmpty)(e.result.data)&&(bwfcrm_contacts_data.export_data=e.result.data,t(Object(l.__)("Cart export has started","wp-marketing-automations"))),Object(a.Pb)(t,3e3)}));case 2:e.n=4;break;case 3:e.p=3,n=e.v,t(n.hasOwnProperty("message")&&n.message?n.message:Object(l.__)("Unable to export","wp-marketing-automations")),Object(a.Pb)(t,3e3);case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(){return e.apply(this,arguments)}}();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(_.a,null),Object(r.createElement)("div",{className:"bwf-content-header-new"},Object(r.createElement)("div",{className:"bwf-content-header-left"},Object(r.createElement)("div",{className:"bwf-content-header-title"},Object(l.__)("Recovered Carts","wp-marketing-automations")),parseInt(B)>0&&Object(r.createElement)("div",{className:"bwf-content-header-count"},Object(l.sprintf)(Object(l._n)("(%s Result)","(%s Results)",B,"wp-marketing-automations"),B)))),Object(a.Ub)()?Object(r.createElement)(r.Fragment,null,re&&Object(r.createElement)(N.a,{status:"error"},re),Object(r.createElement)(f.a,{className:h()("bwfcrm-forms-list-table",{"has-search":!0}),rows:$e,headers:Be,query:{paged:R/c+1},rowsPerPage:c,totalRows:B,isLoading:ee,onPageChange:function(e,t){U((e-1)*c)},onQueryChange:function(e){return"per_page"!==e?function(){}:ze},rowHeader:!0,showMenu:!1,actions:Me>0?[Object(r.createElement)(P.a,G({key:"list-bulk-action",actions:[{id:"delete",icon:"trash",hint:Object(l.__)("Delete","wp-marketing-automations")}],onAction:Te,inLine:!0,reset:Ne},Fe))]:[Object(r.createElement)(x.a,{key:"search",isLoading:ee,searchTerm:null==e?void 0:e.s,showResultCount:!1,setSearchData:function(t){if(Object(O.size)(t))Object(k.l)({s:encodeURIComponent(t)},"/",e);else{var n=Object(O.cloneDeep)(e);n.hasOwnProperty("s")&&(null==n||delete n.s),Object(k.l)(n,"/",{})}}})],emptyMessage:""!==we?Object(l.__)("No results found","wp-marketing-automations"):Object(l.__)("No Data Available! Contact will appear in the list once customers places order after abandonment the cart ","wp-marketing-automations"),extraSectionBeforefilterCol:ee?null:Object(r.createElement)(r.Fragment,null,Object(a.fc)()&&-1!==Object(a.n)(bwfcrm_contacts_data.bwf_pro_version,"3.5.3")&&ge.hasOwnProperty("recovered_carts")&&Object(r.createElement)(o.a,{type:"recovered_carts",localData:ge.recovered_carts,onDismiss:function(){return ie(!0)}}),(!Object(a.fc)()||-1!==Object(a.n)(bwfcrm_contacts_data.bwf_pro_version,"3.5.3"))&&Object(r.createElement)(j.a,{className:"bwf-btn-small is-light",title:Object(l.__)("Export All","wp-marketing-automations"),onClick:function(){Object(a.fc)()?Xe():ue({status:!0,featureTitle:Object(l.__)("Export Cart","wp-marketing-automations"),isFeature:!0,proLink:Object(a.ib)("upgrade",{utm_medium:"Export+Recovered+Cart+Upgrade+Modal"})})},disabled:Object(a.fc)()&&(0===parseInt(B)||ge.hasOwnProperty("recovered_carts")&&!ce)},Object(a.fc)()?Object(r.createElement)(E.a,{icon:"export",size:14}):Object(r.createElement)(E.a,{icon:"king",size:16}),Object(r.createElement)("span",{className:"bwf-ml-4"},Object(l.__)("Export All","wp-marketing-automations"))))}),Object(r.createElement)(D.a,{modalTitle:Object(l.__)("Delete Cart","wp-marketing-automations"),deleteDescriptionText:Object(l.__)("You are about to delete this cart. This action cannot be undone. Cancel to stop, Delete to proceed.","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),cancelButtonText:Object(l.__)("Cancel","wp-marketing-automations"),onConfirm:We,errorMessage:fe.hasOwnProperty("error")?fe.error:"",onRequestClose:Ke,isOpen:fe.status,isDelete:!0,isLoading:fe.loading}),Object(r.createElement)(C.a,{tasks:_e,isOpen:Se,onSuccess:function(){ve(),Ne()},onError:Ne,onRequestClose:function(){Pe(!1),Ne()},screenType:"recovered",screenTypeId:"cart-bulk",actionType:Ae,type:"cart"}),!Object(a.fc)()&&Object(r.createElement)(I.b,{isOpen:se.status,onRequestClose:function(){return ue({status:!1})},modalContent:se})):Object(r.createElement)(S.a,{data:T.a}))}}}]);