(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{1098:function(e,t,n){"use strict";var a=n(77),r=n(0),o=n(1),c=n(3),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={workflow:{name:Object(o.__)("Workflow","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e):"admin.php?page=autonami-automations&edit=".concat(e),redirect:!t}};return t&&(n.single_a_contacts={name:Object(o.__)("Contacts","wp-marketing-automations"),link:"admin.php?page=autonami&path=/automation/".concat(e,"/contacts"),showOnClick:!0},n.analytics={name:Object(o.__)("Analytics","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/analytics"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/analytics"),isPro:!0,showOnClick:!0}),n.engagement={name:Object(o.__)("Engagements","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/engagements"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/engagements"),isPro:!0,showOnClick:!0},Object(c.uc)()&&(n.orders={name:Object(o.__)("Orders","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/orders"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/orders"),isPro:!0,showOnClick:!0}),n};t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],m=arguments.length>7&&void 0!==arguments[7]&&arguments[7],b=arguments.length>8&&void 0!==arguments[8]&&arguments[8],f=bwfcrm_contacts_data&&bwfcrm_contacts_data.header_data?bwfcrm_contacts_data.header_data:{},d=(f.automation_nav,f.automationv2_nav),p=Object(a.a)(),O=p.setActiveMultiple,j=p.resetHeaderMenu,w=p.setL2NavType,y=p.setL2Nav,v=p.setBackLink,g=p.setL2Title,_=p.setL2Content,h=p.setBackLinkLabel,E=p.setL2NavAlign,k=p.setPageHeader,N=p.setTabHeader;return Object(r.useEffect)((function(){j(!0),!c&&w("menu");var a=i(s,m);b||y(s?a:d),e&&a.hasOwnProperty(e)&&a[e].hasOwnProperty("name")&&N(a[e].name),O({leftNav:"automations-v2",rightNav:e}),n&&v(n),s&&v(n&&!m?"admin.php?page=autonami&path=/automations-v1":"admin.php?page=autonami&path=/automations"),c||m&&s&&h(Object(o.__)("All Automations","wp-marketing-automations")),!m&&s&&h(Object(o.__)("All Automations","wp-marketing-automations")),s&&E("left"),t&&""!==t&&g(t),!n&&l&&_(l),k(Object(o.__)("Automations","wp-marketing-automations")),u&&y({})}),[e,m,b]),!0}},1139:function(e,t,n){},1164:function(e,t,n){},1166:function(e,t,n){"use strict";var a=n(0),r=n(6),o=n.n(r),c=n(2),i=n(56),l=n(1),s=n(9),u=n.n(s),m=n(7),b=(n(1167),n(3)),f=n(17);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=d(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}t.a=function(e){var t=e.header,n=void 0===t?Object(l.__)("View Analytics","wp-marketing-automations"):t,r=e.icon,s=void 0===r?"analytic":r,d=e.automationId,p=e.analyticsId,j=e.mode,y=void 0===j?"":j,v=e.extraData,g=void 0===v?{}:v,_=w(Object(a.useState)(!0),2),h=_[0],E=_[1],k=w(Object(a.useState)(!1),2),N=k[0],S=k[1],P=w(Object(a.useState)({}),2),C=P[0],A=P[1],T=function(){parseInt(p)>0&&Object(b.fc)()?(E(!0),A({}),function(){try{var e=O(O({},g),{},{mode:y});u()({path:Object(b.C)("/automation/".concat(d,"/analytics/").concat(p,"?").concat(Object(f.stringify)(e))),method:"GET"}).then((function(e){200===e.code?Object(c.isEmpty)(e.result)||A(e.result):S(!0),E(!1)}))}catch(e){S(!0),E(!1)}}()):E(!1)},D=function(){var e,t=C.tile,n=void 0===t?[]:t;return N?Object(a.createElement)(a.Fragment,null,Object(l.__)("Error while fetching the Analytics.","wp-marketing-automations")):Object(b.fc)()?Object(a.createElement)(a.Fragment,null,Object(c.isEmpty)(n)?Object(a.createElement)("div",{className:"bwf-normal-text"},Object(l.__)("No analytics found.","wp-marketing-automations")):Object(a.createElement)("div",{className:"bwf-info-brick"},n.map((function(e,t){var n=e.label,r=void 0===n?"":n,o=e.value,c=void 0===o?"-":o;if(""!==r)return Object(a.createElement)("div",{className:"bwf-info-item",key:t},Object(a.createElement)("span",{className:"bwf-node-content-type"},r),Object(a.createElement)("span",{className:"bwf-node-content-label"},c))})))):(e=[{label:Object(l.__)("Sent","wp-marketing-automations")},{label:Object(l.__)("Open Rate","wp-marketing-automations")}],"email"===y&&e.push({label:Object(l.__)("Click Rate","wp-marketing-automations")},{label:Object(l.__)("Click to Open Rate","wp-marketing-automations")}),e.push({label:Object(l.__)("Revenue","wp-marketing-automations")},{label:Object(l.__)("Revenue/Contact","wp-marketing-automations")},{label:Object(l.__)("Unsubscribe Rate","wp-marketing-automations")}),Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-info-brick"},e.map((function(e,t){return Object(a.createElement)("div",{className:"bwf-info-item",key:t},Object(a.createElement)("span",{className:"bwf-node-content-type"},e.label),Object(a.createElement)("span",{className:"bwf-node-content-label"},"-"))}))),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-normal-text"},Object(l.__)("Email Analytics is a PRO feature.","wp-marketing-automations")+" ",Object(a.createElement)("a",{target:"__blank",className:"bwf-normal-a-t bwf-font-light",href:Object(b.ib)("upgrade",{utm_medium:"Automation+Email+Analytics"})},Object(l.__)("Upgrade to PRO","wp-marketing-automations")))))};return Object(a.createElement)("div",{className:"bwf-info-popup"},Object(a.createElement)(i.a,{contentClassName:"bwf-info__popover",position:"top center",renderToggle:function(e){var t=e.onToggle,r=e.isOpen,c=o()("bwf-info__toggle bwf-cursor-pointer",{"is-opened":r});return Object(a.createElement)("div",{className:c,onClick:function(){t(),T()},"aria-expanded":r},Object(a.createElement)(m.a,{size:14,icon:s}),n)},renderContent:function(e){var t=e.onToggle;return Object(a.createElement)("div",{className:"bwf-info-popover-container"},Object(a.createElement)("div",{className:"bwf-info-popover-header"},Object(a.createElement)("div",{className:"bwf-info-header-text"},n,!Object(b.fc)()&&b.e),Object(a.createElement)("span",{className:"bwf-info-close",onClick:t},Object(a.createElement)(m.a,{icon:"close",size:20}))),Object(a.createElement)("div",{className:"bwf-info-popover-body"},Object(a.createElement)("div",{className:"bwf-info-wrapper"},Object(a.createElement)("div",{className:"bwf-info--content"},h?Object(a.createElement)("div",{className:"bwf-info-brick"},[1,2,3,4,5,6].map((function(e){return Object(a.createElement)("div",{className:"bwf-info-item",key:e},Object(a.createElement)("span",{className:"bwf-node-content-type"},Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-60 bwf-h-15"})),Object(a.createElement)("span",{className:"bwf-node-content-label"},Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-90 bwf-h-15"})))}))):D()))))},focusOnMount:!0}))}},1167:function(e,t,n){},1232:function(e,t,n){},1233:function(e,t,n){},1234:function(e,t,n){},1235:function(e,t,n){},1236:function(e,t,n){},1237:function(e,t,n){},1238:function(e,t,n){},1298:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(1093),o=n(2),c=n(6),i=n.n(c),l=n(1),s=(n(1137),n(7)),u=n(5),m=n(344),b=n(148),f=n(3);var d=n(9),p=n.n(d),O=(n(1139),n(54)),j=n(11),w=n(40),y=n(26);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return _(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(_(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,_(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,_(m,"constructor",s),_(s,"constructor",l),l.displayName="GeneratorFunction",_(s,r,"GeneratorFunction"),_(m),_(m,r,"Generator"),_(m,a,(function(){return this})),_(m,"toString",(function(){return"[object Generator]"})),(g=function(){return{w:o,m:b}})()}function _(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(_=function(e,t,n,a){function o(t,n){_(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function h(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){h(o,a,r,c,i,"next",e)}function i(e){h(o,a,r,c,i,"throw",e)}c(void 0)}))}}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=v(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==v(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var A=function(e){var t=Object(a.useContext)(f.h),n=e.isOpen,r=e.onRequestClose,c=e.node,d=e.isEvent,v=void 0===d||d,_=e.automationID,h=c.id,k=Object(m.a)(),S=k.setNodeDatabyId,C=k.fetchAutomation,A=k.setAutomationData,T=k.showSidebar,D=Object(b.a)(),I=D.getEventsList,M=D.getActionsList,x=D.getAutomationSteps,F=D.getAutomationLinks,G=D.getCount,L=D.getAutomationData,z=D.getNodeDataByID,U=D.getautomationMeta,q=v?I():M(),B=P(Object(a.useState)({loading:!1,status:!1}),2),R=B[0],H=B[1],V=q.group,J=void 0===V?[]:V,$=q.list,W=void 0===$?{}:$,Y=q.subgroup,Q=void 0===Y?[]:Y,X=q.subgroup_priority,Z=void 0===X?{}:X,K=q.subgroup_desc,ee=void 0===K?{}:K,te=P(Object(a.useState)(""),2),ne=te[0],ae=te[1],re=P(Object(a.useState)(""),2),oe=re[0],ce=re[1],ie=P(Object(a.useState)(""),2),le=ie[0],se=ie[1],ue=P(Object(a.useState)(""),2),me=ue[0],be=ue[1],fe=P(Object(a.useState)(!1),2),de=fe[0],pe=fe[1],Oe=P(Object(a.useState)({status:!1}),2),je=Oe[0],we=Oe[1],ye=x(),ve=F(),ge=G(),_e=L("data"),he=z(h),Ee=he.data,ke=void 0===Ee?{}:Ee,Ne=he.stepId,Se=void 0===Ne?0:Ne,Pe=U(),Ce=Object.keys(Z).sort((function(e,t){return Z[e]-Z[t]})),Ae=_e.source,Te=void 0===Ae?"":Ae,De=_e.event,Ie=void 0===De?"":De,Me=function(e){var t=[],n="";return J.map((function(a){(Object(o.isArray)(a.subgroup)&&a.subgroup.includes(e)||Object(o.isObject)(a.subgroup)&&Object.values(a.subgroup).includes(e))&&(t=a.subgroup,n=a.group_slug)})),{acsubgp:t,acgrp:n}};Object(a.useEffect)((function(){if(Object(o.isEmpty)(J)||(""!=Te||""!=Ie)&&v){var e=Me(Te),t=e.acsubgp,n=e.acgrp;se(Object(o.isObject)(t)?Object.values(t):t),ce(n),be(Ie)}else ce(J[0].group_slug),se(Object(o.isObject)(J[0].subgroup)?Object.values(J[0].subgroup):J[0].subgroup)}),[n]),Object(a.useEffect)((function(){if(Object(o.isEmpty)(ne))if(Object(o.isEmpty)(J)||(""!=Te||""!=Ie)&&v){var e=Me(Te),t=e.acsubgp,n=e.acgrp;se(Object(o.isObject)(t)?Object.values(t):t),ce(n),be(Ie)}else ce(J[0].group_slug);else ce("")}),[ne]);var xe,Fe,Ge=function(){r&&r()},Le=function(){var e=E(g().m((function e(n,a,r,i){var s,u,m;return g().w((function(e){for(;;)switch(e.p=e.n){case 0:return s=!1,i.hasOwnProperty("event")&&W.hasOwnProperty(i.event)&&W[i.event].hasOwnProperty("need_unique_key")&&W[i.event].need_unique_key&&(s=!0),u={},u=""==Ie?{steps:Object(o.cloneDeep)(n).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:a,count:r,data:i,need_unique_key:s}:{data:i,need_unique_key:s},e.p=1,pe(!0),t(Object(l.__)("Updating automation…","wp-marketing-automations")),e.n=2,p()({path:Object(f.C)("/automation/".concat(_)),method:"POST",data:{data:u}}).then(function(){var e=E(g().m((function e(n){return g().w((function(e){for(;;)switch(e.n){case 0:if(200!==n.code){e.n=2;break}return e.n=1,C(_).then((function(){A("openStartSidebar",!0)})).then((function(){var e=Object(o.cloneDeep)(c);e.data.selected="start",A("sidebarNodeData",e),T(!0)}));case 1:t(n.message),Object(f.Pb)(t,3e3),e.n=3;break;case 2:throw Error(Object(f.w)(null==n?void 0:n.message));case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,m=e.v,Object(f.Pb)(t,3e3),pe(!1),setTimeout((function(){H({status:!0,error:m.message})}),[1500]);case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(t,n,a,r){return e.apply(this,arguments)}}(),ze=function(){var e=E(g().m((function e(n,a){var r,i;return g().w((function(e){for(;;)switch(e.p=e.n){case 0:return r={steps:Object(o.cloneDeep)(ye).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:ve,count:ge,data:{action:{action:n,intergration:a}},updateStatus:2},e.p=1,pe(!0),t(Object(l.__)("Updating automation…","wp-marketing-automations")),e.n=2,p()({path:Object(f.C)("/automation/".concat(_,"/step/").concat(Se)),method:"POST",data:r}).then((function(e){if(200!==e.code)throw Error(Object(f.w)(null==e?void 0:e.message));S(c.id,{selected:n},{step_status:2}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&A("meta",N(N({},Pe),e.result.meta)),t(e.message)})).then((function(){var e=Object(o.cloneDeep)(c);e.data.selected=n,A("sidebarNodeData",e),T(!0),pe(!1),Ge(),Object(f.Pb)(t,3e3)}));case 2:e.n=4;break;case 3:e.p=3,i=e.v,Object(f.Pb)(t,3e3),pe(!1),setTimeout((function(){H({status:!0,error:i.message})}),[1500]);case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(t,n){return e.apply(this,arguments)}}(),Ue=function(e){if("string"==typeof e&&""!==e&&Ie!==e)if("start"===h&&v)ke.evtGroup=W[e].source_type,ke.event=e,function(e){var t={};t=ye.map((function(t){return"start"==t.id&&(t.data=e),t}));var n=[];1==ye.length?(t.push({id:"end",type:"end",data:{label:Object(l.__)("End Automation","wp-marketing-automations")},hidden:!1,position:{x:250,y:600}}),n=[{id:"endlink",source:"start",target:"end",sourceHandle:"",animated:!1}]):n=Object(o.cloneDeep)(ve);var a=Object(o.cloneDeep)(_e);a.event=e.event,a.source=e.evtGroup,Le(t,n,2,a)}(ke);else{var n=W[e].integration_slug;ze(e,n)}else t(Ie===e?Object(l.__)("Please choose a different event to save.","wp-marketing-automations"):v?Object(l.__)("Please choose an event.","wp-marketing-automations"):Object(l.__)("Please choose an action.","wp-marketing-automations")),Object(f.Pb)(t,3e3)};return n?Object(a.createElement)(u.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-admin-modal-xl",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(a.createElement)("div",{className:"bwf-modal-search-header"},Object(a.createElement)("div",{className:"bwf-modal-title"},v?Object(l.__)("Select an Event","wp-marketing-automations"):Object(l.__)("Select an Action","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf-modal-search-wrap"},Object(a.createElement)("div",{className:"bwf-component-search-control"},Object(a.createElement)(s.a,{icon:"search",size:15}),Object(a.createElement)(u.TextControl,{value:ne,onChange:ae,placeholder:Object(l.__)("Search…","wp-marketing-automations")}))),Object(a.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:Ge},Object(a.createElement)(s.a,{icon:"close",size:20}))),Object(a.createElement)("div",{className:"bwf-event-modal-main"},Object(a.createElement)("div",{className:"bwf-event-modal-body"},Object(a.createElement)("div",{className:"bwf-modal-sidebar"},Object(a.createElement)("div",{className:"bwf-modal-filter-wrap"},J.map((function(e,t){if(function(e){var t=!1;if(e.hasOwnProperty("subgroup")&&!Object(o.isEmpty)(e.subgroup)){var n=[];(Object(o.isObject)(e.subgroup)?Object.values(e.subgroup):e.subgroup).map((function(e){Q.hasOwnProperty(e)&&n.push(e)})),Object(o.isEmpty)(n)||(t=!0)}return t}(e))return Object(a.createElement)("div",{key:t,className:i()("bwf-modal-filter",{active:oe===e.group_slug}),onClick:function(){be(""),ce(e.group_slug),se(Object(o.isObject)(e.subgroup)?Object.values(e.subgroup):e.subgroup)}},e.label)})))),Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},(xe=[],Fe={},Object(o.isEmpty)(ne)?le.map((function(e){Fe=N(N({},Fe),Q[e])})):Object.values(Q).map((function(e){Fe=N(N({},Fe),e)})),xe.push(Fe),xe).map((function(e,t){if(Object(o.isEmpty)(e))return Object(a.createElement)(a.Fragment,{key:t});var n=[],r=Object.keys(e);return Object(o.isEmpty)(Ce)?n=r:Ce.map((function(e){r.includes(e)&&n.push(e)})),Object(a.createElement)("div",{key:t+"-2"},n.map((function(t,n){var r=[];return r=function(e){var t=[];return(Object(o.isObject)(e)?Object.values(e):e).map((function(e){if(W.hasOwnProperty(e)&&W[e].hasOwnProperty(v?"event_name":"action_name")){var n=v?W[e].event_name:W[e].action_name;(Object(o.isEmpty)(ne)||n.toLowerCase().includes(ne.toLowerCase()))&&t.push(e)}})),t}(e[t]),!Object(o.isEmpty)(r)&&Object(a.createElement)(a.Fragment,{key:n},Object(a.createElement)("div",{className:"bwf-brick-content-header",key:n},t),ee.hasOwnProperty(t)&&""!==ee[t]&&Object(a.createElement)(y.a,{status:"warning",icon:"shield",className:"bwf-mtb-12"},ee[t]),r.map((function(e,t){var n=!!W[e].hasOwnProperty("lock")&&W[e].lock,r=!!W[e].hasOwnProperty("isLite")&&W[e].isLite,o=n&&r;return Object(a.createElement)(j.a,{key:t,isPrimary:me===e,isSecondary:me!==e,className:"bwf-secondary-alter "+(Object(f.fc)()?n?"locked":"":n?o?"locked":"not-pro locked":"not-pro"),onClick:function(){Object(f.fc)()||!n||r?o||be(e):we({status:!0,featureTitle:v?W[e].event_name:W[e].action_name})},disabled:Object(f.fc)()&&n||o},me===e&&Object(a.createElement)("span",{className:"bwf-circle-tick"},Object(a.createElement)(s.a,{icon:"tick",size:10})),v?W[e].event_name:W[e].action_name,n&&!Object(f.fc)()&&!r&&Object(a.createElement)("span",{className:"bwf-display-flex bwf-ml-5"},Object(a.createElement)(s.a,{icon:"king",size:15})))})))})))}))))),Object(a.createElement)("div",{className:"bwf-modal-inner-footer bwf_text_right"},Object(a.createElement)(j.a,{className:"bwf-modal-cancel-btn",onClick:Ge},Object(l.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(j.a,{isPrimary:!0,isBusy:de,className:"bwf-no-ripple",onClick:function(){de||Ue(me)}},Object(l.__)("Done","wp-marketing-automations")))))),Object(a.createElement)(O.a,{modalTitle:v?Object(l.__)("Event Selection","wp-marketing-automations"):Object(l.__)("Action Selection","wp-marketing-automations"),errorMessage:R.error,onRequestClose:function(){return H({status:!1})},isOpen:R.status}),!Object(f.fc)()&&Object(a.createElement)(w.b,{isOpen:je.status,onRequestClose:function(){return we({status:!1})},modalContent:{title:Object(l.sprintf)(Object(l.__)("%s is a PRO Event","wp-marketing-automations"),je.featureTitle),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Event+Upgrade+Modal"})}})):""};function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return I(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(I(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,I(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,I(m,"constructor",s),I(s,"constructor",l),l.displayName="GeneratorFunction",I(s,r,"GeneratorFunction"),I(m),I(m,r,"Generator"),I(m,a,(function(){return this})),I(m,"toString",(function(){return"[object Generator]"})),(D=function(){return{w:o,m:b}})()}function I(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(I=function(e,t,n,a){function o(t,n){I(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=T(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=T(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==T(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return z(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var U=function(e){var t=Object(a.useContext)(f.h),n=e.isOpen,r=e.onRequestClose,c=e.node,d=e.automationID,O=c.id,w=Object(m.a)(),y=w.setNodeDatabyId,v=w.setAutomationData,g=w.showSidebar,_=Object(b.a)(),h=_.getGoals,E=_.getAutomationSteps,k=_.getAutomationLinks,N=_.getCount,S=_.getNodeDataByID,P=(0,_.getautomationMeta)(),C=h(),A=C.group,T=void 0===A?[]:A,I=C.list,M=void 0===I?{}:I,F=C.subgroup,z=void 0===F?[]:F,U=C.subgroup_priority,q=void 0===U?{}:U,B=L(Object(a.useState)(""),2),R=B[0],H=B[1],V=L(Object(a.useState)(""),2),J=V[0],$=V[1],W=L(Object(a.useState)(""),2),Y=W[0],Q=W[1],X=L(Object(a.useState)(""),2),Z=X[0],K=X[1],ee=L(Object(a.useState)(!1),2),te=ee[0],ne=ee[1],ae=E(),re=k(),oe=N(),ce=S(O),ie=ce.data,le=void 0===ie?{}:ie,se=ce.stepId,ue=void 0===se?0:se,me=q[J]?q[J]:{},be=le.source,fe=void 0===be?"":be,de=le.benchmark,pe=void 0===de?"":de,Oe=function(e){var t=[],n="";return T.map((function(a){a.subgroup.includes(e)&&(t=a.subgroup,n=a.group_slug)})),{acsubgp:t,acgrp:n}};Object(a.useEffect)((function(){if(Object(o.isEmpty)(T)||""!=fe||""!=pe){var e=Oe(fe),t=e.acsubgp,n=e.acgrp;Q(t),$(n),K(pe)}else $(T[0].group_slug),Q(T[0].subgroup)}),[n]),Object(a.useEffect)((function(){if(Object(o.isEmpty)(R))if(Object(o.isEmpty)(T)||""!=fe||""!=pe){var e=Oe(fe),t=e.acsubgp,n=e.acgrp;Q(t),$(n),K(pe)}else $(T[0].group_slug);else $("")}),[R]);var je,we=function(){r&&r()},ye=function(){var e,n=(e=D().m((function e(n,a){var r,i,s;return D().w((function(e){for(;;)switch(e.p=e.n){case 0:return r=le,ne(!0),r.benchmark=n,t(Object(l.__)("Adding benchmark..","wp-marketing-automations")),e.p=1,i={steps:Object(o.cloneDeep)(ae).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:re,count:oe,data:{action:{benchmark:n,source:a}},updateStatus:2},e.n=2,p()({path:Object(f.C)("/automation/".concat(d,"/step/").concat(ue)),method:"POST",data:i}).then((function(e){200===e.code&&(t(e.message),y(parseInt(O),r,{step_status:2}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&v("meta",x(x({},P),e.result.meta)))})).then((function(){var e=Object(o.cloneDeep)(c);e.data.benchmark=n,v("sidebarNodeData",e),g(!0),ne(!1),we()}));case 2:e.n=4;break;case 3:e.p=3,s=e.v,console.log(s),ne(!0);case 4:Object(f.Pb)(t,3e3);case 5:return e.a(2)}}),e,null,[[1,3]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){G(o,a,r,c,i,"next",e)}function i(e){G(o,a,r,c,i,"throw",e)}c(void 0)}))});return function(e,t){return n.apply(this,arguments)}}();return n?Object(a.createElement)(u.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-admin-modal-xl",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(a.createElement)("div",{className:"bwf-modal-search-header"},Object(a.createElement)("div",{className:"bwf-modal-title"},Object(l.__)("Select an Goal","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf-modal-search-wrap"},Object(a.createElement)("div",{className:"bwf-component-search-control"},Object(a.createElement)(s.a,{icon:"search",size:15}),Object(a.createElement)(u.TextControl,{value:R,onChange:H,placeholder:Object(l.__)("Search…..")}))),Object(a.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:we},Object(a.createElement)(s.a,{icon:"close",size:20}))),Object(a.createElement)("div",{className:"bwf-event-modal-main"},Object(a.createElement)("div",{className:"bwf-event-modal-body"},Object(a.createElement)("div",{className:"bwf-modal-sidebar"},Object(a.createElement)("div",{className:"bwf-modal-filter-wrap"},T.map((function(e,t){if(function(e){var t=!1;if(e.hasOwnProperty("subgroup")&&!Object(o.isEmpty)(e.subgroup)){var n=[];e.subgroup.map((function(e){z.hasOwnProperty(e)&&n.push(e)})),Object(o.isEmpty)(n)||(t=!0)}return t}(e))return Object(a.createElement)("div",{key:t,className:i()("bwf-modal-filter",{active:J===e.group_slug}),onClick:function(){K(""),$(e.group_slug),Q(e.subgroup)}},e.label)})))),Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},(je=[],Object(o.isEmpty)(R)&&!Object(o.isEmpty)(Y)?Y.map((function(e){je.push(z[e])})):Object.values(z).map((function(e){je.push(e)})),je).map((function(e,t){if(Object(o.isEmpty)(e))return Object(a.createElement)("div",{key:t});var n=[];return n=me&&Object.keys(me).length>0?Object.keys(e).sort((function(e,t){return me[e]||me[t]?me[e]&&!me[t]?1:!me[e]&&me[t]?-1:me[e]-me[t]:1})):Object.keys(e),Object(a.createElement)("div",{key:t},n.map((function(t,n){var r=function(e){var t=[];return e.map((function(e){if(M.hasOwnProperty(e)&&M[e].hasOwnProperty("event_name")){var n=M[e].event_name;(Object(o.isEmpty)(R)||n.toLowerCase().includes(R.toLowerCase()))&&t.push(e)}})),t}(e[t]);return!Object(o.isEmpty)(r)&&Object(a.createElement)("div",{key:n},Object(a.createElement)("div",{className:"bwf-brick-content-header"},t),r.map((function(e){return Object(a.createElement)(j.a,{key:e,isPrimary:Z===e,isSecondary:Z!==e,className:"bwf-secondary-alter",onClick:function(){K(e)}},Z===e&&Object(a.createElement)("span",{className:"bwf-circle-tick"},Object(a.createElement)(s.a,{icon:"tick",size:10})),Object(a.createElement)(a.Fragment,null,M[e].event_name))})))})))}))))),Object(a.createElement)("div",{className:"bwf-modal-inner-footer bwf_text_right"},Object(a.createElement)(j.a,{className:"bwf-modal-cancel-btn",onClick:we},Object(l.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(j.a,{isPrimary:!0,className:"bwf-no-ripple",isBusy:te,onClick:function(){te||function(e){if("string"==typeof e&&""!==e){var n=M[e].source_type;ye(e,n)}else t(Object(l.__)("Please choose an benchmark.","wp-marketing-automations")),Object(f.Pb)(t,3e3)}(Z)}},Object(l.__)("Done","wp-marketing-automations"))))))):""},q=function(e){var t=e.onNodeClick,n=e.onNoteToggleClick,r=e.onElipsisToggleClick,o=e.onInfoToggleClick,c=e.onNodeStatClick,i=e.onNodeQueuedStatClick,l=e.onNodeFailedStatClick,s=e.onAnalyticsClick,u=e.onNodeSkippedStatClick,m=Object(b.a)(),f=m.getEnableCopy,d=m.getEnableMove,p=f(),O=d(),j=Object(a.useCallback)((function(e,t){var n=!(!e.target||"string"!=typeof e.target.className)&&e.target.className;return!!n&&n.includes(t)||e.target.closest("."+t)}),[]);return function(e){if(!p&&!O)if(j(e,"bwf-note__toggle"))n&&n();else if(j(e,"bwf-ellipsis-menu__toggle"))r&&r();else if(j(e,"bwf-info__toggle"))o&&o();else if(j(e,"bwf-queued-status-wrap"))i&&i();else if(j(e,"bwf-failed-status-wrap"))l&&l();else if(j(e,"bwf-skipped-status-wrap"))u&&u();else if(j(e,"bwf-node-analytics"))s&&s();else if(j(e,"bwf-status-wrap"))c&&c();else{var a=j(e,"bwf-ellipsis-menu"),m=j(e,"bwf-note-popup"),b=j(e,"bwf-info-popup");a||m||b||t&&t()}}},B=n(61),R=n(19),H=n(60),V=n(12);function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var W=function(e){var t=e.selected,n=void 0!==t&&t,c=J(Object(a.useState)(!1),2),i=c[0],u=c[1],d=Object(b.a)(),p=d.getEventsList,O=d.getAutomationData,j=d.getOpenStartSidebar,w=d.getEnableMove,y=d.getEnableCopy,v=d.getStatLoading,g=d.getStatData,_=y(),h=w(),E=O(),k=j(),N=v(),S=g(),P=E.ID,C=E.event,T=void 0===C?"":C,D=S.hasOwnProperty("start")?S.start:{};Object(a.useEffect)((function(){k&&(M("sidebarNodeData",e),x(!0))}),[k]);var I=Object(m.a)(),M=I.setAutomationData,x=I.showSidebar,F=p(),G=q({onNodeClick:!Object(o.isEmpty)(T)&&F.list.hasOwnProperty(T)&&function(){Object(V.l)({stepid:"start"},"/"),F.list[T].hasOwnProperty("fields")&&!Object(o.isEmpty)(F.list[T].fields)&&(M("sidebarNodeData",e),x(!0))},onNodeStatClick:function(){M("showContactModalId",T),M("showContactModalType","completed")},onNodeQueuedStatClick:function(){M("showContactModalId",T),M("showContactModalType","active")}});return Object(a.createElement)("div",{className:"bwf-node-wrapper"},Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":"")+(Object(o.isEmpty)(T)?" bwf-empty-start-node":""),onClick:G},Object(o.isEmpty)(T)?Object(a.createElement)("div",{className:"bwf-node-brick is-start-node",onClick:function(){return u(!0)}},Object(a.createElement)("div",{className:"bwf-node-icon"},Object(a.createElement)(s.a,{size:22,icon:"tap-icon"})),Object(a.createElement)("div",{className:"bwf-display-flex bwf-h4"},Object(l.__)("Select an Event","wp-marketing-automations"))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-brick is-start-node-selected"},Object(a.createElement)("div",{className:"bwf-node-icon icon-start"},Object(a.createElement)(s.a,{size:22,icon:"rocket"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},F.list.hasOwnProperty(T)&&F.list[T].hasOwnProperty("source_label")?F.list[T].source_label:""),Object(a.createElement)("div",{className:"bwf-node-content-label"},F.list.hasOwnProperty(T)&&F.list[T].hasOwnProperty("event_name")?F.list[T].event_name:Object(l.__)("Event Not Found","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},!Object(o.isEmpty)(T)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(H.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!_&&!h),renderContent:function(e){var t=e.onToggle;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){u(!0),t()}},Object(a.createElement)(R.a,{justify:"flex-start"},Object(a.createElement)(R.c,null,Object(l.__)("Change Event","wp-marketing-automations")))))}})))),Object(a.createElement)("div",{className:"bwf-node-status bwf-node-m-0"},Object(a.createElement)("div",{className:"bwf-queued-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Active","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},N?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,D.hasOwnProperty("active")?Object(f.xc)(parseInt(D.active)):0))),Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},N?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,D.hasOwnProperty("completed")?Object(f.xc)(parseInt(D.completed)):0)))))),!Object(o.isEmpty)(T)&&Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(a.createElement)(A,{isOpen:i,node:e,onRequestClose:function(){return u(!1)},automationID:P}))},Y=(n(56),n(1232),n(41));function Q(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return X(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(X(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,X(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,X(m,"constructor",s),X(s,"constructor",l),l.displayName="GeneratorFunction",X(s,r,"GeneratorFunction"),X(m),X(m,r,"Generator"),X(m,a,(function(){return this})),X(m,"toString",(function(){return"[object Generator]"})),(Q=function(){return{w:o,m:b}})()}function X(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(X=function(e,t,n,a){function o(t,n){X(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function Z(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var te=function(e){var t,n,r=e.node,c=r.id,d=void 0===c?"":c,O=r.data,j=Object(a.useContext)(f.h),w=K(Object(a.useState)(!1),2),y=w[0],v=w[1],g=K(Object(a.useState)(O.hasOwnProperty("note")?O.note:""),2),_=g[0],h=g[1],E=K(Object(a.useState)(!1),2),k=E[0],N=E[1],S=Object(m.a)().setNodeDatabyId,P=Object(b.a)(),C=P.getAutomationData,A=P.getNodeDataByID,T=P.getEnableMove,D=P.getEnableCopy,I=T(),M=D(),x=Object(o.isEmpty)(d)?{}:A(d),F=x.stepId,G=void 0===F?0:F,L=x.data,z=(void 0===L?{}:L).note,U=void 0===z?"":z,q=C().ID,R=function(){var e,t=(e=Q().m((function e(t){var n;return Q().w((function(e){for(;;)switch(e.p=e.n){case 0:return v(!0),e.p=1,e.n=2,p()({path:Object(f.C)("/automation/".concat(q,"/step/").concat(G)),method:"POST",data:{data:{data:{note:t}}}}).then((function(e){200===e.code&&(j(e.message),O.note=t,S(d,O),N(!1))}));case 2:v(!1),e.n=4;break;case 3:e.p=3,n=e.v,j(n.message),v(!1);case 4:Object(f.Pb)(j,3e3);case 5:return e.a(2)}}),e,null,[[1,3]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){Z(o,a,r,c,i,"next",e)}function i(e){Z(o,a,r,c,i,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),V=K(Object(a.useState)(!1),2),J=V[0],$=V[1];return Object(a.createElement)("div",{className:"bwf-note-popup"},function(e,t){var n=i()("bwf-note__toggle bwf-cursor-pointer",{"is-opened":t});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:n,onClick:function(t){I||M||e(t)},"aria-expanded":t},!Object(o.isEmpty)(_)&&Object(a.createElement)("span",{className:"bwf-has-note"}),Object(a.createElement)(s.a,{size:16,icon:"note"})))}((function(){return $(!J)}),!0),J&&Object(a.createElement)(Y.a,{position:"top right",className:"bwf-note__popover",onClose:function(){return $(!1)},focusOnMount:!0},(t=function(){return $(!J)},Object(a.createElement)("div",{className:"bwf-note-popover-container"},Object(a.createElement)("div",{className:"bwf-note-popover-header"},Object(a.createElement)("div",{className:"bwf-note-header-text"},Object(l.__)("Notes","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-note-close",onClick:t},Object(a.createElement)(s.a,{icon:"close",size:20}))),Object(a.createElement)("div",{className:"bwf-note-popover-body"},Object(o.isEmpty)(_)||k?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(u.TextareaControl,{value:_,onChange:function(e){N(!0),h(e)}}),Object(a.createElement)("div",{className:"bwf_text_right",onClick:function(){return R(_)}},Object(a.createElement)(u.Button,{isPrimary:!0,isBusy:y},Object(o.isEmpty)(U)?Object(l.__)("Add","wp-marketing-automations"):Object(l.__)("Update","wp-marketing-automations")))):Object(a.createElement)("div",{className:"bwf-note-wrapper"},Object(a.createElement)("div",{className:"bwf-note--content"},Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:(n=_,n.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,'<a href="$1" target="_blank" class="bwf-a-no-underline">$1</a>'))}})),Object(a.createElement)(H.a,{label:Object(l.__)("Event note action","wp-marketing-automations"),renderContent:function(e){var t=e.onToggle;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){N(!0)}},Object(l.__)("Edit","wp-marketing-automations")),Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){t(),h(""),R("")}},Object(l.__)("Delete","wp-marketing-automations")))}})))))))},ne=n(1140);function ae(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return re(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(re(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,re(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,re(m,"constructor",s),re(s,"constructor",l),l.displayName="GeneratorFunction",re(s,r,"GeneratorFunction"),re(m),re(m,r,"Generator"),re(m,a,(function(){return this})),re(m,"toString",(function(){return"[object Generator]"})),(ae=function(){return{w:o,m:b}})()}function re(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(re=function(e,t,n,a){function o(t,n){re(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function oe(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ie(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ie(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var le=function(e){var t=e.readables;return Object(a.createElement)("div",{className:"bwf-step-brick"},t.map((function(e,t){var n=e.map((function(e,t){return Object(o.isEmpty)(e)?Object(a.createElement)(a.Fragment,null):Object(a.createElement)("div",{key:t},0!==t&&Object(a.createElement)("div",{className:"bwf-step-divider"},Object(a.createElement)("span",{className:"bwf-divider"},"AND")),Object(a.createElement)("div",{className:"bwf-step-content-content bwf-two-line-ellipse-text"},e))}));return 0!==t?Object(o.isEmpty)(n)?Object(a.createElement)(a.Fragment,null):Object(a.createElement)("div",{key:t+"-or"},Object(a.createElement)("div",{className:"bwf-step-divider divider-line bwf-or"},Object(a.createElement)("span",{className:"bwf-divider"},"OR")),n):n})))},se=function(e){var t=e.data,n=void 0===t?{}:t,c=e.selected,i=void 0!==c&&c,u=e.id,d=ce(Object(a.useState)({status:!1,loading:!0}),2),p=d[0],j=d[1],w=Object(m.a)(),y=w.deleteNode,v=w.setAutomationData,g=w.showSidebar,_=w.setNodeForAdd,h=w.copyNodeHere,E=w.setOpenStepModal,k=w.setModalAnchorNode,N=w.fetchSplitPathNodes,S=Object(b.a)(),P=S.getAutomationId,C=S.getAutomationData,A=S.getEnableCopy,T=S.getEnableMove,D=S.getNodeDataByID,I=S.getLastAddedNode,M=S.getStatLoading,x=S.getStatData,F=S.getRulesData,G=I(),L=C().event,z=P(),U=M(),J=x();Object(a.useEffect)((function(){G==u&&(v("sidebarNodeData",e),g(!0),v("lastAddedNode",0))}),[G]);var $,W,Y=A(),Q=T(),X=D(e.id),Z=X.hasMultiParents,K=void 0!==Z&&Z,ee=X.stepId,re=X.step_status,ie=void 0===re?1:re,se=J.hasOwnProperty(ee)?J[ee]:{},ue=F(L),me=Object(o.isEmpty)(L)||f.dc?{}:Object(ne.a)(L,parseInt(z),ue),be=me.isLoading,fe=me.error,de=me.getReadableTexts,pe=me.rules,Oe=f.dc?[]:($=n.sidebarValues,W=[],Object(o.isEmpty)($)?[]:(Object.keys($).map((function(e){var t=$[e],n=[];!Object(o.isEmpty)(t)&&Object(o.isArray)(t)&&(t.map((function(e){pe.hasOwnProperty(e.filter)&&n.push(e)})),Object(o.isEmpty)(n)||W.push(n))})),W)),je=f.dc||be||fe||Object(o.isEmpty)(L)?[]:de(Oe),we=q({onNodeClick:function(){ee&&Object(V.l)({stepid:ee},"/"),v("sidebarNodeData",e),g(!0)},onNodeStatClick:function(){f.dc?(v("proModalContent",Object(l.__)("Conditional Step","wp-marketing-automations")),v("showProModal",!0)):(v("showContactModalId",ee),v("showContactModalType","completed"))}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":ee},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),f.dc?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ie)?" bwf-draft-node":""),onClick:function(){v("proModalContent",Object(l.__)("Conditional Step","wp-marketing-automations")),v("showProModal",!0)}},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon"},Object(a.createElement)(s.a,{size:26,icon:"condition"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+ee),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Condition","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"})),Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(a.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1})):Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ie)?" bwf-draft-node":""),onClick:we},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon"},Object(a.createElement)(s.a,{size:26,icon:"condition"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Condition","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},Object(a.createElement)(te,{node:e}),Object(a.createElement)(H.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!Y&&!Q),renderContent:function(t){var n=t.onToggle,r=N();return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){Object(f.fc)()?(v("enableCopy",!0),v("copyData",{type:"conditional",data:e.data,id:e.id})):(v("proModalContent",Object(l.__)("Copy Step","wp-marketing-automations")),v("showProModal",!0)),n()}},Object(a.createElement)(R.a,{justify:"space-between"},Object(a.createElement)(R.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(R.c,null,f.e))),!r.includes(u)&&Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){Object(f.fc)()?(v("enableMove",!0),v("moveID",e.id),v("copyData",{type:"conditional",data:e.data,id:e.id})):(v("proModalContent",Object(l.__)("Move Step","wp-marketing-automations")),v("showProModal",!0)),n()}},Object(a.createElement)(R.a,{justify:"space-between"},Object(a.createElement)(R.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(R.c,null,f.e))),Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){var t,a;j({status:!0,onConfirm:(t=ae().m((function t(){return ae().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,y(e).then((function(){return j({status:!1})})).catch((function(e){j({status:!0,err:e.message})}));case 1:return t.a(2)}}),t)})),a=function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function c(e){oe(o,a,r,c,i,"next",e)}function i(e){oe(o,a,r,c,i,"throw",e)}c(void 0)}))},function(){return a.apply(this,arguments)})}),n()}},Object(a.createElement)(R.a,{justify:"flex-start"},Object(a.createElement)(R.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Array.isArray(je)&&je.length?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)(le,{readables:je}))),Object(a.createElement)("div",{className:"bwf-node-status"},Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},U?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,se.hasOwnProperty("completed")?Object(f.xc)(parseInt(se.completed)):0))))):Object(a.createElement)(a.Fragment,null,be?Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content bwf-mb-16"},Object(l.__)("Loading","wp-marketing-automations")))))):Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations")))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1})),K&&Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},Y||Q?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return h(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){_(e.id,{option:"",position:"before"}),E(!0),k(t.target)}}))),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Conditional Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("conditional step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:p.onConfirm,isLoading:!1,onRequestClose:function(){return j({status:!1})},isOpen:p.status,isDelete:!0,showSupportLink:!0,errorMessage:null==p?void 0:p.err}))},ue=n(1166),me=n(150);function be(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return fe(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(fe(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,fe(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,fe(m,"constructor",s),fe(s,"constructor",l),l.displayName="GeneratorFunction",fe(s,r,"GeneratorFunction"),fe(m),fe(m,r,"Generator"),fe(m,a,(function(){return this})),fe(m,"toString",(function(){return"[object Generator]"})),(be=function(){return{w:o,m:b}})()}function fe(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(fe=function(e,t,n,a){function o(t,n){fe(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function de(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function pe(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){de(o,a,r,c,i,"next",e)}function i(e){de(o,a,r,c,i,"throw",e)}c(void 0)}))}}function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return je(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?je(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var we=function(e){var t=e.data,n=void 0===t?{}:t,c=e.selected,i=void 0!==c&&c,u=e.id,d=Oe(Object(a.useState)(!1),2),p=d[0],j=d[1],w=Oe(Object(a.useState)({status:!1,loading:!0}),2),y=w[0],v=w[1],g=Object(m.a)(),_=g.deleteNode,h=g.setAutomationData,E=g.showSidebar,k=g.setNodeForAdd,N=g.copyNodeHere,S=g.setOpenStepModal,P=g.setModalAnchorNode,C=g.fetchSplitPathNodes,T=Object(b.a)(),D=T.getActionsList,I=T.getAutomationData,M=T.getNodeDataByID,x=T.getEnableCopy,F=T.getEnableMove,G=T.getLastAddedNode,L=T.getStatLoading,z=T.getStatData,U=G(),J=D(),$=I(),W=L(),Y=z(),Q=$.ID,X=x(),Z=F(),K=M(e.id),ee=K.hasMultiParents,ne=void 0!==ee&&ee,ae=K.stepId,re=K.step_status,oe=void 0===re?1:re,ce=Y.hasOwnProperty(ae)?Y[ae]:{},ie=n.sidebarValues,le=void 0===ie?{}:ie,se=n.desc_text,fe=void 0===se?"":se;Object(a.useEffect)((function(){U==u&&(j(!0),h("lastAddedNode",0))}),[U]);var de,je,we,ye=q({onNodeClick:!!n.selected&&function(){J.list.hasOwnProperty(n.selected)&&(ae&&Object(V.l)({stepid:ae},"/"),h("sidebarNodeData",e),E(!0))},onNodeStatClick:function(){h("showContactModalId",ae),h("showContactModalType","completed")},onNodeFailedStatClick:function(){h("showContactModalId",ae),h("showContactModalType","failed")},onNodeSkippedStatClick:function(){h("showContactModalId",ae),h("showContactModalType","skipped")},onInfoToggleClick:function(){return h("analyticNodeId",ae)}}),ve=!W&&ce.hasOwnProperty("failed")&&parseInt(ce.failed)>0&&ce.hasOwnProperty("skipped")&&parseInt(ce.skipped)>0;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper ".concat(ve?"bwf-width-2":""),"data-stepid":ae},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(n.hasOwnProperty("selected")&&n.selected&&J.list.hasOwnProperty(n.selected)&&2===parseInt(oe)&&J.list[n.selected].hasOwnProperty("fields")&&!Object(o.isEmpty)(J.list[n.selected].fields)?" bwf-draft-node":""),onClick:ye},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-action"},Object(a.createElement)(s.a,{size:22,icon:"charge"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Action","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},n.hasOwnProperty("selected")&&!Object(o.isEmpty)(n.selected)&&Object(a.createElement)(te,{id:u,node:e}),Object(a.createElement)(H.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!X&&!Z),renderContent:function(t){var r=t.onToggle,c=C();return Object(a.createElement)(a.Fragment,null,n.hasOwnProperty("selected")&&!Object(o.isEmpty)(n.selected)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){Object(f.fc)()?(h("enableCopy",!0),h("copyData",{type:"action",data:e.data})):(h("proModalContent",{featureTitle:Object(l.__)("Copy Step","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),h("showProModal",!0)),r()}},Object(a.createElement)(R.a,{justify:"space-between"},Object(a.createElement)(R.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(R.c,null,f.e))),!c.includes(u)&&Object(a.createElement)(B.a,{isClickable:!0,onInvoke:pe(be().m((function t(){return be().w((function(t){for(;;)switch(t.n){case 0:Object(f.fc)()?(h("enableMove",!0),h("moveID",e.id),h("copyData",{type:"action",data:e.data})):(h("proModalContent",{featureTitle:Object(l.__)("Move Step","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),h("showProModal",!0)),r();case 1:return t.a(2)}}),t)})))},Object(a.createElement)(R.a,{justify:"space-between"},Object(a.createElement)(R.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(R.c,null,f.e)))),Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){var t;v({status:!0,onConfirm:(t=pe(be().m((function t(){return be().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,_(e).then((function(){return v({status:!1})}));case 1:return t.a(2)}}),t)}))),function(){return t.apply(this,arguments)})}),r()}},Object(a.createElement)(R.a,{justify:"flex-start"},Object(a.createElement)(R.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),n.hasOwnProperty("selected")&&!Object(o.isEmpty)(n.selected)?Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},!Object(o.isEmpty)(n)&&n.hasOwnProperty("selected")&&(we=Object(a.createElement)(a.Fragment,null),"wp_sendemail"===n.selected?(de=le.bwfan_email_data,je=void 0===de?{}:de,we=Object(a.createElement)(a.Fragment,null,!Object(o.isEmpty)(je)&&Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle "},Object(a.createElement)(ue.a,{automationId:Q,analyticsId:ae,mode:"email"})))):"twilio_send_sms"!==n.selected&&"bulkgate_send_transactional_sms"!==n.selected&&"linkmobility_send_sms"!==n.selected&&"unifonic_send_sms"!==n.selected||(we=Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle"},Object(a.createElement)(ue.a,{automationId:Q,analyticsId:ae,mode:"sms"}))),Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-content-type"},J.list.hasOwnProperty(n.selected)&&J.list[n.selected].hasOwnProperty("integration_nicename")?J.list[n.selected].integration_nicename:""),Object(a.createElement)("div",{className:"bwf-node-content-label"},J.list.hasOwnProperty(n.selected)?J.list[n.selected].action_name:Object(l.__)("Action Not Found","wp-marketing-automations")),!Object(o.isEmpty)(fe)&&Object(a.createElement)("div",{className:"bwf-node-content-label bwf-node-desc"+(Object(o.isArray)(fe)?"":" bwf-two-line-ellipse-text")},function(e){if(Object(o.isEmpty)(e))return Object(a.createElement)(a.Fragment,null);if(Object(o.isArray)(e)){var t="",n=[];return e.map((function(e){Object(o.isEmpty)(t)&&(t=e),n.push(Object(a.createElement)("span",{key:e},e))})),Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-table-v-center"},Object(a.createElement)("span",null,!Object(o.isEmpty)(t)&&t),!Object(o.isEmpty)(n)&&n.length>1&&Object(a.createElement)("div",{className:"bwf-display-inline",onClick:function(e){e.preventDefault(),e.stopPropagation()}},Object(a.createElement)(me.a,{items:n}))))}return Object(o.isObject)(e)?Object(a.createElement)(a.Fragment,null):e}(fe)),we,J.list.hasOwnProperty(n.selected)&&J.list[n.selected].hasOwnProperty("analytics_mode")&&""!==J.list[n.selected].analytics_mode?Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle"},Object(a.createElement)(ue.a,{automationId:Q,analyticsId:ae,mode:J.list[n.selected].analytics_mode})):null)))))):Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer",onClick:function(){return j(!0)}},Object(l.__)("Not Configured","wp-marketing-automations"))),n.hasOwnProperty("selected")&&!Object(o.isEmpty)(n.selected)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-status"},Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},W?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,ce.hasOwnProperty("completed")?Object(f.xc)(parseInt(ce.completed)):0))),!W&&ce.hasOwnProperty("skipped")&&parseInt(ce.skipped)>0&&Object(a.createElement)("div",{className:"bwf-skipped-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Skipped","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count bwf-skipped-status"},Object(f.xc)(parseInt(ce.skipped)))),!W&&ce.hasOwnProperty("failed")&&parseInt(ce.failed)>0&&Object(a.createElement)("div",{className:"bwf-failed-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Failed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count bwf-failed-status"},Object(f.xc)(parseInt(ce.failed))))))),ne&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},X||Z?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return N(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){k(e.id,{option:"",position:"before"}),S(!0),P(t.target)}})))),Object(a.createElement)(r.d,{type:"source",isConnectable:!1,position:"bottom"}),Object(a.createElement)(A,{isOpen:p,onRequestClose:function(){return j(!1)},node:e,isEvent:!1,automationID:Q}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Action Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("action step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:y.onConfirm,isLoading:!1,onRequestClose:function(){return v({status:!1})},isOpen:y.status,isDelete:!0}))},ye=function(e){var t=Object(b.a)(),n=t.getEnableCopy,o=t.getEnableMove,c=t.getNodeDataByID,i=n(),s=o(),u=Object(m.a)(),f=u.copyNodeHere,d=u.setNodeForAdd,p=u.setOpenStepModal,O=u.setModalAnchorNode,j=c(e.id).hasMultiParents,w=void 0!==j&&j;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper"},w?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},i||s?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return f(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){d(e.id,{option:"",position:"before"}),p(!0),O(t.target)}})),Object(a.createElement)(r.d,{type:"source",position:"top",isConnectable:!1})):Object(a.createElement)(r.d,{type:"source",position:"top",isConnectable:!1}),Object(a.createElement)("div",{className:"bwf-node-content bwf-end"},Object(a.createElement)("div",{className:"bwf-node-content-item"},Object(l.__)("End Automation","wp-marketing-automations")))))};function ve(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return ge(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(ge(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ge(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,ge(m,"constructor",s),ge(s,"constructor",l),l.displayName="GeneratorFunction",ge(s,r,"GeneratorFunction"),ge(m),ge(m,r,"Generator"),ge(m,a,(function(){return this})),ge(m,"toString",(function(){return"[object Generator]"})),(ve=function(){return{w:o,m:b}})()}function ge(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(ge=function(e,t,n,a){function o(t,n){ge(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function _e(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ee(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ee(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var ke=function(e){var t=e.data,n=void 0===t?{}:t,c=e.selected,i=void 0!==c&&c,u=e.id,d=he(Object(a.useState)(!1),2),p=d[0],j=d[1],w=he(Object(a.useState)({status:!1,loading:!0}),2),y=w[0],v=w[1],g=Object(m.a)(),_=g.deleteNode,h=g.setAutomationData,E=g.showSidebar,k=g.setNodeForAdd,N=g.copyNodeHere,S=g.setOpenStepModal,P=g.setModalAnchorNode,C=Object(b.a)(),A=C.getGoals,T=C.getNodeDataByID,D=C.getEnableCopy,I=C.getEnableMove,M=C.getLastAddedNode,x=C.getAutomationData,F=C.getStatLoading,G=C.getStatData,L=A().list,z=M(),J=D(),$=I(),W=F(),Y=G();Object(a.useEffect)((function(){z==u&&(j(!0),h("lastAddedNode",0))}),[z]);var Q=x(),X=T(e.id),Z=X.hasMultiParents,K=void 0!==Z&&Z,ee=X.stepId,ne=X.step_status,ae=void 0===ne?1:ne,re=Q.ID,oe=Y.hasOwnProperty(ee)?Y[ee]:{},ce=n.desc_text,ie=void 0===ce?"":ce,le=q({onNodeClick:!!n&&!!n.benchmark&&function(){ee&&Object(V.l)({stepid:ee},"/"),h("sidebarNodeData",e),E(!0)},onNodeStatClick:function(){f.dc?(h("proModalContent",Object(l.__)("Goal Step","wp-marketing-automations")),h("showProModal",!0)):(h("showContactModalId",ee),h("showContactModalType","completed"))},onNodeQueuedStatClick:function(){f.dc?(h("proModalContent",Object(l.__)("Goal Step","wp-marketing-automations")),h("showProModal",!0)):(h("showContactModalId",ee),h("showContactModalType","queued"))},onNodeFailedStatClick:function(){f.dc?(h("proModalContent",Object(l.__)("Goal Step","wp-marketing-automations")),h("showProModal",!0)):(h("showContactModalId",ee),h("showContactModalType","failed"))}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":ee},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),f.dc?Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ae)?" bwf-draft-node":""),onClick:function(){h("proModalContent","Goal Step"),h("showProModal",!0)}},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(a.createElement)(s.a,{size:26,icon:"goal"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Goal","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"})),Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(a.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ae)?" bwf-draft-node":""),onClick:le},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(a.createElement)(s.a,{size:26,icon:"goal"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Goal","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},n.hasOwnProperty("benchmark")&&!Object(o.isEmpty)(n.benchmark)&&Object(a.createElement)(te,{node:e}),Object(a.createElement)(H.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!J&&!$),renderContent:function(t){var r=t.onToggle;return Object(a.createElement)(a.Fragment,null,n.hasOwnProperty("benchmark")&&!Object(o.isEmpty)(n.benchmark)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){Object(f.fc)()?(h("enableCopy",!0),h("copyData",{type:"benchmark",data:e.data})):(h("proModalContent",Object(l.__)("Copy Step","wp-marketing-automations")),h("showProModal",!0)),r()}},Object(a.createElement)(R.a,{justify:"space-between"},Object(a.createElement)(R.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(R.c,null,f.e))),Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){h("enableMove",!0),h("moveID",e.id),h("copyData",{type:"benchmark",data:e.data}),r()}},Object(a.createElement)(R.a,{justify:"flex-start"},Object(a.createElement)(R.c,null,Object(l.__)("Move","wp-marketing-automations"))))),Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){var t,n;v({status:!0,onConfirm:(t=ve().m((function t(){return ve().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,_(e).then((function(){return v({status:!1})}));case 1:return t.a(2)}}),t)})),n=function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function c(e){_e(o,a,r,c,i,"next",e)}function i(e){_e(o,a,r,c,i,"throw",e)}c(void 0)}))},function(){return n.apply(this,arguments)})}),r()}},Object(a.createElement)(R.a,{justify:"flex-start"},Object(a.createElement)(R.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),!n.hasOwnProperty("benchmark")||Object(o.isEmpty)(n.benchmark)?Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg",onClick:function(){return j(!0)}},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},L.hasOwnProperty(n.benchmark)&&L[n.benchmark].hasOwnProperty("source_label")?L[n.benchmark].source_label:""),Object(a.createElement)("div",{className:"bwf-node-content-label"},L.hasOwnProperty(n.benchmark)?L[n.benchmark].event_name:"Goal Not Found"),!Object(o.isEmpty)(ie)&&Object(a.createElement)("div",{className:"bwf-node-content-label bwf-node-desc"+(Object(o.isArray)(ie)?"":" bwf-two-line-ellipse-text")},function(e){if(Object(o.isEmpty)(e))return Object(a.createElement)(a.Fragment,null);if(Object(o.isArray)(e)){var t="",n=[];return e.map((function(e){Object(o.isEmpty)(t)&&(t=e),n.push(Object(a.createElement)("span",{key:e},e))})),Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-table-v-center"},Object(a.createElement)("span",null,!Object(o.isEmpty)(t)&&t),!Object(o.isEmpty)(n)&&n.length>1&&Object(a.createElement)("div",{className:"bwf-display-inline",onClick:function(e){e.preventDefault(),e.stopPropagation()}},Object(a.createElement)(me.a,{items:n}))))}return e}(ie)))))),!W&&Object(a.createElement)("div",{className:"bwf-node-status "+(Object(o.isEmpty)(n.benchmark)?"bwf-mt-0":"")},Object(a.createElement)("div",{className:"bwf-queued-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Queued","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},W?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,oe.hasOwnProperty("queued")?Object(f.xc)(parseInt(oe.queued)):0))),!Object(o.isEmpty)(n.benchmark)&&Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},W?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,oe.hasOwnProperty("completed")?Object(f.xc)(parseInt(oe.completed)):0))),oe.hasOwnProperty("failed")&&parseInt(oe.failed)>0&&Object(a.createElement)("div",{className:"bwf-failed-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Failed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count bwf-failed-status"},Object(f.xc)(parseInt(oe.failed)))))),K&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},J||$?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return N(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},"Paste Here")):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){k(e.id,{option:"",position:"before"}),S(!0),P(t.target)}})))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(a.createElement)(U,{isOpen:p,onRequestClose:function(){return j(!1)},node:e,automationID:re}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Goal Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("goal step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:y.onConfirm,isLoading:!1,onRequestClose:function(){return v({status:!1})},isOpen:y.status,isDelete:!0,deleteDescriptionText:Object(l.__)("Once you delete this step, all the queued contacts will move to next step right away.","wp-marketing-automations")}))},Ne=n(104),Se=n(10),Pe=n.n(Se);function Ce(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return Ae(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Ae(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ae(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,Ae(m,"constructor",s),Ae(s,"constructor",l),l.displayName="GeneratorFunction",Ae(s,r,"GeneratorFunction"),Ae(m),Ae(m,r,"Generator"),Ae(m,a,(function(){return this})),Ae(m,"toString",(function(){return"[object Generator]"})),(Ce=function(){return{w:o,m:b}})()}function Ae(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(Ae=function(e,t,n,a){function o(t,n){Ae(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function Te(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ie(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ie(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Me={1:Object(l.__)("Delay for a specific period","wp-marketing-automations"),2:Object(l.__)("Delay until a specific date and time","wp-marketing-automations"),3:Object(l.__)("Delay until a custom field date","wp-marketing-automations"),4:Object(l.__)("Delay with variable","wp-marketing-automations")},xe={1:Object(l.__)("Sun","wp-marketing-automations"),2:Object(l.__)("Mon","wp-marketing-automations"),3:Object(l.__)("Tue","wp-marketing-automations"),4:Object(l.__)("Wed","wp-marketing-automations"),5:Object(l.__)("Thu","wp-marketing-automations"),6:Object(l.__)("Fri","wp-marketing-automations"),7:Object(l.__)("Sat","wp-marketing-automations")},Fe=function(e){var t=e.data,n=e.selected,c=void 0!==n&&n,i=e.id,u=De(Object(a.useState)({status:!1,loading:!0}),2),d=u[0],p=u[1],j=Object(m.a)(),w=j.deleteNode,y=j.setAutomationData,v=j.showSidebar,g=j.setNodeForAdd,_=j.copyNodeHere,h=j.setOpenStepModal,E=j.setModalAnchorNode,k=j.fetchSplitPathNodes,N=Object(b.a)(),S=N.getNodeDataByID,P=N.getEnableCopy,C=N.getEnableMove,A=N.getLastAddedNode,T=N.getStatLoading,D=N.getStatData,I=A(),M=!Object(o.isEmpty)(t)&&t.hasOwnProperty("sidebarValues")?t.sidebarValues:{},x=M.type,F=void 0===x?0:x,G=M.data,L=void 0===G?{}:G,z=T(),U=D();Object(a.useEffect)((function(){I==i&&(y("sidebarNodeData",e),v(!0),y("lastAddedNode",0))}),[I]);var J=function(){switch(parseInt(F)){case 1:var e=L.day_delay,t=void 0===e?{}:e,n=L.enable_time_delay,r=void 0!==n&&n,c=L.enable_week_delay,i=void 0!==c&&c,s=L.time_delay,u=void 0===s?{time:""}:s,m=L.week_delay,b=void 0===m?[]:m;if(!Object(o.isEmpty)(t)){var f=Object(l.__)("Delay of","wp-marketing-automations")+" "+t.text+" "+function(e,t){switch(e){case"min":return parseInt(t)>1?Object(l.__)("Minutes","wp-marketing-automations"):Object(l.__)("Minute","wp-marketing-automations");case"hours":return parseInt(t)>1?Object(l.__)("Hours","wp-marketing-automations"):Object(l.__)("Hour","wp-marketing-automations");case"days":return parseInt(t)>1?Object(l.__)("Days","wp-marketing-automations"):Object(l.__)("Day","wp-marketing-automations");case"weeks":return parseInt(t)>1?Object(l.__)("Weeks","wp-marketing-automations"):Object(l.__)("Week","wp-marketing-automations");case"months":return parseInt(t)>1?Object(l.__)("Months","wp-marketing-automations"):Object(l.__)("Month","wp-marketing-automations");default:return""}}(t.unit,t.text),d=[];i&&!Object(o.isEmpty)(b)&&b.map((function(e){xe.hasOwnProperty(e)&&d.push(xe[e])}));var p=Object(o.isEmpty)(d)?Object(l.__)("Skip to next day if time has passed","wp-marketing-automations"):Object(l.__)("Skip to next occurrence if time has passed","wp-marketing-automations");return r&&u.hasOwnProperty("time")&&!Object(o.isEmpty)(u.time)?(f+=" till "+Object(Ne.format)(bwfcrm_contacts_data.time_format,Pe()(u.time,"HH:mm:ss")),Object(o.isEmpty)(d)||(f+=" "+d.join("/")),u.hasOwnProperty("in_contact_timezone")&&u.in_contact_timezone&&(f+=" ".concat(Object(l.__)("in Contact's Timezone","wp-marketing-automations"))),f+=". "+p):Object(o.isEmpty)(d)||(f+=" "+d.join("/"),f+=". "+p),f+"."}break;case 2:var O=L.date,j=void 0===O?"":O,w=L.time_delay,y=void 0===w?{time:"",in_contact_timezone:!1}:w,v=L.enable_step_skip,g=void 0!==v&&v,_=L.skip_to_step,h=void 0===_?{step:"",name:""}:_;if(!Object(o.isEmpty)(j)&&!Object(o.isEmpty)(y.time)){var E="",k="";if(y.hasOwnProperty("in_contact_timezone")&&y.in_contact_timezone?E+=" ".concat(Object(l.__)("in Contact's Timezone.","wp-marketing-automations")):E+=".",g&&!Object(o.isEmpty)(h)&&h.hasOwnProperty("step")&&""!=h.step&&h.hasOwnProperty("name")&&""!=h.name){var N=h.name.split(":");k=" ".concat(Object(l.__)("Jumps to","wp-marketing-automations")," ").concat(N[0]," ").concat(Object(l.__)("if time has passed","wp-marketing-automations"))}return Object(l.__)("Delay till ","wp-marketing-automations")+" "+Object(Ne.format)(bwfcrm_contacts_data.date_format,Pe()(j))+" "+Object(l.__)("at","wp-marketing-automations")+" "+Object(Ne.format)(bwfcrm_contacts_data.time_format,Pe()(y.time,"HH:mm:ss"))+" "+E+k}break;case 3:var S=L.custom_field,P=L.enable_time_delay,C=void 0!==P&&P,A=L.time_delay,T=L.enable_step_skip,D=void 0!==T&&T,I=L.skip_to_step,M=L.occurrence,x=void 0===M?"daymonth":M;if(S.hasOwnProperty("field")&&""!==S.field){var G=Object(l.__)("Delay","wp-marketing-automations");if(C?A.hasOwnProperty("duration")&&(G+=" ".concat(Object(l.__)("of","wp-marketing-automations")," ").concat(A.duration," ").concat(A.type," ").concat(A.timing," ")):G+=" ".concat(Object(l.__)("till","wp-marketing-automations")),S.hasOwnProperty("custom_field_label")&&""!==S.custom_field_label?G+=" ".concat(Object(l.__)("Contact's","wp-marketing-automations")," '").concat(S.custom_field_label,"' "):G+=" ".concat(Object(l.__)("Contacts","wp-marketing-automations")," ( ").concat(S.field," ) ").concat(Object(l.__)("field value","wp-marketing-automations")),"fulldatetime"!==x&&S.hasOwnProperty("time")&&""!==S.time&&(G+=" till ".concat(Object(Ne.format)(bwfcrm_contacts_data.time_format,Pe()(S.time,"HH:mm:ss")))),S.hasOwnProperty("in_contact_timezone")&&S.in_contact_timezone?G+=" ".concat(Object(l.__)("in Contact's Timezone.","wp-marketing-automations")):G+=".",D&&!Object(o.isEmpty)(I)&&I.hasOwnProperty("step")&&""!=I.step&&I.hasOwnProperty("name")&&""!=I.name){var z=I.name.split(":");G+=" ".concat(Object(l.__)("Jumps to","wp-marketing-automations")," ").concat(z[0]," ").concat(Object(l.__)("if time has passed","wp-marketing-automations"),".")}return G}break;case 4:var U=L.variable_field,q=L.enable_time_delay,B=void 0!==q&&q,R=L.time_delay,H=L.enable_step_skip,V=void 0!==H&&H,J=L.skip_to_step;if(U.hasOwnProperty("variable")&&""!==U.variable){var $=Object(l.__)("Delay","wp-marketing-automations");if(B?R.hasOwnProperty("duration")&&($+=" ".concat(Object(l.__)("of","wp-marketing-automations")," ").concat(R.duration," ").concat(R.type," ").concat(R.timing," ")):$+=" "+Object(l.__)("till","wp-marketing-automations"),U.hasOwnProperty("variable")&&""!==U.variable&&($+=" ".concat(Object(l.__)("Orders meta key","wp-marketing-automations")," ").concat(U.variable," value")),U.hasOwnProperty("time")&&""!==U.time&&($+=" till ".concat(Object(Ne.format)(bwfcrm_contacts_data.time_format,Pe()(U.time,"HH:mm:ss")))),U.hasOwnProperty("in_contact_timezone")&&U.in_contact_timezone?$+=" ".concat(Object(l.__)("in Contact's Timezone.","wp-marketing-automations")):$+=".",V&&!Object(o.isEmpty)(J)&&J.hasOwnProperty("step")&&""!=J.step&&J.hasOwnProperty("name")&&""!=J.name){var W=J.name.split(":");$+=" ".concat(Object(l.__)("Jumps to","wp-marketing-automations")," ").concat(W[0]," ").concat(Object(l.__)("if time has passed","wp-marketing-automations"),".")}return $}break;default:return Object(a.createElement)(a.Fragment,null)}return Object(a.createElement)(a.Fragment,null)},$=P(),W=C(),Y=S(e.id),Q=Y.hasMultiParents,X=void 0!==Q&&Q,Z=Y.stepId,K=Y.step_status,ee=void 0===K?1:K,ne=U.hasOwnProperty(Z)?U[Z]:{},ae=q({onNodeClick:function(){Z&&Object(V.l)({stepid:Z},"/"),y("sidebarNodeData",e),v(!0)},onNodeStatClick:function(){y("showContactModalId",Z),y("showContactModalType","completed")},onNodeQueuedStatClick:function(){y("showContactModalId",Z),y("showContactModalType","queued")},onNodeFailedStatClick:function(){y("showContactModalId",Z),y("showContactModalType","failed")}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":Z},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(c?"bwf-selected-node":"")+(2===parseInt(ee)?" bwf-draft-node":""),onClick:ae},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-delay"},Object(a.createElement)(s.a,{size:28,icon:"time-left"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+i),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Delay","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},Object(a.createElement)(te,{node:e}),Object(a.createElement)(H.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!$&&!W),renderContent:function(t){var n=t.onToggle,r=k();return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){Object(f.fc)()?(y("enableCopy",!0),y("copyData",{type:"wait",data:e.data})):(y("proModalContent",{featureTitle:Object(l.__)("Copy Step","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),y("showProModal",!0)),n()}},Object(a.createElement)(R.a,{justify:"space-between"},Object(a.createElement)(R.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(R.c,null,f.e))),!r.includes(i)&&Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){Object(f.fc)()?(y("enableMove",!0),y("moveID",e.id),y("copyData",{type:"wait",data:e.data})):(y("proModalContent",{featureTitle:Object(l.__)("Move Step","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),y("showProModal",!0)),n()}},Object(a.createElement)(R.a,{justify:"space-between"},Object(a.createElement)(R.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(R.c,null,f.e))),Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){var t,a;p({status:!0,onConfirm:(t=Ce().m((function t(){return Ce().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,w(e).then((function(){return p({status:!1})}));case 1:return t.a(2)}}),t)})),a=function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function c(e){Te(o,a,r,c,i,"next",e)}function i(e){Te(o,a,r,c,i,"throw",e)}c(void 0)}))},function(){return a.apply(this,arguments)})}),n()}},Object(a.createElement)(R.a,{justify:"flex-start"},Object(a.createElement)(R.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(o.isEmpty)(t)||!parseInt(F)>0?Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},Me.hasOwnProperty(F)&&Object(a.createElement)("div",{className:"bwf-node-content-type"},Me[F]),Object(a.createElement)("div",{className:"bwf-node-content-label bwf-two-line-ellipse-text",title:J()},J())))))),Object(a.createElement)("div",{className:"bwf-node-status "+(Object(o.isEmpty)(t)?"bwf-mt-0":"")},Object(a.createElement)("div",{className:"bwf-queued-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Queued","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},z?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,ne.hasOwnProperty("queued")?Object(f.xc)(parseInt(ne.queued)):0))),!Object(o.isEmpty)(t)&&Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},z?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,ne.hasOwnProperty("completed")?Object(f.xc)(parseInt(ne.completed)):0))),!z&&ne.hasOwnProperty("failed")&&parseInt(ne.failed)>0&&Object(a.createElement)("div",{className:"bwf-failed-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Failed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count bwf-failed-status"},Object(f.xc)(parseInt(ne.failed))))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1})),X&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},$||W?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return _(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){g(e.id,{option:"",position:"before"}),h(!0),E(t.target)}})))),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Delay Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("delay step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:d.onConfirm,isLoading:!1,onRequestClose:function(){return p({status:!1})},isOpen:d.status,isDelete:!0,deleteDescriptionText:Object(l.__)("Once you delete this step, all the queued contacts will move to next step right away.","wp-marketing-automations")}))},Ge=function(e){var t=Object(m.a)().deleteNode;return Object(a.createElement)("div",{className:e&&e.data&&e.data.direction&&"no"===e.data.direction?"bwf-yes-no-node  bwf-no-node":"bwf-yes-no-node bwf-yes-node"},Object(a.createElement)(r.d,{type:"target",position:"top",style:{opacity:0},isConnectable:!1}),Object(a.createElement)("span",{className:"bwf-yes-no-wrap"},e&&e.data&&e.data.direction&&"no"===e.data.direction?Object(l.__)("No","wp-marketing-automations"):Object(l.__)("Yes","wp-marketing-automations"),Object(a.createElement)("button",{style:{display:"none"},onClick:function(){return t(e)}},"del")),Object(a.createElement)(r.d,{type:"source",position:"bottom",style:{opacity:0},isConnectable:!1}))};function Le(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return ze(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(ze(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ze(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,ze(m,"constructor",s),ze(s,"constructor",l),l.displayName="GeneratorFunction",ze(s,r,"GeneratorFunction"),ze(m),ze(m,r,"Generator"),ze(m,a,(function(){return this})),ze(m,"toString",(function(){return"[object Generator]"})),(Le=function(){return{w:o,m:b}})()}function ze(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(ze=function(e,t,n,a){function o(t,n){ze(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function Ue(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Be(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Be(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Re=function(e){var t=e.selected,n=void 0!==t&&t,o=e.id,c=qe(Object(a.useState)({status:!1,loading:!0}),2),i=c[0],u=c[1],d=Object(m.a)(),p=d.deleteNode,j=d.setAutomationData,w=d.setNodeForAdd,y=d.copyNodeHere,v=d.setOpenStepModal,g=d.setModalAnchorNode,_=Object(b.a)(),h=_.getNodeDataByID,E=_.getEnableCopy,k=_.getEnableMove,N=_.getLastAddedNode,S=_.getStatLoading,P=_.getStatData,C=N(),A=E(),T=k(),D=S(),I=P();Object(a.useEffect)((function(){C==o&&j("lastAddedNode",0)}),[C]);var M=h(e.id),x=M.hasMultiParents,F=void 0!==x&&x,G=M.stepId,L=I.hasOwnProperty(G)?I[G]:{},z=q({onNodeStatClick:function(){j("showContactModalId",G),j("showContactModalType","completed")}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":G},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),f.dc?Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":""),onClick:function(){j("proModalContent","Exit Step"),j("showProModal",!0)}},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(a.createElement)(s.a,{size:26,icon:"exit"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+o),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Exit Automation","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"})),Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(a.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":""),onClick:z},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(a.createElement)(s.a,{size:26,icon:"exit"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+o),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Exit Automation","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},Object(a.createElement)(H.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!A&&!T),renderContent:function(t){var n=t.onToggle;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){var t,a;u({status:!0,onConfirm:(t=Le().m((function t(){return Le().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,p(e).then((function(){return u({status:!1})}));case 1:return t.a(2)}}),t)})),a=function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function c(e){Ue(o,a,r,c,i,"next",e)}function i(e){Ue(o,a,r,c,i,"throw",e)}c(void 0)}))},function(){return a.apply(this,arguments)})}),n()}},Object(a.createElement)(R.a,{justify:"flex-start"},Object(a.createElement)(R.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(a.createElement)("div",{className:"bwf-node-status"},Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},D?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,L.hasOwnProperty("completed")?Object(f.xc)(parseInt(L.completed)):0))))),F&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},A||T?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return y(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"}))):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){w(e.id,{option:"",position:"before"}),v(!0),g(t.target)}})))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Exit Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("exit step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:i.onConfirm,isLoading:!1,onRequestClose:function(){return u({status:!1})},isOpen:i.status,isDelete:!0}))};function He(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return Ve(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Ve(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ve(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,Ve(m,"constructor",s),Ve(s,"constructor",l),l.displayName="GeneratorFunction",Ve(s,r,"GeneratorFunction"),Ve(m),Ve(m,r,"Generator"),Ve(m,a,(function(){return this})),Ve(m,"toString",(function(){return"[object Generator]"})),(He=function(){return{w:o,m:b}})()}function Ve(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(Ve=function(e,t,n,a){function o(t,n){Ve(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function Je(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function $e(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){Je(o,a,r,c,i,"next",e)}function i(e){Je(o,a,r,c,i,"throw",e)}c(void 0)}))}}function We(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ye(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ye(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Qe=function(e){var t=e.data,n=void 0===t?{}:t,c=e.selected,i=void 0!==c&&c,u=e.id,d=We(Object(a.useState)({status:!1,loading:!0}),2),p=d[0],j=d[1],w=Object(m.a)(),y=w.deleteNode,v=w.setAutomationData,g=w.setNodeForAdd,_=w.copyNodeHere,h=w.setOpenStepModal,E=w.setModalAnchorNode,k=w.showSidebar,N=Object(b.a)(),S=N.getNodeDataByID,P=N.getEnableCopy,C=N.getEnableMove,A=N.getLastAddedNode,T=N.getStatLoading,D=N.getStatData,I=A(),M=P(),x=C(),F=T(),G=D();Object(a.useEffect)((function(){I==u&&v("lastAddedNode",0)}),[I]);var L=(!Object(o.isEmpty)(n)&&n.hasOwnProperty("sidebarValues")?n.sidebarValues:{}).jump_to,z=void 0===L?{}:L,U=z.name,J=void 0===U?"":U,$=z.step,W=void 0===$?"":$,Y=S(e.id),Q=Y.hasMultiParents,X=void 0!==Q&&Q,Z=Y.stepId,K=G.hasOwnProperty(Z)?G[Z]:{},ee=q({onNodeClick:function(){Z&&Object(V.l)({stepid:Z},"/"),v("sidebarNodeData",e),k(!0)},onNodeStatClick:function(){Object(f.fc)()?(v("showContactModalId",Z),v("showContactModalType","completed")):(v("proModalContent","Jump Step"),v("showProModal",!0))}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":Z},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),f.dc?Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":""),onClick:function(){v("proModalContent","Jump Step"),v("showProModal",!0)}},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(a.createElement)(s.a,{size:26,icon:"jump"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Jump","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"})),Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(a.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":""),onClick:ee},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(a.createElement)(s.a,{size:26,icon:"jump"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Jump","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},Object(a.createElement)(H.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!M&&!x),renderContent:function(t){var n=t.onToggle;return Object(a.createElement)(a.Fragment,null,""!=W&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){Object(f.fc)()?(v("enableCopy",!0),v("copyData",{type:"jump",data:e.data})):(v("proModalContent","Copy Step"),v("showProModal",!0)),n()}},Object(a.createElement)(R.a,{justify:"space-between"},Object(a.createElement)(R.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(R.c,null,f.e))),Object(a.createElement)(B.a,{isClickable:!0,onInvoke:$e(He().m((function t(){return He().w((function(t){for(;;)switch(t.n){case 0:Object(f.fc)()?(v("enableMove",!0),v("moveID",e.id),v("copyData",{type:"jump",data:e.data})):(v("proModalContent","Move Step"),v("showProModal",!0)),n();case 1:return t.a(2)}}),t)})))},Object(a.createElement)(R.a,{justify:"space-between"},Object(a.createElement)(R.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(R.c,null,f.e)))),Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){var t;j({status:!0,onConfirm:(t=$e(He().m((function t(){return He().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,y(e).then((function(){return j({status:!1})}));case 1:return t.a(2)}}),t)}))),function(){return t.apply(this,arguments)})}),n()}},Object(a.createElement)(R.a,{justify:"flex-start"},Object(a.createElement)(R.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(o.isEmpty)(n)||Object(o.isEmpty)(z)||""==W?Object(a.createElement)("div",{className:"bwf-control-event-error no-padding"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Jump to","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf-node-content-label bwf-two-line-ellipse-text"},""!==J?J:"step #"+W))))),Object(a.createElement)("div",{className:"bwf-node-status"},Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},F?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,K.hasOwnProperty("completed")?Object(f.xc)(parseInt(K.completed)):0))))),X&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},M||x?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return _(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"}))):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){g(e.id,{option:"",position:"before"}),h(!0),E(t.target)}})))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Jump Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("jump step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:p.onConfirm,isLoading:!1,onRequestClose:function(){return j({status:!1})},isOpen:p.status,isDelete:!0}))};function Xe(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return Ze(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Ze(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ze(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,Ze(m,"constructor",s),Ze(s,"constructor",l),l.displayName="GeneratorFunction",Ze(s,r,"GeneratorFunction"),Ze(m),Ze(m,r,"Generator"),Ze(m,a,(function(){return this})),Ze(m,"toString",(function(){return"[object Generator]"})),(Xe=function(){return{w:o,m:b}})()}function Ze(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(Ze=function(e,t,n,a){function o(t,n){Ze(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function Ke(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var nt=function(e){var t=e.selected,n=void 0!==t&&t,c=e.id,i=e.data,u=void 0===i?{}:i,d=et(Object(a.useState)({status:!1,loading:!0}),2),p=d[0],j=d[1],w=Object(m.a)(),y=w.deleteNode,v=w.setAutomationData,g=w.setNodeForAdd,_=w.copyNodeHere,h=w.setOpenStepModal,E=w.setModalAnchorNode,k=w.showSidebar,N=Object(b.a)(),S=N.getNodeDataByID,P=N.getEnableCopy,C=N.getEnableMove,A=N.getLastAddedNode,T=N.getStatLoading,D=N.getStatData,I=A(),M=P(),x=C(),F=T(),G=D();Object(a.useEffect)((function(){I==c&&v("lastAddedNode",0)}),[I]);var L=S(e.id),z=L.hasMultiParents,U=void 0!==z&&z,J=L.stepId,$=G.hasOwnProperty(J)?G[J]:{},W=!Object(o.isEmpty)(u)&&u.hasOwnProperty("sidebarValues")?u.sidebarValues:{},Y=W.split_path,Q=void 0===Y?"":Y,X=W.title,Z=void 0===X?"":X,K=W.desc,ee=void 0===K?"":K,ne=q({onNodeClick:function(){J&&Object(V.l)({stepid:J},"/"),v("sidebarNodeData",e),k(!0)},onNodeStatClick:function(){Object(f.fc)()?(v("showContactModalId",J),v("showContactModalType","completed"),v("contactModalData",{split:!0,pathCount:Q})):(v("proModalContent","Split Path Step"),v("showProModal",!0))},onAnalyticsClick:function(){}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":J},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),f.dc?Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":""),onClick:function(){v("proModalContent","Split Path Step"),v("showProModal",!0)}},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-split-test"},Object(a.createElement)(s.a,{size:26,icon:"split-test"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+c),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Split Path","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"})),Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(a.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":""),onClick:ne},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-split-test"},Object(a.createElement)(s.a,{size:26,icon:"split-test"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+c),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Split Path","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},Object(a.createElement)(te,{node:e}),Object(a.createElement)(H.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!M&&!x),renderContent:function(t){var n=t.onToggle;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){Object(f.fc)()?(v("enableMove",!0),v("moveID",e.id),v("copyData",{type:"split",data:e.data,id:e.id})):(v("proModalContent",Object(l.__)("Move Step","wp-marketing-automations")),v("showProModal",!0)),n()}},Object(a.createElement)(R.a,{justify:"space-between"},Object(a.createElement)(R.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(R.c,null,f.e))),Object(a.createElement)(B.a,{isClickable:!0,onInvoke:function(){var t,a;j({status:!0,onConfirm:(t=Xe().m((function t(){return Xe().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,y(e).then((function(){return j({status:!1})})).catch((function(e){j({status:!0,err:e.message})}));case 1:return t.a(2)}}),t)})),a=function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function c(e){Ke(o,a,r,c,i,"next",e)}function i(e){Ke(o,a,r,c,i,"throw",e)}c(void 0)}))},function(){return a.apply(this,arguments)})}),n()}},Object(a.createElement)(R.a,{justify:"flex-start"},Object(a.createElement)(R.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(o.isEmpty)(u)||Object(o.isEmpty)(Q)?Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick bwf-split-wrap"},Object(a.createElement)("div",{className:"bwf-step-content-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},""!==Z?Z:"-"),""!==ee&&Object(a.createElement)("div",{className:"bwf-node-content-label bwf-node-desc bwf-two-line-ellipse-text"},ee)),Object(a.createElement)("div",{className:"bwf-node-analytics bwf-split-path-analytics"},Object(a.createElement)("div",{className:"bwf-analytics-btn",onClick:function(){Object(f.fc)()?(v("declareWinner",{nodeId:c,stepID:J,title:Z}),v("showSplitWinner",!0)):(v("proModalContent",Object(l.__)("Split Step","wp-marketing-automations")),v("showProModal",!0))}},!Object(f.fc)()&&Object(a.createElement)(s.a,{icon:"king",size:14,color:"#fff"}),Object(l.__)("View Results","wp-marketing-automations")))))),Object(a.createElement)("div",{className:"bwf-node-status bwf-node-mt-10"},Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(a.createElement)("span",{className:"bwf-node-status-count"},F?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,$.hasOwnProperty("completed")?Object(f.xc)(parseInt($.completed)):0)))))),U&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},M||x?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return _(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"}))):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){g(e.id,{option:"",position:"before"}),h(!0),E(t.target)}})))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Split Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("split step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:p.onConfirm,isLoading:!1,onRequestClose:function(){return j({status:!1})},isOpen:p.status,isDelete:!0,showSupportLink:!0,errorMessage:null==p?void 0:p.err}))},at=function(e){var t=e.data,n=void 0===t?{}:t,o=e.id,c=Object(b.a)().getNodeDataByID,i=Object(m.a)().deleteNode,s=c(o).stepId,u=Object(f.Uc)(),d=n.path,p=void 0===d?"1":d;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-splitpath-node-wrapper","data-stepid":s},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(a.createElement)("div",{className:"bwf-split-node split-path-"+p},Object(l.__)("Path","wp-marketing-automations")+" "+u[p],Object(a.createElement)("button",{style:{display:"none"},onClick:function(){return i(e)}},"del"))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}))},rt=(n(1233),n(88)),ot=n(115),ct=n(370),it=n(22);n(1234);function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=lt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=lt(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==lt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ft(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ft(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var dt=function(e){var t=Object(a.useRef)(null),n=e.mergetag,r=e.copyTagToClipBoard,c=e.automationId,s=bt(Object(a.useState)({}),2),m=s[0],b=s[1],f=bt(Object(a.useState)({}),2),d=f[0],p=f[1],O=bt(Object(a.useState)({}),2),j=O[0],w=O[1],y=n.schema,v=void 0===y?[]:y,g=n.tag_name,_=void 0===g?"":g,h=n.default_val,E=void 0===h?[]:h;Object(a.useEffect)((function(){var e={},t={};v.map((function(n){e[n.id]=n.type,t[n.id]=n})),p(e),w(t)}),[v]);var k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,a=t.fields,r=t.relation,o=void 0===r?"OR":r;o=o.toUpperCase();try{var c=null;if("OR"===o){if(a&&Array.isArray(a))for(var i=0;i<a.length;i++){c=e[a[i].id];var l=void 0===a[i].value||a[i].value;if(""!=l&&c==l||""==l&&""!=c&&null!=c)return!0}}else"AND"==o&&a&&Array.isArray(a)&&(n=a.every((function(t){c=e[t.id];var n=void 0===t.value||t.value;return(""===n||c==n)&&(""!=n||""!=c&&null!=c)})))}catch(e){console.log(e)}return n},N=Object(a.useMemo)((function(){var e=["{{"+_];if(!Object(o.isEmpty)(m))if("cart_recovery_link"===_){var t=m.coupon_type,n=void 0===t?"static":t,a=m.dynamic_coupon,r=void 0===a?"":a,c=m.static_coupon,i=void 0===c?"":c;"static"===n&&""!==i?e.push("coupon='"+i+"'"):"dynamic"===n&&""!==r&&e.push("coupon='"+r+"'")}else Object.entries(m).map((function(t){var n=bt(t,2),a=n[0],r=n[1];if(!j[a].hasOwnProperty("toggler")||Object(o.isEmpty)(j[a].toggler)||k(m,j[a].toggler,j[a]))if("search"!=d[a]||Object(o.isEmpty)(r))""!==r&&e.push(a+"='"+r+"'");else{var c=[];r.map((function(e){c.push(e.id)})),e.push(a+"='"+c.join(",")+"'")}}));return e.join(" ")+"}}"}),[m]);return Object(a.createElement)("div",{className:"bwf-merge-tag-wrap bwf_w_full"},Object(a.createElement)(rt.a,{onChange:function(e){!function(e){var t=ut(ut({},E),m);t[e.name]=e.value,b(t)}(e)},initialValues:ut(ut({},E),m),validate:function(){return!1}},(function(e){var n=e.getInputProps,r=e.values;e.errors,e.handleSubmit;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_content",ref:t},Object(a.createElement)("div",null,v.map((function(e,t){return Object(a.createElement)(a.Fragment,{key:t},(Object(o.isEmpty)(e.toggler)||k(r,e.toggler,e))&&e.wrap_before&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(a.createElement)(a.Fragment,null,!1!==e.show&&(Object(o.isEmpty)(e.toggler)||k(r,e.toggler,e))&&Object(a.createElement)(ot.a,{input:e,formProps:n(e.id),values:r,automationId:c})):e.hint?Object(a.createElement)(a.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(o.isEmpty)(e.toggler)||k(r,e.toggler,e))&&e.wrap_after&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))))})),Object(a.createElement)("div",{className:"bwf-merge-tag-config-view"},Object(a.createElement)("span",{className:"bwf-merge-tag"},N),Object(a.createElement)("div",{className:"bwf-display-flex bwf-j-end"},Object(a.createElement)(u.Button,{isPrimary:!0,onClick:function(){r(N)},disabled:(v.map((function(e){if(e.hasOwnProperty("required")&&e.required&&(!m.hasOwnProperty(e.id)||""===m[e.id]))return!1})),!(""!==N))},Object(l.__)("Copy","wp-marketing-automations")))))},pt=n(167);function Ot(e){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){yt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Ot(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=Ot(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ot(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return gt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var _t=function(e){var t=Object(a.useContext)(f.h),n=Object(a.useContext)(pt.a).setSelectedMergeTag,r=e.isOpen,c=e.onRequestClose,m=e.automationID,d=vt(Object(a.useState)(""),2),p=d[0],O=d[1],j=vt(Object(a.useState)(""),2),w=j[0],y=j[1],v=vt(Object(a.useState)({}),2),g=v[0],_=v[1],h=(0,Object(b.a)().getMergeTagList)();Object(a.useEffect)((function(){r||(_({}),O(""),Object(o.isEmpty)(h)||y(Object.keys(h)[0]))}),[r]);var E=function(){c&&c()},k=function(e){n(e);var a=document.createElement("textarea");a.value=e,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),t(Object(l.__)("Merge tag copied.","wp-marketing-automations")),Object(f.Pb)(t,3e3),E()},N=function(){var e,t=(e={},Object.entries(h).map((function(t){var n=vt(t,2),a=n[0],r=n[1];""!==w?w==a&&(e=r):""!==p?Object.entries(r).map((function(t){var n=vt(t,2),a=n[0],r=n[1];(a.includes(p)||r.hasOwnProperty("tag_name")&&r.tag_name.includes(p))&&(e[a]=r)})):e=wt(wt({},e),r)})),Object.values(e).sort((function(e,t){return e.priority-t.priority})));return Object(o.isEmpty)(t)?Object(a.createElement)("tr",null,Object(a.createElement)("td",{className:"bwf-no-merge-tag"},Object(l.__)("No Merge Tag Available","wp-marketing-automations"))):Object(a.createElement)(a.Fragment,null,Object.entries(t).map((function(e,t){var n=vt(e,2),r=(n[0],n[1]);return Object(a.createElement)("tr",{key:"row"+t},Object(a.createElement)("td",null,Object(a.createElement)("span",{className:"bwf-tag-label"},r.tag_description)),Object(a.createElement)("td",null,Object(a.createElement)("span",{className:"bwf-tag-slug"},"{{"+r.tag_name+"}}")),Object(a.createElement)("td",null,r.hasOwnProperty("schema")?Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return _(r)},title:Object(l.__)("Configure","wp-marketing-automations")},Object(a.createElement)(s.a,{color:"#353030",icon:"settings"})):Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return k("{{"+r.tag_name+"}}")},title:Object(l.__)("Copy","wp-marketing-automations")},Object(a.createElement)(s.a,{color:"#353030",icon:"duplicate"}))))})))};return r?Object(a.createElement)(u.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-event-search-modal__merge-tag bwf-admin-modal-xl",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(a.createElement)("div",{className:"bwf-modal-search-header"},Object(a.createElement)("div",{className:"bwf-modal-title"},Object(o.isEmpty)(g)?Object(l.__)("Merge Tags","wp-marketing-automations"):Object(a.createElement)("div",{className:"bwf-display-flex"},Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){_({})}},Object(a.createElement)(s.a,{icon:Object(l.isRTL)()?"arrow-right":"arrow-left"})),g.hasOwnProperty("tag_description")?g.tag_description:"")),Object(a.createElement)("div",{className:"bwf-modal-search-wrap"},Object(o.isEmpty)(g)&&Object(a.createElement)("div",{className:"bwf-component-search-control"},Object(a.createElement)(s.a,{icon:"search",size:15}),Object(a.createElement)(u.TextControl,{value:p,onChange:function(e){""===e?Object(o.isEmpty)(h)||y(Object.keys(h)[0]):y(""),O(e)},placeholder:Object(l.__)("Search by name","wp-marketing-automations")}))),Object(a.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:E},Object(a.createElement)(s.a,{icon:"close",size:20}))),Object(a.createElement)("div",{className:"bwf-event-modal-main"},Object(a.createElement)("div",{className:"bwf-event-modal-body bwf-merge-modal-content"+(Object(o.isEmpty)(g)&&!Object(o.isEmpty)(h)?"":" gridfull")},Object(o.isEmpty)(g)?Object(o.isEmpty)(h)?Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},Object(a.createElement)("div",{className:"bwf-merge-tag-list"},Object(a.createElement)("div",{className:"bwf-no-merge-tag"},Object(l.__)("No Merge Tag Available","wp-marketing-automations"))))))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-modal-sidebar"},Object(a.createElement)("div",{className:"bwf-modal-filter-wrap"},Object.keys(h).map((function(e){return Object(a.createElement)("div",{key:e,className:i()("bwf-modal-filter",{active:w===e}),onClick:function(){O(""),y(e)}},e)})))),Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},Object(a.createElement)("div",{className:"bwf-merge-tag-list"},Object(a.createElement)("table",null,Object(a.createElement)("tbody",null,N())))))))):Object(a.createElement)(dt,{mergetag:g,copyTagToClipBoard:k,automationId:m})))):""};function ht(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return Et(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Et(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Et(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,Et(m,"constructor",s),Et(s,"constructor",l),l.displayName="GeneratorFunction",Et(s,r,"GeneratorFunction"),Et(m),Et(m,r,"Generator"),Et(m,a,(function(){return this})),Et(m,"toString",(function(){return"[object Generator]"})),(ht=function(){return{w:o,m:b}})()}function Et(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(Et=function(e,t,n,a){function o(t,n){Et(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(n),!0).forEach((function(t){St(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function St(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=At(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=At(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==At(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pt(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function Ct(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){Pt(o,a,r,c,i,"next",e)}function i(e){Pt(o,a,r,c,i,"throw",e)}c(void 0)}))}}function At(e){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Dt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var It=function(){var e=Object(a.useContext)(f.h),t=Object(b.a)(),n=t.getSidebarNodeData,r=t.getSelectedSidebarData,c=t.getAutomationId,u=t.getNodeDataByID,d=t.getAutomationData,O=(0,t.getautomationMeta)(),w=Object(m.a)(),v=w.showSidebar,g=w.setNodeDatabyId,_=w.setAutomationData,h=d().event,E=void 0===h?"":h,k=c(),N=Object(a.useRef)(null),S=Tt(Object(a.useState)(!1),2),P=S[0],C=S[1],A=Tt(Object(a.useState)(""),2),T=A[0],D=A[1],I=Tt(Object(a.useState)(!1),2),M=I[0],x=I[1],F=Tt(Object(a.useState)(!1),2),G=F[0],L=F[1],z=Tt(Object(a.useState)([]),2),U=z[0],q=z[1],B=Tt(Object(a.useState)(!1),2),R=B[0],H=B[1],V=Tt(Object(a.useState)(!1),2),J=V[0],$=V[1],W=n(),Y=Tt(Object(a.useState)(!1),2),Q=Y[0],X=Y[1],Z=!Object(o.isEmpty)(W)&&W.hasOwnProperty("data")?W.data:{},K=Object(o.isEmpty)(W)?{}:r(W),ee=K.side_header,te=void 0===ee?[]:ee,ne=!Object(o.isEmpty)(Z)&&Z.hasOwnProperty("sidebarValues")?Z.sidebarValues:{},ae=Object(o.isEmpty)(K)?{}:K,re=ae.fields,oe=void 0===re?[]:re,ce=ae.default_values,ie=void 0===ce?{}:ce,le=!Object(o.isEmpty)(W)&&W.hasOwnProperty("id")?u(W.id):{},se=le.stepId,ue=void 0===se?0:se,me=le.data;(void 0===me?{}:me).sidebarValues;Object(a.useEffect)((function(){q([]),C(!1)}),[]);var be=function(e,t,n){var a=!1,r=t.fields,o=t.relation,c=void 0===o?"OR":o;c=c.toUpperCase();try{var i=null;if("OR"===c){if(r&&Array.isArray(r))for(var l=0;l<r.length;l++){i=e[r[l].id];var s=void 0===r[l].value||r[l].value;if(Array.isArray(s)&&s.includes(i))return!0;if(""!=s&&i==s||""==s&&""!=i&&null!=i)return!0}}else"AND"==c&&r&&Array.isArray(r)&&(a=r.every((function(t){i=e[t.id];var n=void 0===t.value||t.value;return!(!Array.isArray(n)||!n.includes(i))||(""===n||i==n)&&(""!=n||""!=i&&null!=i)})))}catch(e){console.log(e)}return a},fe=[];Object(o.isEmpty)(oe)||oe.forEach((function(e){e.hasOwnProperty("required")&&e.required&&fe.push(e)}));var de=function(e){var t=!1;return Object(o.isObject)(e)?Object.keys(e).map((function(n){["",void 0,null].includes(e[n])&&(t=!0)})):["",void 0,null].includes(e)&&(t=!0),t},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split(","),n=t.map((function(e){return!(!e.includes("{{")&&!e.includes("}}"))||Object(f.t)(e)}));return!n.includes(!1)},Oe=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={};return fe.map((function(a){if(a.hasOwnProperty("toggler")&&!Object(o.isEmpty)(a.toggler)&&!be(e,a.toggler))return!1;if((Array.isArray(e[a.id])&&0===e[a.id].length||""===e[a.id]||void 0===e[a.id])&&(n[a.id]=a.hasOwnProperty("errorMsg")?a.errorMsg:Object(l.__)("This is a required field.","wp-marketing-automations")),"custom_fields"===a.id&&e[a.id].map((function(e,t){!e.hasOwnProperty("field_value")||""===e.field_value||de(e.field_value)?n["field_value_"+t]=a.hasOwnProperty("errorMsg")?a.errorMsg:Object(l.__)("This is a required field.","wp-marketing-automations"):n.hasOwnProperty(a.id)&&delete n[a.id]})),"bwfan_email_data"===a.id)if(e.hasOwnProperty("bwfan_email_to")&&!Object(o.isEmpty)(e.bwfan_email_to)&&(pe(e.bwfan_email_to)||(n.bwfan_email_to=Object(l.__)("Please enter a valid email address.","wp-marketing-automations"))),e.hasOwnProperty("bwfan_email_data")){e.bwfan_email_data.hasOwnProperty("subject")&&""===e.bwfan_email_data.subject&&(n[a.id]="error");var r=Object(f.G)(),c=[],i=e.bwfan_email_data,s=!(!i.hasOwnProperty("data")||Object(o.isEmpty)(i.data)||!i.data.hasOwnProperty("isTransactional"))&&i.data.isTransactional,u="";i.hasOwnProperty("template")&&(u=i.template),u.includes("{{mail_footer}}")||(s||r.includes("unsubscribe_link")||u.includes("unsubscribe_link"))&&(s||r.includes("business_name")||u.includes("business_name"))&&(s||r.includes("business_address")||u.includes("business_address"))||(s||r.includes("unsubscribe_link")||u.includes("unsubscribe_link")||c.push("{{unsubscribe_link}}"),s||r.includes("business_name")||u.includes("business_name")||c.push("{{business_name}}"),s||r.includes("business_address")||u.includes("business_address")||c.push("{{business_address}}")),Object(o.isEmpty)(c)?D(""):(n[a.id]="error",t&&D(Object(l.__)("The required merge tags","wp-marketing-automations")+" "+c.join(", ")+(c.length>1?" are ":" is ")+" "+Object(l.__)("missing in the email body.","wp-marketing-automations")))}else n[a.id]="error";if("coupon_data"===a.id)if(e.hasOwnProperty(a.id)){var m=e[a.id],b=m.type,d=void 0===b?"new":b,p=m.coupon_id,O=void 0===p?{}:p,j=m.general,w=void 0===j?{}:j;("existing"===d&&(Object(o.isEmpty)(O)||!O.hasOwnProperty("key")||""===O.key)||"new"===d&&(Object(o.isEmpty)(w)||!w.hasOwnProperty("amount")||parseFloat(w.amount)<=0))&&(n[a.id]="error")}else n[a.id]="error";if("whatsapp_template_control"===a.type)if(e.hasOwnProperty(a.id)){var y=e[a.id].data,v=void 0===y?{}:y;!Object(o.isEmpty)(v)&&je(v)&&(n[a.id]="error")}else n[a.id]=Object(l.__)("This is required field.","wp-marketing-automations")})),t&&q(n),n},je=function(e){var t=!1;return Object.keys(e).forEach((function(n){""===e[n]||void 0===e[n]?t=!0:e[n]&&"object"===At(e[n])?t=t||je(e[n]):Array.isArray(e[n])&&(t=t||e[n].some((function(e){return je(e)})))})),t},we=function(){var t=Ct(ht().m((function t(n){var a,r,c,i,s,u=arguments;return ht().w((function(t){for(;;)switch(t.p=t.n){case 0:if(a=!(u.length>1&&void 0!==u[1])||u[1],r=[],r=a?Oe(n):[],!Object(o.isEmpty)(r)){t.n=5;break}return Z.sidebarValues=n,H(!0),t.p=1,c={data:{data:{sidebarData:n}}},a||Object(o.isEmpty)(K)||!K.hasOwnProperty("slug")||"wp_sendemail"!==K.slug||(i=Oe(n,!1),Object(o.isEmpty)(i)||(c.updateStatus=2)),t.n=2,p()({path:Object(f.C)("/automation/".concat(k,"/step/").concat(ue)),method:"POST",data:{content:JSON.stringify(c)}}).then((function(t){if(200!==t.code)throw Error(Object(f.w)(null==t?void 0:t.message));var n="";t.hasOwnProperty("result")&&t.result.hasOwnProperty("desc_text")&&!Object(o.isEmpty)(t.result.desc_text)&&(n=t.result.desc_text),g(W.id,Nt(Nt({},Z),{},{desc_text:n}),{step_status:c.hasOwnProperty("updateStatus")&&2===c.updateStatus?2:1}),t.hasOwnProperty("result")&&t.result.hasOwnProperty("meta")&&_("meta",Nt(Nt({},O),t.result.meta)),a&&(e(t.message),J||setTimeout((function(){v(!1)}),100)),H(!1),L(!1)})).catch((function(e){throw Error(Object(f.w)(null==e?void 0:e.message))}));case 2:t.n=4;break;case 3:t.p=3,s=t.v,_("modalData",{status:!0,modalTitle:Object(l.__)("Update Action","wp-marketing-automations"),error:null==s?void 0:s.message}),H(!1),L(!1);case 4:Object(f.Pb)(e,3e3),t.n=6;break;case 5:e(Object(l.__)("Validation failed. Please check the fields for error.","wp-marketing-automations")),Object(f.Pb)(e,3e3),L(!1);case 6:return t.a(2)}}),t,null,[[1,3]])})));return function(e){return t.apply(this,arguments)}}();return Object(a.createElement)(f.f.Provider,{value:{errorList:U,setErrorList:q,stepId:ue}},Object(a.createElement)(f.c.Provider,{value:{isOpenTags:P,setOpenTags:C,automationID:k}},Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-action"},Object(a.createElement)(s.a,{size:22,icon:"charge"})),Object(a.createElement)("div",{className:"wr_event_title"},K.hasOwnProperty("action_name")?K.action_name:""),Object(a.createElement)("div",{className:"wr_event_variant"},te.includes("link-trigger")&&Object(a.createElement)(ct.a,{canCreate:!0,isLinkTriggerOpen:Q,setLinkTriggerOpen:X,hideButton:!1}),te.includes("merge-tag")&&Object(a.createElement)("span",{onClick:function(){C(!0)},className:"bwf-cursor-pointer bwf-modal-icon-link-trigger",key:"merge-tag"},Object(a.createElement)(it.a,{icon:"merge-tag",iconSize:24,size:"auto",toolTipText:Object(a.createElement)("span",{className:"bwfan_tooltip_text bwf-w-120","data-position":"top"},Object(l.__)("Merge tags","wp-marketing-automations"))}))),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){v(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(o.isEmpty)(oe)?Object(a.createElement)("div",{className:"wr_content"},Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info"},Object(l.__)("No settings to configure.","wp-marketing-automations"))):Object(a.createElement)(rt.a,{onSubmit:function(){var e=Ct(ht().m((function e(t){var n,a=arguments;return ht().w((function(e){for(;;)switch(e.n){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],e.n=1,we(t,n);case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}(),initialValues:Nt(Nt({},ie),ne),validate:function(){return!1}},(function(e){var t,n=e.getInputProps,r=e.values,c=e.errors,s=e.handleSubmit;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:(t="wr_content wr-action_wrapper",K.hasOwnProperty("slug")&&(t=t+" wr_action_"+K.slug),t),ref:N},Object(a.createElement)("div",{className:"wr-action_content"},!Object(o.isEmpty)(K)&&K.hasOwnProperty("slug")&&"wp_sendemail"===K.slug&&""!==T&&Object(a.createElement)(y.a,{className:"bwf-error-notice",status:"error"},T),oe.map((function(e,t){return Object(a.createElement)(a.Fragment,{key:t},(Object(o.isEmpty)(e.toggler)||be(r,e.toggler))&&e.wrap_before&&Object(a.createElement)("div",{className:"bwf-w-100p",dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(a.createElement)(a.Fragment,null,!1!==e.show&&(Object(o.isEmpty)(e.toggler)||be(r,e.toggler))&&Object(a.createElement)(ot.a,{input:e,formProps:n(e.id),values:r,isOpenTemplate:M,setOpenTemplate:function(){Object(f.fc)()?x(!M):_("showProModal",!0)},automationId:k,automationEvent:E,setMergeTagModal:C,saveNodeDataOnSubmit:s})):e.hint?Object(a.createElement)(a.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(o.isEmpty)(e.toggler)||be(r,e.toggler))&&e.wrap_after&&Object(a.createElement)("div",{className:"bwf-w-100p",dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return v(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),!Object(o.isEmpty)(K)&&K.hasOwnProperty("slug")&&"wp_sendemail"===K.slug&&Object(a.createElement)(j.a,{isSecondary:!0,onClick:function(){$(!1),L(!0),setTimeout((function(){return s()}),100)},isBusy:G,disabled:Object.keys(c).length},Object(l.__)("Save & Close","wp-marketing-automations")),Object(a.createElement)(j.a,{isPrimary:!0,className:"bwf-no-ripple",onClick:function(){!Object(o.isEmpty)(K)&&K.hasOwnProperty("slug")&&"wp_sendemail"===K.slug&&$(!0),setTimeout((function(){return s()}),100)},isBusy:R&&!G},Object(l.__)("Save","wp-marketing-automations"))))})),Object(a.createElement)(_t,{isOpen:P,onRequestClose:C,automationID:k})))};n(1235);function Mt(e){return function(e){if(Array.isArray(e))return Gt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ft(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||Ft(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(e,t){if(e){if("string"==typeof e)return Gt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gt(e,t):void 0}}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Lt=function(e){var t=e.options,n=e.selected,r=e.setSelected,c=e.selectedContent,i=void 0===c?"":c,l=e.liteDummyData,u=void 0===l?[]:l,m=xt(Object(a.useState)([]),2),b=m[0],d=m[1];return Object(o.isEmpty)(t)?Object(a.createElement)(a.Fragment,null):Object(a.createElement)(a.Fragment,null,t.map((function(e,t){if(Object(o.isEmpty)(e)||!e.hasOwnProperty("value"))return!1;var c=e.value==n?"selected":"";return Object(a.createElement)("div",{className:"bwf-custom-radio-control",key:t},Object(a.createElement)("div",{className:"bwf-custom-radio-option",key:e.value,onClick:function(){return r(e.value)}},Object(a.createElement)("div",{className:"bwf-select-option-indicator "+c},e.hasOwnProperty("isProFeature")&&e.isProFeature&&!Object(f.fc)()?Object(a.createElement)(s.a,{icon:"king"}):Object(a.createElement)("div",{className:"bwf-option-mark-outer"},Object(a.createElement)("div",{className:"bwf-option-mark-inner"}))),Object(a.createElement)("div",{className:"bwf-select-option-info"},Object(a.createElement)("div",{className:"bwf-bold"},e.hasOwnProperty("label")?e.label:""),Object(a.createElement)("div",{className:"bwf-desc"},e.hasOwnProperty("desc")?e.desc:"")),e.hasOwnProperty("isProFeature")&&e.isProFeature&&!Object(f.fc)()&&Object(a.createElement)("a",{onClick:function(t){t.stopPropagation();var n=Mt(b);n.includes(e.value)?n.pop(e.value):n.push(e.value),d(n)},className:"bwf-no-underline bwf-cursor-pointer"},"Explore")),b.includes(e.value)&&u.hasOwnProperty(e.value)&&Object(a.createElement)(a.Fragment,null,u[e.value]),c&&Object(a.createElement)("div",{className:"bwf-option-content"},i))})))},zt=n(375),Ut=n(124);n(1236);function qt(e){return(qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bt(Object(n),!0).forEach((function(t){Ht(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ht(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=qt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=qt(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Jt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var $t=function(e){var t=Object(a.useRef)(null),n=e.mergetag,r=e.copyTagToClipBoard,c=e.automationId,s=Vt(Object(a.useState)({}),2),m=s[0],b=s[1],f=Vt(Object(a.useState)({}),2),d=f[0],p=f[1],O=n.schema,j=void 0===O?[]:O,w=n.tag_name,y=void 0===w?"":w,v=n.default_val,g=void 0===v?[]:v;Object(a.useEffect)((function(){var e=[];j.map((function(t){e[t.id]=t.type})),p(e)}),[j]);var _,h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,a=t.fields,r=t.relation,o=void 0===r?"OR":r;o=o.toUpperCase();try{var c=null;if("OR"===o){if(a&&Array.isArray(a))for(var i=0;i<a.length;i++){c=e[a[i].id];var l=void 0===a[i].value||a[i].value;if(""!=l&&c==l||""==l&&""!=c&&null!=c)return!0}}else"AND"==o&&a&&Array.isArray(a)&&(n=a.every((function(t){c=e[t.id];var n=void 0===t.value||t.value;return(""===n||c==n)&&(""!=n||""!=c&&null!=c)})))}catch(e){console.log(e)}return n},E=function(){var e=["{{"+y];if(!Object(o.isEmpty)(m))if("cart_recovery_link"===y){var t=m.coupon_type,n=void 0===t?"":t,a=m.dynamic_coupon,r=void 0===a?"":a,c=m.static_coupon,i=void 0===c?"":c;"static"===n&&""!==i?e.push("coupon='"+i+"'"):"dynamic"===n&&""!==r&&e.push("coupon='"+r+"'")}else Object.entries(m).map((function(t){var n=Vt(t,2),a=n[0],r=n[1];if("search"!=d[a]||Object(o.isEmpty)(r))""!==r&&e.push(a+"='"+r+"'");else{var c=[];r.map((function(e){c.push(e.id)})),e.push(a+"='"+c.join(",")+"'")}}));return e.join(" ")+"}}"},k=function(){var e=E();return j.map((function(t){!t.hasOwnProperty("required")||!t.required||m.hasOwnProperty(t.id)&&""!==m[t.id]||(e="")})),""!==e};return Object(a.createElement)("div",{className:"bwf-merge-tag-wrap bwf_w_full"},Object(a.createElement)(rt.a,{onChange:function(e){!function(e){var t=Rt({},m);t[e.name]=e.value,b(t)}(e)},initialValues:Rt(Rt({},g),m),validate:function(){return!1}},(function(e){var n=e.getInputProps,r=e.values;e.errors,e.handleSubmit;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_content",ref:t},Object(a.createElement)("div",null,j.map((function(e,t){return Object(a.createElement)(a.Fragment,{key:t},(Object(o.isEmpty)(e.toggler)||h(r,e.toggler,e))&&e.wrap_before&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(a.createElement)(a.Fragment,null,!1!==e.show&&(Object(o.isEmpty)(e.toggler)||h(r,e.toggler,e))&&Object(a.createElement)(ot.a,{input:e,formProps:n(e.id),values:r,automationId:c})):e.hint?Object(a.createElement)(a.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(o.isEmpty)(e.toggler)||h(r,e.toggler,e))&&e.wrap_after&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))))})),(_=E(),Object(a.createElement)("div",{className:"bwf-merge-tag-config-view"},Object(a.createElement)("span",{className:"bwf-merge-tag"},_),Object(a.createElement)("div",{className:"bwf-display-flex bwf-j-end"},Object(a.createElement)(u.Button,{isPrimary:!0,onClick:function(){r(_)},disabled:!k()},Object(l.__)("Select","wp-marketing-automations"))))))};function Wt(e){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(n),!0).forEach((function(t){Xt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Wt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=Wt(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Kt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var en=function(e){var t=Object(a.useContext)(pt.a).setSelectedMergeTag,n=e.isOpen,r=e.onRequestClose,c=e.automationID,m=e.onSelect,f=Zt(Object(a.useState)(""),2),d=f[0],p=f[1],O=Zt(Object(a.useState)(""),2),j=O[0],w=O[1],y=Zt(Object(a.useState)({}),2),v=y[0],g=y[1],_=(0,Object(b.a)().getDelayTagList)();Object(a.useEffect)((function(){n||(g({}),p(""),Object(o.isEmpty)(_)||w(Object.keys(_)[0]))}),[n]);var h=function(){r&&r()},E=function(e){t(e),m(e),h()},k=function(){var e,t=(e={},Object.entries(_).map((function(t){var n=Zt(t,2),a=n[0],r=n[1];""!==j?j==a&&(e=r):""!==d?Object.entries(r).map((function(t){var n=Zt(t,2),a=n[0],r=n[1];(a.includes(d)||r.hasOwnProperty("tag_name")&&r.tag_name.includes(d))&&(e[a]=r)})):e=Qt(Qt({},e),r)})),e);return Object(o.isEmpty)(t)?Object(a.createElement)("tr",null,Object(a.createElement)("td",{className:"bwf-no-merge-tag"},Object(l.__)("No Delay Tag Available","wp-marketing-automations"))):Object(a.createElement)(a.Fragment,null,Object.entries(t).map((function(e,t){var n=Zt(e,2),r=(n[0],n[1]);return Object(a.createElement)("tr",{key:"row"+t},Object(a.createElement)("td",null,Object(a.createElement)("span",{className:"bwf-tag-label"},r.tag_description)),Object(a.createElement)("td",null,Object(a.createElement)("span",{className:"bwf-tag-slug"},"{{"+r.tag_name+"}}")),Object(a.createElement)("td",null,r.hasOwnProperty("schema")?Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return g(r)},title:Object(l.__)("Configure","wp-marketing-automations")},Object(a.createElement)(s.a,{color:"#353030",icon:"settings"})):Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return E("{{"+r.tag_name+"}}")},title:Object(l.__)("Copy","wp-marketing-automations")},Object(a.createElement)(s.a,{color:"#353030",icon:"duplicate"}))))})))};return n?Object(a.createElement)(u.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-event-search-delay-tag bwf-admin-modal-xl bwf-overflow-remove",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(a.createElement)("div",{className:"bwf-modal-search-header"},Object(a.createElement)("div",{className:"bwf-modal-title"},Object(o.isEmpty)(v)?Object(l.__)("Delay Tags","wp-marketing-automations"):Object(a.createElement)("div",{className:"bwf-display-flex"},Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){g({})}},Object(a.createElement)(s.a,{icon:Object(l.isRTL)()?"arrow-right":"arrow-left"})),v.hasOwnProperty("tag_description")?v.tag_description:"")),Object(a.createElement)("div",{className:"bwf-modal-search-wrap"},Object(o.isEmpty)(v)&&Object(a.createElement)("div",{className:"bwf-component-search-control"},Object(a.createElement)(s.a,{icon:"search",size:15}),Object(a.createElement)(u.TextControl,{value:d,onChange:function(e){""===e?Object(o.isEmpty)(_)||w(Object.keys(_)[0]):w(""),p(e)},placeholder:Object(l.__)("Search by name","wp-marketing-automations")}))),Object(a.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:h},Object(a.createElement)(s.a,{icon:"close",size:20}))),Object(a.createElement)("div",{className:"bwf-event-modal-main"},Object(a.createElement)("div",{className:"bwf-event-modal-body bwf-merge-modal-content"+(Object(o.isEmpty)(v)&&!Object(o.isEmpty)(_)?"":" gridfull")},Object(o.isEmpty)(v)?Object(o.isEmpty)(_)?Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},Object(a.createElement)("div",{className:"bwf-merge-tag-list"},Object(a.createElement)("div",{className:"bwf-no-merge-tag"},Object(l.__)("No Delay Tag Available","wp-marketing-automations"))))))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-modal-sidebar"},Object(a.createElement)("div",{className:"bwf-modal-filter-wrap"},Object.keys(_).map((function(e){return Object(a.createElement)("div",{key:e,className:i()("bwf-modal-filter",{active:j===e}),onClick:function(){p(""),w(e)}},e)})))),Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},Object(a.createElement)("div",{className:"bwf-merge-tag-list"},Object(a.createElement)("table",null,Object(a.createElement)("tbody",null,k())))))))):Object(a.createElement)($t,{mergetag:v,copyTagToClipBoard:E,automationId:c})))):""},tn=n(44);function nn(e){return(nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function an(e){return function(e){if(Array.isArray(e))return dn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||fn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function on(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rn(Object(n),!0).forEach((function(t){cn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function cn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=nn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=nn(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==nn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ln(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return sn(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(sn(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,sn(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,sn(m,"constructor",s),sn(s,"constructor",l),l.displayName="GeneratorFunction",sn(s,r,"GeneratorFunction"),sn(m),sn(m,r,"Generator"),sn(m,a,(function(){return this})),sn(m,"toString",(function(){return"[object Generator]"})),(ln=function(){return{w:o,m:b}})()}function sn(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(sn=function(e,t,n,a){function o(t,n){sn(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function un(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function mn(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){un(o,a,r,c,i,"next",e)}function i(e){un(o,a,r,c,i,"throw",e)}c(void 0)}))}}function bn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||fn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fn(e,t){if(e){if("string"==typeof e)return dn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dn(e,t):void 0}}function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var pn=function(){var e=bn(Object(a.useState)({}),2),t=e[0],n=e[1],r=bn(Object(a.useState)({}),2),c=r[0],i=r[1],d=bn(Object(a.useState)(!0),2),O=d[0],w=d[1],y=bn(Object(a.useState)(!1),2),v=y[0],g=y[1],_=bn(Object(a.useState)(!1),2),h=_[0],E=_[1],k=Object(a.useContext)(f.h),N=Object(m.a)(),S=N.showSidebar,P=N.setNodeDatabyId,C=N.setAutomationData,A=N.fetchSplitPathNodes,T=bn(Object(a.useState)(!1),2),D=T[0],I=T[1],M=Object(b.a)(),x=M.getSidebarNodeData,F=M.getNodeDataByID,G=M.getAutomationId,L=M.getAutomationLinks,z=M.getAutomationSteps,U=M.getCount,q=M.getActionsList,B=M.getGoals,R=M.getDelayTagList,H=M.getautomationMeta,V=x(),J=G(),$=R(),W=z(),Y=L(),Q=U(),X=q(),Z=B(),K=H(),ee=A(),te=!Object(o.isEmpty)(V)&&V.hasOwnProperty("id")?F(V.id):{},ne=te.stepId,ae=void 0===ne?0:ne,re=te.data,oe=(void 0===re?{}:re).sidebarValues,ce=function(){var e=mn(ln().m((function e(){return ln().w((function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,p()({path:Object(f.C)("/fields/?type=7,8&all=true"),method:"GET"}).then((function(e){200===e.code&&(Object(o.isEmpty)(e.result)||i(e.result),w(!1))}));case 1:e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){Object(f.fc)()&&ce(),n({})}),[]);var ie=!Object(o.isEmpty)(V)&&V.hasOwnProperty("data")?V.data:{},le=!Object(o.isEmpty)(ie)&&ie.hasOwnProperty("sidebarValues")?ie.sidebarValues:{},se=bn(Object(a.useState)(1),2),ue=se[0],me=se[1],be=bn(Object(a.useState)({day_delay:{unit:"min",text:"0"}}),2),fe=be[0],de=be[1];Object(a.useEffect)((function(){le.hasOwnProperty("type")&&[1,2,3,4].includes(parseInt(le.type))&&me(parseInt(le.type)),le.hasOwnProperty("data")&&!Object(o.isEmpty)(le.data)&&de(le.data)}),[le]),Object(a.useEffect)((function(){if(!O){var e=on(on({},le),{},{type:ue,data:fe});Object(o.isEqual)(oe,e)||Object(o.isEmpty)(oe)?g(!1):g(!0)}}),[ue,fe]);var pe=function(e){var t=e.type,a=void 0===t?0:t,r=e.data,c=void 0===r?{}:r,i={};switch(parseInt(a)){case 1:var s=c.day_delay,u=void 0===s?{}:s,m=c.enable_time_delay,b=void 0!==m&&m,f=c.time_delay,d=void 0===f?{}:f,p=c.enable_week_delay,O=void 0!==p&&p,j=c.week_delay,w=void 0===j?[]:j;(Object(o.isEmpty)(u)||u.hasOwnProperty("text")&&""==u.text)&&(i.day_delay=Object(l.__)("Select a specific period.","wp-marketing-automations")),b?(Object(o.isEmpty)(d)||d.hasOwnProperty("time")&&Object(o.isEmpty)(d.time))&&(i.time_delay=Object(l.__)("Select a specific time of day.","wp-marketing-automations")):c.time_delay={},O?Object(o.isEmpty)(w)&&(i.week_delay=Object(l.__)("Select a specific day of the week.","wp-marketing-automations")):c.week_delay=[];break;case 2:var y=c.date,v=void 0===y?"":y,g=c.time_delay,_=void 0===g?{time:"10:00"}:g,h=c.enable_step_skip,E=void 0!==h&&h,k=c.skip_to_step,N=void 0===k?{}:k;Object(o.isEmpty)(v)&&(i.specific_date=Object(l.__)("Select a specific date.","wp-marketing-automations")),Object(o.isEmpty)(_.time)&&(i.specific_time=Object(l.__)("Select a specific time.","wp-marketing-automations")),!E||N.hasOwnProperty("step")&&""!=N.step||(i.specific_date_time_step=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"));break;case 3:var S=c.custom_field,P=void 0===S?{}:S,C=c.enable_step_skip,A=void 0!==C&&C,T=c.skip_to_step,D=void 0===T?{}:T;if(!P.hasOwnProperty("field")||0==parseInt(P.field)||isNaN(parseInt(P.field))){i.custom_field=Object(l.__)("Please select custom field.","wp-marketing-automations");break}!A||D.hasOwnProperty("step")&&""!=D.step||(i.custom_field=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"));break;case 4:var I=c.variable_field,M=void 0===I?{}:I,x=c.enable_step_skip,F=void 0!==x&&x,G=c.skip_to_step,L=void 0===G?{}:G;if(!M.hasOwnProperty("variable")||""==M.variable){i.variable=Object(l.__)("Please select a delay variable.","wp-marketing-automations");break}!F||L.hasOwnProperty("step")&&""!=L.step||(i.variable=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))}return!!Object(o.isEmpty)(i)||(n(i),!1)},Oe=function(){var e=mn(ln().m((function e(){var t,n,a,r;return ln().w((function(e){for(;;)switch(e.p=e.n){case 0:if(t=!1,n=on(on({},le),{},{type:ue,data:fe}),pe(n)){e.n=1;break}return e.a(2);case 1:if(!Object(o.isEqual)(oe,n)){e.n=2;break}return S(!1),e.a(2);case 2:return Object(o.isEmpty)(oe)||(t=!0),I(!0),a={data:{data:{sidebarData:n}},steps:Object(o.cloneDeep)(W).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:Y,count:Q,optionUpdated:t,actionType:1},e.p=3,e.n=4,p()({path:Object(f.C)("/automation/".concat(J,"/step/").concat(ae)),method:"POST",data:a}).then((function(e){if(200!==e.code)throw Error(Object(f.w)(null==e?void 0:e.message));k(e.message),P(V.id,on(on({},ie),{},{sidebarValues:n}),{step_status:1}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&C("meta",on(on({},K),e.result.meta)),setTimeout((function(){S(!1)}),100),I(!1)})).catch((function(e){throw Error(Object(f.w)(null==e?void 0:e.message))}));case 4:e.n=6;break;case 5:e.p=5,r=e.v,C("modalData",{status:!0,modalTitle:Object(l.__)("Update Delay","wp-marketing-automations"),error:null==r?void 0:r.message}),I(!1);case 6:Object(f.Pb)(k,3e3);case 7:return e.a(2)}}),e,null,[[3,5]])})));return function(){return e.apply(this,arguments)}}(),je=[{value:1,label:Object(l.__)("Delay for a specific period","wp-marketing-automations"),desc:Object(l.__)("Wait for a specified number of hours, days, or week before continuing","wp-marketing-automations"),isProFeature:!1},{value:2,label:Object(l.__)("Delay until a specific date and time","wp-marketing-automations"),desc:Object(l.__)("Set a specific date and time","wp-marketing-automations"),isProFeature:!0},{value:3,label:Object(l.__)("Delay until a custom field date","wp-marketing-automations"),desc:Object(l.__)("Choose from contacts custom field","wp-marketing-automations"),isProFeature:!0}];Object(o.isEmpty)($)||je.push({value:4,label:Object(l.__)("Delay with events variable","wp-marketing-automations"),desc:Object(l.__)("Choose from event field value","wp-marketing-automations"),isProFeature:!0});var we=[{value:"1",label:Object(l.__)("S","wp-marketing-automations")},{value:"2",label:Object(l.__)("M","wp-marketing-automations")},{value:"3",label:Object(l.__)("T","wp-marketing-automations")},{value:"4",label:Object(l.__)("W","wp-marketing-automations")},{value:"5",label:Object(l.__)("TH","wp-marketing-automations")},{value:"6",label:Object(l.__)("F","wp-marketing-automations")},{value:"7",label:Object(l.__)("SA","wp-marketing-automations")}],ye=function(e){return t.hasOwnProperty(e)},ve={1:Object(l.__)("Sun","wp-marketing-automations"),2:Object(l.__)("Mon","wp-marketing-automations"),3:Object(l.__)("Tue","wp-marketing-automations"),4:Object(l.__)("Wed","wp-marketing-automations"),5:Object(l.__)("Thu","wp-marketing-automations"),6:Object(l.__)("Fri","wp-marketing-automations"),7:Object(l.__)("Sat","wp-marketing-automations")},ge=function(){var e=fe.day_delay,t=void 0===e?{}:e,n=fe.enable_time_delay,a=void 0!==n&&n,r=fe.enable_week_delay,c=void 0!==r&&r,i=fe.time_delay,s=void 0===i?{time:"10:00"}:i,u=fe.week_delay,m=void 0===u?[]:u;if(!Object(o.isEmpty)(t)&&t.hasOwnProperty("unit")&&t.hasOwnProperty("text")&&!Object(o.isEmpty)(t.unit)&&!Object(o.isEmpty)(t.text)){var b=t.text+" "+function(e,t){switch(e){case"min":return parseInt(t)>1?Object(l.__)("Minutes","wp-marketing-automations"):Object(l.__)("Minute","wp-marketing-automations");case"hours":return parseInt(t)>1?Object(l.__)("Hours","wp-marketing-automations"):Object(l.__)("Hour","wp-marketing-automations");case"days":return parseInt(t)>1?Object(l.__)("Days","wp-marketing-automations"):Object(l.__)("Day","wp-marketing-automations");case"weeks":return parseInt(t)>1?Object(l.__)("Weeks","wp-marketing-automations"):Object(l.__)("Week","wp-marketing-automations");case"months":return parseInt(t)>1?Object(l.__)("Months","wp-marketing-automations"):Object(l.__)("Month","wp-marketing-automations");default:return""}}(t.unit,t.text),f=[];c&&!Object(o.isEmpty)(m)&&m.map((function(e){ve.hasOwnProperty(e)&&f.push(ve[e])}));var d=Object(o.isEmpty)(f)?Object(l.__)("Skip to next day if time has passed","wp-marketing-automations"):Object(l.__)("Skip to next occurrence if time has passed","wp-marketing-automations");return a&&s.hasOwnProperty("time")&&!Object(o.isEmpty)(s.time)?(b+=" "+Object(l.__)("till","wp-marketing-automations")+" "+Object(Ne.format)(bwfcrm_contacts_data.time_format,Pe()(s.time,"HH:mm:ss")),Object(o.isEmpty)(f)||(b+="  "+f.join("/")),s.hasOwnProperty("in_contact_timezone")&&s.in_contact_timezone&&(b+=" "+Object(l.__)("in Contact's Timezone","wp-marketing-automations")),b+=". "+d):Object(o.isEmpty)(f)||(b+="  "+f.join("/"),b+=". "+d),Object(l.__)("Delay of","wp-marketing-automations")+" "+b+"."}return""},_e=function(){var e=fe.date,t=void 0===e?"":e,n=fe.time_delay,a=void 0===n?{time:"10:00",in_contact_timezone:!1}:n,r=fe.enable_step_skip,c=void 0!==r&&r,i=fe.skip_to_step,s=void 0===i?{step:0,name:""}:i;if(!Object(o.isEmpty)(t)&&a.hasOwnProperty("time")&&!Object(o.isEmpty)(a.time)){var u=Object(l.__)("Delay till","wp-marketing-automations")+" ";if(u+=Object(f.kb)(t,!0,!1)+" ",a.hasOwnProperty("time")&&""!==a.time&&(u+="".concat(Object(l.__)("at","wp-marketing-automations")," ").concat(Object(Ne.format)(bwfcrm_contacts_data.time_format,Pe()(a.time,"HH:mm:ss")))),a.hasOwnProperty("in_contact_timezone")&&a.in_contact_timezone?u+=" ".concat(Object(l.__)("in Contact's Timezone","wp-marketing-automations"),". "):u+=".",c&&!Object(o.isEmpty)(s)&&s.hasOwnProperty("step")&&""!=s.step&&s.hasOwnProperty("name")&&""!=s.name){var m=s.name.split(":");u+=" ".concat(Object(l.__)("Jumps to","wp-marketing-automations")," ").concat(m[0]," ").concat(Object(l.__)("if time has passed","wp-marketing-automations"),".")}return u}return""},he={action:Object(l.__)("Action","wp-marketing-automations"),wait:Object(l.__)("Delay","wp-marketing-automations"),conditional:Object(l.__)("Conditional","wp-marketing-automations"),exit:Object(l.__)("Exit","wp-marketing-automations"),benchmark:Object(l.__)("Goal","wp-marketing-automations")},Ee=Object(a.useMemo)((function(){var e={stepsOptArr:[],stepsOptions:[{value:"",label:Object(l.__)("Select Step","wp-marketing-automations")}]};return Object(o.isEmpty)(W)||(W.map((function(t){var n=t.stepId,a=void 0===n?0:n,r=t.id,o=void 0===r?0:r;if(!["yesNoNode","end","jump","start","exit","split","splitpath"].includes(t.type)&&!e.stepsOptArr.hasOwnProperty(o)&&a!=ae&&!ee.includes(o)){var c=[Object(l.__)("Step","wp-marketing-automations")];c.push(o),he.hasOwnProperty(t.type)&&c.push(" : "+he[t.type]),"action"==t.type&&t.hasOwnProperty("data")&&X.list.hasOwnProperty(t.data.selected)&&X.list[t.data.selected].hasOwnProperty("action_name")&&(X.list[t.data.selected].hasOwnProperty("integration_nicename")?c.push(" - "+X.list[t.data.selected].integration_nicename+" : "):c.push(" - "),c.push(X.list[t.data.selected].action_name)),"benchmark"==t.type&&t.hasOwnProperty("data")&&Z.list.hasOwnProperty(t.data.benchmark)&&Z.list[t.data.benchmark].hasOwnProperty("event_name")&&(Z.list[t.data.benchmark].hasOwnProperty("source_label")&&c.push(Z.list[t.data.benchmark].source_label+" : "),c.push(Z.list[t.data.benchmark].event_name)),e.stepsOptArr[a]=c.join(" "),e.stepsOptions.push({value:a,label:c.join(" ")})}})),e.stepsOptArr.end=Object(l.__)("End Automation","wp-marketing-automations"),e.stepsOptions.push({value:"end",label:Object(l.__)("End Automation","wp-marketing-automations")})),e}),[W]),ke=bn(Object(a.useState)(!1),2),Se=ke[0],Ce=ke[1],Ae=bn(Object(a.useState)(!1),2),Te=Ae[0],De=Ae[1],Ie=function(){var e=fe.day_delay,n=void 0===e?{unit:"min",text:"0"}:e,r=fe.enable_time_delay,c=void 0!==r&&r,i=fe.time_delay,m=void 0===i?{time:"10:00",in_contact_timezone:!1}:i,b=fe.enable_week_delay,d=void 0!==b&&b,p=fe.week_delay,O=void 0===p?["sunday"]:p;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-delay-field "+(ye("day_delay")?"has-error":"")},Object(a.createElement)(zt.a,{units:[{value:"min",label:Object(l.__)("Minutes","wp-marketing-automations")},{value:"hours",label:Object(l.__)("Hours","wp-marketing-automations")},{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")},{value:"months",label:Object(l.__)("Months","wp-marketing-automations")}],onChange:function(e){de(on(on({},fe),{},{day_delay:e}))},value:n}),ye("day_delay")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.day_delay)),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(f.fc)()?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(tn.a,{checked:c,label:Object(l.__)("Delay until a specific time of day","wp-marketing-automations"),onChange:function(e){return de(on(on({},fe),{},{enable_time_delay:e}))}}),c&&Object(a.createElement)("div",{className:"bwf-delay-field "+(ye("time_delay")?"has-error":"")},Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("input",{type:"time",value:m.time,className:"bwf-w-150 bwf-h-36",onChange:function(e){de(on(on({},fe),{},{time_delay:on(on({},fe.time_delay),{},{time:e.target.value})}))}}),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-display-flex "+(Object(f.fc)()?"":"bwf-delay-no-pro")},Object(f.fc)()?Object(a.createElement)(tn.a,{checked:m.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){de(on(on({},fe),{},{time_delay:on(on({},fe.time_delay),{},{in_contact_timezone:e})}))}}):Object(a.createElement)("div",{className:"bwf-cursor-pointer no-color",onClick:function(){C("proModalContent",Object(l.__)("This","wp-marketing-automations")),C("showProModal",!0)}},Object(l.__)("In Contact Timezone","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(s.a,{icon:"king",size:16})))),ye("time_delay")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.time_delay))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start"},Object(a.createElement)(s.a,{icon:"king",size:16}),Object(l.__)("Delay until a specific time of day","wp-marketing-automations"),Object(a.createElement)("a",{onClick:function(){return Ce(!Se)},className:"bwf-no-underline bwf-cursor-pointer"},Object(l.__)("Explore","wp-marketing-automations"))),Se&&Object(a.createElement)("div",{className:"bwf-p-15 bwf-mtb-10 bwf-lite-restrict-section"},Object(a.createElement)(tn.a,{checked:!1,disabled:!0,label:Object(l.__)("Delay until a specific time of day","wp-marketing-automations")}),Object(a.createElement)("div",{className:"bwf-delay-field "},Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("input",{type:"time",value:"",disabled:!0,className:"bwf-w-150 bwf-h-36",onChange:function(){}}),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-display-flex "},Object(a.createElement)(tn.a,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(a.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(a.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(f.ib)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(f.fc)()?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(tn.a,{checked:d,label:Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),onChange:function(e){return de(on(on({},fe),{},{enable_week_delay:e}))}}),d&&Object(a.createElement)("div",{className:"bwf-delay-field "+(ye("week_delay")?"has-error":"")},Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)(u.ButtonGroup,null,we.map((function(e,t){return Object(a.createElement)(u.Button,{key:t,isPrimary:O.includes(e.value),isSecondary:!O.includes(e.value),onClick:function(){var t=an(O);t.includes(e.value)?t=t.filter((function(t){return t!==e.value})):t.push(e.value),de(on(on({},fe),{},{week_delay:t}))}},e.label)}))),ye("week_delay")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.week_delay))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start"},Object(a.createElement)(s.a,{icon:"king",size:16}),Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),Object(a.createElement)("a",{onClick:function(){return De(!Te)},className:"bwf-no-underline bwf-cursor-pointer"},Object(l.__)("Explore","wp-marketing-automations"))),Te&&Object(a.createElement)("div",{className:"bwf-p-15 bwf-mtb-10 bwf-lite-restrict-section"},Object(a.createElement)(tn.a,{checked:!1,disabled:!0,label:Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),onChange:function(){}}),Object(a.createElement)("div",{className:"bwf-delay-field "},Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)(u.ButtonGroup,null,we.map((function(e,t){return Object(a.createElement)(u.Button,{key:t,isPrimary:!1,isSecondary:!0,onClick:function(){},disabled:!0},e.label)})))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(a.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(a.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(f.ib)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))),!Object(o.isEmpty)(ge())&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info"},ge())))},Me=function(e){var t=Pe()().format("MM/DD/YYYY");return Pe()(t).isSameOrBefore(Pe()(e))},xe=function(){var e=fe.custom_field,t=void 0===e?{field:0,time:"10:00",in_contact_timezone:!1,custom_field_label:""}:e,n=fe.enable_time_delay,r=void 0!==n&&n,i=fe.time_delay,s=void 0===i?{duration:0,type:"days",timing:"after"}:i,m=fe.occurrence,b=void 0===m?"daymonth":m,d=fe.enable_step_skip,p=void 0!==d&&d,O=fe.skip_to_step,j=void 0===O?{step:0,name:""}:O,w=Ee.stepsOptArr,y=Ee.stepsOptions;if(Object(o.isEmpty)(c))return Object(a.createElement)(a.Fragment,null,Object(l.__)("No Custom Field with type Date found","wp-marketing-automations"));var v=[{value:"",label:Object(l.__)("Select Type","wp-marketing-automations")}];Object.keys(c).map((function(e){v.push({label:c[e].hasOwnProperty("name")?c[e].name:"",value:e})}));var g,_,h=function(){var e=fe.custom_field,t=void 0===e?{field:"",time:"10:00",in_contact_timezone:!1,custom_field_label:""}:e,n=fe.enable_time_delay,a=void 0!==n&&n,r=fe.time_delay,c=void 0===r?{duration:0,type:"days",timing:"after"}:r,i=fe.enable_step_skip,s=void 0!==i&&i,u=fe.skip_to_step,m=void 0===u?{step:0,name:""}:u,b=fe.occurrence,f=void 0===b?"daymonth":b;if(t.hasOwnProperty("field")&&""!==t.field){var d=Object(l.__)("Delay","wp-marketing-automations")+" ";if(a?c.hasOwnProperty("duration")&&(d+="".concat(Object(l.__)("of","wp-marketing-automations")," ").concat(c.duration," ").concat(c.type," ").concat(c.timing," ")):d+=Object(l.__)("till","wp-marketing-automations")+" ",t.hasOwnProperty("custom_field_label")&&""!==t.custom_field_label?d+=" ".concat(Object(l.__)("Contact's","wp-marketing-automations")," '").concat(t.custom_field_label,"' "):d+="".concat(Object(l.__)("Custom Field","wp-marketing-automations")," ( ").concat(t.field," )"),"fulldatetime"!==f&&t.hasOwnProperty("time")&&""!==t.time&&(d+=" ".concat(Object(l.__)("till","wp-marketing-automations")," ").concat(Object(Ne.format)(bwfcrm_contacts_data.time_format,Pe()(t.time,"HH:mm:ss")))),t.hasOwnProperty("in_contact_timezone")&&t.in_contact_timezone?d+=" ".concat(Object(l.__)("in Contact's Timezone","wp-marketing-automations"),". "):d+=".",s&&!Object(o.isEmpty)(m)&&m.hasOwnProperty("step")&&""!=m.step&&m.hasOwnProperty("name")&&""!=m.name){var p=m.name.split(":");d+=" ".concat(Object(l.__)("Jumps to","wp-marketing-automations")," ").concat(p[0]," ").concat(Object(l.__)("if time has passed","wp-marketing-automations"),".")}return d}return""}();return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(a.createElement)("div",{className:"bwf-delay-field-select bwf-w-210 "+(ye("custom_field")&&""==t.field?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:t.field,className:"bwf_W_full",options:v,onChange:function(e){if(e&&c.hasOwnProperty(e)){var t=Object(o.cloneDeep)(fe);t=on(on({},t),{},{custom_field:on(on({},t.custom_field),{},{field:e,custom_field_label:c[e].name})}),8==c[e].type?(t.occurrence="fulldatetime",t.time_delay=on(on({},t.time_delay),{},{type:"hours"})):(t.occurrence="daymonth",t.time_delay=on(on({},t.time_delay),{},{type:"days"})),de(on(on({},fe),t))}}}),ye("custom_field")&&""==t.field&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please select a custom field.","wp-marketing-automations")))),Object(a.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "+(ye("custom_field")&&""==b?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:b,className:"bwf_w_full",options:(g=(null==t?void 0:t.field)||0,_=[],c.hasOwnProperty(g)&&!Object(o.isEmpty)(c[g])&&c[g].hasOwnProperty("type")&&8===parseInt(c[g].type)&&(_=[{value:"fulldatetime",label:Object(l.__)("Use Full Date Time","wp-marketing-automations")}]),[].concat(an(_),[{value:"daymonth",label:Object(l.__)("Use Day & Month","wp-marketing-automations")},{value:"daymonthyear",label:Object(l.__)("Use Full Date","wp-marketing-automations")}])),onChange:function(e){return de(on(on({},fe),{},{occurrence:e}))}}))),Object(a.createElement)("div",{className:"bwf-sidebar-hint"},Object(l.__)("Note: Contact would not pass this step if the value of custom field is blank.","wp-marketing-automations"),"daymonth"===b&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("br",null),Object(l.__)("It will pick the day and month from the selected field value and if the time is older than the current time it will increase by one year.","wp-marketing-automations")),"fulldatetime"===b&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("br",null),Object(l.__)("It will pick the time, day and month from the selected field value and if the time is older than the current time it will increase by one year.","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},"fulldatetime"!==b&&Object(a.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(a.createElement)("input",{type:"time",value:t.time,className:"bwf-w-210 bwf-h-36",onChange:function(e){de(on(on({},fe),{},{custom_field:on(on({},fe.custom_field),{},{time:e.target.value})}))}})),Object(a.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(a.createElement)(tn.a,{checked:t.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){de(on(on({},fe),{},{custom_field:on(on({},fe.custom_field),{},{in_contact_timezone:e})}))}}))))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "+(Object(f.fc)()?"":"bwf-delay-no-pro")},Object(a.createElement)(tn.a,{checked:r,label:Object(l.__)("Delay for certain occurrence from field value","wp-marketing-automations"),onChange:function(e){Object(f.fc)()?de(on(on({},fe),{},{enable_time_delay:e})):(C("proModalContent",Object(l.__)("This","wp-marketing-automations")),C("showProModal",!0))}}))),r&&Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "+(ye("custom_field")&&parseInt(s.duration)<0?"has-error":"")},Object(a.createElement)(u.TextControl,{className:"bwf-h-36",type:"number",value:s.duration,onChange:function(e){return de(on(on({},fe),{},{time_delay:on(on({},fe.time_delay),{},{duration:e})}))},min:1,placeholder:Object(l.__)("Enter","wp-marketing-automations")})),Object(a.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(a.createElement)(u.SelectControl,{value:s.type,className:"bwf_w_full",options:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];return"fulldatetime"===e&&(t=[{value:"minutes",label:Object(l.__)("Minutes","wp-marketing-automations")},{value:"hours",label:Object(l.__)("Hours","wp-marketing-automations")}]),[].concat(an(t),[{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")}])}(b),onChange:function(e){return de(on(on({},fe),{},{time_delay:on(on({},fe.time_delay),{},{type:e})}))}})),Object(a.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(a.createElement)(u.SelectControl,{value:s.timing,className:"bwf_w_full",options:[{value:"before",label:Object(l.__)("Before","wp-marketing-automations")},{value:"after",label:Object(l.__)("After","wp-marketing-automations")}],onChange:function(e){return de(on(on({},fe),{},{time_delay:on(on({},fe.time_delay),{},{timing:e})}))}}))))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "+(Object(f.fc)()?"":"bwf-delay-no-pro")},Object(a.createElement)(tn.a,{checked:p,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(f.fc)()?de(on(on({},fe),{},{enable_step_skip:e})):(C("proModalContent",Object(l.__)("This","wp-marketing-automations")),C("showProModal",!0))}}))),p&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-delay-skip-step-select bwf-specific-date "+(ye("custom_field")&&""==j.step?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:j.step,className:"bwf_w_full",options:y,onChange:function(e){return de(on(on({},fe),{},{skip_to_step:on(on({},fe.skip_to_step),{},{step:e,name:w[e]})}))}}),ye("custom_field")&&""==j.step&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))))),""!==h&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info"},h)))},Fe=function(){var e=fe.variable_field,t=void 0===e?{variable:"",time:"10:00",in_contact_timezone:!1}:e,n=fe.enable_time_delay,r=void 0!==n&&n,c=fe.time_delay,i=void 0===c?{duration:0,type:"days",timing:"after"}:c,s=fe.occurrence,m=void 0===s?"daymonthyear":s,b=fe.enable_step_skip,d=void 0!==b&&b,p=fe.skip_to_step,O=void 0===p?{step:0,name:""}:p,j=Ee.stepsOptArr,w=Ee.stepsOptions,y=function(){var e=fe.variable_field,t=void 0===e?{variable:"",time:"10:00",in_contact_timezone:!1}:e,n=fe.enable_time_delay,a=void 0!==n&&n,r=fe.time_delay,c=void 0===r?{duration:0,type:"days",timing:"after"}:r,i=fe.occurrence,s=void 0===i?"daymonthyear":i,u=fe.enable_step_skip,m=void 0!==u&&u,b=fe.skip_to_step,f=void 0===b?{step:0,name:""}:b;if(t.hasOwnProperty("variable")&&""!==t.variable){var d=Object(l.__)("Delay","wp-marketing-automations")+" ";if(a?c.hasOwnProperty("duration")&&(d+="".concat(Object(l.__)("of","wp-marketing-automations")," ").concat(c.duration," ").concat(c.type," ").concat(c.timing," ")):d+=Object(l.__)("till","wp-marketing-automations")+" ",d+=" ".concat(Object(l.__)("Orders meta key","wp-marketing-automations")," ").concat(t.variable," value"),"fulldatetime"!==s&&t.hasOwnProperty("time")&&""!==t.time&&(d+=" ".concat(Object(l.__)("till","wp-marketing-automations")," ").concat(Object(Ne.format)(bwfcrm_contacts_data.time_format,Pe()(t.time,"HH:mm:ss")))),t.hasOwnProperty("in_contact_timezone")&&t.in_contact_timezone?d+=" ".concat(Object(l.__)("in Contact's Timezone","wp-marketing-automations"),". "):d+=".",m&&!Object(o.isEmpty)(f)&&f.hasOwnProperty("step")&&""!=f.step&&f.hasOwnProperty("name")&&""!=f.name){var p=f.name.split(":");d+=" ".concat(Object(l.__)("Jumps to","wp-marketing-automations")," ").concat(p[0]," ").concat(Object(l.__)("if time has passed","wp-marketing-automations"),".")}return d}return""}();return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(en,{isOpen:h,onRequestClose:E,automationID:J,onSelect:function(e){de(on(on({},fe),{},{variable_field:on(on({},fe.variable_field),{},{variable:e})}))}}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(a.createElement)("div",{className:"bwf-delay-field-select bwf-w-300 "+(ye("variable")&&""==t.variable?"has-error":""),onClick:function(){return E(!0)}},Object(a.createElement)(u.TextControl,{value:t.variable,disabled:!0}),ye("variable")&&""==t.variable&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please select a variable.","wp-marketing-automations")))),Object(a.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field ",onClick:function(){return E(!0)}},Object(a.createElement)(u.Button,{isSecondary:!0},Object(l.__)("Select","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "},Object(a.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "+(ye("variable")&&""==m?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:m,className:"bwf_w_full",options:[{value:"daymonth",label:Object(l.__)("Use Day & Month","wp-marketing-automations")},{value:"daymonthyear",label:Object(l.__)("Use Full Date","wp-marketing-automations")}],onChange:function(e){return de(on(on({},fe),{},{occurrence:e}))}})))),Object(a.createElement)("div",{className:"bwf-sidebar-hint"},Object(l.__)("Note: If key value is not present it will run immediately.","wp-marketing-automations"),"daymonth"===m&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("br",null),Object(l.__)("It will pick the day and month from the selected field value and if the time is older than the current time it will increase by one year.","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(a.createElement)("input",{type:"time",value:t.time,className:"bwf-w-210 bwf-h-36",onChange:function(e){de(on(on({},fe),{},{variable_field:on(on({},fe.variable_field),{},{time:e.target.value})}))}})),Object(a.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(a.createElement)(tn.a,{checked:t.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){de(on(on({},fe),{},{variable_field:on(on({},fe.variable_field),{},{in_contact_timezone:e})}))}}))))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "+(Object(f.fc)()?"":"bwf-delay-no-pro")},Object(a.createElement)(tn.a,{checked:r,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(e){Object(f.fc)()?de(on(on({},fe),{},{enable_time_delay:e})):(C("proModalContent",Object(l.__)("This","wp-marketing-automations")),C("showProModal",!0))}}))),r&&Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "+(ye("custom_field")&&parseInt(i.duration)<0?"has-error":"")},Object(a.createElement)(u.TextControl,{className:"bwf-h-36",type:"number",value:i.duration,onChange:function(e){return de(on(on({},fe),{},{time_delay:on(on({},fe.time_delay),{},{duration:e})}))},min:1,placeholder:Object(l.__)("Enter","wp-marketing-automations")})),Object(a.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(a.createElement)(u.SelectControl,{value:i.type,className:"bwf_w_full",options:[{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")}],onChange:function(e){return de(on(on({},fe),{},{time_delay:on(on({},fe.time_delay),{},{type:e})}))}})),Object(a.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(a.createElement)(u.SelectControl,{value:i.timing,className:"bwf_w_full",options:[{value:"before",label:Object(l.__)("Before","wp-marketing-automations")},{value:"after",label:Object(l.__)("After","wp-marketing-automations")}],onChange:function(e){return de(on(on({},fe),{},{time_delay:on(on({},fe.time_delay),{},{timing:e})}))}}))))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "+(Object(f.fc)()?"":"bwf-delay-no-pro")},Object(a.createElement)(tn.a,{checked:d,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(f.fc)()?de(on(on({},fe),{},{enable_step_skip:e})):(C("proModalContent",Object(l.__)("This","wp-marketing-automations")),C("showProModal",!0))}}))),d&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-delay-skip-step-select bwf-delay-field "+(ye("variable")&&""==O.step?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:O.step,className:"bwf_w_full",options:w,onChange:function(e){return de(on(on({},fe),{},{skip_to_step:on(on({},fe.skip_to_step),{},{step:e,name:j[e]})}))}}),ye("variable")&&""==O.step&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))))),""!==y&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info"},y)))};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-delay"},Object(a.createElement)(s.a,{size:28,icon:"time-left"})),Object(a.createElement)("div",{className:"wr_event_title"},Object(a.createElement)("span",null,Object(l.__)("Delay","wp-marketing-automations"))),Object(a.createElement)("div",{className:"wr_event_variant"}),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){S(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)("div",{className:"wr_content"},Object(a.createElement)("div",{className:"bwf-delay-wrap"},Object(a.createElement)(Lt,{selected:ue,setSelected:function(e){if(!Object(f.fc)()&&[2,3].includes(parseInt(e)))return C("proModalContent",Object(l.__)("This Type","wp-marketing-automations")),void C("showProModal",!0);de(function(e){switch(e){case 1:return{day_delay:{unit:"min",text:""},enable_time_delay:!1,time_delay:{time:"10:00",in_contact_timezone:!1},enable_week_delay:!1,week_delay:[]};case 2:return{date:"",time_delay:{time:"10:00",in_contact_timezone:!1},enable_step_skip:!1,skip_to_step:{step:0,name:""}};case 3:return{custom_field:{field:"",time:"10:00",in_contact_timezone:!1,custom_field_label:""},time_delay:{duration:0,type:"days",timing:"before"},occurrence:"daymonth",enable_step_skip:!1,skip_to_step:{step:0,name:""}};case 4:return{variable_field:{variable:"",time:"10:00",in_contact_timezone:!1},time_delay:{duration:0,type:"days",timing:"before"},occurrence:"daymonthyear",enable_step_skip:!1,skip_to_step:{step:0,name:""}};default:return{}}}(parseInt(e))),me(e)},options:je,selectedContent:function(){switch(parseInt(ue)){case 1:return Object(a.createElement)(a.Fragment,null,Ie());case 2:return Object(a.createElement)(a.Fragment,null,Object(f.fc)()?(e=fe.date,n=void 0===e?"":e,r=fe.time_delay,c=void 0===r?{time:"10:00",in_contact_timezone:!1}:r,i=fe.enable_step_skip,m=void 0!==i&&i,b=fe.skip_to_step,d=void 0===b?{step:0,name:""}:b,p=Ee.stepsOptArr,j=Ee.stepsOptions,Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-specific-date-time-delay"},Object(a.createElement)("div",{className:"bwf-specific-date bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-field "+(ye("specific_date")?"has-error":"")},Object(a.createElement)(Ut.a,{date:Object(o.isEmpty)(n)?null:Pe()(n),dateFormat:"MM/DD/YYYY",isInvalidDate:function(e){return!Me(e)},onUpdate:function(e){Me(e.text)?de(on(on({},fe),{},{date:e.text})):(k(Object(l.__)("Invalid Date selected","wp-marketing-automations")),Object(f.Pb)(k,3e3))},text:n,iconRight:!0}),ye("specific_date")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.specific_date))),Object(a.createElement)("div",{className:"bwf-specific-time bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-field "+(ye("specific_time")?"has-error":"")},Object(a.createElement)("input",{type:"time",value:c.time,onChange:function(e){de(on(on({},fe),{},{time_delay:on(on({},fe.time_delay),{},{time:e.target.value})}))},className:"bwf-h-36"}),ye("specific_time")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.specific_time))),Object(a.createElement)("div",{className:"bwf-specific-date bwf-w-210 "+(Object(f.fc)()?"":"bwf-delay-no-pro")},Object(f.fc)()?Object(a.createElement)(tn.a,{checked:c.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){de(on(on({},fe),{},{time_delay:on(on({},fe.time_delay),{},{in_contact_timezone:e})}))}}):Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){C("proModalContent",Object(l.__)("This","wp-marketing-automations")),C("showProModal",!0)}},Object(l.__)("In Contact TimeZone","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(s.a,{icon:"king",size:16}))),Object(a.createElement)("div",{className:"bwf-m-0 bwf-mt-16 bwf-single-automation-notice is-gray no-icon"},Object(a.createElement)("span",null,Object(l.__)("Current Store Time","wp-marketing-automations")+":"," "),Object(f.lb)(Pe()().tz("UTC"))),Object(a.createElement)("div",{className:"bwf_clear_16"}),Object(a.createElement)("div",{className:"bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "+(Object(f.fc)()?"":"bwf-delay-no-pro")},Object(a.createElement)(tn.a,{checked:m,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(f.fc)()?de(on(on({},fe),{},{enable_step_skip:e})):(C("proModalContent",Object(l.__)("This","wp-marketing-automations")),C("showProModal",!0))}}))),m&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-specific-date "+(ye("specific_date_time_step")?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:d.step,className:"bwf_w_full",options:j,onChange:function(e){return de(on(on({},fe),{},{skip_to_step:on(on({},fe.skip_to_step),{},{step:e,name:p[e]})}))}}),ye("specific_date_time_step")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.specific_date_time_step))),!Object(o.isEmpty)(_e())&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info"},_e())))):Object(a.createElement)(a.Fragment,null));case 3:return Object(a.createElement)(a.Fragment,null,Object(f.fc)()?Object(a.createElement)("div",{className:"bwf-custom-date-delay"},Object(a.createElement)("div",{className:"bwf-delay-field "},O?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf_w_full bwf-h-15"}):xe())):Object(a.createElement)(a.Fragment,null));case 4:return Object(a.createElement)(a.Fragment,null,Object(f.fc)()?Fe():Object(a.createElement)(a.Fragment,null));default:return Object(a.createElement)(a.Fragment,null)}var e,n,r,c,i,m,b,d,p,j}(),liteDummyData:{2:Object(a.createElement)("div",{className:"bwf-pl-30 bwf-lite-restrict-section"},Object(a.createElement)("div",{className:"bwf-specific-date-time-delay"},Object(a.createElement)("div",{className:"bwf-specific-date bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-field ",style:{pointerEvents:"none"}},Object(a.createElement)(Ut.a,{date:null,dateFormat:"MM/DD/YYYY",onUpdate:function(){},text:"",iconRight:!0,disabled:!0}))),Object(a.createElement)("div",{className:"bwf-specific-time bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-field "},Object(a.createElement)("input",{type:"time",value:"",disabled:!0,onChange:function(){},className:"bwf-h-36"}))),Object(a.createElement)("div",{className:"bwf-specific-date bwf-w-210 "},Object(a.createElement)(tn.a,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "},Object(a.createElement)(tn.a,{checked:!1,disabled:!0,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(){}}))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-specific-date "},Object(a.createElement)(u.SelectControl,{value:"",disabled:!0,className:"bwf_w_full",options:[],onChange:function(){}})),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(a.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(a.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(f.ib)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations")))),3:Object(a.createElement)("div",{className:"bwf-pl-30 bwf-lite-restrict-section"},Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(a.createElement)("div",{className:"bwf-delay-field-select bwf-w-210 "},Object(a.createElement)(u.SelectControl,{value:"",className:"bwf_W_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0})),Object(a.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field bwf-w-210 "},Object(a.createElement)(u.SelectControl,{value:"",className:"bwf_w_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0}))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(a.createElement)("input",{type:"time",value:"",disabled:!0,className:"bwf-w-210 bwf-h-36",onChange:function(){}})),Object(a.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(a.createElement)(tn.a,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "},Object(a.createElement)(tn.a,{checked:!1,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(){},disabled:!0}))),Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "},Object(a.createElement)(u.TextControl,{className:"bwf-h-36",type:"number",disabled:!0,value:"",onChange:function(){},min:1,placeholder:Object(l.__)("Enter","wp-marketing-automations")})),Object(a.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(a.createElement)(u.SelectControl,{value:"",className:"bwf_w_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0})),Object(a.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(a.createElement)(u.SelectControl,{value:"",disabled:!0,className:"bwf_w_full",options:[],onChange:function(){}}))))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "},Object(a.createElement)(tn.a,{checked:!1,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),disabled:!0,onChange:function(){}}))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(a.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(a.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(f.ib)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))}}),v&&Object(a.createElement)("div",{className:"bwf-single-automation-notice"},Object(l.__)("There can be contacts queued at this step, new settings will apply to all of them.","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf_clear_24"}))),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return S(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(j.a,{isPrimary:!0,onClick:Oe,isBusy:D,className:"bwf-no-ripple"},Object(l.__)("Save","wp-marketing-automations"))))},On=n(542),jn=n(111);function wn(e){return(wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yn(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return vn(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(vn(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,vn(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,vn(m,"constructor",s),vn(s,"constructor",l),l.displayName="GeneratorFunction",vn(s,r,"GeneratorFunction"),vn(m),vn(m,r,"Generator"),vn(m,a,(function(){return this})),vn(m,"toString",(function(){return"[object Generator]"})),(yn=function(){return{w:o,m:b}})()}function vn(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(vn=function(e,t,n,a){function o(t,n){vn(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gn(Object(n),!0).forEach((function(t){hn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=wn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=wn(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==wn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function En(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function kn(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){En(o,a,r,c,i,"next",e)}function i(e){En(o,a,r,c,i,"throw",e)}c(void 0)}))}}function Nn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Sn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Pn=function(){var e=Object(a.useContext)(f.h),t=Nn(Object(a.useState)(""),2),n=(t[0],t[1]),r=Nn(Object(a.useState)(!1),2),c=r[0],i=r[1],u=Nn(Object(a.useState)(!1),2),d=u[0],O=u[1],w=Nn(Object(a.useState)(!1),2),y=w[0],v=w[1],g=Nn(Object(a.useState)(""),2),_=g[0],h=g[1];Object(a.useEffect)((function(){i(!1)}),[]);var E,k,N=Object(m.a)(),S=N.showSidebar,P=N.setNodeDatabyId,C=N.setAutomationData,A=Object(b.a)(),T=A.getSidebarNodeData,D=A.getAutomationId,I=A.getNodeDataByID,M=A.getAutomationLinks,x=A.getAutomationSteps,F=A.getCount,G=A.getAutomationData,L=A.getautomationMeta,z=A.getRulesData,U=L(),q=x(),B=M(),R=F(),H=T(),V=D(),J=G(),$=J&&J.event?J.event:"",W=z($),Q=Object(ne.a)($,parseInt(V),W),X=Q.isLoading,Z=(Q.error,Q.rules),K=!Object(o.isEmpty)(H)&&H.hasOwnProperty("data")?H.data:{},ee=!Object(o.isEmpty)(K)&&K.hasOwnProperty("sidebarValues")?(E=K.sidebarValues,k=[],Object(o.isEmpty)(E)?[]:(Object.keys(E).map((function(e){var t=E[e],n=[];t.map((function(e){Z.hasOwnProperty(e.filter)&&n.push(e)})),Object(o.isEmpty)(n)||k.push(n)})),k)):[],te=!Object(o.isEmpty)(H)&&H.hasOwnProperty("id")?I(H.id):{},ae=te.stepId,re=void 0===ae?0:ae,oe=te.data,ce=(void 0===oe?{}:oe).sidebarValues,ie=function(){var t=kn(yn().m((function t(){var n,a,r,c,i=arguments;return yn().w((function(t){for(;;)switch(t.p=t.n){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:{},a=!(i.length>1&&void 0!==i[1])||i[1],r={data:{data:{sidebarData:n}},steps:Object(o.cloneDeep)(q).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:B,count:R},a||(r.updateStatus=2),t.p=1,t.n=2,p()({path:Object(f.C)("/automation/".concat(V,"/step/").concat(re)),method:"POST",data:r}).then((function(t){if(200!==t.code)throw Error(Object(f.w)(null==t?void 0:t.message));a&&e(t.message),a&&(K.sidebarValues=n,P(H.id,K,{step_status:1})),t.hasOwnProperty("result")&&t.result.hasOwnProperty("meta")&&C("meta",_n(_n({},U),t.result.meta)),setTimeout((function(){S(!1)}),100),O(!1)})).catch((function(e){throw Error(Object(f.w)(null==e?void 0:e.message))}));case 2:t.n=4;break;case 3:t.p=3,c=t.v,a&&C("modalData",{status:!0,modalTitle:Object(l.__)("Update Condition","wp-marketing-automations"),error:null==c?void 0:c.message}),O(!1);case 4:Object(f.Pb)(e,3e3);case 5:return t.a(2)}}),t,null,[[1,3]])})));return function(){return t.apply(this,arguments)}}(),le=function(){var e=kn(yn().m((function e(){var t,a,r;return yn().w((function(e){for(;;)switch(e.n){case 0:if(Object(f.fc)()){e.n=1;break}return C("proModalContent",Object(l.__)("Conditional Step","wp-marketing-automations")),C("showProModal",!0),e.a(2);case 1:if(t=Object(o.cloneDeep)(K.sidebarValues),a=[],r=!1,Object(o.isEmpty)(t)||t.map((function(e){Object(o.isEmpty)(e)||(a.push(e),e.map((function(e){var t;(t=e).hasOwnProperty("rule")&&["is_blank","is_not_blank"].includes(t.rule)||!(!t.hasOwnProperty("data")||""==t.data||null==t.data||Array.isArray(t.data)&&Object(o.isEmpty)(t.data)||Z&&Z.hasOwnProperty(t.filter)&&"key-value"==Z[t.filter].input.component&&(""==t.data[0]||null==t.data[0]||Array.isArray(t.data[1])&&Object(o.isEmpty)(t.data[1])||""==t.data[1]||null==t.data[1]||Array.isArray(t.data[1])&&Object(o.isEmpty)(t.data[1]))||Z&&Z.hasOwnProperty(t.filter)&&["Date","Days","datetime"].includes(Z[t.filter].input.component)&&"between"===t.rule&&(!t.data.hasOwnProperty("to")||!t.data.hasOwnProperty("from")||Object(o.isEmpty)(t.data.to)||Object(o.isEmpty)(t.data.from)))||(i(!0),r=!0,n(Object(l.__)("Some condition(s) are empty please remove them or fill them.","wp-marketing-automations")))})))})),Object(o.isEmpty)(a)||r){e.n=4;break}if(!Object(o.isEqual)(ce,a)){e.n=2;break}return S(!1),O(!1),e.a(2);case 2:return O(!0),e.n=3,ie(a);case 3:e.n=5;break;case 4:!r&&n(Object(l.__)("Please select conditions to save.","wp-marketing-automations"));case 5:return e.a(2)}}),e)})));return function(){return e.apply(this,arguments)}}(),se=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object.keys(ee).length,n=Object(o.cloneDeep)(ee);n[t]=[e];var a=_n(_n({},H),{},{data:_n(_n({},K),{},{sidebarValues:n})});C("sidebarNodeData",a),setTimeout((function(){h(""),v(!1)}),1)}),[ee]),ue=(Object(a.useCallback)((function(e){var t=_n({},ee);delete t[e];var n=_n(_n({},H),{},{data:_n(_n({},K),{},{sidebarValues:t})});C("sidebarNodeData",n)}),[ee]),function(){return Object(a.createElement)("ul",{className:"bwf-popover-container bwf-group"},Object(a.createElement)("li",{className:"list-label"},Object(l.__)("Select Group","wp-marketing-automations")),function(){var e=[],t=[];Object.entries(Z).map((function(n){var a=Nn(n,2),r=(a[0],a[1]);e.includes(r.group)||(e.push(r.group),t.push({priority:r.priority?r.priority:0,key:r.group,label:r.groupLabel}))}));return t.sort((function(e,t){return e.priority-t.priority})),t}().map((function(e,t){return Object(a.createElement)("li",{className:"list-values has-pointer",onClick:function(){return h(e.key)},key:t},e.label,Object(a.createElement)("span",{className:"bwf-svgtailf-arrow"},Object(a.createElement)(s.a,{icon:"tailless-arrow-forward",size:14,color:"#353030"})))})))}),me=function(){return Object(a.createElement)("ul",{className:"bwf-popover-container bwf-filters"},Object(a.createElement)("li",{className:"list-label list-values has-pointer is-back-button",onClick:function(){return h("")}},Object(a.createElement)("span",{className:"bwf-svgtailb-arrow"},Object(a.createElement)(s.a,{icon:"tailless-arrow-forward",size:14,color:"#353030"})),Object(l.__)("Back","wp-marketing-automations")),(e=[],Object.entries(Z).map((function(t){var n=Nn(t,2),a=n[0],r=n[1];(Object(o.isEmpty)(_)||_===r.group)&&e.push({key:a,label:r.labels.add})})),e).map((function(e,t){return Object(a.createElement)("li",{className:"list-values has-pointer",onClick:function(){se({filter:e.key,rule:"",data:""})},key:t},e.label)})));var e},be=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e?"bwf-sidebar-empty-placeholder ":"";return Object(a.createElement)("div",{className:t},e&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-main-icon"},Object(a.createElement)(s.a,{icon:"conditional-placeholder",size:90})),Object(a.createElement)("div",{className:"bwf-h2"},X?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-h-30 bwf-w-150 bwf-mb-12"}):Object(l.__)("No Condition","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf-h4 bwf-h4-grey bwf-mb-0"},X?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-300"}):Object(l.__)("Add a condition to segment and make contacts flow to different branches","wp-marketing-automations"))),e&&Object(a.createElement)("div",{className:"bwf_clear_24"}),!Object(o.isEmpty)(Z)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(j.a,{isPrimary:!0,className:"bwf-no-ripple "+(e?"":"bwf-conditional-btn conditional-or"),onClick:function(){return v(!0)},style:e?{}:{margin:"-38px 0px 0px 62px",position:"absolute"}},e?Object(l.__)("Add New Condition","wp-marketing-automations"):Object(l.__)("OR","wp-marketing-automations"),y&&Object(a.createElement)(Y.a,{className:"bwf-conditioal-group-popup "+(e?"":"bwf-conditional-or"),focusOnMount:!0,onFocusOutside:function(){return v(!1)},onClose:function(){return v(!1)}},Object(o.isEmpty)(_)?ue():me())),e&&Object(a.createElement)("div",{className:"bwf_clear_48"})))};return Object(a.createElement)(f.f.Provider,{value:{errorList:c,setErrorList:i,stepId:re}},Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon"},Object(a.createElement)(s.a,{size:26,icon:"condition"})),Object(a.createElement)("div",{className:"wr_event_title"},Object(l.__)("Condition","wp-marketing-automations"),!Object(f.fc)()&&Object(a.createElement)(jn.a,null)),Object(a.createElement)("div",{className:"wr_event_variant"}),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:kn(yn().m((function e(){return yn().w((function(e){for(;;)switch(e.n){case 0:if(!Object(o.isEmpty)(ee)){e.n=1;break}return e.n=1,ie([],!1);case 1:S(!1);case 2:return e.a(2)}}),e)})))},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)("div",{className:"wr_content wr-conditioal-sidebar"},Object(o.isEmpty)(ee)||Object(o.isEmpty)(Z)?Object(a.createElement)(a.Fragment,null,be()):Object(a.createElement)(a.Fragment,null,Object.keys(ee).map((function(e,t){return Object(a.createElement)("div",{className:"bwf-conditional-wrap",key:t},Object(a.createElement)(On.a,{key:e,filters:Z,groupingEnabled:!0,value:ee[e],setValue:function(t){var n=Object(o.cloneDeep)(ee);n[e]=t,n=n.filter((function(e){return 0!==Object.keys(e).length}));var a=_n(_n({},H),{},{data:_n(_n({},K),{},{sidebarValues:n})});C("sidebarNodeData",a)}}),t+1!==Object.keys(ee).length&&Object(a.createElement)("div",{className:"bwf-conditional-rules-label-or"},Object(a.createElement)("span",{className:"bwf-line"}),Object(a.createElement)("span",{className:"bwf-rule-text"},Object(l.__)("OR","wp-marketing-automations"))))})),be(!1)),Object(a.createElement)("div",{className:"bwf_clear_24"})),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(j.a,{className:"bwf-cancel-btn",onClick:kn(yn().m((function e(){return yn().w((function(e){for(;;)switch(e.n){case 0:if(!Object(o.isEmpty)(ee)){e.n=1;break}return e.n=1,ie([],!1);case 1:S(!1);case 2:return e.a(2)}}),e)})))},Object(l.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(j.a,{isPrimary:!0,className:"bwf-no-ripple",onClick:le,isBusy:d,disabled:d||Object(o.isEmpty)(Z)||Object(o.isEmpty)(ee)},!Object(f.fc)()&&Object(a.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),Object(l.__)("Save","wp-marketing-automations"))))};function Cn(e){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function An(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return Tn(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Tn(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Tn(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,Tn(m,"constructor",s),Tn(s,"constructor",l),l.displayName="GeneratorFunction",Tn(s,r,"GeneratorFunction"),Tn(m),Tn(m,r,"Generator"),Tn(m,a,(function(){return this})),Tn(m,"toString",(function(){return"[object Generator]"})),(An=function(){return{w:o,m:b}})()}function Tn(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(Tn=function(e,t,n,a){function o(t,n){Tn(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function Dn(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function In(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?In(Object(n),!0).forEach((function(t){xn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):In(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Cn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=Cn(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Cn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Gn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Ln=function(){var e=Object(a.useContext)(f.h),t=Fn(Object(a.useState)(!1),2),n=t[0],r=t[1],c=Fn(Object(a.useState)(!1),2),u=c[0],d=c[1],O=Fn(Object(a.useState)(!1),2),w=O[0],y=O[1],v=Object(b.a)(),g=v.getSidebarNodeData,_=v.getNodeDataByID,h=v.getAutomationSteps,E=v.getAutomationLinks,k=v.getCount,N=v.getAutomationId,S=v.getGoals,P=v.getautomationMeta,C=Object(m.a)(),A=C.showSidebar,T=C.setNodeDatabyId,D=C.setAutomationData,I=Object(a.useRef)(null),M=Fn(Object(a.useState)([]),2),x=M[0],F=M[1],G=g(),L=S().list,z=void 0===L?{}:L,U=P(),q=G.data,B=G&&G.data&&G.data.benchmark&&z.hasOwnProperty(G.data.benchmark)?z[G.data.benchmark]:{},R=G&&G.data&&G.data.benchmark?G.data.benchmark:"",H=!Object(o.isEmpty)(G.data)&&G.data.hasOwnProperty("sidebarValues")?G.data.sidebarValues:{},V=B.fields,J=void 0===V?[]:V,$=B.default_values,W=void 0===$?{}:$,Y=N(),Q=h(),X=E(),Z=k(),K=!Object(o.isEmpty)(G)&&G.hasOwnProperty("id")?_(G.id):{},ee=K.stepId,te=void 0===ee?0:ee,ne=K.data,ae=(void 0===ne?{}:ne).sidebarValues;Object(a.useEffect)((function(){F([])}),[]);var re=Mn(Mn({},W),H),oe=function(e,t,n){var a=!1,r=t.fields,o=t.relation,c=void 0===o?"OR":o;c=c.toUpperCase();try{var i=null;if("OR"===c){if(r&&Array.isArray(r))for(var l=0;l<r.length;l++){i=e[r[l].id];var s=void 0===r[l].value||r[l].value;if(Array.isArray(s)&&s.includes(i))return!0;if(""!=s&&i==s||""==s&&""!=i&&null!=i)return!0}}else"AND"==c&&r&&Array.isArray(r)&&(a=r.every((function(t){i=e[t.id];var n=void 0===t.value||t.value;return!(!Array.isArray(n)||!n.includes(i))||(""===n||i==n)&&(""!=n||""!=i&&null!=i)})))}catch(e){console.log(e)}return a},ce=function(){var t,n=(t=An().m((function t(n){var a,c;return An().w((function(t){for(;;)switch(t.p=t.n){case 0:if(Object(f.fc)()){t.n=1;break}return D("proModalContent",Object(l.__)("Goal Step","wp-marketing-automations")),D("showProModal",!0),t.a(2);case 1:if(!Object(o.isEmpty)(le(n))){t.n=7;break}if(!Object(o.isEqual)(ae,n)){t.n=2;break}return A(!1),t.a(2);case 2:return q.sidebarValues=n,r(!0),a={data:{data:{sidebarData:n}},steps:Object(o.cloneDeep)(Q).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:X,count:Z,optionUpdated:u,actionType:3},t.p=3,t.n=4,p()({path:Object(f.C)("/automation/".concat(Y,"/step/").concat(te)),method:"POST",data:a}).then((function(t){if(200!==t.code)throw Error(Object(f.w)(null==t?void 0:t.message));e(t.message);var n="";t.hasOwnProperty("result")&&t.result.hasOwnProperty("desc_text")&&!Object(o.isEmpty)(t.result.desc_text)&&(n=t.result.desc_text),t.hasOwnProperty("result")&&t.result.hasOwnProperty("meta")&&D("meta",Mn(Mn({},U),t.result.meta)),T(G.id,Mn(Mn({},q),{},{desc_text:n}),{step_status:1}),setTimeout((function(){A(!1)}),100),r(!1)})).catch((function(e){throw Error(Object(f.w)(null==e?void 0:e.message))}));case 4:t.n=6;break;case 5:t.p=5,c=t.v,D("modalData",{status:!0,modalTitle:Object(l.__)("Update Goal","wp-marketing-automations"),error:null==c?void 0:c.message}),r(!1);case 6:Object(f.Pb)(e,3e3);case 7:return t.a(2)}}),t,null,[[3,5]])})),function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function c(e){Dn(o,a,r,c,i,"next",e)}function i(e){Dn(o,a,r,c,i,"throw",e)}c(void 0)}))});return function(e){return n.apply(this,arguments)}}(),ie=[];Object(o.isEmpty)(J)||J.forEach((function(e){e.hasOwnProperty("required")&&e.required&&ie.push(e)}));var le=function(e){var t={};return ie.map((function(n){(!n.hasOwnProperty("toggler")||Object(o.isEmpty)(n.toggler)||oe(e,n.toggler))&&(Array.isArray(e[n.id])&&0===e[n.id].length||""===e[n.id]||void 0===e[n.id])&&(t[n.id]=n.hasOwnProperty("errorMsg")?n.errorMsg:Object(l.__)("This is a required field.","wp-marketing-automations")),"bwfan_email_data"===n.id&&(!e.hasOwnProperty("bwfan_email_data")||e.bwfan_email_data.hasOwnProperty("subject")&&Object(o.isEmpty)(e.bwfan_email_data.subject))&&(t[n.id]="error")})),F(t),t};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(a.createElement)(s.a,{size:26,icon:"goal"})),Object(a.createElement)("div",{className:"wr_event_title"},B.event_name,!Object(f.fc)()&&Object(a.createElement)(jn.a,null)),Object(a.createElement)("div",{className:"wr_event_variant"},Object(f.fc)()&&!Object(o.isEmpty)(R)&&"crm_link_trigger"===R&&Object(a.createElement)(ct.a,{canCreate:!0,isLinkTriggerOpen:w,setLinkTriggerOpen:y,hideButton:!1})),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return A(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)(f.f.Provider,{value:{errorList:x,setErrorList:F,stepId:te}},Object(a.createElement)(rt.a,{onSubmit:function(e){ce(e)},initialValues:re,validate:function(e){return d(function(e){var t=q.sidebarValues,n=void 0===t?{}:t;if(Object(o.isEmpty)(n))return!1;var a=re.bwfan_goal_run,r=void 0===a?"":a,c=e.bwfan_goal_run;return r!==(void 0===c?"":c)&&"wait"===r}(e)),!1}},(function(e){var t=e.getInputProps,r=e.values,c=e.errors,m=e.handleSubmit;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_content",ref:I},Object(a.createElement)("div",null,J.map((function(e,n){return Object(a.createElement)(a.Fragment,{key:n},(Object(o.isEmpty)(e.toggler)||oe(r,e.toggler))&&e.wrap_before&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(a.createElement)(a.Fragment,null,!1!==e.show&&(Object(o.isEmpty)(e.toggler)||oe(r,e.toggler))&&Object(a.createElement)(ot.a,{input:e,formProps:t(e.id),values:r})):e.hint?Object(a.createElement)(a.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(o.isEmpty)(e.toggler)||oe(r,e.toggler))&&e.wrap_after&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))}))),u&&Object(a.createElement)("div",{className:"bwf-single-automation-notice"},Object(l.__)("There can be contacts queued at this step, new settings will apply to all of them.","wp-marketing-automations"))),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return A(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(j.a,{isPrimary:!0,onClick:function(){m()},className:"bwf-no-ripple",isBusy:n,disabled:Object.keys(c).length},!Object(f.fc)()&&Object(a.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),Object(l.__)("Save","wp-marketing-automations"))))}))))},zn=n(212);function Un(e){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qn(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return Bn(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Bn(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Bn(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,Bn(m,"constructor",s),Bn(s,"constructor",l),l.displayName="GeneratorFunction",Bn(s,r,"GeneratorFunction"),Bn(m),Bn(m,r,"Generator"),Bn(m,a,(function(){return this})),Bn(m,"toString",(function(){return"[object Generator]"})),(qn=function(){return{w:o,m:b}})()}function Bn(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(Bn=function(e,t,n,a){function o(t,n){Bn(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function Rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(n),!0).forEach((function(t){Vn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Un(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=Un(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Un(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jn(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function $n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Yn=function(){var e=Object(a.useContext)(f.h),t=$n(Object(a.useState)(!1),2),n=t[0],r=t[1],c=Object(b.a)(),u=c.getSelectedEventData,d=c.getAutomationId,O=c.getautomationMeta,w=Object(m.a)(),y=w.showSidebar,v=w.setAutomationData,g=d(),_=Object(a.useRef)(null),h=$n(Object(a.useState)(!1),2),E=h[0],k=h[1],N=$n(Object(a.useState)([]),2),S=N[0],P=N[1],C=O(),A=u(),T=!Object(o.isEmpty)(C)&&C.hasOwnProperty("event_meta")?C.event_meta:{},D=Object(o.isEmpty)(A)?{}:A,I=D.fields,M=void 0===I?[]:I,x=D.default_values,F=void 0===x?{}:x,G=D.need_unique_key,L=void 0!==G&&G;Object(a.useEffect)((function(){P([]),k(!1)}),[]);var z=function(e,t,n){var a=!1,r=t.fields,o=t.relation,c=void 0===o?"OR":o;c=c.toUpperCase();try{var i=null;if("OR"===c){if(r&&Array.isArray(r))for(var l=0;l<r.length;l++){i=e[r[l].id];var s=void 0===r[l].value||r[l].value;if(Array.isArray(s)&&s.includes(i))return!0;if(""!=s&&i==s||""==s&&""!=i&&null!=i)return!0}}else"AND"==c&&r&&Array.isArray(r)&&(a=r.every((function(t){i=e[t.id];var n=void 0===t.value||t.value;return!(!Array.isArray(n)||!n.includes(i))||(""===n||i==n)&&(""!=n||""!=i&&null!=i)})))}catch(e){console.log(e)}return a},U=function(){var t,n=(t=qn().m((function t(n){var a;return qn().w((function(t){for(;;)switch(t.p=t.n){case 0:if(!Object(o.isEmpty)(B(n))){t.n=6;break}if(!Object(o.isEqual)(T,n)){t.n=1;break}return y(!1),t.a(2);case 1:return r(!0),t.p=2,t.n=3,p()({path:Object(f.C)("/automation/".concat(g,"/")),method:"POST",data:{data:{meta:{event_meta:n},isWebhook:L}}}).then((function(t){if(200!==t.code)throw Error(Object(f.w)(null==t?void 0:t.message));e(t.message);var a=Hn({},n);L&&T.hasOwnProperty("webhook_data")&&(a.webhook_data=T.webhook_data),v("meta",Hn(Hn({},C),{},{event_meta:a})),setTimeout((function(){y(!1)}),100),r(!1)})).catch((function(e){throw Error(Object(f.w)(null==e?void 0:e.message))}));case 3:t.n=5;break;case 4:t.p=4,a=t.v,v("modalData",{status:!0,modalTitle:Object(l.__)("Update Event","wp-marketing-automations"),error:null==a?void 0:a.message}),r(!1);case 5:Object(f.Pb)(e,3e3);case 6:return t.a(2)}}),t,null,[[2,4]])})),function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function c(e){Jn(o,a,r,c,i,"next",e)}function i(e){Jn(o,a,r,c,i,"throw",e)}c(void 0)}))});return function(e){return n.apply(this,arguments)}}(),q=[];Object(o.isEmpty)(M)||M.forEach((function(e){e.hasOwnProperty("required")&&e.required&&q.push(e)}));var B=function(e){var t={};return q.map((function(n){(!n.hasOwnProperty("toggler")||Object(o.isEmpty)(n.toggler)||z(e,n.toggler))&&(Array.isArray(e[n.id])&&0===e[n.id].length||""===e[n.id]||void 0===e[n.id])&&(t[n.id]=n.hasOwnProperty("errorMsg")?n.errorMsg:Object(l.__)("This is a required field.","wp-marketing-automations")),"bwfan_email_data"===n.id&&(!e.hasOwnProperty("bwfan_email_data")||e.bwfan_email_data.hasOwnProperty("subject")&&Object(o.isEmpty)(e.bwfan_email_data.subject))&&(t[n.id]="error"),"bwf_form_submit"===n.type&&(e.hasOwnProperty("bwfan-form-field-map")&&e["bwfan-form-field-map"].hasOwnProperty("bwfan_email_field_map")&&""!==e["bwfan-form-field-map"].bwfan_email_field_map||(t["bwfan-form-email-field-map"]="error"))})),P(t),t};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-start"},Object(a.createElement)(s.a,{size:22,icon:"rocket"})),Object(a.createElement)("div",{className:"wr_event_title"},A.hasOwnProperty("event_name")?A.event_name:""),Object(a.createElement)("div",{className:"wr_event_variant"}),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return y(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)(f.f.Provider,{value:{errorList:S,setErrorList:P}},Object(a.createElement)(rt.a,{onSubmit:function(e){U(e)},initialValues:Hn(Hn({},F),T),validate:function(){return!1}},(function(e){var t=e.getInputProps,r=e.values,c=e.errors,s=e.handleSubmit;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_content",ref:_},Object(a.createElement)("div",null,M.map((function(e,n){return Object(a.createElement)(a.Fragment,{key:n},(Object(o.isEmpty)(e.toggler)||z(r,e.toggler))&&e.wrap_before&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(a.createElement)(a.Fragment,null,!1!==e.show&&(Object(o.isEmpty)(e.toggler)||z(r,e.toggler))&&Object(a.createElement)(ot.a,{input:e,formProps:t(e.id),values:r})):e.hint?Object(a.createElement)(a.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(o.isEmpty)(e.toggler)||z(r,e.toggler))&&e.wrap_after&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return y(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(j.a,{isPrimary:!0,onClick:function(){s()},className:"bwf-no-ripple",isBusy:n,disabled:Object.keys(c).length},Object(l.__)("Save","wp-marketing-automations"))))}))),Object(f.fc)()&&Object(a.createElement)(zn.a,{isOpen:E,setOpenTags:k}))};function Qn(e){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xn(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return Zn(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Zn(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Zn(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,Zn(m,"constructor",s),Zn(s,"constructor",l),l.displayName="GeneratorFunction",Zn(s,r,"GeneratorFunction"),Zn(m),Zn(m,r,"Generator"),Zn(m,a,(function(){return this})),Zn(m,"toString",(function(){return"[object Generator]"})),(Xn=function(){return{w:o,m:b}})()}function Zn(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(Zn=function(e,t,n,a){function o(t,n){Zn(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){ta(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ta(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Qn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=Qn(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function na(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function aa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ra(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ra(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var oa=function(){var e=aa(Object(a.useState)(!1),2),t=e[0],n=e[1],r=aa(Object(a.useState)(!1),2),c=r[0],i=r[1],d=aa(Object(a.useState)({step:"",name:""}),2),O=d[0],w=d[1],y=Object(a.useContext)(f.h),v=Object(m.a)(),g=v.showSidebar,_=v.setNodeDatabyId,h=v.fetchSplitPathNodes,E=v.setAutomationData,k=Object(b.a)(),N=k.getSidebarNodeData,S=k.getNodeDataByID,P=k.getAutomationId,C=k.getAutomationLinks,A=k.getAutomationSteps,T=k.getCount,D=k.getActionsList,I=k.getGoals,M=k.getautomationMeta,x=N(),F=P(),G=A(),L=C(),z=T(),U=D(),q=I(),B=M(),R=h(),H=!Object(o.isEmpty)(x)&&x.hasOwnProperty("id")?S(x.id):{},V=(H.id,H.stepId),J=void 0===V?0:V,$=H.data,W=(void 0===$?{}:$).sidebarValues;Object(a.useEffect)((function(){n({}),n(!1)}),[]);var Y=!Object(o.isEmpty)(x)&&x.hasOwnProperty("data")?x.data:{},Q=!Object(o.isEmpty)(Y)&&Y.hasOwnProperty("sidebarValues")?Y.sidebarValues:{};Object(a.useEffect)((function(){Q.hasOwnProperty("jump_to")&&!Object(o.isEmpty)(Q.jump_to)&&w(Q.jump_to)}),[Q]);var X={action:Object(l.__)("Action","wp-marketing-automations"),wait:Object(l.__)("Delay","wp-marketing-automations"),conditional:Object(l.__)("Conditional","wp-marketing-automations"),exit:Object(l.__)("Exit","wp-marketing-automations"),benchmark:Object(l.__)("Goal","wp-marketing-automations")},Z=Object(a.useMemo)((function(){var e={stepsOptArr:[],stepsOptions:[{value:"",label:Object(l.__)("Select Step","wp-marketing-automations")}]};return Object(o.isEmpty)(G)||(G.map((function(t){var n=t.stepId,a=void 0===n?0:n,r=t.id,o=void 0===r?0:r;if(!["yesNoNode","start","end","exit","jump","split","splitpath"].includes(t.type)&&!e.stepsOptArr.hasOwnProperty(o)&&!R.includes(o)){var c=[Object(l.__)("Step","wp-marketing-automations")];c.push(o),X.hasOwnProperty(t.type)&&c.push(" : "+X[t.type]),"action"==t.type&&t.hasOwnProperty("data")&&U.list.hasOwnProperty(t.data.selected)&&U.list[t.data.selected].hasOwnProperty("action_name")&&(U.list[t.data.selected].hasOwnProperty("integration_nicename")?c.push(" - "+U.list[t.data.selected].integration_nicename+" : "):c.push(" - "),c.push(U.list[t.data.selected].action_name)),"benchmark"==t.type&&t.hasOwnProperty("data")&&q.list.hasOwnProperty(t.data.benchmark)&&q.list[t.data.benchmark].hasOwnProperty("event_name")&&(q.list[t.data.benchmark].hasOwnProperty("source_label")&&c.push(q.list[t.data.benchmark].source_label+" : "),c.push(q.list[t.data.benchmark].event_name)),e.stepsOptArr[a]=c.join(" "),e.stepsOptions.push({value:a,label:c.join(" ")})}})),e.stepsOptArr.end=Object(l.__)("End Automation","wp-marketing-automations"),e.stepsOptions.push({value:"end",label:Object(l.__)("End Automation","wp-marketing-automations")})),e}),[G]),K=Z.stepsOptArr,ee=Z.stepsOptions,te=function(){var e,t=(e=Xn().m((function e(){var t,a,r;return Xn().w((function(e){for(;;)switch(e.p=e.n){case 0:if(Object(f.fc)()){e.n=1;break}return E("proModalContent",Object(l.__)("Jump Step","wp-marketing-automations")),E("showProModal",!0),e.a(2);case 1:if(O.hasOwnProperty("step")&&""!=O.step&&O.hasOwnProperty("name")&&""!=O.name){e.n=2;break}return n(!0),e.a(2);case 2:if(n(!1),t=ea(ea({},Q),{},{jump_to:O}),!Object(o.isEqual)(W,t)){e.n=3;break}return g(!1),e.a(2);case 3:return e.p=3,i(!0),a={data:{data:{sidebarData:t}},steps:Object(o.cloneDeep)(G).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:L,count:z},e.n=4,p()({path:Object(f.C)("/automation/".concat(F,"/step/").concat(J)),method:"POST",data:a}).then((function(e){if(200!==e.code)throw Error(Object(f.w)(null==e?void 0:e.message));y(e.message),_(x.id,ea(ea({},Y),{},{sidebarValues:t}),{step_status:1}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&E("meta",ea(ea({},B),e.result.meta)),setTimeout((function(){g(!1)}),100),i(!1)})).catch((function(e){throw Error(Object(f.w)(null==e?void 0:e.message))}));case 4:e.n=6;break;case 5:e.p=5,r=e.v,E("modalData",{status:!0,modalTitle:Object(l.__)("Update Jump","wp-marketing-automations"),error:null==r?void 0:r.message}),i(!1);case 6:Object(f.Pb)(y,3e3);case 7:return e.a(2)}}),e,null,[[3,5]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){na(o,a,r,c,i,"next",e)}function i(e){na(o,a,r,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-jump"},Object(a.createElement)(s.a,{size:28,icon:"jump"})),Object(a.createElement)("div",{className:"wr_event_title"},Object(a.createElement)("span",null,Object(l.__)("Jump","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(jn.a,null)),Object(a.createElement)("div",{className:"wr_event_variant"}),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){g(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)("div",{className:"wr_content"},Object(a.createElement)("div",{className:"bwf-jump-wrap"},Object(a.createElement)("div",{className:"bwf-jump-skip-step-select "+(t?"has-error":"")},Object(a.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("Jump To","wp-marketing-automations")),Object(a.createElement)(u.SelectControl,{value:O.step,className:"bwf_w_full",options:ee,onChange:function(e){w({step:e,name:e?K[e]:""})}}),t&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("This is a required field.","wp-marketing-automations"))))),Object(a.createElement)("div",{className:"bwf_clear_24"})),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return g(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(j.a,{isPrimary:!0,onClick:te,isBusy:c,className:"bwf-no-ripple"},!Object(f.fc)()&&Object(a.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),Object(l.__)("Save","wp-marketing-automations"))))},ca=n(66);function ia(e){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function la(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return sa(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(sa(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,sa(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,sa(m,"constructor",s),sa(s,"constructor",l),l.displayName="GeneratorFunction",sa(s,r,"GeneratorFunction"),sa(m),sa(m,r,"Generator"),sa(m,a,(function(){return this})),sa(m,"toString",(function(){return"[object Generator]"})),(la=function(){return{w:o,m:b}})()}function sa(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(sa=function(e,t,n,a){function o(t,n){sa(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ma(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ua(Object(n),!0).forEach((function(t){ba(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ua(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ba(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=ia(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=ia(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ia(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fa(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function da(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pa(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pa(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Oa=function(){var e=da(Object(a.useState)(!1),2),t=e[0],n=e[1],r=da(Object(a.useState)(!1),2),c=r[0],i=r[1],d=da(Object(a.useState)(""),2),O=d[0],w=d[1],y=da(Object(a.useState)(""),2),v=y[0],g=y[1],_=da(Object(a.useState)(""),2),h=_[0],E=_[1],k=Object(a.useContext)(f.h),N=Object(m.a)(),S=N.showSidebar,P=N.setNodeDatabyId,C=N.setAutomationData,A=N.setSplitNodePath,T=N.fetchAutomationStat,D=Object(a.useRef)(new AbortController),I=Object(b.a)(),M=I.getSidebarNodeData,x=I.getNodeDataByID,F=I.getAutomationId,G=(0,I.getautomationMeta)(),L=M(),z=F(),U=!Object(o.isEmpty)(L)&&L.hasOwnProperty("id")?x(L.id):{},q=U.id,B=void 0===q?0:q,R=U.stepId,H=void 0===R?0:R,V=[{key:"",label:Object(l.__)("Select","wp-marketing-automations")},{key:"2",label:"2"},{key:"3",label:"3"}];Object(a.useEffect)((function(){return n({}),n(!1),function(){D.current.abort()}}),[]);var J=!Object(o.isEmpty)(L)&&L.hasOwnProperty("data")?L.data:{},$=!Object(o.isEmpty)(J)&&J.hasOwnProperty("sidebarValues")?J.sidebarValues:{};Object(a.useEffect)((function(){$.hasOwnProperty("split_path")&&!Object(o.isEmpty)($.split_path)&&w($.split_path),$.hasOwnProperty("title")&&!Object(o.isEmpty)($.title)&&g($.title),$.hasOwnProperty("desc")&&!Object(o.isEmpty)($.desc)&&E($.desc)}),[$]);var W=function(){var e,t=(e=la().m((function e(){var t,a,r,o,c,s,u,m;return la().w((function(e){for(;;)switch(e.p=e.n){case 0:if(Object(f.fc)()){e.n=1;break}return C("proModalContent",Object(l.__)("Split Path Step","wp-marketing-automations")),C("showProModal",!0),e.a(2);case 1:if(""!=O&&""!=v){e.n=2;break}return n(!0),e.a(2);case 2:return i(!0),n(!1),t=ma(ma({},$),{},{split_path:O,title:v,desc:h}),a={data:{data:{sidebarData:t}}},r=[],$.hasOwnProperty("split_path")&&""!=$.split_path||(o=A(B,O),c=o.newStep,s=o.newLink,u=o.newCount,a=ma(ma({},a),{},{steps:c,links:s,count:u}),r=c,C("statLoading",!0)),e.p=3,e.n=4,p()({path:Object(f.C)("/automation/".concat(z,"/step/").concat(H)),method:"POST",data:a}).then((function(e){if(200!==e.code)throw Error(Object(f.w)(null==e?void 0:e.message));k(e.message),$.hasOwnProperty("split_path")&&""!=$.split_path?P(L.id,ma(ma({},J),{},{sidebarValues:t}),{step_status:1}):P(L.id,ma(ma({},J),{},{sidebarValues:t}),{step_status:1},r),T(),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&C("meta",ma(ma({},G),e.result.meta)),setTimeout((function(){S(!1)}),100),i(!1)})).catch((function(e){throw Error(Object(f.w)(null==e?void 0:e.message))}));case 4:e.n=6;break;case 5:e.p=5,m=e.v,C("modalData",{status:!0,modalTitle:Object(l.__)("Update Split","wp-marketing-automations"),error:null==m?void 0:m.message}),i(!1);case 6:Object(f.Pb)(k,3e3);case 7:return e.a(2)}}),e,null,[[3,5]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){fa(o,a,r,c,i,"next",e)}function i(e){fa(o,a,r,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-split-test"},Object(a.createElement)(s.a,{size:28,icon:"split-test"})),Object(a.createElement)("div",{className:"wr_event_title"},Object(a.createElement)("span",null,Object(l.__)("Split Path","wp-marketing-automations")),!Object(f.fc)()&&Object(a.createElement)(jn.a,null)),Object(a.createElement)("div",{className:"wr_event_variant"}),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){S(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)("div",{className:"wr_content "+($.hasOwnProperty("split_path")&&""!=$.split_path?"":"split-full")},Object(a.createElement)("div",{className:"bwf-split-wrap"},Object(a.createElement)("div",{className:"bwf-split-title-text "+(t&&""===v?"has-error":"")},Object(a.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("Name","wp-marketing-automations")),Object(a.createElement)(u.TextControl,{className:"bwf-h-36",value:v,onChange:function(e){return g(e)},placeholder:Object(l.__)("Enter Name","wp-marketing-automations")}),t&&""===v&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("This is a required field.","wp-marketing-automations")))),(!$.hasOwnProperty("split_path")||""==$.split_path)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-split-path-select "+(t&&""===O?"has-error":"")},Object(a.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("No of Paths","wp-marketing-automations")),Object(a.createElement)(ca.b,{selected:O,className:"bwf_w_full",options:V,onChange:function(e){w(e)}}),t&&""===O&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("This is a required field.","wp-marketing-automations"))))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-split-title-desc "},Object(a.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("Description","wp-marketing-automations")),Object(a.createElement)(u.TextareaControl,{placeholder:Object(l.__)("Type here …","wp-marketing-automations"),value:h,onChange:function(e){return E(e)},rows:4})),Object(a.createElement)("div",{className:"bwf_clear_24"}))),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return S(!1)},disabled:c},Object(l.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(j.a,{isPrimary:!0,className:"bwf-no-ripple",onClick:W,isBusy:c,disabled:c},!Object(f.fc)()&&Object(a.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),$.hasOwnProperty("split_path")&&""!=$.split_path?Object(l.__)("Save","wp-marketing-automations"):Object(l.__)("Add","wp-marketing-automations"))))},ja=function(){var e=Object(b.a)(),t=Object(m.a)(),n=t.setAutomationData,r=t.showSidebar,c=e.openSidebar,i=e.getSidebarNodeData,s=e.getNodeDataByStepID,u=e.getNodeDataByID,f=c(),d=i(),p=d.type,O=void 0===p?"":p,j=d.data,w=void 0===j?{}:j,y=Object(V.i)().stepid,v=void 0===y?"":y,g=w.selected,_=void 0===g?"":g;Object(a.useEffect)((function(){if(""!==v){var e="start"===v?u("start"):s(v);Object(o.isEmpty)(e)?Object(V.k)(["stepid","editor"]):(n("sidebarNodeData",e),r(!0))}}),[]),Object(a.useEffect)((function(){if(f&&""===v&&!Object(o.isEmpty)(d)){var e=d.id,t=void 0===e?"":e;if(""!==t){var n=u(t),a=n.hasOwnProperty("stepId")?n.stepId:"";""!==(a=""===a&&"start"===t?"start":a)&&Object(V.l)({stepid:a},"/")}}}),[f]);return f?Object(a.createElement)("div",{className:"bwf-wl-wrap"},Object(a.createElement)("div",{className:"wl-sidebar-overlay step-"+O+"-wrap ",onClick:function(e){return e.preventDefault()}}),Object(a.createElement)("div",{className:"wr wr-expanded step-"+O+"-wrap-content "+("wp_sendemail"==_?"bwf-mail-action":"")},function(){switch(O){case"start":return Object(a.createElement)(Yn,null);case"action":return Object(a.createElement)(It,null);case"conditional":return Object(a.createElement)(Pn,null);case"wait":return Object(a.createElement)(pn,null);case"benchmark":return Object(a.createElement)(Ln,null);case"jump":return Object(a.createElement)(oa,null);case"split":return Object(a.createElement)(Oa,null);default:return Object(a.createElement)(a.Fragment,null,Object(l.__)("Node Type not registered","wp-marketing-automations"))}}())):Object(a.createElement)(a.Fragment,null)},wa=n(77),ya=n(110),va=n(1098),ga=n(1145);n(1136),n(1237);function _a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ha(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ha(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ha(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Ea=function(e){var t=e.id,n=e.sourceX,o=e.sourceY,c=e.targetX,i=e.targetY,s=e.sourcePosition,u=e.targetPosition,f=e.style,d=void 0===f?{}:f,p=(e.data,e.arrowHeadType),O=e.markerEndId,j=e.source,w=e.sourceHandleId,y=Object(r.g)({sourceX:n,sourceY:o,sourcePosition:s,targetX:c,targetY:i,targetPosition:u}),v=Object(r.i)(p,O),g=_a(Object(r.h)({sourceX:n,sourceY:o,targetX:c,targetY:i}),2),_=g[0],h=g[1],E=Object(m.a)(),k=E.setNodeForAdd,N=E.copyNodeHere,S=E.setOpenStepModal,P=E.setModalAnchorNode,C=Object(b.a)(),A=C.getEnableCopy,T=C.getEnableMove,D=C.getNodeDataByID,I=A(),M=T(),x=D(j);return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("path",{id:t,style:d,className:"react-flow__edge-path",d:y,markerEnd:v}),Object(a.createElement)("foreignObject",{width:23,height:23,x:_-11.5,y:h-11.5,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml"},Object(a.createElement)("div",{className:"bwf-edge-body"},I||M?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return N(x,"after",w||"")}},Object(a.createElement)("div",{className:"bwf-drag-node is-edge"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(e){k(j,{option:w}),S(!0),P(e.target)}}))))},ka=n(147),Na=n(17),Sa=(n(1238),n(33));function Pa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ca(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ca(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ca(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Aa=function(){var e=Object(b.a)(),t=e.getShowContactModalId,n=e.getAutomationData,r=e.getShowContactModalType,c=e.getContactModalExtraData,d=t(),O=r(),j=n().ID,y=c(),v=Object(o.isEmpty)(y)||Object(o.isNull)(y)?{}:y,g=v.split,_=void 0!==g&&g,h=v.path,E=void 0===h?"":h,k=v.pathCount,N=void 0===k?2:k,S=Object(m.a)().setAutomationData,P=Pa(Object(a.useState)(!0),2),C=P[0],A=P[1],T=Pa(Object(a.useState)({}),2),D=T[0],I=T[1],M=Pa(Object(a.useState)(10),2),x=M[0],F=M[1],G=Pa(Object(a.useState)(0),2),L=G[0],z=G[1],U=Pa(Object(a.useState)(!1),2),q=U[0],B=U[1],R=Pa(Object(a.useState)(E),2),H=R[0],V=R[1],J=Object(a.useRef)(new AbortController);Object(a.useEffect)((function(){return function(){S("contactModalData",{}),J.current.abort()}}),[]),Object(a.useEffect)((function(){A(!0),I({}),function(){try{var e={limit:x,offset:L,type:O};""!==H&&(e.path=H);var t=Object(Na.stringify)(e),n="string"!=typeof d?parseInt(d):0;p()({path:Object(f.C)("/automation/".concat(j,"/step/").concat(n,"/contacts?").concat(t)),method:"GET",signal:J.current.signal}).then((function(e){200===e.code&&(Object(o.isEmpty)(e.result)||I(e.result)),A(!1)}))}catch(e){A(!1)}}()}),[d,L,x,H]);var $=i()("bwfcrm-contacts-list",{"has-search":!1}),W=[{key:"name",label:Object(l.__)("Name","wp-marketing-automations"),isLeftAligned:!0,required:!0,cellClassName:"bwf-w-210 bwf-word-break"},{key:"email",label:Object(l.__)("Email","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-word-break bwf-w-150"},{key:"date",label:function(){if(_)return Object(l.__)("Date","wp-marketing-automations");switch(O){case"completed":return Object(l.__)("Completed On","wp-marketing-automations");case"queued":return Object(l.__)("Queued On","wp-marketing-automations");case"failed":return Object(l.__)("Failed On","wp-marketing-automations");case"active":return Object(l.__)("Started On","wp-marketing-automations");case"skipped":return Object(l.__)("Skipped On","wp-marketing-automations");default:return Object(l.__)("Date","wp-marketing-automations")}}(),isLeftAligned:!0,cellClassName:"bwf-w-150 bwf-word-break"}];!_||""!=E&&"all"!=E||W.push({key:"path",label:Object(l.__)("Path","wp-marketing-automations"),isLeftAligned:!1,cellClassName:"bwf-w-90"}),W.push({key:"traillink",label:"",isLeftAligned:!0,cellClassName:"bwf-w-100"});var Y,Q,X,Z,K,ee,te=function(e){return Object(a.createElement)(Sa.a,{href:"admin.php?page=autonami&path=/contact/"+e.id,type:"bwf-crm",className:"bwf-cursor-pointer bwf-a-no-underline",style:{color:"#0073aa"},key:e.id},e.hasOwnProperty("name")&&""!==e.name?e.name:"-")},ne=function(e){var t=[];return Object(o.isEmpty)(e)||e.map((function(e){var n=[{display:te(e),value:""},{display:e.email,value:""},{display:e.hasOwnProperty("time")&&""!==e.time?Object(f.kb)(Pe.a.unix(e.time).format("MM/DD/YYYY HH:mm:ss")):"-",value:""}];!_||""!=E&&"all"!=E||n.push({display:e.hasOwnProperty("path")&&le.hasOwnProperty(e.path)?Object(a.createElement)("div",{className:"bwf-splitpath bwfpathid-".concat(e.path)},Object(l.sprintf)(Object(l.__)("Path %s","wp-marketing-automations"),le[e.path])):"-",value:""}),n.push({display:e.hasOwnProperty("trail")&&""!==e.trail?Object(a.createElement)("div",{onClick:function(){Object(f.fc)()?(S("customerSelected",e),S("showContactModalId",0),S("showContactModalType","")):B(!0)},className:"bwf-cursor-pointer bwf-display-flex bwf-flex-start gap-8",style:{color:"#0073aa"}},!Object(f.fc)()&&Object(a.createElement)(s.a,{icon:"king",size:16}),Object(l.__)("View Journey","wp-marketing-automations")):"-",value:""}),t.push(n)})),t},ae=function(e){z((e-1)*x)},re=function(e){return"per_page"!==e?function(){}:oe},oe=function(e){e!==x&&F(e)},ce=Object(a.createElement)("div",{className:"bwf-contact-zero-state"},Object(a.createElement)(s.a,{icon:"contact-zero"}),Object(a.createElement)("div",{className:"bwf-heading"},Object(l.__)("No Contacts","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf-desc"},Object(l.__)("Once your customer start purchase or interact with the product. The contacts will appear here","wp-marketing-automations"))),ie=function(){var e=D.total,t=void 0===e?0:e,n=D.path_total,a=void 0===n?0:n;return""==H?parseInt(t):parseInt(a)},le=Object(f.Uc)();return Object(a.createElement)(u.Modal,{className:"bwf-admin-modal bwf-admin-modal-large bwf-single-automation-contact-modal bwf-h--core-header",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(a.createElement)("div",{className:"bwf-modal-header"},Object(a.createElement)("div",{className:"bwf-modal-heading"},function(){var e="",t=ie();if(_)e=""==E||"all"==E?Object(l.__)("Split Path Contacts","wp-marketing-automations"):Object(l.sprintf)(Object(l.__)("Path %s Contacts","wp-marketing-automations"),le[E]);else switch(O){case"completed":e=Object(l.__)("Completed Contacts","wp-marketing-automations");break;case"queued":e=Object(l.__)("Queued Contacts","wp-marketing-automations");break;case"failed":e=Object(l.__)("Failed Contacts","wp-marketing-automations");break;case"skipped":e=Object(l.__)("Skipped Contacts","wp-marketing-automations");break;case"active":e=Object(l.__)("Active Contacts","wp-marketing-automations");break;default:e=Object(l.__)("Contacts","wp-marketing-automations")}return e+" "+(t>0?"("+t+")":"")}()),Object(a.createElement)("span",{onClick:function(){S("showContactModalId",0),S("showContactModalType","")},className:"bwf-modal-close"},Object(a.createElement)(s.a,{icon:"close",color:"#353030"}))),(Q=D.data,X=void 0===Q?[]:Q,Z=D.total,K=void 0===Z?0:Z,D.path_total,ee=parseInt(L)/parseInt(x)+1,C||0!==parseInt(K)?Object(a.createElement)(a.Fragment,null,_&&(""===E||"all"===E)&&Object(a.createElement)("div",{className:"bwf-path-selector"},Object(a.createElement)(u.SelectControl,{value:H,className:"bwf_w_full",options:(Y=[{label:Object(l.__)("Path: All","wp-marketing-automations"),value:""},{label:Object(l.__)("Path A","wp-marketing-automations"),value:"1"},{label:Object(l.__)("Path B","wp-marketing-automations"),value:"2"}],3===parseInt(N)&&Y.push({label:Object(l.__)("Path C","wp-marketing-automations"),value:"3"}),Y),onChange:function(e){V(e)}})),Object(a.createElement)(ka.a,{className:$,title:"",rows:C?[]:ne(X),headers:W,query:{paged:ee},rowsPerPage:x,totalRows:ie(),isLoading:C,onPageChange:ae,onQueryChange:re,showMenu:!1,emptyMessage:Object(l.__)("No contacts found","wp-marketing-automations")}),!Object(f.fc)()&&Object(a.createElement)(w.b,{isOpen:q,onRequestClose:function(){return B(!1)},modalContent:{isFeature:!0,featureTitle:Object(l.__)("Contact Journey","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Step+Contact+Journey+Upgrade+Modal"})}})):Object(a.createElement)(a.Fragment,null,ce)))},Ta=n(49);function Da(e){return(Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ia(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return Ma(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Ma(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ma(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,Ma(m,"constructor",s),Ma(s,"constructor",l),l.displayName="GeneratorFunction",Ma(s,r,"GeneratorFunction"),Ma(m),Ma(m,r,"Generator"),Ma(m,a,(function(){return this})),Ma(m,"toString",(function(){return"[object Generator]"})),(Ia=function(){return{w:o,m:b}})()}function Ma(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(Ma=function(e,t,n,a){function o(t,n){Ma(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function xa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Fa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xa(Object(n),!0).forEach((function(t){Ga(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ga(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Da(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=Da(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Da(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function La(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function za(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ua(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ua(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var qa=function(e){var t=e.isProActive,n=void 0!==t&&t,r=Object(a.useContext)(f.h),c=za(Object(a.useState)(!1),2),i=c[0],d=c[1],p=za(Object(a.useState)(!1),2),O=p[0],j=p[1],w=za(Object(a.useState)(!1),2),y=w[0],v=w[1],g=Object(m.a)(),_=g.addNewStep,h=g.unsetCurrentNode,E=g.setOpenStepModal,k=g.setAutomationData,N=g.fetchSplitPathNodes,S=g.showSidebar,P=g.isInsideConditional,C=Object(b.a)(),A=C.getCurrentNode,T=C.getCurrentNodeAction,D=C.getOpenStepModal,I=C.getModalAnchorNode,M=D(),x=A(),F=T(),G=I();Object(a.useEffect)((function(){if(!Object(o.isEmpty)(x)&&x.hasOwnProperty("id")){var e=P(x.id);v(e),N().includes(x.id)?j(!0):j(!1)}}),[x]);var L=function(){var e,t=(e=Ia().m((function e(){var t,n,a,o,c=arguments;return Ia().w((function(e){for(;;)switch(e.n){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:"action",d(!0),n=F.data&&F.data.option?F.data.option:"",a=F.data&&F.data.position?F.data.position:"after",o=Fa(Fa({},x),{},{xPos:x.position.x,yPos:x.position.y}),e.n=1,_(t,o,n,a,{}).then((function(e){Object(f.Pb)(r,3e3),h(),d(!1),E(!1),"split"==t&&(k("sidebarNodeData",e),S(!0))}));case 1:return e.a(2)}}),e)})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){La(o,a,r,c,i,"next",e)}function i(e){La(o,a,r,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}();return M&&Object(a.createElement)(Y.a,{onFocusOutside:function(){h(),E(!1)},position:"center",className:"bwf-type-select-modal",onClick:function(e){return e.stopPropagation()},anchorRef:G},!i&&Object(a.createElement)("div",{className:"bwf-title-wrap"},Object(a.createElement)("div",{className:"bwf-title bwf_w_full"},Object(l.__)("Add Step","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf-cross bwf-cursor-pointer",onClick:function(){return E(!1)}},Object(a.createElement)(s.a,{icon:"cross",size:20})," ")),Object(a.createElement)("div",{className:"bwf-type-select-wrapper "+(i?"is-loading":"")},i?Object(a.createElement)("div",{className:"bwf-display-flex-column set-center is-loading"},Object(a.createElement)(Ta.a,{spaceClass:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-h3"},Object(l.__)("Please Wait…","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-p"},Object(l.__)("We are adding step in the flow","wp-marketing-automations"))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)(u.Button,{isSecondary:!0,onClick:function(){L("action")}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"charge"})),Object(l.__)("Action","wp-marketing-automations")),Object(a.createElement)(u.Button,{isSecondary:!0,onClick:function(){L("wait")}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"time-left"})),Object(l.__)("Delay","wp-marketing-automations")),Object(a.createElement)(u.Button,{isSecondary:!0,onClick:function(){n?L("conditional"):(k("proModalContent",{featureTitle:Object(l.__)("Conditional Step","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Add+Step+Condition+Upgrade+Modal"}),image:Object(f.vb)("conditional-step.png"),benefit:Object(l.__)("Use hundreds of conditions and advanced branching to create a highly tailored contact journey. Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))},style:{width:"100%"}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"condition"})),Object(l.__)("Condition","wp-marketing-automations"),!n&&Object(a.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(a.createElement)(s.a,{icon:"king",size:16}))),!O&&Object(a.createElement)(a.Fragment,null,!y&&Object(a.createElement)(u.Button,{isSecondary:!0,onClick:function(){n?L("split"):(k("proModalContent",{featureTitle:Object(l.__)("Split Path","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Add+Step+Split+Path+Upgrade+Modal"}),image:Object(f.vb)("split-path.png"),benefit:Object(l.__)("Test the subject lines, frequency or different automation paths to uncover hidden profits.Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))},style:{width:"100%"}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"split-test"})),Object(l.__)("Split Path","wp-marketing-automations"),!n&&Object(a.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(a.createElement)(s.a,{icon:"king",size:16}))),Object(a.createElement)(u.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){n?L("benchmark"):(k("proModalContent",{featureTitle:Object(l.__)("Goal Step","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Add+Step+Goal+Upgrade+Modal"}),image:Object(f.vb)("goal-step.png"),benefit:Object(l.__)("Never send unnecessary messages to users. Pull users to a specific step when a goal is achieved. Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"goal"})),Object(l.__)("Goal","wp-marketing-automations"),!n&&Object(a.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(a.createElement)(s.a,{icon:"king",size:16}))),Object(a.createElement)(u.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){n?L("jump"):(k("proModalContent",{featureTitle:Object(l.__)("Jump Step","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Add+Step+Jump+Upgrade+Modal"}),image:Object(f.vb)("jump-step.png"),benefit:Object(l.__)("Create advanced automations by letting contacts jump to any step in the journey.Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"jump"})),Object(l.__)("Jump","wp-marketing-automations"),!n&&Object(a.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(a.createElement)(s.a,{icon:"king",size:16}))),Object(a.createElement)(u.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){n?L("exit"):(k("proModalContent",{featureTitle:Object(l.__)("Exit Automation","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Add+Step+Exit+Upgrade+Modal"}),image:Object(f.vb)("exit-step.png"),benefit:Object(l.__)("Use this to make strategic decisions to end automation based on certain conditions.Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"exit"})),Object(l.__)("Exit","wp-marketing-automations"),!n&&Object(a.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(a.createElement)(s.a,{icon:"king",size:16})))))))},Ba=n(68),Ra=(n(1164),n(28)),Ha=n(35),Va=n.n(Ha),Ja=n(62),$a=n.n(Ja),Wa=n(47);function Ya(e){return(Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Xa(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xa(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function Za(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return Ka(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Ka(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ka(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,Ka(m,"constructor",s),Ka(s,"constructor",l),l.displayName="GeneratorFunction",Ka(s,r,"GeneratorFunction"),Ka(m),Ka(m,r,"Generator"),Ka(m,a,(function(){return this})),Ka(m,"toString",(function(){return"[object Generator]"})),(Za=function(){return{w:o,m:b}})()}function Ka(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(Ka=function(e,t,n,a){function o(t,n){Ka(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function er(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function tr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?er(Object(n),!0).forEach((function(t){nr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):er(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Ya(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=Ya(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ya(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ar(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}var rr=function(e){return{name:"contact-journey",className:"bwf-search-bwf-tags-result",options:function(t){return(n=Za().m((function t(n){var a,r,o;return Za().w((function(t){for(;;)switch(t.n){case 0:return a={search:n,limit:10,offset:0},t.n=1,p()({path:Object(f.C)("/automation/".concat(e,"/contacts/journey?")+Object(Na.stringify)(a)),method:"GET"});case 1:return r=t.v,o=[],Va()(r,"result")&&!$a()(r.result)&&(o=r.result.map((function(e){return tr(tr({},e),{},{key:String(e.trail),label:$a()(e.f_name)&&$a()(e.l_name)?e.email:e.f_name+" "+e.l_name})}))),t.a(2,o)}}),t)})),a=function(){var e=this,t=arguments;return new Promise((function(a,r){var o=n.apply(e,t);function c(e){ar(o,a,r,c,i,"next",e)}function i(e){ar(o,a,r,c,i,"throw",e)}c(void 0)}))},function(e){return a.apply(this,arguments)})(t);var n,a},isDebounced:!0,getOptionIdentifier:function(e){return e.key},getOptionKeywords:function(e){return[e.label]},getOptionLabel:function(e,t){return Object(a.createElement)("span",{key:"name",className:"bwf-customer-journey-search-result-name","aria-label":e.label},Object(a.createElement)("div",{className:"bwf-search-wrap"},Object(a.createElement)("div",{className:"bwf-search-label"},e.label),Object(a.createElement)("div",{className:"bwf-search-date"},"On:"," ",e.hasOwnProperty("c_date")?Object(f.kb)(e.c_date):"")))},getOptionCompletion:function(e){return e}}},or=function(e){var t=Qa(Object(a.useState)(!1),2),n=t[0],r=t[1],c=e.automationId,i=Object(a.useRef)(),u=Object(m.a)().setAutomationData,d=Object(b.a)().getCustomerSelected;Object(f.Vc)(i,(function(){return r(!1)}));var p=d(),O=function(e){if(Object(o.isArray)(e)&&!$a()(e)){if(!$a()(e)){var t=e[e.length-1];(e=[])[0]=t}var n=e.find((function(e){return Va()(e,"key")}));u("customerSelected",n),r(!1)}else u("customerSelected",{})};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:"<style>body{overflow-y: hidden !important;}</style>"}}),Object(a.createElement)("div",{className:"bwf-automation-customer-journey-wrap"},Object(a.createElement)("div",{className:"bwf-automation-customer-journey"},Object(a.createElement)("div",{className:"bwf-customer-journey-header"},Object(a.createElement)("div",{className:"bwf-section-header",onClick:function(){Object(f.fc)()?!n&&$a()(p)&&r(!0):(u("proModalContent",{featureTitle:Object(l.__)("Contact Journey","wp-marketing-automations"),proLink:Object(f.ib)("upgrade",{utm_medium:"Automation+Workflow+Contact+Journey+Upgrade+Modal"})}),u("showProModal",!0))}},Object(a.createElement)(s.a,{icon:Object(f.fc)()?"split-path":"king",width:16,height:18}),Object(a.createElement)("span",null,Object(l.__)("View Contact Journey","wp-marketing-automations")))),Object(f.fc)()&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-customer-journey-popover-wrap"},n&&Object(a.createElement)(Y.a,{ref:i,onFocusOutside:function(e){i.current.contains(e.relatedTarget)||n&&r(!1)},className:"bwf-customer-journey-popover",focusOnMount:!0,placement:"bottom"},Object(a.createElement)("div",{className:"bwf-customer-journey-popover-content"},Object(a.createElement)(Ra.a,{autocompleter:rr(c),className:"bwf-customer-journey-search",placeholder:Object(l.__)("Search by Name, Email and Phone","wp-marketing-automations"),multiple:!1,inlineTags:!1,selected:[],onChange:O,bwfEnableEmptySearch:!0})))))),!$a()(p)&&Object(a.createElement)("div",{className:"bwf-customer-selected"},Object(a.createElement)(Wa.a,{id:p.trail,label:p.hasOwnProperty("label")&&!$a()(p.label.trim())?p.label:p.email,remove:function(){return u("customerSelected",{})}}))))},cr=n(1134);function ir(e){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lr(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return sr(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(sr(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,sr(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,sr(m,"constructor",s),sr(s,"constructor",l),l.displayName="GeneratorFunction",sr(s,r,"GeneratorFunction"),sr(m),sr(m,r,"Generator"),sr(m,a,(function(){return this})),sr(m,"toString",(function(){return"[object Generator]"})),(lr=function(){return{w:o,m:b}})()}function sr(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(sr=function(e,t,n,a){function o(t,n){sr(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function mr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ur(Object(n),!0).forEach((function(t){br(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ur(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function br(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=ir(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=ir(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ir(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fr(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function dr(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){fr(o,a,r,c,i,"next",e)}function i(e){fr(o,a,r,c,i,"throw",e)}c(void 0)}))}}function pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Or(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Or(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Or(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var jr=function(){var e=Object(m.a)(),t=e.setAutomationData,n=e.declareWinnerPath,r=Object(b.a)(),c=r.selectedWinner,i=r.getAutomationId,d=r.getautomationMeta,O=pr(Object(a.useState)(!1),2),w=O[0],y=O[1],v=pr(Object(a.useState)(!1),2),g=v[0],_=v[1],h=pr(Object(a.useState)(!1),2),E=h[0],k=h[1],N=pr(Object(a.useState)(!0),2),S=N[0],P=N[1],C=pr(Object(a.useState)(!0),2),A=C[0],T=C[1],D=pr(Object(a.useState)(""),2),I=D[0],M=D[1],x=pr(Object(a.useState)(!1),2),F=x[0],G=x[1],L=Object(f.Uc)(),z=c(),U=z.nodeId,q=void 0===U?"":U,B=z.stepID,R=void 0===B?"":B,H=z.title,V=void 0===H?"":H,J=Object(a.useRef)(new AbortController),$=d(),W=i(),Y=function(){t("declareWinner",{}),t("showSplitWinner",!1)};Object(a.useEffect)((function(){!function(){try{P(!0),p()({path:Object(f.C)("/automation/".concat(W,"/analytics/").concat(R,"?mode=split")),method:"GET"}).then((function(e){200===e.code&&e.result.hasOwnProperty("data")&&!Object(o.isEmpty)(e.result.data)&&T(e.result.data),P(!1)}))}catch(e){P(!1)}}()}),[]);var Q=function(){var e=dr(lr().m((function e(a,r,o){return lr().w((function(e){for(;;)switch(e.p=e.n){case 0:return y(!0),e.p=1,e.n=2,p()({path:Object(f.C)("/automation/".concat(W,"/step/").concat(r,"/declare-winner")),method:"POST",signal:J.current.signal,data:{node_id:a,path_num:o}}).then(function(){var e=dr(lr().m((function e(c){return lr().w((function(e){for(;;)switch(e.n){case 0:if(!c.result){e.n=1;break}return G(!0),e.n=1,n(a,o).then((function(e){if(e){k(!0);var n=e.targetElemt,a=e.newStep,o=e.newLink,c=e.newCount;try{p()({path:Object(f.C)("/automation/".concat(W,"/step/").concat(r,"/")),method:"POST",signal:J.current.signal,data:{steps:a,links:o,count:c}}).then((function(e){200===e.code&&(e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&t("meta",mr(mr({},$),e.result.meta)),t("targetNode",n),t("flowCenter",!0)),k(!1)}))}catch(e){k(!1)}}else k(!1)}));case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,e.v,y(!1);case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(t,n,a){return e.apply(this,arguments)}}(),X=function(){var e,t,n=(e=A.paths,t=[],(void 0===e?[]:e).map((function(e){var n=e.path,a=void 0===n?"":n,r=e.stats,o=void 0===r?[]:r;parseInt(a)===parseInt(I)&&(t=o)})),t);return Object(a.createElement)("div",{className:"bwf-declare-winner-confirm-wrap"},Object(a.createElement)(s.a,{icon:"declare-winner"}),Object(a.createElement)("div",{className:"bwf-declare-winner-confirm-content"},Object(a.createElement)("div",{className:"bwf-declare-winner-confirm-header"},Object(l.sprintf)(Object(l.__)("Congratulations! You have declared Path %s as winner","wp-marketing-automations"),L[I])),Object(a.createElement)("div",{className:"bwf-declare-winner-confirm-stat-wrap"},n.map((function(e,t){return Object(a.createElement)("div",{className:"bwf-declare-winner-confirm-stat",key:t},Object(a.createElement)("div",{className:"bwf-split-node-value"},e.v),Object(a.createElement)("div",{className:"bwf-split-node-label"},e.l))}))),Object(a.createElement)("div",{className:"bwf-declare-winner-confirm-footer"},Object(a.createElement)(j.a,{isPrimary:!0,isBusy:E,disabled:E,onClick:Y},E?Object(l.__)("Updating Automation","wp-marketing-automations"):Object(l.__)("Close","wp-marketing-automations")))))};return Object(a.createElement)(u.Modal,{className:"bwf-admin-modal bwf-admin-modal-no-header bwf-declare-winner-modal "+(!g||F?"bwf-admin-modal-1024":"bwf-admin-modal-480"),shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(a.createElement)("div",{className:"bwf-declare-winner-header-wrap"},Object(a.createElement)("div",{className:"bwf-declare-winner-header"},function(){if(S)return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-210 bwf-h-20"}),Object(a.createElement)("div",{className:"bwf_clear_5"}),Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-150 bwf-h-15"}));var e=A.started_at,t=void 0===e?"":e;return g?Object(a.createElement)(a.Fragment,null,F?"":Object(l.sprintf)(Object(l.__)("Declare Path %s as Winner","wp-marketing-automations"),L[I])):Object(a.createElement)("div",{className:"bwf-declarewinner-step-title"},Object(a.createElement)("div",{className:"bwf-title-wrap"},Object(a.createElement)("div",{className:"bwf-split-title"},Object(l.sprintf)(Object(l.__)("Result of %s","wp-marketing-automations"),V))),Object(a.createElement)("div",{className:"bwf-split-date"},Object(a.createElement)("span",null,Object(l.__)("Started On ","wp-marketing-automations")+" : "),Object(f.lb)(t)))}()),Object(a.createElement)("div",{className:"bwf-close-modal",onClick:Y},Object(a.createElement)(s.a,{icon:"close",size:20}))),Object(a.createElement)("div",{className:"bwf-declare-winner-content"},function(){if(S)return Object(a.createElement)("div",{className:"bwf-declare-winner-analytics-wrap"},[1,2].map((function(e){return Object(a.createElement)("div",{className:"bwf-declare-winner-analytics-row",key:e},Object(a.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-60"})),[1,2,3,4,5,6,7,8].map((function(e){return Object(a.createElement)("div",{className:"bwf-declare-winner-analytics-col",key:e},Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-30"}),Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-70"}))})),Object(a.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-h-30 bwf-w-120"})))})));var e=A.paths,t=void 0===e?[]:e;return g?Object(a.createElement)(a.Fragment,null,F?X():Object(l.sprintf)(Object(l.__)("You are about to declare Path %s as winner. All other paths will be removed from the automation. This action cannot be undone.","wp-marketing-automations"),L[I])):Object(a.createElement)("div",{className:"bwf-declare-winner-analytics-wrap"},t.map((function(e,t){var n=e.path,r=void 0===n?1:n,o=e.stats,c=void 0===o?[]:o;return Object(a.createElement)("div",{className:"bwf-declare-winner-analytics-row",key:t},Object(a.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(a.createElement)("span",{className:"bwf-split-path-title splitpath-".concat(r)},Object(l.__)("Path","wp-marketing-automations")+" "+L[r])),c.map((function(e,t){return Object(a.createElement)("div",{className:"bwf-declare-winner-analytics-col",key:t},Object(a.createElement)("span",{className:"bwf-split-test-value"},e.v),Object(a.createElement)("span",{className:"bwf-split-test-label"},e.l))})),Object(a.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(a.createElement)("div",{className:"bwf-declare-winner-btn",onClick:function(){_(!0),M(r)}},Object(l.__)("Declare Winner","wp-marketing-automations"))))})))}()),g&&!F&&Object(a.createElement)("div",{className:"bwf-declare-winner-footer",key:"footer"},Object(a.createElement)(j.a,{className:"bwf-cancel-btn",onClick:Y,disabled:!1},Object(l.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(j.a,{isPrimary:!0,onClick:function(){Q(q,R,I)},isBusy:w,disabled:w},Object(l.__)("Declare Winner","wp-marketing-automations"))))};function wr(e){return(wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yr(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof i?a:i,s=Object.create(l.prototype);return vr(s,"_invoke",function(n,a,r){var o,i,l,s=0,u=r||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,b.n=n,c}};function f(n,a){for(i=n,l=a,t=0;!m&&s&&!r&&t<u.length;t++){var r,o=u[t],f=b.p,d=o[2];n>3?(r=d===a)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(i=0,b.v=a,b.n=o[1]):f<d&&(r=n<3||o[0]>a||a>d)&&(o[4]=n,o[5]=a,b.n=d,i=0))}if(r||n>1)return c;throw m=!0,a}return function(r,u,d){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&f(u,d),i=u,l=d;(t=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(b.n=-1),f(i,l)):b.n=l:b.v=l);try{if(s=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(m=b.n<0)?l:n.call(a,b))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:m}}}(n,r,o),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(vr(t={},a,(function(){return this})),t),m=s.prototype=i.prototype=Object.create(u);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,vr(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,vr(m,"constructor",s),vr(s,"constructor",l),l.displayName="GeneratorFunction",vr(s,r,"GeneratorFunction"),vr(m),vr(m,r,"Generator"),vr(m,a,(function(){return this})),vr(m,"toString",(function(){return"[object Generator]"})),(yr=function(){return{w:o,m:b}})()}function vr(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}(vr=function(e,t,n,a){function o(t,n){vr(e,t,(function(e){return this._invoke(t,n,e)}))}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,a)}function gr(e){return function(e){if(Array.isArray(e))return Nr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||kr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _r(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function hr(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){_r(o,a,r,c,i,"next",e)}function i(e){_r(o,a,r,c,i,"throw",e)}c(void 0)}))}}function Er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,c,i=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw r}}return i}}(e,t)||kr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kr(e,t){if(e){if("string"==typeof e)return Nr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nr(e,t):void 0}}function Nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function Sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Pr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sr(Object(n),!0).forEach((function(t){Cr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Cr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=wr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=wr(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==wr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ar=function(e){var t=e.id,n=Object(wa.a)(),c=n.setL2Title,d=n.setPageCountData,j=Object(ya.a)().getPageCountData,y=Object(a.useContext)(f.h),v=Object(r.n)().setCenter,g=Object(r.l)(),_=Object(r.m)((function(e){return e.setSelectedElements})),h=Object(pt.b)(),E=h.mergeTag,k=h.setMergeTag,N=h.reset,S=h.identifier,P=h.setIdentifier,C=Object(b.a)(),A=j(),T=C.getLoading,D=C.getAutomationSteps,I=C.getAutomationLinks,M=C.getEnableCopy,x=C.getEnableMove,F=C.getAutomationData,G=C.getError,L=C.getShowContactModalId,z=C.getOpenStartSidebar,U=C.getCustomerSelected,q=C.isProModal,B=C.getautomationMeta,R=C.getModalData,H=C.getFlowCenter,J=C.getTargetNode,$=C.showSplitWinnerModal,Y=C.getProModalContent,Q=C.getSingleAutomationFailedCount,X=R(),Z=Object(m.a)(),K=Z.setAutomationData,ee=Z.fetchAutomationStat,te=I(),ne=D(),ae=M(),re=x(),oe=T(),ce=G(),ie=F(),le=L(),ue=ie.title,me=void 0===ue?"":ue,be=z(),fe=U(),de=q(),pe=Y(),Oe=B(),je=Oe.tips,ve=void 0===je?[]:je,ge=H(),_e=J(),he=$(),Ee=Q();Object(a.useEffect)((function(){oe||d(Pr(Pr({},A),{},{single_a_contacts:Ee}))}),[Ee]),Object(va.a)("workflow",me,"admin.php?page=autonami&path=/automations",!1,null,t,!1,!0,!1),Object(a.useEffect)((function(){K("isNewAutomation",0)}),[ie]);var Ne=Object(a.useRef)();Object(a.useEffect)((function(){return window.addEventListener("keyup",(function(e){"Escape"!==e.key&&"27"!==e.keyCode||null!==document.querySelector(".bwf-escape-note")&&(K("enableCopy",!1),K("enableMove",!1),K("isProcessingCopyPaste",!1),K("copyData",{}),K("moveID",0),Object(f.Pb)(y,100))})),K("enableCopy",!1),K("enableMove",!1),K("copyData",{}),function(){document.body.style.overflow="",c(""),K("statLoading",!0),K("statData",[]),K("isLoading",!0)}}),[]),Object(a.useEffect)((function(){Object(o.isNull)(document.querySelector("#bwf-single-automation-wrap"))||(Ne.current=document.querySelector("#bwf-single-automation-wrap").getBoundingClientRect()),oe||ee()}),[oe]);var Se={start:W,action:we,conditional:se,end:ye,benchmark:ke,wait:Fe,yesNoNode:Ge,exit:Re,jump:Qe,split:nt,splitpath:at},Pe={"bwf-default":Ea},Ce=te.map((function(e){return e.id&&(e.id.includes("yesedge")||e.id.includes("noedge")||e.hasOwnProperty("sourceHandle")&&"split-edge"===e.sourceHandle)?e:Pr(Pr({},e),{},{type:"bwf-default"})})),Ae=Er(Object(a.useState)([]),2),Te=Ae[0],De=Ae[1],Ie=Er(Object(a.useState)(!1),2),Me=Ie[0],xe=Ie[1],Le=Er(Object(a.useState)("bwf-automation-wrap"),2),ze=Le[0],Ue=Le[1],qe=Er(Object(a.useState)(!1),2),Be=qe[0],He=qe[1],Ve=Er(Object(a.useState)(!0),2),Je=Ve[0],$e=Ve[1];if(Object(a.useEffect)((function(){if(!Me||ge){var e=0,t=0,n=g.getState(),a=n.nodes,r=n.selectedElements;if(Object(o.isEmpty)(r)||be||ge)if(K("openStartSidebar",!1),ge&&!Object(o.isEmpty)(r)){var c=a.filter((function(e){return e.id===_e}));(Object(o.isEmpty)(c)||Object(o.isNull)(c)||""===c||Object(o.isUndefined)(c))&&(c=r[0]),c.hasOwnProperty("__rf")?(e=c.__rf.position.x,t=c.__rf.position.y):(e=c.position.x,t=c.position.y),t=parseFloat(t)+parseFloat(Ne.current.height)*(Be?.5:.4),xe(!0),v(e,t,1),K("flowCenter",!1)}else if(a.length&&Ne.current){var i=a[0];i.hasOwnProperty("__rf")?(e=i.__rf.position.x+140,t=i.__rf.position.y):(e=i.position.x+140,t=i.position.y),t=parseFloat(t)+parseFloat(Ne.current.height)*(Be?.5:.4),xe(!0),v(e,t,1),K("flowCenter",!1)}}}),[Te,Me,ge]),Object(a.useEffect)((function(){(xe(!1),ne.length>1)?function(){var e=hr(yr().m((function e(){var t;return yr().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Object(ga.a)([].concat(gr(ne),gr(Ce)),!0,ae||re?20:0);case 1:t=e.v,De(t);case 2:return e.a(2)}}),e)})));return function(){return e.apply(this,arguments)}}()():De(ne)}),[ne,oe,Be,fe]),Object(a.useEffect)((function(){_([])}),[fe]),oe)return Object(a.createElement)(Ta.a,null);var We,Ye,Xe=function(){var e=hr(yr().m((function e(){var n;return yr().w((function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,p()({path:Object(f.C)("/automation/".concat(t,"/delete_meta")),method:"DELETE",data:{meta_key:"tips"}}).then((function(e){200===e.code&&K("meta",Pr(Pr({},Oe),{},{tips:[]}))}));case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.log(n);case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}();return Object(a.createElement)(pt.a.Provider,{value:{selectedMergeTag:E,setSelectedMergeTag:k,resetSelection:N,selectedIdentifier:S,setSelectedIdentifier:P}},Object(o.isEmpty)(ce)?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(Ba.a,null),Object(a.createElement)("div",{className:i()(ze,{"full-screen":Be}),id:"bwf-single-automation-wrap"},Object(a.createElement)("div",{className:"automation-title"}," ",me," "),Object(a.createElement)(or,{automationId:t}),(ae||re)&&Object(a.createElement)("div",{className:"bwf-escape-note"},Object(l.__)("Press ESC to skip paste step","wp-marketing-automations")),Object(o.isEmpty)(fe)?Object(a.createElement)(r.f,{defaultZoom:1,minZoom:.5,maxZoom:4,nodeTypes:Se,nodesConnectable:!1,nodesDraggable:!1,zoomOnScroll:!1,zoomOnDoubleClick:!1,paneMoveable:!0,panOnScroll:!0,elements:Te,edgeTypes:Pe,onSelectionChange:function(e){if(!Object(o.isNull)(e)&&e.length>0){var t=e[0];if(Object(r.k)(t))return void Ue("bwf-automation-wrap bwf-node-selected");if(Object(r.j)(t))return void Ue("bwf-automation-wrap bwf-edge-selected");Ue("bwf-automation-wrap")}}},Object(a.createElement)(qa,{isProActive:Object(f.fc)()}),Object(a.createElement)(r.c,{showInteractive:!1},Object(a.createElement)(r.b,{onClick:function(){He(!Be),document.body.style.overflow=Be?"":"hidden",_([])}},Be?Object(a.createElement)("span",{className:"dashicons dashicons-fullscreen-exit-alt custom-control-icon"}):Object(a.createElement)("span",{className:"dashicons dashicons-fullscreen-alt custom-control-icon"}))),Object(a.createElement)(r.a,null)):Object(a.createElement)(cr.a,{inAutomation:!0,setFullScreen:He,fullScreen:Be}),!Object(o.isEmpty)(ve)&&Object(a.createElement)("div",{className:"bwfan-automation-tips"},Object(a.createElement)("span",{className:"bwf-close-tip",onClick:Xe},Object(a.createElement)(s.a,{icon:"close",size:12})),ve.map((function(e,t){return Object(a.createElement)("div",{className:"bwfan-automation-tip",key:t},Object(a.createElement)("div",null,Object(a.createElement)(s.a,{icon:"tip"}),Object(a.createElement)("strong",null,"Tip")),Object(a.createElement)("div",null,e))})))),Object(a.createElement)(ja,null),""!==le&&0!==le&&Object(a.createElement)(Aa,null)):Object(a.createElement)(a.Fragment,null,(We=ce.message,Ye=void 0===We?Object(l.__)("There has been a critical error on this website.","wp-marketing-automations"):We,Object(a.createElement)(a.Fragment,null,Je&&Object(a.createElement)(u.Modal,{title:Object(l.__)("Failed","wp-marketing-automations"),onRequestClose:function(){$e(!1),Object(V.l)({page:"autonami",path:"/automations/"},"/",{})},className:"bwf-admin-modal bwf-admin-modal-small bwf-single-automation-error-modal",shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1},Object(a.createElement)("div",{className:"bwf-error-content"},Object(a.createElement)(a.Fragment,null,Object(a.createElement)("p",null,Ye),Object(a.createElement)("p",null,Object(l.__)("For quick help, contact FunnelKit","wp-marketing-automations")," ",Object(a.createElement)("a",{href:"https://funnelkit.com/support/?utm_source=WordPress&utm_medium=Automation+Error&utm_campaign=FKA+Lite+Plugin",target:"_blank",rel:"noopener noreferrer"},Object(l.__)("support ","wp-marketing-automations"))))),Object(a.createElement)("div",{className:"bwf-footer"},Object(a.createElement)(u.Button,{isPrimary:!0,onClick:function(){$e(!1),Object(V.l)({page:"autonami",path:"/automations/"},"/",{})}},Object(l.__)("Close","wp-marketing-automations"))))))),!Object(f.fc)()&&Object(a.createElement)(w.b,{isOpen:de,onRequestClose:function(){return K("showProModal",!1)},modalContent:Pr({isFeature:!0,proLink:Object(f.ib)("upgrade")},pe)}),Object(a.createElement)(O.a,{modalTitle:X.modalTitle,deleteEntityName:X.deleteEntityName,confirmText:X.confirmText,confirmButtonText:X.buttonConfirm,cancelButtonText:X.buttonCancel,onConfirm:X.onConfirm,isLoading:X.loading,successMessage:X.success,errorMessage:X.error,content:X.content,onRequestClose:function(){K("modalData",{loading:!1,status:!1})},confirmDescription:X.hasOwnProperty("confirmDescription")?X.confirmDescription:"",isOpen:X.status,isDelete:X.isDelete}),he&&Object(a.createElement)(jr,null))};t.default=function(e){var t=e.match.params.id;Object(f.m)("Automation #"+t);var n=Object(m.a)(),o=n.fetchAutomation,c=n.setAutomationData,i=n.clearAutomationError;return Object(a.useEffect)((function(){c("statLoading",!0),c("statData",[]),c("isLoading",!0),i(),o(t)}),[t]),Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-single-automation-body-header",style:{paddingBottom:"8px"}},Object(a.createElement)("div",{className:"bwf-content-header-left"},Object(a.createElement)("div",{className:"bwf-content-header-title2"},Object(l.__)("Workflow","wp-marketing-automations")))),Object(a.createElement)(r.e,null,Object(a.createElement)(Ar,{id:t})))}}}]);