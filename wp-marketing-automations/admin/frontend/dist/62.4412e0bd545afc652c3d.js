(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{1225:function(e,t,n){},1305:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(68),a=n(1),c=n(147),i=n(52);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=["getStateProp"];function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(){var e=Object(i.a)("taskHistoryList"),t=e.getStateProp;return f(f({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,s)),{},{getTaskHistory:function(){return t("tasks")},getPageNumber:function(){return parseInt(t("offset"))/parseInt(t("limit"))+1},getPerPageCount:function(){return parseInt(t("limit"))},getOffset:function(){return parseInt(t("offset"))},getTotalCount:function(){return parseInt(t("total"))},getLoadingStatus:function(){return t("isLoading")},getCompletedCount:function(){return t("completed")},getScheduledCount:function(){return t("scheduled")},getPausedCount:function(){return t("paused")},getFailedCount:function(){return t("failed")},getPageCountData:function(){return t("countData")}})},p=n(51),y=n(3);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var d=["fetch","setStateProp"];function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=O(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==O(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(){var e=Object(p.a)("taskHistoryList"),t=e.fetch,n=e.setStateProp;return j(j({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,d)),{},{fetch:function(e,n,r,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",c=n.s,i=void 0===c?"":c,u=n.automation,s=n.action,l={offset:r,limit:o,status:e,action_slug:s,automation_id:u,search:""!=a?a:i};t("GET",Object(y.C)("/automations/task-history"),l)},setTaskListValues:function(e,t){n(e,t)}})},h=n(2),_=n(60),k=n(61),E=n(19),S=n(5),P=n(54),T=n(9),C=n.n(T),N=n(6),x=n.n(N),D=(n(1225),n(12)),A=n(7),I=n(204),F=n(28);function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,c,i=[],u=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var M=function(e){var t=e.onSearch,n=L(Object(r.useState)([]),2),o=n[0],c=n[1];return Object(r.createElement)(F.a,{autocompleter:I.d,multiple:!1,allowFreeTextSearch:!0,inlineTags:!0,selected:o,onChange:function(e){c(e),t(Object(h.isEmpty)(e)?"":e[0].key)},placeholder:Object(a.__)("Search","wp-marketing-automations"),showClearButton:!0,disabled:!1,bwfMaintainSingleTerm:!0})},R=n(149),B=n(97);function q(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return H(s,"_invoke",function(n,r,o){var a,i,u,s=0,l=o||[],f=!1,b={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,u=e,b.n=n,c}};function m(n,r){for(i=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],m=b.p,p=a[2];n>3?(o=p===r)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,b.v=r,b.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,b.n=p,i=0))}if(o||n>1)return c;throw f=!0,r}return function(o,l,p){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,p),i=l,u=p;(t=i<2?e:u)||!f;){a||(i?i<3?(i>1&&(b.n=-1),m(i,u)):b.n=u:b.v=u);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=b.n<0)?u:n.call(r,b))!==c)break}catch(t){a=e,i=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var c={};function i(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(H(t={},r,(function(){return this})),t),f=s.prototype=i.prototype=Object.create(l);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,H(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,H(f,"constructor",s),H(s,"constructor",u),u.displayName="GeneratorFunction",H(s,o,"GeneratorFunction"),H(f),H(f,o,"Generator"),H(f,r,(function(){return this})),H(f,"toString",(function(){return"[object Generator]"})),(q=function(){return{w:a,m:b}})()}function H(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}(H=function(e,t,n,r){function a(t,n){H(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))})(e,t,n,r)}function U(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}var Y=function(e){var t=e.isOpen,n=e.tasks,o=e.onSuccess,c=e.onError,i=e.onRequestClose,u=n?n.length:0,s=Object(B.useMutation)(function(){var e,t=(e=q().m((function e(t){return q().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,C()({path:Object(y.C)("/automations/tasks/"),method:"DELETE",data:{task_ids:t}});case 1:return e.a(2,e.v)}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){U(a,r,o,c,i,"next",e)}function i(e){U(a,r,o,c,i,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),{onSuccess:function(){setTimeout((function(){return s.reset()}),2500),o&&o()},onError:function(){c&&c()}});return Object(r.createElement)(P.a,{modalTitle:Object(a._n)("Delete Task","Delete Tasks",u,"wp-marketing-automations"),deleteDescriptionText:Object(r.createElement)(r.Fragment,null,Object(a.__)("You are about to delete ","wp-marketing-automations"),Object(a._n)("task","tasks",u,"wp-marketing-automations"),Object(a.__)(". This action cannot be undone. Cancel to stop, Delete to proceed.","wp-marketing-automations")),confirmButtonText:Object(a.__)("Delete","wp-marketing-automations"),cancelButtonText:Object(a.__)("Cancel","wp-marketing-automations"),onConfirm:function(){return s.mutate(n.map((function(e){return e.id})))},isLoading:s.isLoading,successMessage:s.isSuccess&&Object(a.__)("Tasks Deleted!","wp-marketing-automations"),errorMessage:s.isError&&(s.error&&s.error.message?s.error.message:Object(a.__)("Unable to delete tasks","wp-marketing-automations")),onRequestClose:function(){return!!i&&i()},isOpen:t,confirmDescription:Object(a.__)("This action is irreversible","wp-marketing-automations"),isDelete:!0})};function V(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return $(s,"_invoke",function(n,r,o){var a,i,u,s=0,l=o||[],f=!1,b={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,u=e,b.n=n,c}};function m(n,r){for(i=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],m=b.p,p=a[2];n>3?(o=p===r)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,b.v=r,b.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,b.n=p,i=0))}if(o||n>1)return c;throw f=!0,r}return function(o,l,p){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,p),i=l,u=p;(t=i<2?e:u)||!f;){a||(i?i<3?(i>1&&(b.n=-1),m(i,u)):b.n=u:b.v=u);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=b.n<0)?u:n.call(r,b))!==c)break}catch(t){a=e,i=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var c={};function i(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):($(t={},r,(function(){return this})),t),f=s.prototype=i.prototype=Object.create(l);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,$(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,$(f,"constructor",s),$(s,"constructor",u),u.displayName="GeneratorFunction",$(s,o,"GeneratorFunction"),$(f),$(f,o,"Generator"),$(f,r,(function(){return this})),$(f,"toString",(function(){return"[object Generator]"})),(V=function(){return{w:a,m:b}})()}function $(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}($=function(e,t,n,r){function a(t,n){$(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))})(e,t,n,r)}function J(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}var Q=function(e){var t=e.isOpen,n=e.tasks,o=e.onSuccess,c=e.onError,i=e.onRequestClose,u=e.screenType,s=Object(B.useMutation)(function(){var e,t=(e=V().m((function e(t){return V().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,C()({path:Object(y.C)("/automations/execute-tasks/"),method:"POST",data:{task_ids:t}});case 1:return e.a(2,e.v)}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){J(a,r,o,c,i,"next",e)}function i(e){J(a,r,o,c,i,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),{onSuccess:function(){setTimeout((function(){return s.reset()}),2500),o&&o()},onError:function(){c&&c()}});return Object(r.createElement)(P.a,{modalTitle:"failed"===u?Object(a.__)("Reschedule Task","wp-marketing-automations"):Object(a.__)("Execute Task","wp-marketing-automations"),deleteDescriptionText:"failed"===u?Object(a.__)("You are about to reschedule selected task. This action cannot be undone. Cancel to stop, Reschedule to proceed.","wp-marketing-automations"):Object(a.__)("You are about to execute selected task. This action cannot be undone. Cancel to stop, Execute to proceed.","wp-marketing-automations"),confirmButtonText:"failed"===u?Object(a.__)("Reschedule","wp-marketing-automations"):Object(a.__)("Execute","wp-marketing-automations"),cancelButtonText:Object(a.__)("Cancel","wp-marketing-automations"),onConfirm:function(){return s.mutate(n.map((function(e){return e.id})))},successMessage:s.isSuccess&&("failed"===u?Object(a.__)("Tasks Rescheduled!","wp-marketing-automations"):Object(a.__)("Tasks Executed!","wp-marketing-automations")),errorMessage:s.isError&&(s.error&&s.error.message?s.error.message:"failed"===u?Object(a.__)("Unable to reschedule tasks","wp-marketing-automations"):Object(a.__)("Unable to execute tasks","wp-marketing-automations")),onRequestClose:function(){return!!i&&i()},isOpen:t,isDelete:!0})};function z(){return(z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,c,i=[],u=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var X=function(e){var t=e.floatingBarProps,n=void 0===t?{}:t,o=e.resetSelection,c=e.onSuccess,i=e.screenType,u=e.screenTypeId,s=K(Object(r.useState)([]),2),l=s[0],f=s[1],b=K(Object(r.useState)(!1),2),m=b[0],p=b[1],y=K(Object(r.useState)(!1),2),O=y[0],d=y[1],g=function(){o&&o(),f([])};Object(r.useEffect)((function(){g()}),[i]);var j,v,w=Object(r.useCallback)((function(e,t){switch(e){case"delete":f(t),p(!0);break;case"execute":f(t),d(!0)}}),[]);return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(R.a,z({actions:(j=i,v=[{id:"delete",icon:"trash",hint:Object(a.__)("Delete Tasks","wp-marketing-automations")}],"completed"!==j&&v.push({id:"execute",icon:"play",hint:"failed"===j?Object(a.__)("Reschedule","wp-marketing-automations"):Object(a.__)("Execute","wp-marketing-automations")}),v),onAction:w},n)),Object(r.createElement)(Y,{tasks:l,isOpen:m,onSuccess:function(){c&&c("delete",l),g()},onError:g,onRequestClose:function(){return p(!1)}}),Object(r.createElement)(Q,{tasks:l,isOpen:O,onSuccess:function(){c&&c("execute",l),g()},onError:g,onRequestClose:function(){return d(!1)},screenType:i,screenTypeId:u}))},Z=n(44);function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(){return(te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=ee(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ee(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ae(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return ce(s,"_invoke",function(n,r,o){var a,i,u,s=0,l=o||[],f=!1,b={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,u=e,b.n=n,c}};function m(n,r){for(i=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],m=b.p,p=a[2];n>3?(o=p===r)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,b.v=r,b.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,b.n=p,i=0))}if(o||n>1)return c;throw f=!0,r}return function(o,l,p){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,p),i=l,u=p;(t=i<2?e:u)||!f;){a||(i?i<3?(i>1&&(b.n=-1),m(i,u)):b.n=u:b.v=u);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=b.n<0)?u:n.call(r,b))!==c)break}catch(t){a=e,i=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var c={};function i(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ce(t={},r,(function(){return this})),t),f=s.prototype=i.prototype=Object.create(l);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ce(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,ce(f,"constructor",s),ce(s,"constructor",u),u.displayName="GeneratorFunction",ce(s,o,"GeneratorFunction"),ce(f),ce(f,o,"Generator"),ce(f,r,(function(){return this})),ce(f,"toString",(function(){return"[object Generator]"})),(ae=function(){return{w:a,m:b}})()}function ce(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}(ce=function(e,t,n,r){function a(t,n){ce(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))})(e,t,n,r)}function ie(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function ue(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){ie(a,r,o,c,i,"next",e)}function i(e){ie(a,r,o,c,i,"throw",e)}c(void 0)}))}}function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,c,i=[],u=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw o}}return i}}(e,t)||le(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){if(e){if("string"==typeof e)return fe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fe(e,t):void 0}}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var be=function(e){var t=e.type,n=e.query,o=n.automation,i=n.action,u=w(),s=m(),l=Object(r.useContext)(y.h),f=u.fetch,b=u.setTaskListValues,p=s.getTaskHistory,O=s.getPageNumber,d=s.getPerPageCount,g=s.getTotalCount,j=s.getOffset,v=s.getLoadingStatus,T=s.getCompletedCount,N=s.getFailedCount,I=s.getPausedCount,F=s.getScheduledCount,L=Object(r.useRef)(new AbortController),G=se(Object(r.useState)({loading:!1,status:!1}),2),B=G[0],q=G[1],H=se(Object(r.useState)([]),2),U=H[0],Y=H[1],V=se(Object(r.useState)([]),2),$=V[0],J=V[1],Q=se(Object(r.useState)(!1),2),z=Q[0],K=Q[1],W=se(Object(r.useState)({}),2),ee=W[0],ne=W[1],oe=se(Object(r.useState)(""),2),ce=oe[0],ie=oe[1],fe=[],be=se(Object(r.useState)([]),2),me=(be[0],be[1]),pe=p(),ye=d(),Oe=j(),de=g(),ge=O(),je=v(),ve=F(),we=N(),he=T(),_e=I(),ke="t_0";Object(h.isEmpty)(t)||("paused"===t?ke="t_1":"completed"===t?ke="l_1":"failed"===t&&(ke="l_0")),Object(r.useEffect)((function(){me([]),f(ke,n,Oe,ye,ce)}),[Oe,ye,t,o,i]);var Ee=function(){var e=ue(ae().m((function e(){return ae().w((function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,C()({path:Object(y.C)("/automations/task-filters"),method:"GET",signal:L.current.signal}).then((function(e){200==e.code&&(e.result.hasOwnProperty("automations")&&Y(Object.entries(e.result.automations).map((function(e){var t=se(e,2),n=t[0];return{label:t[1],value:n}}))),e.result.hasOwnProperty("actions")&&J(e.result.actions&&Object.entries(e.result.actions).map((function(e){var t=se(e,2),n=t[0];return{label:t[1],value:n}}))))})).catch((function(e){console.log(e)}));case 1:e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){return Ee(),function(){L.current.abort()}}),[]);var Se=function(e){e!==ye&&b("limit",e)},Pe=function(){var e=ue(ae().m((function e(t,r){var o,c,i,u,s;return ae().w((function(e){for(;;)switch(e.p=e.n){case 0:if(o="",c="",i="","delete"===r?(o=Object(y.C)("/automations/tasks"),c="DELETE",i="Deleting..."):"execute"===r?(o=Object(y.C)("/automations/execute-tasks"),c="POST",i="Executing..."):"run"===r&&(o=Object(y.C)("/automations/run-tasks"),c="POST",i="Running..."),l(i),!(Array.isArray(t)&&!Object(h.isEmpty)(t)||"run"===r&&parseInt(t)>0)){e.n=5;break}return e.p=1,e.n=2,C()({path:o,method:c,data:{task_ids:t}}).then((function(e){if(200===e.code)q({status:!1}),f(ke,n,0,ye,ce),l(e.message);else{var t=e&&e.message&&e.message.msg?e.message.msg:"";t=!t&&e&&e.message?e.message:t,l(t)}}));case 2:e.n=4;break;case 3:e.p=3,s=e.v,u=!(u=s&&s.message&&s.message.msg?s.message.msg:"")&&s&&s.message?s.message:u,l(u);case 4:e.n=6;break;case 5:l(Object(a.__)("No Task Selected","wp-marketing-automations"));case 6:Object(y.Pb)(l,3e3);case 7:return e.a(2)}}),e,null,[[1,3]])})));return function(t,n){return e.apply(this,arguments)}}(),Te=Object(r.useMemo)((function(){var e={};if(Array.isArray(pe)){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=le(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw a}}}}(pe);try{for(n.s();!(t=n.n()).done;){var r=t.value;e[r.id]=r}}catch(e){n.e(e)}finally{n.f()}}return e}),[pe]),Ce=Object(R.b)(Te),Ne=Ce.singleSelectProps,xe=Ce.selectAllProps,De=Ce.floatingBarProps,Ae=Ce.resetSelection,Ie=pe?pe.map((function(e){var t,n=[{display:Object(r.createElement)(Z.a,te({type:"checkbox",checked:!1,onChange:function(){}},Ne[e.id])),value:e.id},{display:(t=e,Object(r.createElement)(_.a,{label:Object(a.__)("Quick Actions","wp-marketing-automations"),menuPosition:"bottom right",renderContent:function(e){var n=e.onToggle;return Object(r.createElement)(r.Fragment,null,["t_0","t_1"].includes(ke)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(k.a,{isClickable:!0,onInvoke:function(){Pe(t.id,"run"),n()}},Object(r.createElement)(E.a,{justify:"flex-start"},Object(r.createElement)(E.c,null,Object(r.createElement)(A.a,{icon:"play"})),Object(r.createElement)(E.c,null,Object(a.__)("Run now","wp-marketing-automations"))))),Object(r.createElement)(k.a,{isClickable:!0,onInvoke:function(){var e={status:!0,deleteDescriptionText:Object(a.__)("You are about to delete task. This action cannot be undone. Cancel to stop, Delete to proceed.","wp-marketing-automations"),buttonConfirm:Object(a.__)("Delete","wp-marketing-automations"),buttonCancel:Object(a.__)("Cancel","wp-marketing-automations"),modalTitle:Object(a.__)("Delete Task","wp-marketing-automations")};q(re(re({},e),{},{onConfirm:function(){return Pe([t.id],"delete",e)}})),n()}},Object(r.createElement)(E.a,{justify:"flex-start"},Object(r.createElement)(E.c,null,Object(r.createElement)(A.a,{icon:"trash"})),Object(r.createElement)(E.c,null,Object(a.__)("Delete","wp-marketing-automations")))))}})),value:""},{display:"#"+e.id,value:""},{display:e.task_integration+" : "+e.task_integration_action,value:e.task_integration},{display:e.task_details?Object(r.createElement)("ul",{dangerouslySetInnerHTML:{__html:e.task_details}}):"-",value:""},{display:e.automation_name?Object(r.createElement)("a",{href:e.automation_url,className:"bwf-a-no-underline"},e.automation_name):"-",value:e.automation_name},{display:e.task_date?Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.task_date}}):"-",value:""},{display:Object(r.createElement)(S.Button,{isSecondary:!0,className:"bwf-btn-small is-light bwf-btn-gray",onClick:function(){ne(e),K(!0)}},Object(a.__)("View","wp-marketing-automations")),value:""}];return fe.push(e.id),n})):[],Fe=Object(r.createElement)(r.Fragment,null,Object(a.__)("Scheduled","wp-marketing-automations"),parseInt(ve)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},ve):""),Le=Object(r.createElement)(r.Fragment,null,Object(a.__)("Completed","wp-marketing-automations"),parseInt(he)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},he):""),Ge=Object(r.createElement)(r.Fragment,null,Object(a.__)("Failed","wp-marketing-automations"),parseInt(we)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},we):""),Me=Object(r.createElement)(r.Fragment,null,Object(a.__)("Paused","wp-marketing-automations"),parseInt(_e)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},_e):""),Re=x()("bwfcrm-task-list-table",{"has-search":!0}),Be=[{key:"id",label:Object(r.createElement)(Z.a,te({type:"checkbox",checked:!1,onChange:function(){},"aria-label":Object(a.__)("Select","wp-marketing-automations")},xe)),required:!0,cellClassName:"bwf-col-action bwf-w-30 bwf-table-col-sticky bwf-sticky-left"},{key:"action",label:"",isLeftAligned:!0,required:!0,cellClassName:"bwf-col-action bwf-w-30 bwf-table-col-sticky bwf-sticky-left"},{key:"task",label:Object(a.__)("Task","wp-marketing-automations"),isLeftAligned:!0,required:!0,cellClassName:"bwf-w-100"},{key:"actions",label:Object(a.__)("Action","wp-marketing-automations"),isLeftAligned:!0},{key:"data",label:Object(a.__)("Data","wp-marketing-automations"),isLeftAligned:!0},{key:"automation",label:Object(a.__)("Automation","wp-marketing-automations"),isLeftAligned:!0},{key:"date",label:Object(a.__)("Date","wp-marketing-automations"),isLeftAligned:!0},{key:"view",label:"",isLeftAligned:!0,cellClassName:"bwf-w-60"}],qe=Object(r.createElement)("div",{className:"bwf-page-filters bwf-display-flex bwf-flex"},Object(r.createElement)(S.SelectControl,{className:"bwf-w-300 bwf-mr-10",value:o||"",options:[{label:Object(a.__)("Select Automation","wp-marketing-automations"),value:""}].concat(U),onChange:function(e){if(e)Object(D.l)({automation:e},"/",n);else{var t=n;delete t.automation,Object(D.l)({},"/",t)}}}),Object(r.createElement)(S.SelectControl,{className:"bwf-w-300 bwf-mr-10",value:i||"",options:[{label:Object(a.__)("Select Action","wp-marketing-automations"),value:""}].concat($),onChange:function(e){if(e)Object(D.l)({action:e},"/",n);else{var t=n;delete t.action,Object(D.l)({},"/",t)}}}));return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-content-header-new"},Object(r.createElement)("div",{className:"bwf-content-header-left"},Object(r.createElement)("span",{className:"bwf-cursor-pointer bwf-display-flex",onClick:function(){return Object(D.l)({page:"autonami",path:"/automations-v1"},"/",{})}},Object(r.createElement)(A.a,{icon:"arrow-left",size:20})),Object(r.createElement)("div",{className:"bwf-content-header-title"},Object(a.__)("Task History","wp-marketing-automations")),parseInt(de)>0&&Object(r.createElement)("div",{className:"bwf-content-header-count"},Object(a.sprintf)(Object(a.__)("(%s Results)","wp-marketing-automations"),de)))),Object(r.createElement)(S.ButtonGroup,{className:"bwf-btn-group-tabs"},Object(r.createElement)(S.Button,{isPrimary:!t||"scheduled"===t,isSecondary:t&&"scheduled"!==t,onClick:function(){return Object(D.l)({path:"/automations-v1/task-history/scheduled"},"/",n)}},Fe),Object(r.createElement)(S.Button,{isPrimary:t&&"paused"===t,isSecondary:t&&"paused"!==t,onClick:function(){return Object(D.l)({path:"/automations-v1/task-history/paused"},"/",n)}},Me),Object(r.createElement)(S.Button,{isPrimary:t&&"completed"===t,isSecondary:t&&"completed"!==t,onClick:function(){return Object(D.l)({path:"/automations-v1/task-history/completed"},"/",n)}},Le),Object(r.createElement)(S.Button,{isPrimary:t&&"failed"===t,isSecondary:t&&"failed"!==t,onClick:function(){return Object(D.l)({path:"/automations-v1/task-history/failed"},"/",n)}},Ge)),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(c.a,{rows:Ie,className:Re,headers:Be,query:{paged:ge},rowsPerPage:ye,totalRows:de,isLoading:je,onPageChange:function(e,t){b("offset",(e-1)*ye)},onQueryChange:function(e){return"per_page"!==e?function(){}:Se},rowHeader:!0,showMenu:!1,actions:[Object(r.createElement)("div",{className:"bwf-flex",key:"bwf-an-task-history-filters"},qe),Object(r.createElement)(M,{query:n,onSearch:function(e){ie(e||""),f(ke,n,0,ye,e)},key:"bwf-an-task-history-search"})],emptyMessage:Object(a.__)("No tasks found","wp-marketing-automations")}),z&&Object(r.createElement)(S.Modal,{className:"bwf-message-preview-modal bwf-admin-modal bwf-admin-modal-large bwf-task-model bwf-h--core-header",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(r.createElement)("div",{className:"bwf-modal-header"},Object(r.createElement)("div",{className:"bwf-modal-heading"},Object(a.__)("Details","wp-marketing-automations")),Object(r.createElement)("span",{onClick:function(){return K(!1)},className:"bwf-modal-close"},Object(r.createElement)(A.a,{icon:"close",color:"#353030"}))),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-150 bwf_bold bwf_align_center"},Object(a.__)("Automation","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},ee.automation_name)),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-150 bwf_bold bwf_align_center"},Object(a.__)("Event","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},ee.automation_source+" : "+ee.automation_event)),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-150 bwf_bold bwf_align_center"},Object(a.__)("Action","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},ee.task_integration+(ee.task_integration_action?" : ".concat(ee.task_integration_action):""))),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey bwf-task-details"},Object(r.createElement)("ul",{className:"bwf_align_center",dangerouslySetInnerHTML:{__html:ee.task_details}})),!Object(h.isEmpty)(ee.task_message)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-h3 bwf-pt-15"},Object(a.__)("Notes","wp-marketing-automations")),Object.entries(ee.task_message).map((function(e,t){var n=se(e,2),o=n[0],a=n[1];return Object(r.createElement)("div",{className:"bwf-p-15",key:t},Object(r.createElement)("div",{className:"bwfcrm-task_notes_card"},a),Object(r.createElement)("div",{className:"bwfcrm-task_notes_time"},Object(r.createElement)("i",null,o)))}))))),Object(r.createElement)(P.a,{modalTitle:B.modalTitle,deleteDescriptionText:B.deleteDescriptionText,confirmButtonText:B.buttonConfirm,cancelButtonText:B.buttonCancel,onConfirm:B.onConfirm,isLoading:B.loading,successMessage:B.success,errorMessage:B.error,onRequestClose:function(){return q({status:!1})},isOpen:B.status,content:B.content,isDelete:!0}),Object(r.createElement)(X,{floatingBarProps:De,resetSelection:Ae,onSuccess:function(){return f(ke,n,0,ye)},screenType:t,screenTypeId:ke}))},me=n(1098),pe=n(110),ye=n(77);function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Oe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Oe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.default=function(e){var t=(0,m().getPageCountData)(),n=Object(pe.a)().getPageCountData,c=Object(ye.a)().setPageCountData,i=n();Object(r.useEffect)((function(){c(ge(ge({},i),t))}),[t]),Object(me.a)("automations-v1","","","","",0),Object(y.m)(Object(a.__)("Task History","wp-marketing-automations"));var u=e.match.params.type,s=Object(D.i)();return Object(r.createElement)(o.a,null,Object(r.createElement)("div",{className:"bwfcrm-task-list"},Object(r.createElement)(be,{query:s,type:u})))}}}]);