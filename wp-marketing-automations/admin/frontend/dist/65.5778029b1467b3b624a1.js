(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{1126:function(e,t,a){"use strict";var n=a(0),r=a(28),c=a(1),i=a(204);t.a=function(e){var t=e.selected,a=e.onTagsChange;return Object(n.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(n.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add Tags","wp-marketing-automations")),Object(n.createElement)(r.a,{autocompleter:i.b,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){a(e)},onRemoveTag:function(e,n){var r=t.filter((function(t){return!(t.key==e&&t.label==n)}));a(r)},placeholder:Object(c.__)("Search by tag name","wp-marketing-automations"),showClearButton:!0,disabled:!1}))}},1143:function(e,t,a){"use strict";var n=a(0),r=a(28),c=a(1),i=a(204);t.a=function(e){var t=e.selected,a=e.onListsChange;return Object(n.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(n.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add to Lists","wp-marketing-automations")),Object(n.createElement)(r.a,{autocompleter:i.a,multiple:!1,allowFreeTextSearch:!0,selected:t,onChange:function(e){a(e)},onRemoveTag:function(e){var n=t.filter((function(t){return t.key!=e}));a(n)},placeholder:Object(c.__)("Search by list name","wp-marketing-automations"),showClearButton:!0,disabled:!1}))}},1324:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(1),c=a(1108),i=a(5),l=a(2),o=a(1126),s=a(1143),u=a(19),m=a(68),b=a(7),d=a(26),f=a(3);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){j(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function j(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=p(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==p(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,c,i,l=[],o=!0,s=!1;try{if(c=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;o=!1}else for(;!(o=(n=c.call(a)).done)&&(l.push(n.value),l.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{if(!o&&null!=a.return&&(i=a.return(),Object(i)!==i))return}finally{if(s)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?v(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var y=function(e){var t=e.headersData,a=e.onRequestImport,c=e.submitButtonText,p=e.secondaryButtonText,O=e.onSecondaryButtonClick,v=e.savedData,y=e.buttonAlignClass,_=e.backButtonText,E=e.backButtonClick,k=e.extra,h=e.isSubmitButtonBusy,S=e.sourceHeaderText,N=void 0===S?Object(r.__)("Columns To Import","wp-marketing-automations"):S,x=e.contactHeaderText,C=void 0===x?Object(r.__)("Map Into Field","wp-marketing-automations"):x,T=e.updateExistingText,B=void 0===T?Object(r.__)("Update Existing Contacts","wp-marketing-automations"):T,F=e.secondaryClass,A=void 0===F?"":F,P=t.headers,I=t.fields,D=w(Object(n.useState)(v&&v.mapped_fields?function(e,t){if(!e)return{};var a={},n=function(n){t.find((function(e){return e.index.toString()===n}))&&(a[n]=e[n])};for(var r in e)n(r);return a}(v.mapped_fields,P):{}),2),M=D[0],U=D[1],R=w(Object(n.useState)(0),2),H=R[0],L=R[1],q=v&&v.tags?v.tags.map((function(e){return{key:e.id,label:e.value}})):[],J=v&&v.lists?v.lists.map((function(e){return{key:e.id,label:e.value}})):[],z=w(Object(n.useState)(q),2),V=z[0],$=z[1],G=w(Object(n.useState)(J),2),K=G[0],Q=G[1],W=w(Object(n.useState)(!(!v||!("update_existing"in v))&&v.update_existing),2),X=W[0],Y=W[1],Z=w(Object(n.useState)(!v||!("update_blank"in v)||v.update_blank),2),ee=Z[0],te=Z[1],ae=w(Object(n.useState)(!v||!("marketing_status"in v)||v.marketing_status),2),ne=ae[0],re=(ae[1],w(Object(n.useState)(!(!v||!("trigger_events"in v))&&v.trigger_events),2)),ce=re[0],ie=re[1],le=w(Object(n.useState)(null),2),oe=le[0],se=le[1],ue=(k||{}).disableMarketingStatusCheck,me=void 0!==ue&&ue,be=function(){return se(null),0===Object(l.size)(M)?(setTimeout((function(){return se(Object(r.__)("Select the contact fields.","wp-marketing-automations"))}),500),!1):!!Object.values(M).includes("email")||(setTimeout((function(){return se(Object(r.__)("Map contact email with a form field.","wp-marketing-automations"))}),500),!1)},de=function(){if(be()){var e={};P.map((function(t){t.index in M&&(e[t.index]=M[t.index])}));var t={map:e,tags:V.map((function(e){return{id:e.key,value:e.label}})),lists:K.map((function(e){return{id:e.key,value:e.label}})),update_existing:X,trigger_events:ce,imported_contact_status:H,dont_update_blank:ee};!me&&(t.marketing_status=ne),a(t)}},fe=function(){if(be()){var e={};P.map((function(t){t.index in M&&(e[t.index]=M[t.index])}));var t={map:e,tags:V.map((function(e){return{id:e.key,value:e.label}})),lists:K.map((function(e){return{id:e.key,value:e.label}})),update_existing:X,trigger_events:ce};!me&&(t.marketing_status=ne),O(t)}},pe=Object(f.P)();return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-c-import-mapper-fields bwf-card-wrap bwf-form-fields bwf-crm-importer-csv-wrap"},Object(n.createElement)("div",{className:"bwf-card-header"},Object(n.createElement)("span",{className:"bwf-form-title"},Object(r.__)("Mapping","wp-marketing-automations"))),oe&&Object(n.createElement)("div",{className:"bwf-mr-16 bwf-ml-16"},Object(n.createElement)(m.a,null),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)(d.a,{status:"error",onRemove:function(){return se(null)}},oe)),!Object(l.isArray)(I)||!I.length>0||!Object(l.isArray)(P)||!P.length>0?!Object(l.isArray)(I)||!I.length>0?Object(n.createElement)(d.a,{status:"error",className:"bwf-mlr-24 bwf-mt-24-i"},Object(r.__)("No contact fields found","wp-marketing-automations")):!Object(l.isArray)(P)||!P.length>0?Object(n.createElement)(d.a,{status:"error",className:"bwf-mlr-24 bwf-mt-24-i"},Object(r.__)("No mapping fields found","wp-marketing-automations")):void 0:Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-crm-import-section"},Object(n.createElement)("div",{className:"bwf-c-import-field",key:"mapper-sel-wrap"},Object(n.createElement)("strong",null,N),Object(n.createElement)("span",null),Object(n.createElement)("strong",null,C)),P.map((function(e,t){return Object(n.createElement)("div",{key:t,className:"bwf-c-import-field"},Object(n.createElement)(i.TextControl,{disabled:!0,value:e.header}),Object(n.createElement)("span",{className:"bwf-display-flex"},Object(n.createElement)(b.a,{icon:"mapper"})),Object(n.createElement)("select",{value:e.index in M?M[e.index]:"",onChange:function(t){return function(e,t){var a=t.target.value,n="index"in e?e.index:"";""===a&&n in M?U(Object(l.omit)(M,n)):""!==a&&""!==n&&U(g(g({},M),{},j({},n,a)))}(e,t)},key:"bwf-select-field"},Object(n.createElement)("option",{value:"",key:"default-key"+t},Object(r.__)("Do Not Import This Field","wp-marketing-automations")),I.map((function(e,a){return"fields"in e&&e.fields.length>0&&Object(n.createElement)("optgroup",{key:e.id+"-"+a+"-"+t,label:e.name},e.fields.map((function(e){return Object(n.createElement)("option",{key:e.id,value:e.id},e.name)})))}))))}))),Object(n.createElement)("div",{className:"bwf-crm-import-section",style:{border:0}},Object(n.createElement)("div",{className:"bwf-h4"},Object(r.__)("Contact Profile","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf-c-import-field",key:"select-tag-list"},Object(n.createElement)(o.a,{onTagsChange:$,selected:V}),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)(s.a,{onListsChange:Q,selected:K})),!me&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-heading7-new"},Object(r.__)("Status","wp-marketing-automations")),Object(n.createElement)("select",{className:"bwf-import-csv-status-select",onChange:function(e){L(e.target.value)},key:"bwf-select-status",value:H},Object.keys(pe).map((function(e){return Object(n.createElement)("option",{key:e,value:e},pe[e])}))),Object(n.createElement)("div",{className:"bwf_clear_24"})),Object(n.createElement)("div",null,Object(n.createElement)(i.ToggleControl,{label:B,checked:X,className:"bwf-tooglecontrol-advance",onChange:Y})),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",null,Object(n.createElement)(i.ToggleControl,{label:Object(r.__)("Don't Update Blank Values","wp-marketing-automations"),checked:ee,className:"bwf-tooglecontrol-advance",onChange:te})),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",null,Object(n.createElement)(i.ToggleControl,{label:Object(r.__)("Trigger Automations (For Tag & List Related Events)","wp-marketing-automations"),checked:ce,className:"bwf-tooglecontrol-advance",onChange:ie})))),Object(n.createElement)("div",{className:"bwf-pt-0"},y?Object(n.createElement)(n.Fragment,null,Object(n.createElement)(u.a,null,!!_&&Object(n.createElement)(u.b,null,Object(n.createElement)(i.Button,{isSecondary:!0,onClick:E,className:A},_)),Object(n.createElement)(u.b,{className:y},Object(n.createElement)(i.Button,{onClick:de,isBusy:!!h,disabled:!(!h&&P.length>0),isPrimary:!0},Object(n.createElement)("span",null,c||Object(r.__)("Import","wp-marketing-automations"))),p&&Object(n.createElement)(i.Button,{onClick:fe,className:"bwf-ml-10",isSecondary:!0},p)))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)(i.Button,{onClick:de,isPrimary:!0,isBusy:!!h,disabled:!!h,className:"bwf-display-flex"},Object(n.createElement)("span",null,c||Object(r.__)("Import","wp-marketing-automations"))),p&&Object(n.createElement)(i.Button,{onClick:fe,className:"bwf-ml-10",isSecondary:!0},p)))))},_=a(1104),E=a(49);t.default=function(e){var t=e.feedId,a=Object(c.a)(),i=a.setStep,l=a.fetchMappingData,o=a.updateStepTwo,s=a.resetUpdateStepTwoStatus,u=Object(_.a)(),b=u.getFormFields,p=u.getFormHeaders,O=u.getFeed,g=u.getLoading,j=u.getError,w=u.getEditMapMode,v=u.getUpdateStepTwoStatus,k={fields:b(),headers:p()},h=g(),S=j(),N=O(),x=N&&N.status?parseInt(N.status):1,C=N&&N.data?N.data:{},T=w(),B=v();Object(n.useEffect)((function(){l(parseInt(t))}),[]);var F=Object(n.useContext)(f.h);Object(n.useEffect)((function(){3===B&&F(Object(r.__)("Unable to save mapping data","wp-marketing-automations")),2===B&&(F(Object(r.__)("Mapping data saved successfully","wp-marketing-automations")),i("double_optin")),B&&1!==B&&(s(),setTimeout((function(){return F("")}),3e3))}),[B]);var A=Object(r.__)("Next","wp-marketing-automations");return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(m.a,null),Object(n.createElement)("div",{className:"bwf-crm-stepper-wrap"},Object(n.createElement)("div",{className:"bwf-crm-importer-wrap"},S&&Object(n.createElement)(d.a,{status:"error"},S.message?S.message:Object(r.__)("Unknown error occurred","wp-marketing-automations")),h?Object(n.createElement)(E.a,null):Object(n.createElement)(y,{headersData:k,onRequestImport:function(e){o(t,e,x)},submitButtonText:A,submitButtonIcon:"arrow-right-alt",savedData:C,buttonAlignClass:"bwf_text_right bwf-m-20-imp",secondaryClass:"bwf-m-20-imp",backButtonText:!T&&Object(r.__)("Back","wp-marketing-automations"),backButtonClick:!T&&function(){return i("selection")},sourceHeaderText:Object(r.__)("Forms Fields","wp-marketing-automations"),contactHeaderText:Object(r.__)("Contact Fields","wp-marketing-automations"),extra:{disableMarketingStatusCheck:!0},isSubmitButtonBusy:1===B}))))}}}]);