(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{1144:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(125),a={"am-AM":/^(\+?374|0)(33|4[134]|55|77|88|9[13-689])\d{6}$/,"ar-AE":/^((\+?971)|0)?5[024568]\d{7}$/,"ar-BH":/^(\+?973)?(3|6)\d{7}$/,"ar-DZ":/^(\+?213|0)(5|6|7)\d{8}$/,"ar-LB":/^(\+?961)?((3|81)\d{6}|7\d{7})$/,"ar-EG":/^((\+?20)|0)?1[0125]\d{8}$/,"ar-IQ":/^(\+?964|0)?7[0-9]\d{8}$/,"ar-JO":/^(\+?962|0)?7[789]\d{7}$/,"ar-KW":/^(\+?965)([569]\d{7}|41\d{6})$/,"ar-LY":/^((\+?218)|0)?(9[1-6]\d{7}|[1-8]\d{7,9})$/,"ar-MA":/^(?:(?:\+|00)212|0)[5-7]\d{8}$/,"ar-OM":/^((\+|00)968)?([79][1-9])\d{6}$/,"ar-PS":/^(\+?970|0)5[6|9](\d{7})$/,"ar-SA":/^(!?(\+?966)|0)?5\d{8}$/,"ar-SD":/^((\+?249)|0)?(9[012369]|1[012])\d{7}$/,"ar-SY":/^(!?(\+?963)|0)?9\d{8}$/,"ar-TN":/^(\+?216)?[2459]\d{7}$/,"az-AZ":/^(\+994|0)(10|5[015]|7[07]|99)\d{7}$/,"ar-QA":/^(\+?974|0)?([3567]\d{7})$/,"bs-BA":/^((((\+|00)3876)|06))((([0-3]|[5-6])\d{6})|(4\d{7}))$/,"be-BY":/^(\+?375)?(24|25|29|33|44)\d{7}$/,"bg-BG":/^(\+?359|0)?8[789]\d{7}$/,"bn-BD":/^(\+?880|0)1[13456789][0-9]{8}$/,"ca-AD":/^(\+376)?[346]\d{5}$/,"cs-CZ":/^(\+?420)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"da-DK":/^(\+?45)?\s?\d{2}\s?\d{2}\s?\d{2}\s?\d{2}$/,"de-DE":/^((\+49|0)1)(5[0-25-9]\d|6([23]|0\d?)|7([0-57-9]|6\d))\d{7,9}$/,"de-AT":/^(\+43|0)\d{1,4}\d{3,12}$/,"de-CH":/^(\+41|0)([1-9])\d{1,9}$/,"de-LU":/^(\+352)?((6\d1)\d{6})$/,"dv-MV":/^(\+?960)?(7[2-9]|9[1-9])\d{5}$/,"el-GR":/^(\+?30|0)?6(8[5-9]|9(?![26])[0-9])\d{7}$/,"el-CY":/^(\+?357?)?(9(9|7|6|5|4)\d{6})$/,"en-AI":/^(\+?1|0)264(?:2(35|92)|4(?:6[1-2]|76|97)|5(?:3[6-9]|8[1-4])|7(?:2(4|9)|72))\d{4}$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-AG":/^(?:\+1|1)268(?:464|7(?:1[3-9]|[28]\d|3[0246]|64|7[0-689]))\d{4}$/,"en-BM":/^(\+?1)?441(((3|7)\d{6}$)|(5[0-3][0-9]\d{4}$)|(59\d{5}$))/,"en-BS":/^(\+?1[-\s]?|0)?\(?242\)?[-\s]?\d{3}[-\s]?\d{4}$/,"en-GB":/^(\+?44|0)7[1-9]\d{8}$/,"en-GG":/^(\+?44|0)1481\d{6}$/,"en-GH":/^(\+233|0)(20|50|24|54|27|57|26|56|23|53|28|55|59)\d{7}$/,"en-GY":/^(\+592|0)6\d{6}$/,"en-HK":/^(\+?852[-\s]?)?[456789]\d{3}[-\s]?\d{4}$/,"en-MO":/^(\+?853[-\s]?)?[6]\d{3}[-\s]?\d{4}$/,"en-IE":/^(\+?353|0)8[356789]\d{7}$/,"en-IN":/^(\+?91|0)?[6789]\d{9}$/,"en-JM":/^(\+?876)?\d{7}$/,"en-KE":/^(\+?254|0)(7|1)\d{8}$/,"fr-CF":/^(\+?236| ?)(70|75|77|72|21|22)\d{6}$/,"en-SS":/^(\+?211|0)(9[1257])\d{7}$/,"en-KI":/^((\+686|686)?)?( )?((6|7)(2|3|8)[0-9]{6})$/,"en-KN":/^(?:\+1|1)869(?:46\d|48[89]|55[6-8]|66\d|76[02-7])\d{4}$/,"en-LS":/^(\+?266)(22|28|57|58|59|27|52)\d{6}$/,"en-MT":/^(\+?356|0)?(99|79|77|21|27|22|25)[0-9]{6}$/,"en-MU":/^(\+?230|0)?\d{8}$/,"en-MW":/^(\+?265|0)(((77|88|31|99|98|21)\d{7})|(((111)|1)\d{6})|(32000\d{4}))$/,"en-NA":/^(\+?264|0)(6|8)\d{7}$/,"en-NG":/^(\+?234|0)?[789]\d{9}$/,"en-NZ":/^(\+?64|0)[28]\d{7,9}$/,"en-PG":/^(\+?675|0)?(7\d|8[18])\d{6}$/,"en-PK":/^((00|\+)?92|0)3[0-6]\d{8}$/,"en-PH":/^(09|\+639)\d{9}$/,"en-RW":/^(\+?250|0)?[7]\d{8}$/,"en-SG":/^(\+65)?[3689]\d{7}$/,"en-SL":/^(\+?232|0)\d{8}$/,"en-TZ":/^(\+?255|0)?[67]\d{8}$/,"en-UG":/^(\+?256|0)?[7]\d{8}$/,"en-US":/^((\+1|1)?( |-)?)?(\([2-9][0-9]{2}\)|[2-9][0-9]{2})( |-)?([2-9][0-9]{2}( |-)?[0-9]{4})$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-ZM":/^(\+?26)?0[79][567]\d{7}$/,"en-ZW":/^(\+263)[0-9]{9}$/,"en-BW":/^(\+?267)?(7[1-8]{1})\d{6}$/,"es-AR":/^\+?549(11|[2368]\d)\d{8}$/,"es-BO":/^(\+?591)?(6|7)\d{7}$/,"es-CO":/^(\+?57)?3(0(0|1|2|4|5)|1\d|2[0-4]|5(0|1))\d{7}$/,"es-CL":/^(\+?56|0)[2-9]\d{1}\d{7}$/,"es-CR":/^(\+506)?[2-8]\d{7}$/,"es-CU":/^(\+53|0053)?5\d{7}$/,"es-DO":/^(\+?1)?8[024]9\d{7}$/,"es-HN":/^(\+?504)?[9|8|3|2]\d{7}$/,"es-EC":/^(\+?593|0)([2-7]|9[2-9])\d{7}$/,"es-ES":/^(\+?34)?[6|7]\d{8}$/,"es-GT":/^(\+?502)?[2|6|7]\d{7}$/,"es-PE":/^(\+?51)?9\d{8}$/,"es-MX":/^(\+?52)?(1|01)?\d{10,11}$/,"es-NI":/^(\+?505)\d{7,8}$/,"es-PA":/^(\+?507)\d{7,8}$/,"es-PY":/^(\+?595|0)9[9876]\d{7}$/,"es-SV":/^(\+?503)?[67]\d{7}$/,"es-UY":/^(\+598|0)9[1-9][\d]{6}$/,"es-VE":/^(\+?58)?(2|4)\d{9}$/,"et-EE":/^(\+?372)?\s?(5|8[1-4])\s?([0-9]\s?){6,7}$/,"fa-IR":/^(\+?98[\-\s]?|0)9[0-39]\d[\-\s]?\d{3}[\-\s]?\d{4}$/,"fi-FI":/^(\+?358|0)\s?(4[0-6]|50)\s?(\d\s?){4,8}$/,"fj-FJ":/^(\+?679)?\s?\d{3}\s?\d{4}$/,"fo-FO":/^(\+?298)?\s?\d{2}\s?\d{2}\s?\d{2}$/,"fr-BF":/^(\+226|0)[67]\d{7}$/,"fr-BJ":/^(\+229)\d{8}$/,"fr-CD":/^(\+?243|0)?(8|9)\d{8}$/,"fr-CM":/^(\+?237)6[0-9]{8}$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"fr-GF":/^(\+?594|0|00594)[67]\d{8}$/,"fr-GP":/^(\+?590|0|00590)[67]\d{8}$/,"fr-MQ":/^(\+?596|0|00596)[67]\d{8}$/,"fr-PF":/^(\+?689)?8[789]\d{6}$/,"fr-RE":/^(\+?262|0|00262)[67]\d{8}$/,"fr-WF":/^(\+681)?\d{6}$/,"he-IL":/^(\+972|0)([23489]|5[012345689]|77)[1-9]\d{6}$/,"hu-HU":/^(\+?36|06)(20|30|31|50|70)\d{7}$/,"id-ID":/^(\+?62|0)8(1[123456789]|2[1238]|3[1238]|5[12356789]|7[78]|9[56789]|8[123456789])([\s?|\d]{5,11})$/,"ir-IR":/^(\+98|0)?9\d{9}$/,"it-IT":/^(\+?39)?\s?3\d{2} ?\d{6,7}$/,"it-SM":/^((\+378)|(0549)|(\+390549)|(\+3780549))?6\d{5,9}$/,"ja-JP":/^(\+81[ \-]?(\(0\))?|0)[6789]0[ \-]?\d{4}[ \-]?\d{4}$/,"ka-GE":/^(\+?995)?(79\d{7}|5\d{8})$/,"kk-KZ":/^(\+?7|8)?7\d{9}$/,"kl-GL":/^(\+?299)?\s?\d{2}\s?\d{2}\s?\d{2}$/,"ko-KR":/^((\+?82)[ \-]?)?0?1([0|1|6|7|8|9]{1})[ \-]?\d{3,4}[ \-]?\d{4}$/,"ky-KG":/^(\+996\s?)?(22[0-9]|50[0-9]|55[0-9]|70[0-9]|75[0-9]|77[0-9]|880|990|995|996|997|998)\s?\d{3}\s?\d{3}$/,"lt-LT":/^(\+370|8)\d{8}$/,"lv-LV":/^(\+?371)2\d{7}$/,"mg-MG":/^((\+?261|0)(2|3)\d)?\d{7}$/,"mn-MN":/^(\+|00|011)?976(77|81|88|91|94|95|96|99)\d{6}$/,"my-MM":/^(\+?959|09|9)(2[5-7]|3[1-2]|4[0-5]|6[6-9]|7[5-9]|9[6-9])[0-9]{7}$/,"ms-MY":/^(\+?60|0)1(([0145](-|\s)?\d{7,8})|([236-9](-|\s)?\d{7}))$/,"mz-MZ":/^(\+?258)?8[234567]\d{7}$/,"nb-NO":/^(\+?47)?[49]\d{7}$/,"ne-NP":/^(\+?977)?9[78]\d{8}$/,"nl-BE":/^(\+?32|0)4\d{8}$/,"nl-NL":/^(((\+|00)?31\(0\))|((\+|00)?31)|0)6{1}\d{8}$/,"nl-AW":/^(\+)?297(56|59|64|73|74|99)\d{5}$/,"nn-NO":/^(\+?47)?[49]\d{7}$/,"pl-PL":/^(\+?48)? ?([5-8]\d|45) ?\d{3} ?\d{2} ?\d{2}$/,"pt-BR":/^((\+?55\ ?[1-9]{2}\ ?)|(\+?55\ ?\([1-9]{2}\)\ ?)|(0[1-9]{2}\ ?)|(\([1-9]{2}\)\ ?)|([1-9]{2}\ ?))((\d{4}\-?\d{4})|(9[1-9]{1}\d{3}\-?\d{4}))$/,"pt-PT":/^(\+?351)?9[1236]\d{7}$/,"pt-AO":/^(\+?244)?9\d{8}$/,"ro-MD":/^(\+?373|0)((6(0|1|2|6|7|8|9))|(7(6|7|8|9)))\d{6}$/,"ro-RO":/^(\+?40|0)\s?7\d{2}(\/|\s|\.|-)?\d{3}(\s|\.|-)?\d{3}$/,"ru-RU":/^(\+?7|8)?9\d{9}$/,"si-LK":/^(?:0|94|\+94)?(7(0|1|2|4|5|6|7|8)( |-)?)\d{7}$/,"sl-SI":/^(\+386\s?|0)(\d{1}\s?\d{3}\s?\d{2}\s?\d{2}|\d{2}\s?\d{3}\s?\d{3})$/,"sk-SK":/^(\+?421)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"so-SO":/^(\+?252|0)((6[0-9])\d{7}|(7[1-9])\d{7})$/,"sq-AL":/^(\+355|0)6[2-9]\d{7}$/,"sr-RS":/^(\+3816|06)[- \d]{5,9}$/,"sv-SE":/^(\+?46|0)[\s\-]?7[\s\-]?[02369]([\s\-]?\d){7}$/,"tg-TJ":/^(\+?992)?[5][5]\d{7}$/,"th-TH":/^(\+66|66|0)\d{9}$/,"tr-TR":/^(\+?90|0)?5\d{9}$/,"tk-TM":/^(\+993|993|8)\d{8}$/,"uk-UA":/^(\+?38)?0(50|6[36-8]|7[357]|9[1-9])\d{7}$/,"uz-UZ":/^(\+?998)?(6[125-79]|7[1-69]|88|9\d)\d{7}$/,"vi-VN":/^((\+?84)|0)((3([2-9]))|(5([25689]))|(7([0|6-9]))|(8([1-9]))|(9([0-9])))([0-9]{7})$/,"zh-CN":/^((\+|00)86)?(1[3-9]|9[28])\d{9}$/,"zh-TW":/^(\+?886\-?|0)?9\d{8}$/,"dz-BT":/^(\+?975|0)?(17|16|77|02)\d{6}$/,"ar-YE":/^(((\+|00)9677|0?7)[0137]\d{7}|((\+|00)967|0)[1-7]\d{6})$/,"ar-EH":/^(\+?212|0)[\s\-]?(5288|5289)[\s\-]?\d{5}$/,"fa-AF":/^(\+93|0)?(2{1}[0-8]{1}|[3-5]{1}[0-4]{1})(\d{7})$/,"mk-MK":/^(\+?389|0)?((?:2[2-9]\d{6}|(?:3[1-4]|4[2-8])\d{6}|500\d{5}|5[2-9]\d{6}|7[0-9][2-9]\d{5}|8[1-9]\d{6}|800\d{5}|8009\d{4}))$/};function o(e,t,n){if(Object(r.a)(e),n&&n.strictMode&&!e.startsWith("+"))return!1;if(Array.isArray(t))return t.some((function(t){if(a.hasOwnProperty(t)&&a[t].test(e))return!0;return!1}));if(t in a)return a[t].test(e);if(!t||"any"===t){for(var o in a){if(a.hasOwnProperty(o))if(a[o].test(e))return!0}return!1}throw new Error("Invalid locale '".concat(t,"'"))}a["en-CA"]=a["en-US"],a["fr-CA"]=a["en-CA"],a["fr-BE"]=a["nl-BE"],a["zh-HK"]=a["en-HK"],a["zh-MO"]=a["en-MO"],a["ga-IE"]=a["en-IE"],a["fr-CH"]=a["de-CH"],a["it-CH"]=a["fr-CH"];Object.keys(a)},1254:function(e,t,n){},1264:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(5),o=n(11),i=n(1),c=n(1094),l=n(1101),u=n(9),s=n.n(u),m=n(12),b=n(3),f=n(2),d=n(207),p=n(160),g=n(1099),O=n(1097),j=n(49);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var w=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},_=function(e){var t=Object(g.a)().sendTestEmail,n=(0,Object(O.a)().getSendTestEmailStatus)(),a=y(Object(r.useState)("http://app.getautonami.com"),2),o=a[0],c=a[1],l=Object(r.useRef)();Object(r.useEffect)((function(){l.current=e}),[e]);var u=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"send_test_email"===e.data.action&&e.data.token===w.editor_nonce&&e.data.data){var n=e.data.data,r=n.email,a=n.body,o=n.subject,u=void 0===o?"":o;r&&a&&(c(e.origin),t(r,l.current,u||Object(i.__)("FunnelKit Automations - Test email subject","wp-marketing-automations"),a))}};return Object(r.useEffect)((function(){return window.addEventListener("message",u),function(){return window.removeEventListener("message",u)}}),[]),Object(r.useEffect)((function(){if(n&&1!==n){var e=2===n,t=document.getElementById("bwf_email_editor_frame");t&&t.contentWindow.postMessage({token:w.editor_nonce,action:"send_test_email",data:{isSent:e}},o)}}),[n]),!0};function h(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var C=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},T=function(e){var t=Object(g.a)().saveBroadcastContent,n=Object(O.a)(),a=n.getSaveContentStatus,o=n.getEmailsToSubmit,i=n.getCurrentEmailIndex,c=a(),l=o(),u=i(),s=Object(r.useRef)(l),m=Object(r.useRef)(u);Object(r.useEffect)((function(){s.current=l,m.current=u}),[l,u]);var b=E(Object(r.useState)("http://app.getautonami.com"),2),f=b[0],d=b[1],p=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"save_design"===e.data.action&&e.data.token===C.editor_nonce&&e.data.data){var n=e.data.data,r=n.body,a=n.design;if(r&&a){d(e.origin);var o=h(s.current);o[m.current].editor={body:r,design:a},t(o,!0)}}};return Object(r.useEffect)((function(){return window.addEventListener("message",p),function(){return window.removeEventListener("message",p)}}),[]),Object(r.useEffect)((function(){if(c&&1!==c&&e){var t=2===c,n=document.getElementById("bwf_email_editor_frame");n&&n.contentWindow.postMessage({token:C.editor_nonce,action:"save_design",data:{isSaved:t}},f)}}),[c]),!0};function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var $=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},A=function(){var e=N(Object(r.useState)("http://app.getautonami.com"),2),t=e[0],n=e[1],a=function(e){-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"wp_image_upload"===e.data.action&&e.data.token===$.editor_nonce&&e.data.data&&(n(e.origin),s())},o=Object(r.useRef)(),c=N(Object(r.useState)(""),2),l=c[0],u=c[1],s=function(){if(!wp||!wp.media)return"";o.current||(o.current=wp.media({title:Object(i.__)("Select or Upload Media","wp-marketing-automations"),button:{text:"Select Image"},multiple:!1}),o.current.on("select",(function(){var e=o.current.state().get("selection").first().toJSON();u(e.url)}))),o.current.open()};return Object(r.useEffect)((function(){return window.addEventListener("message",a),function(){return window.removeEventListener("message",a)}}),[]),Object(r.useEffect)((function(){if(l){var e=document.getElementById("bwf_email_editor_frame");e&&e.contentWindow.postMessage({token:$.editor_nonce,action:"wp_image_upload",data:{isUploaded:!0,imageURL:l}},t)}}),[l]),!0},I=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},M=function(e){var t=(0,Object(O.a)().getEmailContent)(),n=Object(r.useRef)(),a=Object(r.useRef)();Object(r.useEffect)((function(){n.current=t,a.current=function(e){var t={};for(var n in e){var r=e[n];if(r){var a={};for(var o in r)r[o]&&r[o].hasOwnProperty("tag_description")&&r[o].hasOwnProperty("tag_name")&&(a[o]={name:r[o].tag_description,value:"{{".concat(r[o].tag_name,"}}")});t[n]={name:n,mergeTags:a}}}return t}(e)}),[t,e]);var o=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"get_design"===e.data.action&&e.data.token===I.editor_nonce){var t=Object(b.Jb)(),r=n.current&&n.current.editor&&n.current.editor.design?n.current.editor.design:t,o=document.getElementById("bwf_email_editor_frame");o&&o.contentWindow.postMessage({token:I.editor_nonce,action:"get_design",data:{gotDesign:!0,json:r,subject:n.current&&n.current.subject?n.current.subject:"",mergeTags:a.current,enableLinkTrigger:!0,textDirection:Object(b.kc)()?"rtl":""}},e.origin)}};return Object(r.useEffect)((function(){return window.addEventListener("message",o),function(){return window.removeEventListener("message",o)}}),[]),!0},x=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},L=function(e){var t=function(t){-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"open_merge_tags"===t.data.action&&t.data.token===x.editor_nonce&&t.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}}),[]),!0},R=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},F=function(e){var t=function(t){-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"close_editor"===t.data.action&&t.data.token===R.editor_nonce&&t.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}}),[]),!0},G=n(484),D=function(e){var t=function(){e&&e()};return Object(r.useEffect)((function(){return window.history.pushState(null,null,window.location.href),window.addEventListener("popstate",t),function(){return window.removeEventListener("popstate",t)}}),[]),!0},B=n(7),U=n(40),V=n(26),H=n(54);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return W(u,"_invoke",function(n,r,a){var o,c,l,u=0,s=a||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,c=0,l=e,b.n=n,i}};function f(n,r){for(c=n,l=r,t=0;!m&&u&&!a&&t<s.length;t++){var a,o=s[t],f=b.p,d=o[2];n>3?(a=d===r)&&(l=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(c=0,b.v=r,b.n=o[1]):f<d&&(a=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,b.n=d,c=0))}if(a||n>1)return i;throw m=!0,r}return function(a,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&f(s,d),c=s,l=d;(t=c<2?e:l)||!m;){o||(c?c<3?(c>1&&(b.n=-1),f(c,l)):b.n=l:b.v=l);try{if(u=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(m=b.n<0)?l:n.call(r,b))!==i)break}catch(t){o=e,c=1,l=t}finally{u=1}}return{value:t,done:m}}}(n,a,o),!0),u}var i={};function c(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(W(t={},r,(function(){return this})),t),m=u.prototype=c.prototype=Object.create(s);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,W(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=u,W(m,"constructor",u),W(u,"constructor",l),l.displayName="GeneratorFunction",W(u,a,"GeneratorFunction"),W(m),W(m,a,"Generator"),W(m,r,(function(){return this})),W(m,"toString",(function(){return"[object Generator]"})),(K=function(){return{w:o,m:b}})()}function W(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(W=function(e,t,n,r){function o(t,n){W(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=z(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==z(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return X(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ee=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},te=function(){return Object(r.createElement)("div",{className:"bwf-c-save-content-loading"},Object(r.createElement)(j.a,null),Object(r.createElement)("h3",null,Object(i.__)("Loading Visual Builder","wp-marketing-automations")))},ne=function(e){var t=e.iframeRef,n=e.editorSrc;return Object(r.createElement)("iframe",{ref:t,title:Object(i.__)("Email Editor","wp-marketing-automations"),src:n,id:"bwf_email_editor_frame",style:{width:"100%",height:"100%"}})},re=function(e){var t=Object(m.i)(),n=Q(Object(r.useState)(!1),2),c=n[0],l=n[1],u=Q(Object(r.useState)(!1),2),d=u[0],p=u[1],j=Q(Object(r.useState)(!1),2),y=j[0],v=j[1],w=Q(Object(r.useState)(!1),2),h=w[0],E=w[1],k=Q(Object(r.useState)({status:!1}),2),S=k[0],C=k[1],N=e.broadcastId,P=e.contentNumber,$=e.openMergeTags,I=e.mailData,x=e.mergeTags,R=e.openLinkTrigger,z=ee.license,W=ee.editor_nonce,q=ee.url,J=Object(g.a)(),X=J.fetchCurrentMailEditorContent,re=J.saveBroadcastContent,ae=J.resetSaveContentStatus,oe=J.setEmailContentForBlock,ie=Object(O.a)(),ce=ie.getSaveContentStatus(),le=ie.getEmailContent(),ue=Q(Object(r.useState)(!1),2),se=ue[0],me=ue[1];Object(r.useEffect)((function(){se||2!==ce&&3!==ce||(me(!0),ae())}),[ce]);var be=Object(r.useCallback)((function(){l(!1),X()}));M(x||[]),_(I),T(se),A(),L($),F(be),Object(G.a)(R),D(be);var fe="//app.getautonami.com/get/".concat(z,"/").concat(W,"/").concat(q,"/crm.broadcast.").concat(N,".content.").concat(P),de=Object(r.useRef)();Object(r.useEffect)((function(){c?(re(),document.body.classList.add("bwf-c-modal-open")):(me(!1),document.body.classList.remove("bwf-c-modal-open"))}),[c]);var pe=function(){var e,n=(e=K().m((function e(){var n,r,a;return K().w((function(e){for(;;)switch(e.p=e.n){case 0:if(n=le.editor,!(r=void 0===n?{}:n).hasOwnProperty("design")||Object(f.isEmpty)(r.design)){e.n=4;break}return e.p=1,v(!0),e.n=2,s()({path:Object(b.C)("/block-migrator"),method:"POST",data:{unlayer_data:r.design,domain:q,key:z}}).then((function(e){if(e.hasOwnProperty("result")){var n=e.result,r=n.status,a=void 0!==r&&r,o=n.block_data,c=void 0===o?{}:o;if(a&&!Object(f.isEmpty)(c)&&c.hasOwnProperty("body")&&""!==c.body&&c.hasOwnProperty("settings")&&!Object(f.isEmpty)(c.settings))oe(c),Object(m.l)(Z(Z({},t),{},{editor:"block"}),"/",{});else{if(e.result.hasOwnProperty("license_error"))return v(!1),void E(!0);C({status:!0,error:e.hasOwnProperty("message")&&""!==e.message?e.message:Object(i.__)("Failed to migrate the content. Please try again later.","wp-marketing-automations")})}}else C({status:!0,error:e.hasOwnProperty("message")&&""!==e.message?e.message:Object(i.__)("Failed to migrate the content. Please try again later.","wp-marketing-automations")});v(!1)}));case 2:e.n=4;break;case 3:e.p=3,a=e.v,v(!1),C({status:!0,error:a.hasOwnProperty("message")&&""!==a.message?a.message:Object(i.__)("Failed to migrate the content. Please try again later.","wp-marketing-automations")});case 4:return e.a(2)}}),e,null,[[1,3]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Y(o,r,a,i,c,"next",e)}function c(e){Y(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}(),ge=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(r.createElement)(V.a,{status:"error",className:e?"bwf-m-0 bwf-no-b-radius bwf-w-100p bwf-ptb-5 bwf-unlayer-notice-center":"bwf-mb-16 bwf-mt-0"},Object(r.createElement)("div",{className:"bwf-display-flex"},Object(r.createElement)("div",null,Object(r.createElement)("strong",null,Object(i.__)("Notice","wp-marketing-automations")),": "+Object(i.__)("The legacy visual builder will soon be deprecated. We recommend switching the content to the new email builder.","wp-marketing-automations")+" ",Object(r.createElement)("a",{href:Object(b.ib)("",{utm_campaign:"FKA+Pro+Plugin",utm_medium:"Migrate+Legacy+Email+Builder/"},"https://funnelkit.com/docs/autonami-2/email-builder/migration-from-legacy-email-builder/"),target:"__blank"},Object(r.createElement)("span",{className:"bwf_bold"},Object(i.__)("Learn More","wp-marketing-automations")))),Object(r.createElement)(o.a,{onClick:pe,className:"bwf-btn-small is-black bwf-no-wrap",isBusy:y},Object(i.__)("Switch to New Builder","wp-marketing-automations"))))};return Object(r.createElement)(r.Fragment,null,c&&Object(r.createElement)("div",{className:"bwf-c-editor-modal-wrapper",style:{flexDirection:"column"}},ge(!0),Object(r.createElement)("div",{className:"bwf-c-editor-modal bwf-c-editor-modal-full-width"},!se&&Object(r.createElement)(te,null),!!se&&Object(r.createElement)(ne,{iframeRef:de,editorSrc:fe}))),Object(r.createElement)(r.Fragment,null,ge(!1),Object(r.createElement)("div",{className:"bwf-c-editor-button-wrapper"},Object(r.createElement)(B.a,{icon:"launch-editor",size:40}),Object(r.createElement)("div",{className:"bwf-heading5-new"},Object(i.__)("Visually get email with drop & drop builder.","wp-marketing-automations")),Object(r.createElement)(a.Button,{isTertiary:!0,onClick:function(){Object(b.fc)()?l(!0):p(!0)}},!Object(b.fc)()&&b.e,Object(i.__)("Edit","wp-marketing-automations")))),!Object(b.fc)()&&Object(r.createElement)(U.b,{isOpen:d,onRequestClose:function(){return p(!1)},modalContent:{isFeature:!0,featureTitle:Object(i.__)("Visual Builder","wp-marketing-automations"),proLink:Object(b.ib)("upgrade",{utm_medium:"Visual+Builder+Upgrade+Modal"})}}),h&&Object(r.createElement)(a.Modal,{title:Object(i.__)("License Invalid","wp-marketing-automations"),onRequestClose:function(){E(!1),l(!1)},className:"bwf-admin-modal bwf-admin-modal-squeezy"},Object(r.createElement)("div",{className:"bwf-p bwf-break-word"},Object(i.__)("Drag and Drop Email Editor requires an active license. Please go to ","wp-marketing-automations"),Object(r.createElement)("span",{className:"bwf_bold"},sprintf(Object(i.__)(" %s > %s ","wp-marketing-automations"),Object(i.__)("Settings","wp-marketing-automations"),Object(i.__)("General","wp-marketing-automations"))),Object(i.__)("and add valid license keys.","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-admin-modal-actions"},Object(r.createElement)(a.Button,{className:"bwf-modal-cancel-btn",onClick:function(){E(!1),l(!1)}},Object(i.__)("Cancel","wp-marketing-automations")),Object(r.createElement)(a.Button,{className:"components-button is-primary",onClick:function(){Object(m.l)({page:"autonami",path:"/settings"},"/",{})}},Object(i.__)("Go To Settings","wp-marketing-automations")))),Object(r.createElement)(H.a,{modalTitle:Object(i.__)("Migration","wp-marketing-automations"),errorMessage:S.error,onRequestClose:function(){return C({status:!1})},isOpen:S.status}))},ae=n(212),oe=n(44),ie=n(6),ce=n.n(ie),le=n(83),ue=n(380);function se(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return me(u,"_invoke",function(n,r,a){var o,c,l,u=0,s=a||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,c=0,l=e,b.n=n,i}};function f(n,r){for(c=n,l=r,t=0;!m&&u&&!a&&t<s.length;t++){var a,o=s[t],f=b.p,d=o[2];n>3?(a=d===r)&&(l=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(c=0,b.v=r,b.n=o[1]):f<d&&(a=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,b.n=d,c=0))}if(a||n>1)return i;throw m=!0,r}return function(a,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&f(s,d),c=s,l=d;(t=c<2?e:l)||!m;){o||(c?c<3?(c>1&&(b.n=-1),f(c,l)):b.n=l:b.v=l);try{if(u=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(m=b.n<0)?l:n.call(r,b))!==i)break}catch(t){o=e,c=1,l=t}finally{u=1}}return{value:t,done:m}}}(n,a,o),!0),u}var i={};function c(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(me(t={},r,(function(){return this})),t),m=u.prototype=c.prototype=Object.create(s);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,me(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=u,me(m,"constructor",u),me(u,"constructor",l),l.displayName="GeneratorFunction",me(u,a,"GeneratorFunction"),me(m),me(m,a,"Generator"),me(m,r,(function(){return this})),me(m,"toString",(function(){return"[object Generator]"})),(se=function(){return{w:o,m:b}})()}function me(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(me=function(e,t,n,r){function o(t,n){me(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function be(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function fe(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){be(o,r,a,i,c,"next",e)}function c(e){be(o,r,a,i,c,"throw",e)}i(void 0)}))}}function de(e){return function(e){if(Array.isArray(e))return Oe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ge(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||ge(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){if(e){if("string"==typeof e)return Oe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oe(e,t):void 0}}function Oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var je=function(e){var t=e.value,n=void 0===t?"":t,a=e.onUpdate,o=void 0===a?function(){}:a,i=e.label,c=void 0===i?"":i,l=e.placeholder,u=void 0===l?"":l,s=pe(Object(r.useState)(""),2),m=s[0],d=s[1],p=Object(r.useRef)(null),g=""!==n?n.split(","):[];return Object(r.createElement)(r.Fragment,null,""!==c&&Object(r.createElement)("div",{className:"bwf-add-mail-input-label"},c),Object(r.createElement)("div",{className:"bwf-add-mail-input-wrap",onClick:function(){return p.current.focus()}},function(){if(""!==n)return Object(r.createElement)(r.Fragment,null,g.map((function(e,t){return""!==e.trim()&&Object(r.createElement)("span",{key:t,className:"bwf-search__selected-tag",onClick:function(e){return e.stopPropagation()}},e,Object(r.createElement)("span",{onClick:function(t){t.stopPropagation();var n=de(g).filter((function(t){return t!=e}));o(n.join(","))}},Object(r.createElement)(B.a,{size:16,icon:"cross-circle"})))})))}(),g.length<10&&Object(r.createElement)("input",{type:"text",ref:p,value:m,onChange:function(e){return d(e.target.value)},onKeyDown:function(e){if(["Enter"," "].includes(e.key)&&(e.preventDefault(),Object(b.mc)(m))){var t=Object(f.cloneDeep)(g);t.push(m),o(t.join(",")),d("")}},onBlur:function(e){if(e.preventDefault(),Object(b.mc)(m)){var t=Object(f.cloneDeep)(g);t.push(m),o(t.join(",")),d("")}},autoComplete:"off",placeholder:u})))},ye=function(e){var t=e.setPreview,n=e.content,c=e.type,l=e.maildata,u=pe(Object(r.useState)(Object(b.Fb)()),2),m=u[0],d=u[1],p=pe(Object(r.useState)(!0),2),y=p[0],v=p[1],w=pe(Object(r.useState)(Object(b.Fb)()),2),_=w[0],h=w[1],E=pe(Object(r.useState)(""),2),k=E[0],S=E[1],C=pe(Object(r.useState)(!1),2),T=C[0],N=C[1],P=pe(Object(r.useState)("desktop"),2),$=P[0],A=P[1],I=Object(g.a)(),M=Object(O.a)().validateCurrentEmail(),x=Object(r.useContext)(b.h),L=I.sendTestEmail;Object(r.useEffect)((function(){R()}),[]);var R=function(){var e=fe(se().m((function e(){var t;return se().w((function(e){for(;;)switch(e.p=e.n){case 0:if(n){e.n=1;break}return d(""),v(!1),e.a(2);case 1:return e.p=1,t={content:n,type:c},e.n=2,s()({path:Object(b.C)("/broadcast/email-preview"),method:"POST",data:t}).then((function(e){d(e.result.body.replace(/\\/g,"")),v(!1)}));case 2:e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=fe(se().m((function e(){var t;return se().w((function(e){for(;;)switch(e.n){case 0:if(N(!0),n=void 0,n=!1,!Object(f.isEmpty)(_)&&M.content&&M.type&&M.utmMedium&&M.utmSource||(n=!0),n){e.n=2;break}return S(""),e.n=1,L(_,l,"","").then((function(e){setTimeout((function(){N(!1),Object(f.isInteger)(e)&&2===parseInt(e)?x(Object(i.__)("Test mail sent successfully.","wp-marketing-automations")):x(Object(i.__)("Test mail failed to send.","wp-marketing-automations")),Object(b.Pb)(x,3e3)}),1e3)}));case 1:e.n=3;break;case 2:t="",Object(f.isEmpty)(_)&&(t=Object(i.__)("Email is required.","wp-marketing-automations")),Object(f.isEmpty)(t)&&!M.content&&(t=Object(i.__)("Mail content is required field.","wp-marketing-automations")),S(t),N(!1);case 3:return e.a(2)}var n}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.createElement)(a.Modal,{className:"bwf-admin-modal bwf-admin-modal-no-header bwf-admin-modal-fullscreen bwf-fullsc-modal",shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1},Object(r.createElement)("div",{className:"bwf-stretch-header-single"},Object(r.createElement)("div",{className:"bwf-left-section"},Object(r.createElement)("div",{className:"bwf-editable-title"},Object(i.__)("Preview & Test","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwfan-responsive-toggle"},["desktop","mobile"].map((function(e){return Object(r.createElement)(o.a,{key:e,className:ce()("bwf-responsive-toggle-icon",{"active-screen":$===e}),onClick:function(){void 0!==A&&A(e)},showTooltip:!1,size:20,title:Object(f.capitalize)(e)},Object(r.createElement)(B.a,{icon:e,size:20,color:$===e?"#353030":"#82838e"}))}))),Object(r.createElement)("div",{className:"bwf-right-section"},Object(r.createElement)("div",{className:"bwf-back-button bwf-display-flex bwf-cursor-pointer",onClick:function(){return t(!1)}},Object(r.createElement)(B.a,{icon:"cross"})))),Object(r.createElement)("div",{className:"bwf-preview-model-content"},Object(r.createElement)("div",{className:"bwf-preview-model-c-sidebar"},Object(r.createElement)("div",{className:ce()("bwf-send-test-email",{"bwf-has-error":!!k})},Object(r.createElement)("div",{className:"bwf-send-test-email-header"},Object(i.__)("Send Test Email","wp-marketing-automations")),Object(r.createElement)(je,{value:_,onUpdate:function(e){var t,n;Object(b.Bc)(e),h(e),t=e,n="",Object(f.isEmpty)(t)&&(n=Object(i.__)("Email is required.","wp-marketing-automations")),S(n),Object(f.isEmpty)(n)},placeholder:Object(i.__)("Enter email addressâ€¦","wp-marketing-automations")}),""!==k&&Object(r.createElement)("div",{className:"bwf-send-email-err"},k),Object(r.createElement)(o.a,{variant:"primary",className:"bwf-test-email-btn bwf-no-ripple "+(T?"isloading":""),onClick:F},T?Object(r.createElement)(le.a,{color:"#ffffff"}):Object(i.__)("Send Email","wp-marketing-automations"))),!y&&Object(r.createElement)(ue.a,{previewData:m,content:n})),Object(r.createElement)("div",{className:"bwf-preview-model-c-preview"},Object(r.createElement)("div",{className:"bwf-iframe bwf-preview-screen-"+$},y?Object(r.createElement)(j.a,null):Object(r.createElement)("iframe",{srcDoc:m})))))},ve=n(1144),we=n(499),_e=n(171),he=function(e){var t=e.enable,n=e.position,o=e.imageURL,c=e.setData;return Object(r.createElement)("div",{className:"bwf-c-campaign-email"},Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)(a.ToggleControl,{label:Object(i.__)("Enable Image Sending","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",checked:t,onChange:function(e){return c("enable",e)}}),t&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)(a.RadioControl,{className:"bwfcrm-inline-option",selected:n,label:Object(i.__)("Select Image Position","wp-marketing-automations"),options:[{value:"after",label:Object(i.__)("After","wp-marketing-automations")},{value:"before",label:Object(i.__)("Before","wp-marketing-automations")}],onChange:function(e){return c("position",e)}}),Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)(_e.a,{image:o?{url:o}:"",onChange:function(e){!Object(f.isNull)(e)&&e.hasOwnProperty("url")?c("imageURL",e.url):c("imageURL","")}})))},Ee=n(245),ke=n(48);function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){Ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Se(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Se(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Se(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $e(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$e(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Ae=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Ie=function(){var e=Pe(Object(r.useState)(!1),2),t=e[0],n=e[1],a=Pe(Object(r.useState)(!1),2),o=a[0],i=a[1],c=Object(ke.a)(Object(b.Cb)()).formatAmount,l=Object(r.useCallback)((function(e){var t=document.getElementById("bwf_email_editor_frame");t&&t.contentWindow.postMessage({token:Ae.editor_nonce,action:"select_product_for_tool",data:{product:Te(Te({},e),{},{formattedPrice:c(e.price)})}},o),n(!1)}),[o]),u=Object(r.useCallback)((function(e){-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"select_product_for_tool"===e.data.action&&e.data.token===Ae.editor_nonce&&(i(e.origin),n(!0))}),[n]);return Object(r.useEffect)((function(){return window.addEventListener("message",u),function(){return window.removeEventListener("message",u)}}),[]),t&&Object(r.createElement)(Ee.a,{onRequestClose:function(){return n(!1)},onProductSelected:l})},Me=n(370),xe=n(31),Le=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Re=function(e){var t=e.mergeTags,n=(e.enableConditional,Object(O.a)()),a=n.getEmailContent,o=n.getCurrentEmailIndex,l=n.getLastUpdatedTime,u=n.getIsMigrating,s=a(),m=(o(),Object(r.useRef)()),d=Object(r.useRef)(),p=Object(r.useRef)(),g=c.a.getCampaignData(),j=u(),y=g.last_modified,v=void 0===y?"":y,w=l();Object(r.useEffect)((function(){m.current=s,d.current=function(e){var t={group:[],data:{}};for(var n in e){var r=e[n];if(r){var a="";switch(n){case"contact":a={label:Object(i.__)("Contact","wp-marketing-automations"),value:"contact"};break;case"contact_fields":a={label:Object(i.__)("Fields","wp-marketing-automations"),value:"contact_fields"};break;case"general":a={label:Object(i.__)("General","wp-marketing-automations"),value:"general"};break;case"affwp":a={label:Object(i.__)("Affiliate WP","wp-marketing-automations"),value:"affwp"}}t.group.push(a),t.data[n]=r}}return t}(t),p.current=j}),[s,t,j]);var _=Le.license,h=void 0===_?"":_,E=function(e){var t,n,r,a=m.current&&m.current.block&&m.current.block.body?m.current.block.body:"",o=m.current&&m.current.block&&m.current.block.settings&&!Object(f.isEmpty)(m.current.block.settings)?m.current.block.settings:{};return{title:m.current&&m.current.subject?m.current.subject:"",previewText:m.current&&m.current.preheader?m.current.preheader:"",content:a,siteSettings:Object(b.nb)(),last_updated:w||v,editorSettings:o,disableTitleHeader:!1,enableTemplate:!0,enableMergeTags:!Object(f.isEmpty)(d.current),mergeTagData:d.current,enableConditions:!1,enableMediaUpload:!0,blockSupported:[],isWCActive:Object(b.uc)(),isPro:Object(b.fc)(),proModalData:{heading:Object(i.__)("This is a Pro Feature","wp-marketing-automations"),content:Object(i.__)("We're sorry, this feature is not available on your plan. Please upgrade to the PRO plan to unlock all these awesome features.","wp-marketing-automations"),cta_text:Object(i.__)("Go Pro","wp-marketing-automations"),link:"#"},client_id:"e682ca5385e5cbd92e285aae974f73cf",client_secret:"5ab88daa93c6279318ea6fbaae56ee69",license:(r=h,r?r.split("").filter((function(e,t){return t%2!=0})).reverse().join(""):r),support:(n={},Object(b.uc)()&&(n.wc=[]),n),integrations:{wc:{blocks:[],subscriptions:!!Object(f.get)(bwfcrm_contacts_data,"is_wcs_active",!1)}},siteDomain:Object(b.zb)(),blockNavigationToolbar:[{name:"merge-tag",title:"Merge Tag",icon:'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <g> <path d="M3.375 4.3125C3.375 3.17341 4.29841 2.25 5.4375 2.25C5.74816 2.25 6 2.50184 6 2.8125C6 3.12316 5.74816 3.375 5.4375 3.375C4.91973 3.375 4.5 3.79473 4.5 4.3125V7.54386C4.5 8.10258 4.27499 8.62185 3.89825 9C4.27499 9.37815 4.5 9.89742 4.5 10.4561V13.6875C4.5 14.2053 4.91973 14.625 5.4375 14.625C5.74816 14.625 6 14.8768 6 15.1875C6 15.4982 5.74816 15.75 5.4375 15.75C4.29841 15.75 3.375 14.8266 3.375 13.6875V10.4561C3.375 10.0526 3.11678 9.69436 2.73396 9.56675L2.63462 9.53363C2.40493 9.45707 2.25 9.24212 2.25 9C2.25 8.75788 2.40493 8.54293 2.63462 8.46637L2.73396 8.43325C3.11678 8.30564 3.375 7.94739 3.375 7.54386V4.3125ZM14.625 4.3125C14.625 3.17341 13.7016 2.25 12.5625 2.25C12.2518 2.25 12 2.50184 12 2.8125C12 3.12316 12.2518 3.375 12.5625 3.375C13.0803 3.375 13.5 3.79473 13.5 4.3125V7.54386C13.5 8.10258 13.725 8.62185 14.1017 9C13.725 9.37815 13.5 9.89742 13.5 10.4561V13.6875C13.5 14.2053 13.0803 14.625 12.5625 14.625C12.2518 14.625 12 14.8768 12 15.1875C12 15.4982 12.2518 15.75 12.5625 15.75C13.7016 15.75 14.625 14.8266 14.625 13.6875V10.4561C14.625 10.0526 14.8832 9.69436 15.266 9.56675L15.3654 9.53363C15.5951 9.45707 15.75 9.24212 15.75 9C15.75 8.75788 15.5951 8.54293 15.3654 8.46637L15.266 8.43325C14.8832 8.30564 14.625 7.94739 14.625 7.54386V4.3125Z" fill="#0073AA"/> </g> </svg>',clickAction:xe.a.OPEN_MERGE_TAG,visibility:{show:["email-block/heading","email-block/button","email-block/text","email-block/list","email-block/menu"],hide:[]}},{name:"link-trigger",title:"Link Trigger",icon:'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <g> <path d="M8.38495 4.85271C8.17288 5.0012 8.12134 5.29349 8.26983 5.50555C8.40182 5.69405 8.64743 5.75572 8.84932 5.66281L8.92267 5.62067L10.4586 4.54521C11.731 3.65427 13.4847 3.9635 14.3756 5.23589C15.2309 6.45738 14.9802 8.12248 13.833 9.04197L13.685 9.15294L12.149 10.2284C11.937 10.3769 11.8854 10.6692 12.0339 10.8812C12.1659 11.0697 12.4115 11.1314 12.6134 11.0385L12.6868 10.9964L14.2227 9.92089C15.9192 8.73298 16.3315 6.39468 15.1436 4.69816C13.9953 3.05819 11.772 2.61825 10.0926 3.66379L9.92086 3.77725L8.38495 4.85271ZM3.77722 8.07908C2.0807 9.26699 1.66839 11.6053 2.85631 13.3018C4.00463 14.9418 6.22791 15.3817 7.90731 14.3362L8.07904 14.2227L9.61495 13.1473C9.82701 12.9988 9.87855 12.7065 9.73006 12.4944C9.59807 12.3059 9.35246 12.2443 9.15057 12.3372L9.07722 12.3793L7.54131 13.4548C6.26892 14.3457 4.5152 14.0365 3.62426 12.7641C2.76896 11.5426 3.01974 9.8775 4.1669 8.958L4.31494 8.84703L5.85085 7.77158C6.06292 7.62309 6.11446 7.3308 5.96597 7.11874C5.83398 6.93023 5.58837 6.86857 5.38648 6.96148L5.31313 7.00362L3.77722 8.07908ZM11.8029 6.4651L5.65926 10.7669C5.4472 10.9154 5.39566 11.2077 5.54415 11.4198C5.67614 11.6083 5.92175 11.6699 6.12364 11.577L6.19699 11.5349L12.3406 7.23305C12.5527 7.08456 12.6042 6.79228 12.4557 6.58021C12.3238 6.39171 12.0781 6.33004 11.8763 6.42295L11.8029 6.4651L5.65926 10.7669L11.8029 6.4651Z" fill="#0073AA"/> </g> </svg>',clickAction:xe.a.OPEN_LINK_TRIGGER,visibility:{show:["email-block/heading","email-block/button","email-block/text","email-block/list","email-block/menu"],hide:[]}}],isRTL:Object(b.kc)(),testEmails:Object(b.Fb)(),footer:bwfanParams.bwfan_global_settings.bwfan_email_footer_setting,webFonts:b.Mb,customFonts:b.r,version:b.l,imageSizes:b.Qb,isMigration:null!==(t=p.current)&&void 0!==t&&t}};return Object(r.useEffect)((function(){xe.c.registerRequestHandler(xe.a.GET_EDITOR_CONTENT,E)}),[]),!0},Fe=function(e){var t=Object(O.a)().getIsMigrating,n=Object(g.a)().setEmailContentByKey,a=t(),o=Object(r.useRef)();return Object(r.useEffect)((function(){o.current=a}),[a]),Object(r.useEffect)((function(){xe.c.registerRequestHandler(xe.a.CLOSE_EDITOR,(function(){if(o.current&&n("type","editor"),!e)throw{message:Object(i.__)("Close editor callback is not defined","wp-marketing-automations"),code:"CLOSE_EDITOR_ERROR"};e()}))}),[]),!0};function Ge(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return De(u,"_invoke",function(n,r,a){var o,c,l,u=0,s=a||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,c=0,l=e,b.n=n,i}};function f(n,r){for(c=n,l=r,t=0;!m&&u&&!a&&t<s.length;t++){var a,o=s[t],f=b.p,d=o[2];n>3?(a=d===r)&&(l=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(c=0,b.v=r,b.n=o[1]):f<d&&(a=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,b.n=d,c=0))}if(a||n>1)return i;throw m=!0,r}return function(a,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&f(s,d),c=s,l=d;(t=c<2?e:l)||!m;){o||(c?c<3?(c>1&&(b.n=-1),f(c,l)):b.n=l:b.v=l);try{if(u=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(m=b.n<0)?l:n.call(r,b))!==i)break}catch(t){o=e,c=1,l=t}finally{u=1}}return{value:t,done:m}}}(n,a,o),!0),u}var i={};function c(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(De(t={},r,(function(){return this})),t),m=u.prototype=c.prototype=Object.create(s);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,De(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=u,De(m,"constructor",u),De(u,"constructor",l),l.displayName="GeneratorFunction",De(u,a,"GeneratorFunction"),De(m),De(m,a,"Generator"),De(m,r,(function(){return this})),De(m,"toString",(function(){return"[object Generator]"})),(Ge=function(){return{w:o,m:b}})()}function De(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(De=function(e,t,n,r){function o(t,n){De(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function Be(e){return function(e){if(Array.isArray(e))return Ue(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ue(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ue(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Ve(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}var He=function(){var e=Object(g.a)().saveBroadcastContent,t=Object(O.a)(),n=t.getEmailsToSubmit,a=t.getCurrentEmailIndex,o=n(),c=a(),l=Object(r.useRef)(o),u=Object(r.useRef)(c);Object(r.useEffect)((function(){l.current=o,u.current=c}),[o,c]);var s=function(){var t,n=(t=Ge().m((function t(){var n,r,a,o,u,s,m,b,d,p=arguments;return Ge().w((function(t){for(;;)switch(t.p=t.n){case 0:if(n=p.length>0&&void 0!==p[0]?p[0]:{},t.p=1,r=n.block,a=void 0===r?{}:r,o=n.subject,u=void 0===o?"":o,s=n.preheader,m=void 0===s?"":s,!Object(f.isEmpty)(a)||!Object(f.isEmpty)(u)){t.n=2;break}throw Error(Object(i.__)("Please add subject or content to save","wp-marketing-automations"));case 2:return b=Be(l.current),Object(f.isEmpty)(a)||(b[c].block=a),a.hasOwnProperty("template")&&(b[c].body=a.template),""!==u&&(b[c].subject=u),""!==m&&(b[c].preheader=m),t.n=3,e(b,!0);case 3:if(d=t.v,2!==parseInt(d)){t.n=4;break}return t.a(2,{isSaved:!0});case 4:throw Error(Object(i.__)("Failed to save email content","wp-marketing-automations"));case 5:throw t.p=5,{message:t.v.message,code:"SAVE_CONTENT_ERROR"};case 6:return t.a(2)}}),t,null,[[1,5]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){Ve(o,r,a,i,c,"next",e)}function c(e){Ve(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();return Object(r.useEffect)((function(){xe.c.registerRequestHandler(xe.a.SAVE_EDITOR_CONTENT,s)}),[]),!0};function ze(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return Ke(u,"_invoke",function(n,r,a){var o,c,l,u=0,s=a||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,c=0,l=e,b.n=n,i}};function f(n,r){for(c=n,l=r,t=0;!m&&u&&!a&&t<s.length;t++){var a,o=s[t],f=b.p,d=o[2];n>3?(a=d===r)&&(l=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(c=0,b.v=r,b.n=o[1]):f<d&&(a=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,b.n=d,c=0))}if(a||n>1)return i;throw m=!0,r}return function(a,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&f(s,d),c=s,l=d;(t=c<2?e:l)||!m;){o||(c?c<3?(c>1&&(b.n=-1),f(c,l)):b.n=l:b.v=l);try{if(u=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(m=b.n<0)?l:n.call(r,b))!==i)break}catch(t){o=e,c=1,l=t}finally{u=1}}return{value:t,done:m}}}(n,a,o),!0),u}var i={};function c(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(Ke(t={},r,(function(){return this})),t),m=u.prototype=c.prototype=Object.create(s);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Ke(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=u,Ke(m,"constructor",u),Ke(u,"constructor",l),l.displayName="GeneratorFunction",Ke(u,a,"GeneratorFunction"),Ke(m),Ke(m,a,"Generator"),Ke(m,r,(function(){return this})),Ke(m,"toString",(function(){return"[object Generator]"})),(ze=function(){return{w:o,m:b}})()}function Ke(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(Ke=function(e,t,n,r){function o(t,n){Ke(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function We(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}var qe=function(e){var t=Object(g.a)().sendTestEmail,n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]);var a=function(){var e,r=(e=ze().m((function e(){var r,a,o,c,l,u=arguments;return ze().w((function(e){for(;;)switch(e.p=e.n){case 0:if(r=u.length>0&&void 0!==u[0]?u[0]:{},e.p=1,a=r.email,o=r.body,a&&o){e.n=2;break}throw Error(Object(i.__)("Please add email and content to send test email","wp-marketing-automations"));case 2:return c=n.current&&n.current.subject?n.current.subject:"",e.n=3,t(a,n.current,c,o);case 3:if(l=e.v,2!==parseInt(l)){e.n=4;break}return e.a(2,{sent:!0});case 4:throw Error(Object(i.__)("Test mail failed to send.","wp-marketing-automations"));case 5:throw e.p=5,{message:e.v.message,code:"TEST_EMAIL_ERROR"};case 6:return e.a(2)}}),e,null,[[1,5]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){We(o,r,a,i,c,"next",e)}function c(e){We(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return r.apply(this,arguments)}}();return Object(r.useEffect)((function(){xe.c.registerRequestHandler(xe.a.SEND_TEST_EMAIL,a)}),[]),!0};function Ze(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return Je(u,"_invoke",function(n,r,a){var o,c,l,u=0,s=a||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,c=0,l=e,b.n=n,i}};function f(n,r){for(c=n,l=r,t=0;!m&&u&&!a&&t<s.length;t++){var a,o=s[t],f=b.p,d=o[2];n>3?(a=d===r)&&(l=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(c=0,b.v=r,b.n=o[1]):f<d&&(a=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,b.n=d,c=0))}if(a||n>1)return i;throw m=!0,r}return function(a,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&f(s,d),c=s,l=d;(t=c<2?e:l)||!m;){o||(c?c<3?(c>1&&(b.n=-1),f(c,l)):b.n=l:b.v=l);try{if(u=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(m=b.n<0)?l:n.call(r,b))!==i)break}catch(t){o=e,c=1,l=t}finally{u=1}}return{value:t,done:m}}}(n,a,o),!0),u}var i={};function c(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(Je(t={},r,(function(){return this})),t),m=u.prototype=c.prototype=Object.create(s);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Je(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=u,Je(m,"constructor",u),Je(u,"constructor",l),l.displayName="GeneratorFunction",Je(u,a,"GeneratorFunction"),Je(m),Je(m,a,"Generator"),Je(m,r,(function(){return this})),Je(m,"toString",(function(){return"[object Generator]"})),(Ze=function(){return{w:o,m:b}})()}function Je(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(Je=function(e,t,n,r){function o(t,n){Je(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function Ye(e){return function(e){if(Array.isArray(e))return Qe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Qe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qe(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Xe(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}var et=function(e,t,n,a){var o=Object(g.a)().saveBroadcastContent,c=Object(O.a)(),l=c.getSaveContentStatus,u=c.getEmailsToSubmit,s=c.getCurrentEmailIndex,m=(l(),u()),b=s(),d=Object(r.useRef)(m),p=Object(r.useRef)(b);Object(r.useEffect)((function(){d.current=m,p.current=b}),[m,b]);var j=function(){var e,t=(e=Ze().m((function e(){var t,r,c,l,u,s,m,p,g=arguments;return Ze().w((function(e){for(;;)switch(e.p=e.n){case 0:if(t=g.length>0&&void 0!==g[0]?g[0]:{},e.p=1,r=t.block,c=void 0===r?{}:r,l=t.subject,u=void 0===l?"":l,s=t.preheader,m=void 0===s?"":s,t.utmEnable,t.utm,!Object(f.isEmpty)(c)||!Object(f.isEmpty)(u)){e.n=2;break}throw Error(Object(i.__)("please add subject or content to import","wp-marketing-automations"));case 2:return(p=Ye(d.current))[b].block=c,""!==u&&(p[b].subject=u,p[b].preheader=m),n(!0),e.n=3,o(p);case 3:return n(!0),document.getElementById("bwf_block_editor_frame").src=a,setTimeout((function(){n(!1)}),2e3),e.a(2,{isSaved:!0});case 4:throw e.p=4,{message:e.v.message,code:"IMPORT_TEMPLATE_ERROR"};case 5:return e.a(2)}}),e,null,[[1,4]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Xe(o,r,a,i,c,"next",e)}function c(e){Xe(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(r.useEffect)((function(){xe.c.registerRequestHandler(xe.a.IMPORT_TEMPLATE,j)}),[]),!0},tt=function(e){var t=function(){e&&e()};return Object(r.useEffect)((function(){return window.history.pushState(null,null,window.location.href),window.addEventListener("popstate",t),function(){return window.removeEventListener("popstate",t)}}),[]),!0},nt=n(321),rt=n.n(nt),at=n(334);function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(){return(it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}function ct(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=ot(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ot(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ut(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var st=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},mt=function(){return Object(r.createElement)("div",{className:"bwf-c-save-content-loading"},Object(r.createElement)(rt.a,{options:{loop:!0,autoplay:!0,animationData:at,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},height:480,width:480}),Object(r.createElement)("div",{style:{marginTop:"-60px",fontSize:"21px",fontWeight:"400",paddingLeft:"40px"}},Object(i.__)("Launching Editor","wp-marketing-automations")))},bt=function(e){var t=e.iframeRef,n=e.editorSrc,a=e.isImport;return Object(r.createElement)("iframe",{ref:t,title:Object(i.__)("Block Editor","wp-marketing-automations"),src:n,id:"bwf_block_editor_frame",style:{width:"100%",height:"100%",display:a?"none":"block"}})},ft=function(){return Object(r.createElement)("div",{className:"bwf-c-save-content-loading"},Object(r.createElement)(rt.a,{options:{loop:!0,autoplay:!0,animationData:at,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},height:480,width:480}),Object(r.createElement)("div",{style:{marginTop:"-60px",fontSize:"21px",fontWeight:"400",paddingLeft:"40px"}},Object(i.__)("Importing Template","wp-marketing-automations")))},dt=function(e){var t=Object(m.i)(),n=e.mailData,a=e.mergeTags,o=e.setOpen,i=e.enableConditional,c=(st.license,st.editor_nonce,st.url,Object(g.a)()),l=c.fetchCurrentMailEditorContent,u=c.saveBroadcastContent,s=c.resetSaveContentStatus,d=Object(O.a)(),p=d.getSaveContentStatus(),j=(d.getDisableSaveValue(),lt(Object(r.useState)(!1),2)),y=j[0],v=j[1],w=lt(Object(r.useState)(!1),2),_=w[0],h=w[1];Object(r.useEffect)((function(){y||2!==p&&3!==p||(v(!0),s())}),[p]);var E=Object(r.useCallback)((function(){if(t.hasOwnProperty("editor")){var e=Object(f.cloneDeep)(t);delete e.editor,Object(m.l)(e,"/",{})}o(!1),l()})),k=Object(b.U)().editorSrc;Re({mergeTags:a||[],enableConditional:i}),He(),Fe(E),qe(n),et(y,_,h,k),tt(E);var S=Object(r.useRef)();return Object(r.useEffect)((function(){return u(),document.body.classList.add("bwf-c-modal-open"),v(!1),function(){document.body.classList.remove("bwf-c-modal-open")}}),[]),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-editor-modal-wrapper"},Object(r.createElement)("div",{className:"bwf-c-editor-modal bwf-c-editor-modal-full-width"},!y&&Object(r.createElement)(mt,null),_&&Object(r.createElement)(ft,null),!!y&&Object(r.createElement)(bt,{iframeRef:S,editorSrc:k,isImport:_}))))},pt=function(e){var t=Object(m.i)().editor,n=void 0===t?"":t,o=lt(Object(r.useState)(!1),2),c=o[0],l=o[1],u=lt(Object(r.useState)(!1),2),s=u[0],f=u[1],d=(0,Object(O.a)().getDisableSaveValue)();Object(r.useEffect)((function(){("block"===n||d)&&l(!0)}),[]);var p=e.openLinkTrigger,g=e.openMergeTags,j=ct(ct({},xe.a.OPEN_LINK_TRIGGER,(function(){if(p)return p(!0),{opened:!0};throw{message:Object(i.__)("Failed to open Link trigger","wp-marketing-automations"),code:"OPEN_LINK_TRIGGER_FETCH_ERROR"}})),xe.a.OPEN_MERGE_TAG,(function(){if(g)return g(!0),{opened:!0};throw{message:Object(i.__)("Failed to open Merge Tags","wp-marketing-automations"),code:"OPEN_LINK_TRIGGER_FETCH_ERROR"}}));return c?Object(r.createElement)(r.Fragment,null,Object(r.createElement)(dt,it({},e,{setOpen:l})),Object(r.createElement)(xe.b,{customHandlers:j})):Object(r.createElement)("div",{className:"bwf-c-editor-button-wrapper"},Object(r.createElement)(B.a,{icon:"launch-editor",size:40}),Object(r.createElement)("div",{className:"bwf-heading5-new"},Object(i.__)("Utilize our drag & drop builder to craft elegant email templates including WooCommerce Blocks.","wp-marketing-automations")),Object(r.createElement)(a.Button,{isTertiary:!0,onClick:function(){Object(b.fc)()?l(!0):f(!0)}},!Object(b.fc)()&&b.e,Object(i.__)("Edit","wp-marketing-automations")),!Object(b.fc)()&&Object(r.createElement)(U.b,{isOpen:s,onRequestClose:function(){return f(!1)},modalContent:{isFeature:!0,featureTitle:Object(i.__)("New Visual Builder","wp-marketing-automations"),proLink:Object(b.ib)("upgrade",{utm_medium:"New+Visual+Builder+Upgrade+Modal"})}}))},gt=n(544),Ot=n(41),jt=n(520),yt=n(107);function vt(e){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wt(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return _t(u,"_invoke",function(n,r,a){var o,c,l,u=0,s=a||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,c=0,l=e,b.n=n,i}};function f(n,r){for(c=n,l=r,t=0;!m&&u&&!a&&t<s.length;t++){var a,o=s[t],f=b.p,d=o[2];n>3?(a=d===r)&&(l=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(c=0,b.v=r,b.n=o[1]):f<d&&(a=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,b.n=d,c=0))}if(a||n>1)return i;throw m=!0,r}return function(a,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&f(s,d),c=s,l=d;(t=c<2?e:l)||!m;){o||(c?c<3?(c>1&&(b.n=-1),f(c,l)):b.n=l:b.v=l);try{if(u=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(m=b.n<0)?l:n.call(r,b))!==i)break}catch(t){o=e,c=1,l=t}finally{u=1}}return{value:t,done:m}}}(n,a,o),!0),u}var i={};function c(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(_t(t={},r,(function(){return this})),t),m=u.prototype=c.prototype=Object.create(s);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_t(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=u,_t(m,"constructor",u),_t(u,"constructor",l),l.displayName="GeneratorFunction",_t(u,a,"GeneratorFunction"),_t(m),_t(m,a,"Generator"),_t(m,r,(function(){return this})),_t(m,"toString",(function(){return"[object Generator]"})),(wt=function(){return{w:o,m:b}})()}function _t(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(_t=function(e,t,n,r){function o(t,n){_t(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function ht(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){St(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function St(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=vt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=vt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==vt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Tt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Nt=Object(b.Db)(),Pt=[{label:Object(i.__)("Visual Builder","wp-marketing-automations"),value:"block",className:"bwf-display-flex bwf-campaign-template-type"},{label:Object(i.__)("Rich Text","wp-marketing-automations"),value:"rich",className:"bwf-display-flex bwf-campaign-template-type "},Nt.includes("wc")&&{label:Object(i.__)("WooCommerce","wp-marketing-automations"),value:"wc",className:"bwf-display-flex bwf-campaign-template-type "},{label:Object(i.__)("Raw HTML","wp-marketing-automations"),value:"html",className:"bwf-display-flex bwf-campaign-template-type"},Object(b.lc)()&&{label:Object(i.__)("Visual Builder (Legacy)","wp-marketing-automations"),value:"editor",className:"bwf-display-flex bwf-campaign-template-type"}].filter(Boolean),$t=function(e){var t=e.maildata,n=e.setTemplateModal,l=c.a.getCampaignData(),u=parseInt(l.type),s=Object(b.K)(),m=Object(g.a)(),j=m.setEmailContentByKey,y=m.setEmailUtmByKey,v=m.setMultipleUtm,w=m.resetSendTestEmailStatus,_=m.sendTestEmail,h=Object(r.useContext)(b.h),E=Ct(Object(r.useState)(!1),2),k=E[0],S=E[1],C=Ct(Object(r.useState)(""),2),T=C[0],N=C[1],P=Ct(Object(r.useState)(!1),2),$=P[0],A=P[1],I=Object(O.a)(),M=I.getEmailContent()?I.getEmailContent():{},x=Object(r.useRef)(null);Object(r.useLayoutEffect)((function(){x.current=M}),[]);var L=Object(r.useMemo)((function(){return null===x.current||JSON.stringify(x.current)===JSON.stringify(M)}),[M]),R=I.getIsMigrating(),F=Ct(Object(r.useState)(!1),2),G=F[0],D=F[1],V="utm"in M?M.utm:{},H=Ct(Object(r.useState)(!1),2),z=H[0],K=H[1],W=Ct(Object(r.useState)(""),2),q=W[0],Z=W[1],J=Ct(Object(r.useState)([]),2),Y=J[0],Q=J[1],X="subject"in M?M.subject:"",ee="preheader"in M?M.preheader:"",te="type"in M?M.type:"block",ne="utmEnabled"in M&&M.utmEnabled,ie=Ct(Object(r.useState)({message:"",type:1}),2),le=ie[0],ue=ie[1],se="whatsAppImage"in M&&M.whatsAppImage,me="whatsAppImageSetting"in M?M.whatsAppImageSetting:{},be="position"in me?me.position:"after",fe="imageURL"in me?me.imageURL:"",de="source"in V?V.source:"",pe="medium"in V?V.medium:"",ge="name"in V?V.name:"",Oe="content"in V?V.content:"",je="term"in V?V.term:"",_e=Ct(Object(r.useState)(!1),2),Ee=_e[0],ke=_e[1],Se=I.getShowValidationFlag(),Ce=Ct(Object(r.useState)(!1),2),Te=Ce[0],Ne=Ce[1],Pe=Ct(Object(r.useState)("content"),2),$e=Pe[0],Ae=Pe[1],xe=Ct(Object(r.useState)([]),2),Le=xe[0],Re=xe[1],Fe=Ct(Object(r.useState)(!1),2),Ge=Fe[0],De=Fe[1],Be=Ct(Object(r.useState)(!1),2),Ue=Be[0],Ve=Be[1],He=Ct(Object(r.useState)(""),2),ze=(He[0],He[1]),Ke=I.getCurrentEmailIndex(),We=M&&M.body?M.body:"",qe="editor"in M?M.editor:{},Ze=qe&&qe.body?qe.body:"",Je="editor"===te?Ze:We,Ye="<p>Hi {{contact_first_name}},</p><p></p>"+bwfanParams.bwfan_global_settings.bwfan_email_footer_setting;Object(r.useEffect)((function(){Object(f.isEmpty)(We)&&j("body",1==u?Ye:"Hi {{contact_first_name}},")}),[We]);var Qe=ne?kt(kt({},t),{},{utmName:ge,utmMedium:pe,utmContent:Oe,utmSource:de,utmTerm:je}):t;Object(r.useEffect)((function(){if(ne){var e={};!de&&(e.source=Object(b.s)("source")),!pe&&(e.medium=s[u].label),!ge&&(e.name=Object(f.trim)(l.title).replace(/\s/g,"+")),v(e)}}),[ne]);var Xe=I.validateCurrentEmail(),et={1:Object(i.__)("Place your HTML here","wp-marketing-automations"),2:Object(i.__)("Enter the SMS Body","wp-marketing-automations"),3:Object(i.__)("Place your message here","wp-marketing-automations")},tt=function(){return"editor"==M.type?M.hasOwnProperty("editor")&&M.editor.hasOwnProperty("body")?M.editor.body:"":M.body},nt=I.getSendTestEmailStatus();Object(r.useEffect)((function(){null!==nt&&setTimeout((function(){w(),ue({message:"",type:1})}),2e3),1!=u&&(2===nt&&ue({message:Object(i.__)("Test message sent","wp-marketing-automations"),type:1}),3===nt&&ue({message:Object(i.__)("Unable to send message","wp-marketing-automations"),type:1}))}),[nt]);var rt=Se&&!Xe.subject?" bwf-field-error":"",at=Se&&!Xe.content?" bwf-field-error-textarea":"",ot=Se&&!Xe.utmSource?" bwf-field-error":"",it=Se&&!Xe.utmMedium?" bwf-field-error":"",ct=Object(r.useMemo)((function(){return Pt.map((function(e){return!("editor"!==te&&"editor"===e.value&&!R)&&e})).filter(Boolean)}),[R,L,Ke]);return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-campaign-body"},1===u&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(yt.a,{value:X,onChange:function(e){return j("subject",e)},onButtonClick:function(){Ne(!0),Ae("subject")},buttonText:Object(r.createElement)(B.a,{size:28,icon:"merge-tag"}),label:Object(i.__)("Subject","wp-marketing-automations"),placeholder:Object(i.__)("Enter subject","wp-marketing-automations"),className:"bwf-field-m0"+rt}),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-campaign-mail-headers-wrap"},Object(r.createElement)(yt.a,{value:ee,placeholder:Object(i.__)("Enter preview text","wp-marketing-automations"),onButtonClick:function(){Ne(!0),Ae("preheader")},buttonText:Object(r.createElement)(B.a,{size:28,icon:"merge-tag"}),label:Object(i.__)("Preview Text","wp-marketing-automations"),onChange:function(e){return j("preheader",e)}})),Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)("div",{className:"bwf-heading7-new bwf-mb-8"},Object(i.__)("Template Type","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-select-template-type"},ct.map((function(e){return Object(r.createElement)("label",{key:e.value,className:ce()("components-radio-control__option",{"is-selected":te===e.value})},Object(r.createElement)("input",{type:"radio",className:"components-radio-control__input",value:e.value,onChange:function(){m.showValidation(!1),j("type",e.value)},checked:te===e.value&&"checked"}),Object(r.createElement)("span",null,e.label),"block"===e.value&&Object(r.createElement)("span",{className:"bwf-tags bwf-tag-green"},Object(i.__)("New","wp-marketing-automations")))}))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.Flex,{gap:3,justify:"flex-start"},!["editor","block"].includes(te)&&Object(r.createElement)(a.FlexItem,null,Object(r.createElement)(o.a,{className:"bwf-btn-small bwf-btn-gray btn-svg-none is-light",onClick:function(){if(Object(b.fc)())return Ae("content"),void Ne(!0);D(!0)}},Object(r.createElement)(B.a,{icon:Object(b.fc)()?"merge-tag":"king",size:16}),Object(i.__)("Merge Tags","wp-marketing-automations"))),Object(r.createElement)(a.FlexItem,null,Object(r.createElement)("div",null,Object(r.createElement)(Me.a,{canCreate:!0,isLinkTriggerOpen:Ge,onClose:function(){return De(!1)},setLinkTriggerOpen:function(e){Object(b.fc)()?De(e):D(!0)},modelOpenContent:Object(r.createElement)(o.a,{className:"bwf-btn-small bwf-btn-gray btn-svg-none is-light"},Object(r.createElement)(B.a,{icon:Object(b.fc)()?"link-trigger":"king",size:16}),Object(i.__)("Link Triggers","wp-marketing-automations")),hideButton:["editor","block"].includes(te)}))))),Object(r.createElement)(a.FlexItem,null,Object(r.createElement)(o.a,{className:"bwf-btn-small is-light",onClick:function(){Object(b.fc)()?n(!0):D(!0)}},Object(r.createElement)(B.a,{icon:Object(b.fc)()?"templates":"king",size:16}),Object(i.__)("Templates","wp-marketing-automations"))))),Object(r.createElement)("div",{className:"bwf_clear_24"})),Object(r.createElement)("div",{className:at},1===u&&("rich"===te||"wc"===te)&&Object(r.createElement)(p.a,{content:Je,keyid:"bwf-campaign-email-editor",setContent:function(e){return j("body",e)}}),("html"===te||2===u||3===u)&&Object(r.createElement)(a.TextareaControl,{value:Je,onChange:function(e){return j("body",e)},label:2===u||3===u?Object(i.__)("Message","wp-marketing-automations"):"",placeholder:et[u],rows:[2,3].includes(u)?5:24,className:"bwf-email-raw-html"}),1===u&&"editor"===te&&Object(r.createElement)(re,{broadcastId:l.id,contentNumber:parseInt(Ke),openMergeTags:function(){return Ne(!0)},mailData:Qe,mergeTags:Le,openLinkTrigger:De}),1===u&&"block"===te&&Object(r.createElement)(pt,{objectId:"emialblock",contentNumber:parseInt(Ke),openMergeTags:function(){return Ne(!0)},mailData:t,mergeTags:Le,openLinkTrigger:De,enableConditional:!!Object(b.fc)(),setConditionalModal:K,setConditionalEventOrigin:Z,setConditionalData:Q,openSiteSettings:Ve,setSiteSettingsEventOrigin:ze})),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexItem,null,Object(r.createElement)("div",{className:"bwf-display-flex gap-12"},1==u&&Object(r.createElement)(we.a,{templateData:M,type:1,checkIfValid:function(){return!!Xe.subject||(m.showValidation(!0),!1)}}),1!=u&&Object(r.createElement)("div",null,Object(r.createElement)(o.a,{isTertiary:!0,className:"bwf-btn-grey bwf-btn-small",onClick:function(){S(!0)}},Object(i.__)("Send Test Message","wp-marketing-automations")),k&&Object(r.createElement)(Ot.a,{className:"bwf-campaign-test-mail-popup",onFocusOutside:function(){S(!1)},onClick:function(e){return e.stopPropagation()},focusOnMount:"no-focus"},Object(r.createElement)("div",{className:"bwf-campaign-test-mail-wrap"},Object(r.createElement)("div",{className:"bwf-p",style:{marginBottom:"16px"}},Object(r.createElement)(a.TextControl,{value:T,onChange:function(e){return N(e)},placeholder:Object(i.__)("Enter phone no.","wp-marketing-automations")})),Object(r.createElement)(o.a,{isPrimary:!0,isBusy:$,onClick:function(){var e,t=(e=wt().m((function e(t){var n;return wt().w((function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),A(!0),r=void 0,r=!1,!(Object(f.isEmpty)(T)||![2,3].includes(u)&&!Object(b.mc)(T)||[2,3].includes(u)&&!Object(ve.a)(T))&&Xe.content&&Xe.type&&Xe.utmMedium&&Xe.utmSource||(r=!0),r){e.n=2;break}return e.n=1,_(T,Qe,"","").then((function(){setTimeout((function(){A(!1),S(!1)}),1e3)})).catch((function(e){console.log(e),A(!1),S(!1),h(Object(i.__)("Unable to send message","wp-marketing-automations")),Object(b.Pb)(h,3e3)}));case 1:e.n=3;break;case 2:n="",Object(f.isEmpty)(T)&&[2,3].includes(u)&&(n=Object(i.__)("Phone is required field.","wp-marketing-automations")),Object(f.isEmpty)(n)&&[2,3].includes(u)&&(Object(ve.a)(T)||(n=Object(i.__)("Entered phone is not valid.","wp-marketing-automations"))),Object(f.isEmpty)(n)&&!Xe.content&&(n=Object(i.__)("Content is required field.","wp-marketing-automations")),ue({message:n,type:2}),A(!1);case 3:return e.a(2)}var r}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){ht(o,r,a,i,c,"next",e)}function c(e){ht(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}()},Object(i.__)("Send","wp-marketing-automations"))))),1==u&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(o.a,{isTertiary:!0,className:"bwf-btn-grey bwf-btn-small",onClick:function(){Object(f.isEmpty)(tt())?ue({message:Object(i.__)("No content available for preview.","wp-marketing-automations"),status:2}):ke(!0)}},Object(i.__)("Preview and Test","wp-marketing-automations")),Ee&&Object(r.createElement)(ye,{setPreview:ke,content:tt(),type:te,maildata:t})))),Object(r.createElement)(a.FlexItem,null,!(1===u&&["editor","block"].includes(te))&&3!==u&&Object(r.createElement)(o.a,{isTertiary:!0,className:"bwf-btn-grey bwf-btn-small",onClick:function(e){e.preventDefault(),Ae("content");var t=2===u?bwfanParams.bwfan_global_settings.bwfan_sms_unsubscribe_text:bwfanParams.bwfan_global_settings.bwfan_email_footer_setting;j("body","".concat(Je||""," \n").concat(t))}},Object(i.__)("Add Unsubscribe Text","wp-marketing-automations")))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)(oe.a,{checked:ne,label:Object(i.__)("Automatically append UTM parameters to email links","wp-marketing-automations"),className:"bwf-crm-campaign-third-step-utm",onChange:function(e){return j("utmEnabled",e)}}),ne&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-campaign-utm-section"},Object(r.createElement)(a.TextControl,{value:de,onChange:function(e){return y("source",e.replace(/\s/g,"+"))},label:Object(i.__)("Campaign Source","wp-marketing-automations"),placeholder:Object(i.__)("Enter UTM source","wp-marketing-automations"),help:Object(i.__)("Referrer: (e.g., google, newsletter)","wp-marketing-automations"),className:"bwf-field-comp-label-content"+ot}),Object(r.createElement)(a.TextControl,{value:pe,onChange:function(e){return y("medium",e.replace(/\s/g,"+"))},label:Object(i.__)("Campaign Medium","wp-marketing-automations"),placeholder:Object(i.__)("Enter UTM medium","wp-marketing-automations"),help:Object(i.__)("Marketing medium: (e.g., CPC, banner, email)","wp-marketing-automations"),className:"bwf-field-comp-label-content"+it}),Object(r.createElement)(a.TextControl,{value:ge,onChange:function(e){return y("name",e.replace(/\s/g,"+"))},label:Object(i.__)("Campaign Name","wp-marketing-automations"),placeholder:Object(i.__)("Enter UTM name","wp-marketing-automations"),help:Object(i.__)("Product, promo code, or slogan (e.g., spring_sale)","wp-marketing-automations"),className:"bwf-field-comp-label-content"}),Object(r.createElement)(a.TextControl,{value:je,onChange:function(e){return y("term",e.replace(/\s/g,"+"))},label:Object(i.__)("Campaign Term","wp-marketing-automations"),placeholder:Object(i.__)("Enter UTM term","wp-marketing-automations"),className:"bwf-field-comp-label-content"}),Object(r.createElement)(a.TextControl,{value:Oe,onChange:function(e){return y("content",e.replace(/\s/g,"+"))},label:Object(i.__)("Campaign Content","wp-marketing-automations"),placeholder:Object(i.__)("Enter UTM content","wp-marketing-automations"),className:"bwf-field-comp-label-content bwf-mb-0"}))),3==u&&Object(r.createElement)(he,{enable:se,position:be,imageURL:fe,setData:function(e,t){if("enable"==e)j("whatsAppImage",t);else if(["position","imageURL"].includes(e)){var n={position:be,imageURL:fe};n[e]=t,j("whatsAppImageSetting",n)}}}),Object(r.createElement)(d.a,{message:le.message,type:le.type,removeMessage:function(){return ue({message:"",type:1})}})),Object(r.createElement)(ae.a,{isOpen:Te,setOpenTags:Ne,onMergeTagSelected:function(e){"subject"===$e&&j("subject","".concat(X||""," ").concat(e)),"preheader"===$e&&j("preheader","".concat(ee||""," ").concat(e)),"content"===$e&&j("body","".concat(Je||""," ").concat(e)),Ne(!1)},onMergeTagsLoaded:function(e){return Re(e)}}),Object(r.createElement)(jt.a,{isOpen:Ue,setOpen:Ve}),Object(b.uc)()&&Object(r.createElement)(Ie,null),Object(b.fc)()&&Object(r.createElement)(gt.a,{isConditionalModal:z,setConditionalModal:K,conditionalEventOrigin:q,setConditionalData:Q,conditionalData:Y}),!Object(b.fc)()&&Object(r.createElement)(U.b,{isOpen:G,onRequestClose:function(){return D(!1)},modalContent:{isFeature:!0,featureTitle:Object(i.__)("Broadcast","wp-marketing-automations")}}))},At=n(521),It=(n(1254),n(68)),Mt=function(e){var t=Object(g.a)(),n=Object(O.a)(),o=n.getSmartSendSettings(),c=o.enable,l=o.percent,u=o.hours,s=t.setSmartSendByKey,m=n.getShowValidationFlag(),b=n.getEmails();return Array.isArray(b)&&b.length>1?Object(r.createElement)("div",{className:"bwf-c-campaign-email bwf-mt-24 bwf-campaign-smart-send-container"},Object(r.createElement)("div",{className:"bwf-heading3-new bwf-mb-16"},Object(i.__)("Smart Sending","wp-marketing-automations")),Object(r.createElement)(a.ToggleControl,{label:Object(i.__)("Enable Smart Sending","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",checked:c,onChange:function(e){return s("enable",e)}}),c&&Object(r.createElement)("div",{className:"bwf-display-flex"},Object(r.createElement)("div",{className:"bwf-w-280"}),Object(r.createElement)("div",{className:"bwf-w-100p"},parseInt(l)>0&&parseInt(u)>0?Object(r.createElement)("div",{className:"bwf-campaign-smart-send-notice"},Object(r.createElement)("div",{className:"bwf-campaign-smart-s-svg"},Object(r.createElement)(B.a,{icon:"icon-bulb",width:13,height:17})),Object(r.createElement)("div",{className:"bwf-campaign-smart-send-n-txt"},Object(r.createElement)("span",{className:"bwf-n-b"},Object(i.__)("How Smart Sending Works?","wp-marketing-automations")),Object(r.createElement)("span",null,Object(i.sprintf)(Object(i.__)("This broadcast will first go to %d percent of your contacts. After %d hours, the variant with the highest open rate will be sent to the rest.","wp-marketing-automations"),parseInt(l),parseInt(u))))):Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)(a.TextControl,{type:"number",value:l,onChange:function(e){return s("percent",e)},label:Object(i.__)("Sample size (in percent)","wp-marketing-automations"),placeholder:Object(i.__)("Enter percent","wp-marketing-automations"),className:ce()({"bwf-field-comp-label-content":!0,"bwf-field-error":m&&!parseInt(l)})}),Object(r.createElement)(a.TextControl,{type:"number",value:u,onChange:function(e){return s("hours",e)},label:Object(i.__)("Wait time (in hours)","wp-marketing-automations"),placeholder:Object(i.__)("Enter hour difference","wp-marketing-automations"),className:ce()({"bwf-field-comp-label-content":!0,"bwf-mb-0":!0,"bwf-field-error":m&&!parseInt(u)})})))):null};function xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Lt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Rt="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Ft=function(e){var t=e.mailData,n=e.unsubscribeLink,a=e.errMsg,o=Object(g.a)(),l=Object(O.a)(),u=o.setCurrentEmail,s=o.addEmail,m=o.showValidation,d=o.deleteEmail,p=o.overrideCurrentContent,j=xt(Object(r.useState)(!1),2),y=j[0],v=j[1],w=l.getEmails(),_=l.getCurrentEmail(),h=l.getSmartSendSettings(),E=l.emailsValidToSubmit(),k=l.getShowValidationFlag(),S=c.a.getCampaignData(),C=!!(S&&S.data&&S.data.ab_type)&&"ab"===S.data.ab_type,T=Object(r.useRef)(!1),N=Object(r.useCallback)((function(e){return ce()({active:_===e})})),P=!C||!![!h.enable||!!parseInt(h.hours)&&w.length>1,!h.enable||!!parseInt(h.percent)&&w.length>1].reduce((function(e,t){return e&&t}),!0),$=Object(r.useContext)(b.h);return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:""},(!E||!P||!n)&&k&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(It.a,null),Object(r.createElement)(V.a,{className:"bwf-error-notice",status:"error",onRemove:function(){return m(!1)}},(!E||!P)&&Object(i.__)("Some required fields are not filled, check below","wp-marketing-automations"),!n&&Object(r.createElement)(r.Fragment,null,(!E||!P)&&Object(r.createElement)("br",null),Object(f.isEmpty)(a)?Object(i.__)("{{unsubscribe_link}} are required merge tags, they must be missing from the email body","wp-marketing-automations"):a))),C&&Object(r.createElement)("div",{className:"bwf-c-campaign-email-tabs bwf-mb-16"},Object(r.createElement)("ul",null,w.map((function(e,t){return Object(r.createElement)("li",{onClick:function(){return function(e){!T.current&&u(e),T.current=!1}(e)},className:N(e),key:"bwf-c-campaign-email-tabs-".concat(t)},0===t?Object(i.__)("Control","wp-marketing-automations"):Object(i.__)("Variant","wp-marketing-automations")," ",t>0&&Rt[parseInt(t)%Rt.length-1],t>0&&Object(r.createElement)("span",{className:"bwf-w-20 bwf-h-20 bwf-cursor-pointer bwf-ml-4 bwf-display-flex",onClick:function(){return function(e){T.current=!0,d(e)}(e)}},Object(r.createElement)(B.a,{icon:"cross",size:16})))})),w.length<3&&Object(r.createElement)("li",{className:"bwf-c-campaign-email-variant"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-h-20",onClick:function(){return s()}},Object(r.createElement)("span",{className:"bwf-rotate-45 bwf-p-0"},Object(r.createElement)(B.a,{icon:"cross",size:16,color:"#353030"})),Object(r.createElement)("span",null,Object(i.__)("Add Variant","wp-marketing-automations")))))),1===parseInt(S.type)&&Object(r.createElement)("span",{className:"bwf-c-campaign-template-selector"},Object(r.createElement)(At.a,{showText:!1,openTemplate:y,setTemplateModal:v,applyTemplate:function(e){p(e),$(Object(i.__)("Template Applied Successfully.","wp-marketing-automations")),setTimeout((function(){$("")}),2e3)}})),Object(r.createElement)($t,{maildata:t,setTemplateModal:v}),Object(r.createElement)(Mt,null)))},Gt=n(77);function Dt(e){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return Ut(u,"_invoke",function(n,r,a){var o,c,l,u=0,s=a||[],m=!1,b={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,c=0,l=e,b.n=n,i}};function f(n,r){for(c=n,l=r,t=0;!m&&u&&!a&&t<s.length;t++){var a,o=s[t],f=b.p,d=o[2];n>3?(a=d===r)&&(l=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(c=0,b.v=r,b.n=o[1]):f<d&&(a=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,b.n=d,c=0))}if(a||n>1)return i;throw m=!0,r}return function(a,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&f(s,d),c=s,l=d;(t=c<2?e:l)||!m;){o||(c?c<3?(c>1&&(b.n=-1),f(c,l)):b.n=l:b.v=l);try{if(u=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(m=b.n<0)?l:n.call(r,b))!==i)break}catch(t){o=e,c=1,l=t}finally{u=1}}return{value:t,done:m}}}(n,a,o),!0),u}var i={};function c(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(Ut(t={},r,(function(){return this})),t),m=u.prototype=c.prototype=Object.create(s);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Ut(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=u,Ut(m,"constructor",u),Ut(u,"constructor",l),l.displayName="GeneratorFunction",Ut(u,a,"GeneratorFunction"),Ut(m),Ut(m,a,"Generator"),Ut(m,r,(function(){return this})),Ut(m,"toString",(function(){return"[object Generator]"})),(Bt=function(){return{w:o,m:b}})()}function Ut(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(Ut=function(e,t,n,r){function o(t,n){Ut(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function Vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(n),!0).forEach((function(t){zt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Dt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Dt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kt(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function Wt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return qt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.default=function(e){var t=Object(m.i)(),n=Wt(Object(r.useState)({message:"",type:1}),2),u=n[0],p=n[1],j=Wt(Object(r.useState)([]),2),y=j[0],v=j[1],w=Wt(Object(r.useState)([]),2),_=w[0],h=w[1],E=Wt(Object(r.useState)(Object(b.S)("from_name")),2),k=E[0],S=E[1],C=Wt(Object(r.useState)(Object(b.S)("from_email")),2),T=C[0],N=C[1],P=Wt(Object(r.useState)(Object(b.S)("reply_to_email")),2),$=P[0],A=P[1],I=Wt(Object(r.useState)(""),2),M=I[0],x=I[1],L=Object(l.a)().setCampaignValues,R=c.a.getCampaignId(),F=c.a.getCampaignData(),G=parseInt(F.type);Object(r.useEffect)((function(){F&&!Object(f.isNull)(F.data)&&(F.data.hasOwnProperty("content")&&!Object(f.isEmpty)(F.data.content)?v(F.data.content):v(1==G?[{subject:"",preheader:"",type:"block",body:"",utm:{}}]:[{body:"",utm:{}}]),F.data.hasOwnProperty("senders_name")&&S(F.data.senders_name),F.data.hasOwnProperty("senders_email")&&N(F.data.senders_email),F.data.hasOwnProperty("replyto")&&!Object(f.isEmpty)(F.data.replyto)&&A(F.data.replyto))}),[]);var D=Object(Gt.a)().setL2Title;Object(r.useEffect)((function(){D("title"in F?Object(r.createElement)(r.Fragment,null,F.title):"")}),[F]);var B={name:1!==G||null===k||k.length>0,email:1!==G||null===T||Object(b.mc)(T),content:null===y||y.length>0},U=Object(O.a)(),V=U.emailsValidToSubmit(),H=U.getEmails(),z=U.getAllEmailContent(),K=U.getSmartSendSettings(),W=Object(g.a)();Object(r.useEffect)((function(){if(F&&F.data){var e=!F.data.ab_type||"ab"===F.data.ab_type,t=F.data.content?Array.isArray(F.data.content)&&!e?[F.data.content[0]]:F.data.content:[],n=F.data.smart_send&&e?F.data.smart_send:{};W.initContent(t,n)}}),[R]);var q=!![1!==G||k&&k.length>0,1!==G||T&&Object(b.mc)(T),1!==G||Object(f.isEmpty)($)||$&&Object(b.mc)($)].reduce((function(e,t){return e&&t}),!0),Z=!(!(F&&F.data&&F.data.ab_type)||"ab"===F.data.ab_type)||!![!K.enable||!!parseInt(K.hours)&&H.length>1,!K.enable||!!parseInt(K.percent)&&H.length>1].reduce((function(e,t){return e&&t}),!0),J=function(){if(1!==G)return!0;var e=Object(b.G)();x("");var t=!0,n=[];return H.map((function(r){var a=z.hasOwnProperty(r)?z[r]:{},o="";a.hasOwnProperty("type")&&("editor"==a.type?a.hasOwnProperty("editor")&&a.editor.hasOwnProperty("body")&&(o=a.editor.body):a.hasOwnProperty("body")&&(o=a.body)),o.includes("{{mail_footer}}")||(t=(e.includes("unsubscribe_link")||o.includes("unsubscribe_link"))&&(e.includes("business_name")||o.includes("business_name"))&&(e.includes("business_address")||o.includes("business_address")))||(e.includes("unsubscribe_link")||o.includes("unsubscribe_link")||n.includes("{{unsubscribe_link}}")||n.push("{{unsubscribe_link}}"),e.includes("business_name")||o.includes("business_name")||n.includes("{{business_name}}")||n.push("{{business_name}}"),e.includes("business_address")||o.includes("business_address")||n.includes("{{business_address}}")||n.push("{{business_address}}"))})),Object(f.isEmpty)(n)||x(Object(i.__)("The required merge tags","wp-marketing-automations")+" "+n.join(", ")+(n.length>1?" are ":" is ")+" "+Object(i.__)("missing in the email body","wp-marketing-automations")),h(t),t},Y=function(){var t,n=(t=Bt().m((function t(){var n,r,a,o;return Bt().w((function(t){for(;;)switch(t.p=t.n){case 0:if(n=J(),W.showValidation(!1),!(q&&V&&Z&&n)){t.n=5;break}return e.setPending(!0),t.p=1,r=Ht({content:H.map((function(e){return V[e]})),senders_name:k,senders_email:T,replyto:$,modified_by:Object(b.Q)()},K.enable?{smart_send:{enable:K.enable,percent:K.percent,hours:K.hours}}:{}),a={content:JSON.stringify(r),step:3},t.n=2,s()({path:Object(b.C)("/broadcast/".concat(R)),method:"POST",data:a}).then((function(e){200===e.code?(L("data",e.result),L("step",4)):p({message:e.message,type:0})}));case 2:t.n=4;break;case 3:t.p=3,o=t.v,p({message:o.message,type:0});case 4:e.setPending(!1),t.n=6;break;case 5:W.showValidation(!0);case 6:return t.a(2)}}),t,null,[[1,3]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){Kt(o,r,a,i,c,"next",e)}function c(e){Kt(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}(),Q=B&&!B.email?" bwf-field-error":"",X=B&&!B.name?" bwf-field-error":"";return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(It.a,null),Object(r.createElement)("div",{className:"bwf-campaign-step-div bwf-card-wrap bwf-campaign-step-3"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(r.createElement)("span",{className:"bwf-form-title"},Object(i.__)("Content","wp-marketing-automations"))),1===G&&Object(r.createElement)("div",{className:"bwf-p-gap"},Object(r.createElement)("div",{className:"bwf-c-campaign-email"},Object(r.createElement)(a.TextControl,{value:k,onChange:S,label:Object(i.__)("From Name","wp-marketing-automations"),placeholder:Object(i.__)("Enter From Name","wp-marketing-automations"),className:X}),Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:T,onChange:N,label:Object(i.__)("From Email","wp-marketing-automations"),placeholder:Object(i.__)("Enter From Email","wp-marketing-automations"),className:Q})),Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:$,placeholder:Object(i.__)("Enter Reply-To Email","wp-marketing-automations"),label:Object(i.__)("Reply-To Email","wp-marketing-automations"),onChange:A}))))),Object(r.createElement)("div",{className:"bwf-p-gap "+(1===parseInt(G)?"bwf-pt-0":"")},Object(r.createElement)(Ft,{mailData:{reply_to:$,senders_email:T,senders_name:k},unsubscribeLink:_,errMsg:M}),Object(r.createElement)(d.a,{message:u.message,type:u.type,removeMessage:function(){return p({message:"",type:1})}})),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-crm-campaign-navigation"},Object(r.createElement)(o.a,{className:"bwf-crm-navigation-previous",isSecondary:!0,onClick:function(){var e=F.data&&!Object(f.isNull)(F.data)&&F.data.hasOwnProperty("filters")?F.data.filters:{};Object(f.isEmpty)(e)||Object(m.l)(e,"/",t),L("step",2)}},Object(i.__)("Previous","wp-marketing-automations")),Object(r.createElement)(o.a,{isPrimary:!0,className:"bwf-crm-navigation-next",disabled:!q,onClick:Y,isBusy:e.isPending},Object(i.__)("Next","wp-marketing-automations"))))))}}}]);